var kc=Object.defineProperty;var Cc=(s,e,t)=>e in s?kc(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ee=(s,e,t)=>Cc(s,typeof e!="symbol"?e+"":e,t);import{j as n,aS as Mt,c6 as Nc,T as Gr,bo as pa,ay as js,aB as Wt,Y as ks,aw as Xs,G as yo,C as Ec,ab as Tc,aG as bo,bV as Ac,bX as _o,bY as xo,aC as Zs,bW as Mc,a9 as ct,ba as wo,bv as So,am as Ic,K as jo,X as jn,V as Oc,k as Pc,m as Lc,c7 as fa,c8 as Dc,I as Rc,N as ga,aQ as va}from"./ui-B8VyAbFl.js";import{r as Y,g as Fc,d as ya,a as Vc,b as Uc}from"./vendor-DG599jyl.js";import{a as er,u as qc,c as kr}from"./query-CWB_8EHL.js";import{u as Bc,a as $c,b as Jc,c as Gc,d as zc,g as Yc,e as Wc,h as Hc,i as Kc,j as Qc}from"./agentService-CIaYz9sF.js";import{p as Et,B as je,Q as mr,R as pr,U as Oe,V as ze,C as Ae,d as Le,e as De,b as Me,g as be,h as _e,i as xe,j as we,k as re,I as ye,T as ht,s as qt,v as Bt,w as $t,x as Jt,y as Xc,L as H,q as jt,t as X,c as Zc,u as eu}from"./index-BJQAqHy1.js";import{A as tr,a as sr}from"./avatar-CY5DU8VH.js";import{T as tu,a as su,b as Ms,c as Is,d as ru,e as ts}from"./table-D9-4Z--A.js";import{g as nu,a as au,u as iu}from"./defaultAssistantTemplateService-AysMmEVJ.js";import{S as ou}from"./slider-DNb3zHE4.js";import{a as ps}from"./client-BpmmoQGL.js";import{g as ba,a as _a,b as xa,T as wa,V as Sa,M as ja,c as ka,d as Ca,e as Na}from"./vapiProviders-Dxd86dpD.js";import{u as lu}from"./router-BnJytTjr.js";const Ea=({agent:s,details:e,isLoading:t,onUpdateField:r,onUpdateSystemMessage:a,onDelete:i,onPublishToggle:l,isPublished:c,isSaving:d,onTalkToAssistant:m,MODEL_PROVIDERS:g,VOICE_PROVIDERS:_,TRANSCRIBER_PROVIDERS:T,getProviderModels:N,getProviderVoices:k,getTranscriberModels:y,normalizeProviderValue:w,getInitials:C})=>{var I,E,O,p,B,K,R,he,A,z,j,F,D,ae,Te;return t?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 min-h-[400px]",children:[n.jsx(Mt,{className:"h-10 w-10 animate-spin text-indigo-500 mb-4"}),n.jsx("p",{className:"text-white/60",children:"Fetching Vapi agent details..."})]}):n.jsxs("div",{className:"flex flex-col h-full bg-[#0b0f2e]",children:[n.jsxs("div",{className:"p-6 border-b border-white/10 flex items-center justify-between sticky top-0 bg-[#0b0f2e] z-10",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx(tr,{className:"h-16 w-16 ring-2 ring-indigo-500/20",children:n.jsx(sr,{className:"text-white bg-gradient-to-br from-indigo-500/30 to-purple-500/30 text-xl font-bold",children:C(s.name)})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:s.name}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx(Et,{variant:"secondary",className:"bg-green-500/20 text-green-400 border border-green-500/30",children:"Active"}),n.jsxs("span",{className:"text-sm text-white/50 font-mono",children:["ID: ",String(s.id).substring(0,12),"..."]}),d&&n.jsxs("div",{className:"flex items-center text-xs text-blue-400",children:[n.jsx(Mt,{className:"h-3 w-3 mr-1 animate-spin"}),"Auto-saving..."]})]})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs(je,{size:"sm",onClick:m,className:"bg-gradient-to-r from-teal-500 to-cyan-600 hover:from-teal-600 hover:to-cyan-700 text-white shadow-lg",children:[n.jsx(Nc,{className:"h-4 w-4 mr-2"}),"Talk"]}),n.jsx(je,{variant:c?"default":"outline",size:"sm",onClick:()=>l(s),className:c?"bg-green-600 hover:bg-green-700 text-white":"text-white bg-transparent hover:bg-white/10 border-white/20",children:c?"Published":"Publish"}),n.jsx(je,{variant:"outline",size:"sm",onClick:()=>i(s),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10 border-red-400/30",children:n.jsx(Gr,{className:"h-4 w-4"})})]})]}),n.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:n.jsxs(mr,{defaultValue:"model",className:"w-full",children:[n.jsxs(pr,{className:"flex flex-wrap items-center gap-2 mb-8 bg-transparent p-0 h-auto",children:[n.jsxs(Oe,{value:"model",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[n.jsx(pa,{className:"h-4 w-4 mr-2"}),"Model"]}),n.jsxs(Oe,{value:"voice",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[n.jsx(js,{className:"h-4 w-4 mr-2"}),"Voice"]}),n.jsxs(Oe,{value:"transcriber",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[n.jsx(Wt,{className:"h-4 w-4 mr-2"}),"Transcriber"]}),n.jsxs(Oe,{value:"advanced",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag z-0",children:[n.jsx(ks,{className:"h-4 w-4 mr-2"}),"Advanced"]})]}),n.jsxs(ze,{value:"model",className:"space-y-6",children:[n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Le,{children:n.jsxs(De,{className:"flex items-center text-white gap-2",children:[n.jsx(pa,{className:"h-5 w-5 text-indigo-400"}),"Model Configuration"]})}),n.jsxs(Me,{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Provider"}),n.jsxs(be,{value:w(((I=e==null?void 0:e.model)==null?void 0:I.provider)||"","model"),onValueChange:W=>r("model.provider",W),children:[n.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(xe,{placeholder:((E=e==null?void 0:e.model)==null?void 0:E.provider)||"Select provider"})}),n.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:g.map(W=>n.jsx(re,{value:W.id,children:n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("span",{children:W.name})})},W.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Model"}),n.jsxs(be,{value:((O=e==null?void 0:e.model)==null?void 0:O.model)||"",onValueChange:W=>r("model.model",W),children:[n.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(xe,{placeholder:((p=e==null?void 0:e.model)==null?void 0:p.model)||"Select model"})}),n.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:N(((B=e==null?void 0:e.model)==null?void 0:B.provider)||"openai").map(W=>n.jsx(re,{value:W.id,children:n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"font-medium text-white",children:W.name}),n.jsx("span",{className:"text-xs text-white/50",children:W.id})]})},W.id))})]})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Temperature"}),n.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",type:"number",min:"0",max:"1",step:"0.1",value:((K=e==null?void 0:e.model)==null?void 0:K.temperature)||.7,onChange:W=>r("model.temperature",parseFloat(W.target.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Max Tokens"}),n.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",type:"number",value:((R=e==null?void 0:e.model)==null?void 0:R.maxTokens)||1e3,onChange:W=>r("model.maxTokens",parseInt(W.target.value))})]})]})]})]}),n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Le,{children:n.jsxs(De,{className:"flex items-center text-white gap-2",children:[n.jsx(Xs,{className:"h-5 w-5 text-indigo-400"}),"System Prompt"]})}),n.jsx(Me,{children:n.jsx(ht,{className:"bg-white/5 border-white/10 text-white min-h-[300px]",value:((z=(A=(he=e==null?void 0:e.model)==null?void 0:he.messages)==null?void 0:A[0])==null?void 0:z.content)||(e==null?void 0:e.systemMessage)||"",onChange:W=>a(W.target.value),placeholder:"You are a helpful assistant..."})})]})]}),n.jsx(ze,{value:"voice",className:"space-y-6",children:n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Le,{children:n.jsxs(De,{className:"flex items-center text-white gap-2",children:[n.jsx(js,{className:"h-5 w-5 text-indigo-400"}),"Voice Configuration"]})}),n.jsx(Me,{className:"space-y-6",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Voice Provider"}),n.jsxs(be,{value:w(((j=e==null?void 0:e.voice)==null?void 0:j.provider)||"","voice"),onValueChange:W=>r("voice.provider",W),children:[n.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(xe,{})}),n.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:_.map(W=>n.jsx(re,{value:W.id,children:W.name},W.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Voice ID"}),n.jsxs(be,{value:((F=e==null?void 0:e.voice)==null?void 0:F.voiceId)||"",onValueChange:W=>r("voice.voiceId",W),children:[n.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(xe,{placeholder:"Select voice..."})}),n.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:k(((D=e==null?void 0:e.voice)==null?void 0:D.provider)||"11labs").map(W=>n.jsx(re,{value:W.id,children:W.name},W.id))})]})]})]})})]})}),n.jsx(ze,{value:"transcriber",className:"space-y-6",children:n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Le,{children:n.jsxs(De,{className:"flex items-center text-white gap-2",children:[n.jsx(Wt,{className:"h-5 w-5 text-indigo-400"}),"Transcriber"]})}),n.jsx(Me,{className:"space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"STT Provider"}),n.jsxs(be,{value:((ae=e==null?void 0:e.transcriber)==null?void 0:ae.provider)||"deepgram",onValueChange:W=>r("transcriber.provider",W),children:[n.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(xe,{})}),n.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:T.map(W=>n.jsx(re,{value:W.id,children:W.name},W.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Language"}),n.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",value:((Te=e==null?void 0:e.transcriber)==null?void 0:Te.language)||"en",onChange:W=>r("transcriber.language",W.target.value)})]})]})})]})}),n.jsx(ze,{value:"advanced",className:"space-y-6",children:n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Le,{children:n.jsx(De,{children:"Call Settings"})}),n.jsx(Me,{className:"space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Max Duration (sec)"}),n.jsx(ye,{type:"number",className:"bg-white/5 border-white/10 text-white mt-1",value:(e==null?void 0:e.maxDurationSeconds)||600,onChange:W=>r("maxDurationSeconds",parseInt(W.target.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Background Sound"}),n.jsxs(be,{value:(e==null?void 0:e.backgroundSound)||"off",onValueChange:W=>r("backgroundSound",W),children:[n.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(xe,{})}),n.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(re,{value:"off",children:"Off"}),n.jsx(re,{value:"office",children:"Office"}),n.jsx(re,{value:"cafe",children:"Cafe"})]})]})]})]})})]})})]})})]})},cu=({agent:s,details:e,isLoading:t,onEdit:r,getInitials:a})=>{var c,d,m,g,_,T,N,k,y;const i=e&&typeof e=="object"&&"data"in e?e.data:e||{},l=(i==null?void 0:i.llm)||((c=i==null?void 0:i.response_engine)==null?void 0:c.llm_details)||((d=i==null?void 0:i.response_engine)==null?void 0:d.llm)||null;return t?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 min-h-[400px]",children:[n.jsx(Mt,{className:"h-10 w-10 animate-spin text-orange-500 mb-4"}),n.jsx("p",{className:"text-white/60",children:"Fetching Retell agent details..."})]}):n.jsxs("div",{className:"flex flex-col h-full bg-[#0b0f2e]",children:[n.jsxs("div",{className:"p-8 border-b border-white/10 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsx(tr,{className:"h-20 w-20 ring-4 ring-orange-500/20",children:n.jsx(sr,{className:"text-white bg-gradient-to-br from-orange-500/30 to-red-500/30 text-2xl font-bold",children:a(s.name||(i==null?void 0:i.agent_name)||s.name)})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:(i==null?void 0:i.agent_name)||s.name}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Et,{variant:"outline",className:"border-orange-500/30 text-orange-400 bg-orange-500/5 px-3 py-1",children:"Retell AI Agent"}),n.jsx("span",{className:"text-sm text-white/40 font-mono",children:(i==null?void 0:i.agent_id)||s.agent_id||s.id})]})]})]}),n.jsxs(je,{onClick:r,className:"bg-orange-600 hover:bg-orange-700 text-white px-6",children:[n.jsx(ks,{className:"h-4 w-4 mr-2"}),"Edit Agent"]})]}),n.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[n.jsxs(Ae,{className:"neo-card bg-white/5 border-white/10",children:[n.jsx(Le,{children:n.jsxs(De,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(ks,{className:"h-6 w-6"}),"Core Configuration"]})}),n.jsxs(Me,{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice ID"}),n.jsx("p",{className:"text-white font-medium",children:(i==null?void 0:i.voice_id)||"Not set"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Model"}),n.jsx("p",{className:"text-white font-medium",children:((m=i==null?void 0:i.response_engine)==null?void 0:m.llm_id)||((g=i==null?void 0:i.response_engine)==null?void 0:g.llm)||"Retell LLM"})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Language"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(yo,{className:"h-4 w-4 text-white/40"}),n.jsx("p",{className:"text-white",children:((i==null?void 0:i.language)||"en-US").toUpperCase()})]})]})]})]}),n.jsxs(Ae,{className:"neo-card bg-white/5 border-white/10",children:[n.jsx(Le,{children:n.jsxs(De,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(Wt,{className:"h-6 w-6"}),"Speech & Interaction"]})}),n.jsxs(Me,{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Sensitivity"}),n.jsx("p",{className:"text-white",children:(i==null?void 0:i.interruption_sensitivity)||"Default"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Denoising"}),n.jsx("p",{className:"text-white",children:i!=null&&i.opt_out_sensitive_data_storage?"Enabled":"Disabled"})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Ambient Sound"}),n.jsx("p",{className:"text-white capitalize",children:(i==null?void 0:i.ambient_sound)||"None"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Emotion"}),n.jsx("p",{className:"text-white",children:(i==null?void 0:i.voice_emotion)||"—"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Model"}),n.jsx("p",{className:"text-white",children:(i==null?void 0:i.voice_model)||"—"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Temp"}),n.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.voice_temperature)<"u"?String(i.voice_temperature):"—"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Speed"}),n.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.voice_speed)<"u"?String(i.voice_speed):"—"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Volume"}),n.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.volume)<"u"?String(i.volume):"—"})]})]})]})]}),n.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[n.jsx(Le,{children:n.jsxs(De,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(Xs,{className:"h-6 w-6"}),"Agent Instructions"]})}),n.jsx(Me,{children:n.jsx("div",{className:"bg-black/20 p-6 rounded-xl border border-white/5 text-white/80 leading-relaxed whitespace-pre-wrap min-h-[150px]",children:l?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase",children:"General Prompt"}),n.jsx("div",{className:"text-white mt-1",children:l.general_prompt||l.instructions||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase",children:"Begin Message"}),n.jsx("div",{className:"text-white mt-1",children:l.begin_message||"—"})]})]}):n.jsx("div",{className:"text-white/60",children:((_=i==null?void 0:i.response_engine)==null?void 0:_.instructions)||(i==null?void 0:i.instructions)||"No instructions provided."})})})]}),l&&n.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[n.jsx(Le,{children:n.jsxs(De,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(Ec,{className:"h-5 w-5"}),"LLM Details"]})}),n.jsx(Me,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"LLM ID"}),n.jsx("div",{className:"text-white mt-1",children:l.llm_id||l.llmId||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Model"}),n.jsx("div",{className:"text-white mt-1",children:l.model||l.llm_model||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Temperature"}),n.jsx("div",{className:"text-white mt-1",children:typeof l.model_temperature<"u"?String(l.model_temperature):"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Start Speaker"}),n.jsx("div",{className:"text-white mt-1",children:l.start_speaker||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"KB Config"}),n.jsx("div",{className:"text-white mt-1",children:l.kb_config?`top_k: ${l.kb_config.top_k}, filter_score: ${l.kb_config.filter_score}`:"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Published"}),n.jsx("div",{className:"text-white mt-1",children:l.is_published?"Yes":"No"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Last Modified"}),n.jsx("div",{className:"text-white mt-1",children:l.last_modification_timestamp?new Date(l.last_modification_timestamp).toLocaleString():l.lastModified?new Date(l.lastModified).toLocaleString():"—"})]})]})})]}),n.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[n.jsx(Le,{children:n.jsxs(De,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(Tc,{className:"h-5 w-5"}),"Telephony & Call Flow"]})}),n.jsx(Me,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Webhook URL"}),n.jsx("div",{className:"text-white mt-1",children:(i==null?void 0:i.webhook_url)||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Webhook Timeout"}),n.jsx("div",{className:"text-white mt-1",children:i!=null&&i.webhook_timeout_ms?`${i.webhook_timeout_ms} ms`:"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"IVR Action"}),n.jsx("div",{className:"text-white mt-1",children:((N=(T=i==null?void 0:i.ivr_option)==null?void 0:T.action)==null?void 0:N.type)||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Action"}),n.jsx("div",{className:"text-white mt-1",children:((y=(k=i==null?void 0:i.voicemail_option)==null?void 0:k.action)==null?void 0:y.type)||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Message"}),n.jsx("div",{className:"text-white mt-1",children:(i==null?void 0:i.voicemail_message)||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Timeout"}),n.jsx("div",{className:"text-white mt-1",children:i!=null&&i.voicemail_detection_timeout_ms?`${i.voicemail_detection_timeout_ms} ms`:"—"})]})]})})]}),n.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[n.jsx(Le,{children:n.jsxs(De,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(bo,{className:"h-5 w-5"}),"Post-call Analysis"]})}),n.jsx(Me,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Model"}),n.jsx("div",{className:"text-white",children:(i==null?void 0:i.post_call_analysis_model)||"—"}),n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold mt-2",children:"Analysis Prompts"}),n.jsx("div",{className:"text-white whitespace-pre-wrap mt-1",children:(i==null?void 0:i.analysis_summary_prompt)||"—"}),n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold mt-2",children:"Analysis Data Schema"}),n.jsx("div",{className:"mt-1",children:Array.isArray(i==null?void 0:i.post_call_analysis_data)&&i.post_call_analysis_data.length>0?i.post_call_analysis_data.map((w,C)=>n.jsxs("div",{className:"text-white/90 mb-2",children:[n.jsxs("div",{className:"font-medium",children:[w.name," ",n.jsxs("span",{className:"text-white/60",children:["(",w.type,")"]})]}),n.jsx("div",{className:"text-white/70 text-sm",children:w.description}),Array.isArray(w.examples)&&n.jsxs("div",{className:"text-white/60 text-sm mt-1",children:["Examples: ",w.examples.join(", ")]})]},C)):n.jsx("div",{className:"text-white/60",children:"No post-call data configured."})})]})})]})]})})]})},uu=({isOpen:s,onClose:e,onSuccess:t,agentId:r,initialData:a})=>{var _,T,N,k,y,w,C,I,E,O;const[i,l]=Y.useState(!1),[c,d]=Y.useState(null);Y.useEffect(()=>{var p,B,K;a&&s&&d({agent_name:a.agent_name||a.name,voice_id:a.voice_id,response_engine:{type:"retell-llm",llm_id:(p=a.response_engine)==null?void 0:p.llm_id,instructions:(B=a.response_engine)==null?void 0:B.instructions},language:m(a),ambient_sound:a.ambient_sound||"none",interruption_sensitivity:a.interruption_sensitivity||.8,llm:a.llm||((K=a.response_engine)==null?void 0:K.llm_details)||null})},[a,s]);function m(p){return p.language||p.lang||"en-US"}const g=async p=>{var B,K,R;p.preventDefault(),l(!0);try{const he={agent_name:c.agent_name,voice_id:c.voice_id,language:c.language,ambient_sound:c.ambient_sound,interruption_sensitivity:c.interruption_sensitivity};if(await Bc(r,he),c.llm&&((B=c.response_engine)!=null&&B.llm_id)){const A=String(c.response_engine.llm_id),z={model:c.llm.model,model_temperature:c.llm.model_temperature,general_prompt:c.llm.general_prompt,begin_message:c.llm.begin_message,start_speaker:c.llm.start_speaker,kb_config:c.llm.kb_config,is_published:typeof c.llm.is_published<"u"?c.llm.is_published:void 0};await $c(A,z)}X.success("Retell agent updated successfully"),t(),e()}catch(he){console.error("Error updating Retell agent:",he),X.error(((R=(K=he.response)==null?void 0:K.data)==null?void 0:R.message)||"Failed to update Retell agent")}finally{l(!1)}};return c?n.jsx(qt,{open:s,onOpenChange:e,children:n.jsxs(Bt,{className:"sm:max-w-[700px] bg-[#0b0f2e] border-white/10 text-white max-h-[90vh] overflow-y-auto neon-fire-scroll",children:[n.jsxs($t,{children:[n.jsxs(Jt,{className:"text-2xl font-bold flex items-center gap-2",children:[n.jsx(ks,{className:"h-6 w-6 text-orange-500"}),"Update Retell Agent"]}),n.jsxs(Xc,{className:"text-white/60",children:["Modify configuration for agent: ",c.agent_name]})]}),n.jsxs("form",{onSubmit:g,className:"space-y-6 py-4",children:[n.jsxs(mr,{defaultValue:"general",className:"w-full",children:[n.jsxs(pr,{className:"bg-white/5 border border-white/10 p-1 w-full grid grid-cols-3",children:[n.jsx(Oe,{value:"general",className:"data-[state=active]:bg-orange-600",children:"General"}),n.jsx(Oe,{value:"voice",className:"data-[state=active]:bg-orange-600",children:"Voice"}),n.jsx(Oe,{value:"llm",className:"data-[state=active]:bg-orange-600",children:"LLM & Prompt"})]}),n.jsxs(ze,{value:"general",className:"space-y-4 pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{htmlFor:"name",children:"Agent Name"}),n.jsx(ye,{id:"name",value:c.agent_name,onChange:p=>d({...c,agent_name:p.target.value}),className:"bg-white/5 border-white/10 text-white"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{children:"Language"}),n.jsxs(be,{value:c.language,onValueChange:p=>d({...c,language:p}),children:[n.jsx(_e,{className:"bg-white/5 border-white/10",children:n.jsx(xe,{})}),n.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(re,{value:"en-US",children:"English (US)"}),n.jsx(re,{value:"en-GB",children:"English (UK)"}),n.jsx(re,{value:"es-ES",children:"Spanish"})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{children:"Ambient Sound"}),n.jsxs(be,{value:c.ambient_sound,onValueChange:p=>d({...c,ambient_sound:p}),children:[n.jsx(_e,{className:"bg-white/5 border-white/10",children:n.jsx(xe,{})}),n.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(re,{value:"none",children:"None"}),n.jsx(re,{value:"coffee-shop",children:"Coffee Shop"}),n.jsx(re,{value:"office",children:"Office"})]})]})]})]})]}),n.jsxs(ze,{value:"voice",className:"space-y-4 pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{htmlFor:"voiceId",children:"Voice ID"}),n.jsx(ye,{id:"voiceId",value:c.voice_id,onChange:p=>d({...c,voice_id:p.target.value}),className:"bg-white/5 border-white/10 text-white font-mono",placeholder:"e.g. 11labs-Adrian"}),n.jsx("p",{className:"text-[10px] text-white/40",children:"Enter a valid Retell Voice ID or ElevenLabs Voice ID"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{children:"Interruption Sensitivity (0.0 - 1.0)"}),n.jsx(ye,{type:"number",step:"0.1",min:"0",max:"1",value:c.interruption_sensitivity,onChange:p=>d({...c,interruption_sensitivity:parseFloat(p.target.value)}),className:"bg-white/5 border-white/10"})]})]}),n.jsxs(ze,{value:"llm",className:"space-y-4 pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{children:"Instructions (System Prompt)"}),n.jsx(ht,{value:c.response_engine.instructions||((_=c.llm)==null?void 0:_.general_prompt)||"",onChange:p=>d({...c,response_engine:{...c.response_engine,instructions:p.target.value},llm:{...c.llm,general_prompt:p.target.value}}),className:"bg-white/5 border-white/10 text-white min-h-[120px]",placeholder:"You are an AI assistant..."})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{children:"Begin Message"}),n.jsx(ye,{value:((T=c.llm)==null?void 0:T.begin_message)||"",onChange:p=>d({...c,llm:{...c.llm,begin_message:p.target.value}}),className:"bg-white/5 border-white/10 text-white"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{children:"Model"}),n.jsx(ye,{value:((N=c.llm)==null?void 0:N.model)||"",onChange:p=>d({...c,llm:{...c.llm,model:p.target.value}}),className:"bg-white/5 border-white/10 text-white"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{children:"Temperature"}),n.jsx(ye,{type:"number",step:"0.1",min:"0",max:"2",value:typeof((k=c.llm)==null?void 0:k.model_temperature)<"u"?String(c.llm.model_temperature):"",onChange:p=>d({...c,llm:{...c.llm,model_temperature:parseFloat(p.target.value)}}),className:"bg-white/5 border-white/10"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{children:"Start Speaker"}),n.jsxs(be,{value:((y=c.llm)==null?void 0:y.start_speaker)||"agent",onValueChange:p=>d({...c,llm:{...c.llm,start_speaker:p}}),children:[n.jsx(_e,{className:"bg-white/5 border-white/10",children:n.jsx(xe,{})}),n.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(re,{value:"agent",children:"Agent"}),n.jsx(re,{value:"user",children:"User"})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(H,{children:"KB Top K"}),n.jsx(ye,{type:"number",value:((C=(w=c.llm)==null?void 0:w.kb_config)==null?void 0:C.top_k)||"",onChange:p=>{var B;return d({...c,llm:{...c.llm,kb_config:{...((B=c.llm)==null?void 0:B.kb_config)||{},top_k:parseInt(p.target.value||"0")}}})},className:"bg-white/5 border-white/10"})]}),n.jsxs("div",{children:[n.jsx(H,{children:"KB Filter Score"}),n.jsx(ye,{type:"number",step:"0.01",value:((E=(I=c.llm)==null?void 0:I.kb_config)==null?void 0:E.filter_score)||"",onChange:p=>{var B;return d({...c,llm:{...c.llm,kb_config:{...((B=c.llm)==null?void 0:B.kb_config)||{},filter_score:parseFloat(p.target.value||"0")}}})},className:"bg-white/5 border-white/10"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(H,{children:"Published"}),n.jsx(jt,{checked:!!((O=c.llm)!=null&&O.is_published),onCheckedChange:p=>d({...c,llm:{...c.llm,is_published:p}})})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-white/10",children:[n.jsx(je,{type:"button",variant:"ghost",onClick:e,disabled:i,children:"Cancel"}),n.jsx(je,{type:"submit",className:"bg-orange-600 hover:bg-orange-700",disabled:i,children:i?n.jsx(Mt,{className:"mr-2 h-4 w-4 animate-spin"}):"Save Changes"})]})]})]})}):null};var ko={};function Ta(s,e){if(s==null)return{};var t,r,a=function(l,c){if(l==null)return{};var d={};for(var m in l)if({}.hasOwnProperty.call(l,m)){if(c.indexOf(m)!==-1)continue;d[m]=l[m]}return d}(s,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(r=0;r<i.length;r++)t=i[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(s,t)&&(a[t]=s[t])}return a}function We(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function de(s){return de=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(s)}function Co(s){var e=function(t,r){if(de(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var i=a.call(t,r||"default");if(de(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}(s,"string");return de(e)=="symbol"?e:e+""}function Aa(s,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(s,Co(r.key),r)}}function He(s,e,t){return e&&Aa(s.prototype,e),t&&Aa(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function fr(s,e){if(e&&(de(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(s)}function rt(s){return rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},rt(s)}function Cs(s,e){return Cs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Cs(s,e)}function gr(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Cs(s,e)}function lt(s,e,t){return(e=Co(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Ma(s,e,t,r,a,i,l){try{var c=s[i](l),d=c.value}catch(m){return void t(m)}c.done?e(d):Promise.resolve(d).then(r,a)}function Q(s){return function(){var e=this,t=arguments;return new Promise(function(r,a){var i=s.apply(e,t);function l(d){Ma(i,r,a,l,c,"next",d)}function c(d){Ma(i,r,a,l,c,"throw",d)}l(void 0)})}}function Ia(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,r=Array(e);t<e;t++)r[t]=s[t];return r}function Fe(s,e){return function(t){if(Array.isArray(t))return t}(s)||function(t,r){var a=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(a!=null){var i,l,c,d,m=[],g=!0,_=!1;try{if(c=(a=a.call(t)).next,r===0){if(Object(a)!==a)return;g=!1}else for(;!(g=(i=c.call(a)).done)&&(m.push(i.value),m.length!==r);g=!0);}catch(T){_=!0,l=T}finally{try{if(!g&&a.return!=null&&(d=a.return(),Object(d)!==d))return}finally{if(_)throw l}}return m}}(s,e)||function(t,r){if(t){if(typeof t=="string")return Ia(t,r);var a={}.toString.call(t).slice(8,-1);return a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set"?Array.from(t):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ia(t,r):void 0}}(s,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function du(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Oa,Os={exports:{}},zr=function(){if(Oa)return Os.exports;Oa=1;var s,e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(y,w,C){return Function.prototype.apply.call(y,w,C)};s=e&&typeof e.ownKeys=="function"?e.ownKeys:Object.getOwnPropertySymbols?function(y){return Object.getOwnPropertyNames(y).concat(Object.getOwnPropertySymbols(y))}:function(y){return Object.getOwnPropertyNames(y)};var r=Number.isNaN||function(y){return y!=y};function a(){a.init.call(this)}Os.exports=a,Os.exports.once=function(y,w){return new Promise(function(C,I){function E(p){y.removeListener(w,O),I(p)}function O(){typeof y.removeListener=="function"&&y.removeListener("error",E),C([].slice.call(arguments))}k(y,w,O,{once:!0}),w!=="error"&&function(p,B,K){typeof p.on=="function"&&k(p,"error",B,K)}(y,E,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var i=10;function l(y){if(typeof y!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof y)}function c(y){return y._maxListeners===void 0?a.defaultMaxListeners:y._maxListeners}function d(y,w,C,I){var E,O,p,B;if(l(C),(O=y._events)===void 0?(O=y._events=Object.create(null),y._eventsCount=0):(O.newListener!==void 0&&(y.emit("newListener",w,C.listener?C.listener:C),O=y._events),p=O[w]),p===void 0)p=O[w]=C,++y._eventsCount;else if(typeof p=="function"?p=O[w]=I?[C,p]:[p,C]:I?p.unshift(C):p.push(C),(E=c(y))>0&&p.length>E&&!p.warned){p.warned=!0;var K=new Error("Possible EventEmitter memory leak detected. "+p.length+" "+String(w)+" listeners added. Use emitter.setMaxListeners() to increase limit");K.name="MaxListenersExceededWarning",K.emitter=y,K.type=w,K.count=p.length,B=K,console&&console.warn&&console.warn(B)}return y}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(y,w,C){var I={fired:!1,wrapFn:void 0,target:y,type:w,listener:C},E=m.bind(I);return E.listener=C,I.wrapFn=E,E}function _(y,w,C){var I=y._events;if(I===void 0)return[];var E=I[w];return E===void 0?[]:typeof E=="function"?C?[E.listener||E]:[E]:C?function(O){for(var p=new Array(O.length),B=0;B<p.length;++B)p[B]=O[B].listener||O[B];return p}(E):N(E,E.length)}function T(y){var w=this._events;if(w!==void 0){var C=w[y];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}function N(y,w){for(var C=new Array(w),I=0;I<w;++I)C[I]=y[I];return C}function k(y,w,C,I){if(typeof y.on=="function")I.once?y.once(w,C):y.on(w,C);else{if(typeof y.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof y);y.addEventListener(w,function E(O){I.once&&y.removeEventListener(w,E),C(O)})}}return Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(y){if(typeof y!="number"||y<0||r(y))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+y+".");i=y}}),a.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(y){if(typeof y!="number"||y<0||r(y))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+y+".");return this._maxListeners=y,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(y){for(var w=[],C=1;C<arguments.length;C++)w.push(arguments[C]);var I=y==="error",E=this._events;if(E!==void 0)I=I&&E.error===void 0;else if(!I)return!1;if(I){var O;if(w.length>0&&(O=w[0]),O instanceof Error)throw O;var p=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw p.context=O,p}var B=E[y];if(B===void 0)return!1;if(typeof B=="function")t(B,this,w);else{var K=B.length,R=N(B,K);for(C=0;C<K;++C)t(R[C],this,w)}return!0},a.prototype.addListener=function(y,w){return d(this,y,w,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(y,w){return d(this,y,w,!0)},a.prototype.once=function(y,w){return l(w),this.on(y,g(this,y,w)),this},a.prototype.prependOnceListener=function(y,w){return l(w),this.prependListener(y,g(this,y,w)),this},a.prototype.removeListener=function(y,w){var C,I,E,O,p;if(l(w),(I=this._events)===void 0)return this;if((C=I[y])===void 0)return this;if(C===w||C.listener===w)--this._eventsCount==0?this._events=Object.create(null):(delete I[y],I.removeListener&&this.emit("removeListener",y,C.listener||w));else if(typeof C!="function"){for(E=-1,O=C.length-1;O>=0;O--)if(C[O]===w||C[O].listener===w){p=C[O].listener,E=O;break}if(E<0)return this;E===0?C.shift():function(B,K){for(;K+1<B.length;K++)B[K]=B[K+1];B.pop()}(C,E),C.length===1&&(I[y]=C[0]),I.removeListener!==void 0&&this.emit("removeListener",y,p||w)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(y){var w,C,I;if((C=this._events)===void 0)return this;if(C.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):C[y]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete C[y]),this;if(arguments.length===0){var E,O=Object.keys(C);for(I=0;I<O.length;++I)(E=O[I])!=="removeListener"&&this.removeAllListeners(E);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(w=C[y])=="function")this.removeListener(y,w);else if(w!==void 0)for(I=w.length-1;I>=0;I--)this.removeListener(y,w[I]);return this},a.prototype.listeners=function(y){return _(this,y,!0)},a.prototype.rawListeners=function(y){return _(this,y,!1)},a.listenerCount=function(y,w){return typeof y.listenerCount=="function"?y.listenerCount(w):T.call(y,w)},a.prototype.listenerCount=T,a.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]},Os.exports}(),Ps=du(zr),Pa=Object.prototype.hasOwnProperty;function La(s,e,t){for(t of s.keys())if(Ue(t,e))return t}function Ue(s,e){var t,r,a;if(s===e)return!0;if(s&&e&&(t=s.constructor)===e.constructor){if(t===Date)return s.getTime()===e.getTime();if(t===RegExp)return s.toString()===e.toString();if(t===Array){if((r=s.length)===e.length)for(;r--&&Ue(s[r],e[r]););return r===-1}if(t===Set){if(s.size!==e.size)return!1;for(r of s)if((a=r)&&typeof a=="object"&&!(a=La(e,a))||!e.has(a))return!1;return!0}if(t===Map){if(s.size!==e.size)return!1;for(r of s)if((a=r[0])&&typeof a=="object"&&!(a=La(e,a))||!Ue(r[1],e.get(a)))return!1;return!0}if(t===ArrayBuffer)s=new Uint8Array(s),e=new Uint8Array(e);else if(t===DataView){if((r=s.byteLength)===e.byteLength)for(;r--&&s.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(s)){if((r=s.byteLength)===e.byteLength)for(;r--&&s[r]===e[r];);return r===-1}if(!t||typeof s=="object"){for(t in r=0,s)if(Pa.call(s,t)&&++r&&!Pa.call(e,t)||!(t in e)||!Ue(s[t],e[t]))return!1;return Object.keys(e).length===r}}return s!=s&&e!=e}const hu={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},No={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},Ne={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Ve={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},kt={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class P{static getFirstMatch(e,t){const r=t.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,t){const r=t.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,t,r){if(e.test(t))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const t=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(t.push(0),t[0]===10)switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const t=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(t.push(0),!(t[0]===1&&t[1]<5))return t[0]===1&&t[1]<6?"Cupcake":t[0]===1&&t[1]>=6?"Donut":t[0]===2&&t[1]<2?"Eclair":t[0]===2&&t[1]===2?"Froyo":t[0]===2&&t[1]>2?"Gingerbread":t[0]===3?"Honeycomb":t[0]===4&&t[1]<1?"Ice Cream Sandwich":t[0]===4&&t[1]<4?"Jelly Bean":t[0]===4&&t[1]>=4?"KitKat":t[0]===5?"Lollipop":t[0]===6?"Marshmallow":t[0]===7?"Nougat":t[0]===8?"Oreo":t[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,r=!1){const a=P.getVersionPrecision(e),i=P.getVersionPrecision(t);let l=Math.max(a,i),c=0;const d=P.map([e,t],m=>{const g=l-P.getVersionPrecision(m),_=m+new Array(g+1).join(".0");return P.map(_.split("."),T=>new Array(20-T.length).join("0")+T).reverse()});for(r&&(c=l-Math.min(a,i)),l-=1;l>=c;){if(d[0][l]>d[1][l])return 1;if(d[0][l]===d[1][l]){if(l===c)return 0;l-=1}else if(d[0][l]<d[1][l])return-1}}static map(e,t){const r=[];let a;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(a=0;a<e.length;a+=1)r.push(t(e[a]));return r}static find(e,t){let r,a;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,a=e.length;r<a;r+=1){const i=e[r];if(t(i,r))return i}}static assign(e,...t){const r=e;let a,i;if(Object.assign)return Object.assign(e,...t);for(a=0,i=t.length;a<i;a+=1){const l=t[a];typeof l=="object"&&l!==null&&Object.keys(l).forEach(c=>{r[c]=l[c]})}return e}static getBrowserAlias(e){return hu[e]}static getBrowserTypeByAlias(e){return No[e]||""}}const ge=/version\/(\d+(\.?_?\d+)+)/i,mu=[{test:[/googlebot/i],describe(s){const e={name:"Googlebot"},t=P.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/opera/i],describe(s){const e={name:"Opera"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/opr\/|opios/i],describe(s){const e={name:"Opera"},t=P.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/SamsungBrowser/i],describe(s){const e={name:"Samsung Internet for Android"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/Whale/i],describe(s){const e={name:"NAVER Whale Browser"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/MZBrowser/i],describe(s){const e={name:"MZ Browser"},t=P.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/focus/i],describe(s){const e={name:"Focus"},t=P.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/swing/i],describe(s){const e={name:"Swing"},t=P.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/coast/i],describe(s){const e={name:"Opera Coast"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(s){const e={name:"Opera Touch"},t=P.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/yabrowser/i],describe(s){const e={name:"Yandex Browser"},t=P.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/ucbrowser/i],describe(s){const e={name:"UC Browser"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/Maxthon|mxios/i],describe(s){const e={name:"Maxthon"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/epiphany/i],describe(s){const e={name:"Epiphany"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/puffin/i],describe(s){const e={name:"Puffin"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/sleipnir/i],describe(s){const e={name:"Sleipnir"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/k-meleon/i],describe(s){const e={name:"K-Meleon"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/micromessenger/i],describe(s){const e={name:"WeChat"},t=P.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/qqbrowser/i],describe(s){const e={name:/qqbrowserlite/i.test(s)?"QQ Browser Lite":"QQ Browser"},t=P.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/msie|trident/i],describe(s){const e={name:"Internet Explorer"},t=P.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/\sedg\//i],describe(s){const e={name:"Microsoft Edge"},t=P.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/edg([ea]|ios)/i],describe(s){const e={name:"Microsoft Edge"},t=P.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/vivaldi/i],describe(s){const e={name:"Vivaldi"},t=P.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/seamonkey/i],describe(s){const e={name:"SeaMonkey"},t=P.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/sailfish/i],describe(s){const e={name:"Sailfish"},t=P.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,s);return t&&(e.version=t),e}},{test:[/silk/i],describe(s){const e={name:"Amazon Silk"},t=P.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/phantom/i],describe(s){const e={name:"PhantomJS"},t=P.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/slimerjs/i],describe(s){const e={name:"SlimerJS"},t=P.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(s){const e={name:"BlackBerry"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/(web|hpw)[o0]s/i],describe(s){const e={name:"WebOS Browser"},t=P.getFirstMatch(ge,s)||P.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/bada/i],describe(s){const e={name:"Bada"},t=P.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/tizen/i],describe(s){const e={name:"Tizen"},t=P.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/qupzilla/i],describe(s){const e={name:"QupZilla"},t=P.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/firefox|iceweasel|fxios/i],describe(s){const e={name:"Firefox"},t=P.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/electron/i],describe(s){const e={name:"Electron"},t=P.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/MiuiBrowser/i],describe(s){const e={name:"Miui"},t=P.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/chromium/i],describe(s){const e={name:"Chromium"},t=P.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,s)||P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/chrome|crios|crmo/i],describe(s){const e={name:"Chrome"},t=P.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/GSA/i],describe(s){const e={name:"Google Search"},t=P.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test(s){const e=!s.test(/like android/i),t=s.test(/android/i);return e&&t},describe(s){const e={name:"Android Browser"},t=P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/playstation 4/i],describe(s){const e={name:"PlayStation 4"},t=P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/safari|applewebkit/i],describe(s){const e={name:"Safari"},t=P.getFirstMatch(ge,s);return t&&(e.version=t),e}},{test:[/.*/i],describe(s){const e=s.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:P.getFirstMatch(e,s),version:P.getSecondMatch(e,s)}}}];var pu=[{test:[/Roku\/DVP/],describe(s){const e=P.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,s);return{name:Ve.Roku,version:e}}},{test:[/windows phone/i],describe(s){const e=P.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,s);return{name:Ve.WindowsPhone,version:e}}},{test:[/windows /i],describe(s){const e=P.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,s),t=P.getWindowsVersionName(e);return{name:Ve.Windows,version:e,versionName:t}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(s){const e={name:Ve.iOS},t=P.getSecondMatch(/(Version\/)(\d[\d.]+)/,s);return t&&(e.version=t),e}},{test:[/macintosh/i],describe(s){const e=P.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,s).replace(/[_\s]/g,"."),t=P.getMacOSVersionName(e),r={name:Ve.MacOS,version:e};return t&&(r.versionName=t),r}},{test:[/(ipod|iphone|ipad)/i],describe(s){const e=P.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,s).replace(/[_\s]/g,".");return{name:Ve.iOS,version:e}}},{test(s){const e=!s.test(/like android/i),t=s.test(/android/i);return e&&t},describe(s){const e=P.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,s),t=P.getAndroidVersionName(e),r={name:Ve.Android,version:e};return t&&(r.versionName=t),r}},{test:[/(web|hpw)[o0]s/i],describe(s){const e=P.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,s),t={name:Ve.WebOS};return e&&e.length&&(t.version=e),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(s){const e=P.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,s)||P.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,s)||P.getFirstMatch(/\bbb(\d+)/i,s);return{name:Ve.BlackBerry,version:e}}},{test:[/bada/i],describe(s){const e=P.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,s);return{name:Ve.Bada,version:e}}},{test:[/tizen/i],describe(s){const e=P.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,s);return{name:Ve.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:Ve.Linux})},{test:[/CrOS/],describe:()=>({name:Ve.ChromeOS})},{test:[/PlayStation 4/],describe(s){const e=P.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,s);return{name:Ve.PlayStation4,version:e}}}],fu=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(s){const e=P.getFirstMatch(/(can-l01)/i,s)&&"Nova",t={type:Ne.mobile,vendor:"Huawei"};return e&&(t.model=e),t}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:Ne.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:Ne.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:Ne.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:Ne.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:Ne.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:Ne.tablet})},{test(s){const e=s.test(/ipod|iphone/i),t=s.test(/like (ipod|iphone)/i);return e&&!t},describe(s){const e=P.getFirstMatch(/(ipod|iphone)/i,s);return{type:Ne.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:Ne.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:Ne.mobile})},{test:s=>s.getBrowserName(!0)==="blackberry",describe:()=>({type:Ne.mobile,vendor:"BlackBerry"})},{test:s=>s.getBrowserName(!0)==="bada",describe:()=>({type:Ne.mobile})},{test:s=>s.getBrowserName()==="windows phone",describe:()=>({type:Ne.mobile,vendor:"Microsoft"})},{test(s){const e=Number(String(s.getOSVersion()).split(".")[0]);return s.getOSName(!0)==="android"&&e>=3},describe:()=>({type:Ne.tablet})},{test:s=>s.getOSName(!0)==="android",describe:()=>({type:Ne.mobile})},{test:s=>s.getOSName(!0)==="macos",describe:()=>({type:Ne.desktop,vendor:"Apple"})},{test:s=>s.getOSName(!0)==="windows",describe:()=>({type:Ne.desktop})},{test:s=>s.getOSName(!0)==="linux",describe:()=>({type:Ne.desktop})},{test:s=>s.getOSName(!0)==="playstation 4",describe:()=>({type:Ne.tv})},{test:s=>s.getOSName(!0)==="roku",describe:()=>({type:Ne.tv})}],gu=[{test:s=>s.getBrowserName(!0)==="microsoft edge",describe(s){if(/\sedg\//i.test(s))return{name:kt.Blink};const e=P.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,s);return{name:kt.EdgeHTML,version:e}}},{test:[/trident/i],describe(s){const e={name:kt.Trident},t=P.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:s=>s.test(/presto/i),describe(s){const e={name:kt.Presto},t=P.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test(s){const e=s.test(/gecko/i),t=s.test(/like gecko/i);return e&&!t},describe(s){const e={name:kt.Gecko},t=P.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:kt.Blink})},{test:[/(apple)?webkit/i],describe(s){const e={name:kt.WebKit},t=P.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}}];class Da{constructor(e,t=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},t!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=P.find(mu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=P.find(pu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};const e=P.find(fu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=P.find(gu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return P.assign({},this.parsedResult)}satisfies(e){const t={};let r=0;const a={};let i=0;if(Object.keys(e).forEach(l=>{const c=e[l];typeof c=="string"?(a[l]=c,i+=1):typeof c=="object"&&(t[l]=c,r+=1)}),r>0){const l=Object.keys(t),c=P.find(l,m=>this.isOS(m));if(c){const m=this.satisfies(t[c]);if(m!==void 0)return m}const d=P.find(l,m=>this.isPlatform(m));if(d){const m=this.satisfies(t[d]);if(m!==void 0)return m}}if(i>0){const l=Object.keys(a),c=P.find(l,d=>this.isBrowser(d,!0));if(c!==void 0)return this.compareVersion(a[c])}}isBrowser(e,t=!1){const r=this.getBrowserName().toLowerCase();let a=e.toLowerCase();const i=P.getBrowserTypeByAlias(a);return t&&i&&(a=i.toLowerCase()),a===r}compareVersion(e){let t=[0],r=e,a=!1;const i=this.getBrowserVersion();if(typeof i=="string")return e[0]===">"||e[0]==="<"?(r=e.substr(1),e[1]==="="?(a=!0,r=e.substr(2)):t=[],e[0]===">"?t.push(1):t.push(-1)):e[0]==="="?r=e.substr(1):e[0]==="~"&&(a=!0,r=e.substr(1)),t.indexOf(P.compareVersions(i,r,a))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,t=!1){return this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(t=>this.is(t))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class vu{static getParser(e,t=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new Da(e,t)}static parse(e){return new Da(e).getResult()}static get BROWSER_MAP(){return No}static get ENGINE_MAP(){return kt}static get OS_MAP(){return Ve}static get PLATFORMS_MAP(){return Ne}}function vr(){return Date.now()+Math.random().toString()}function fs(){throw new Error("Method must be implemented in subclass")}function Eo(s,e){return e!=null&&e.proxyUrl?e.proxyUrl+(e.proxyUrl.slice(-1)==="/"?"":"/")+s.substring(8):s}function rr(s){return s!=null&&s.callObjectBundleUrlOverride?s.callObjectBundleUrlOverride:Eo("https://c.daily.co/call-machine/versioned/".concat("0.80.0","/static/call-machine-object-bundle.js"),s)}function nr(s){try{new URL(s)}catch{return!1}return!0}const Se=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Gt="8.55.0",pe=globalThis;function ar(s,e,t){const r=pe,a=r.__SENTRY__=r.__SENTRY__||{},i=a[Gt]=a[Gt]||{};return i[s]||(i[s]=e())}const Zt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Yr=["debug","info","warn","error","log","assert","trace"],ir={};function Es(s){if(!("console"in pe))return s();const e=pe.console,t={},r=Object.keys(ir);r.forEach(a=>{const i=ir[a];t[a]=e[a],e[a]=i});try{return s()}finally{r.forEach(a=>{e[a]=t[a]})}}const Z=ar("logger",function(){let s=!1;const e={enable:()=>{s=!0},disable:()=>{s=!1},isEnabled:()=>s};return Zt?Yr.forEach(t=>{e[t]=(...r)=>{s&&Es(()=>{pe.console[t](`Sentry Logger [${t}]:`,...r)})}}):Yr.forEach(t=>{e[t]=()=>{}}),e}),Ut="?",Ra=/\(error: (.*)\)/,Fa=/captureMessage|captureException/;function Ls(s){return s[s.length-1]||{}}const Va="<anonymous>";function It(s){try{return s&&typeof s=="function"&&s.name||Va}catch{return Va}}function Ua(s){const e=s.exception;if(e){const t=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&t.push(...r.stacktrace.frames)}),t}catch{return}}}const zs={},qa={};function zt(s,e){zs[s]=zs[s]||[],zs[s].push(e)}function Yt(s,e){if(!qa[s]){qa[s]=!0;try{e()}catch(t){Zt&&Z.error(`Error while instrumenting ${s}`,t)}}}function st(s,e){const t=s&&zs[s];if(t)for(const r of t)try{r(e)}catch(a){Zt&&Z.error(`Error while triggering instrumentation handler.
Type: ${s}
Name: ${It(r)}
Error:`,a)}}let Cr=null;function yu(){Cr=pe.onerror,pe.onerror=function(s,e,t,r,a){return st("error",{column:r,error:a,line:t,msg:s,url:e}),!!Cr&&Cr.apply(this,arguments)},pe.onerror.__SENTRY_INSTRUMENTED__=!0}let Nr=null;function bu(){Nr=pe.onunhandledrejection,pe.onunhandledrejection=function(s){return st("unhandledrejection",s),!Nr||Nr.apply(this,arguments)},pe.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function yr(){return kn(pe),pe}function kn(s){const e=s.__SENTRY__=s.__SENTRY__||{};return e.version=e.version||Gt,e[Gt]=e[Gt]||{}}const To=Object.prototype.toString;function Cn(s){switch(To.call(s)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Ht(s,Error)}}function hs(s,e){return To.call(s)===`[object ${e}]`}function Ao(s){return hs(s,"ErrorEvent")}function Ba(s){return hs(s,"DOMError")}function ft(s){return hs(s,"String")}function Nn(s){return typeof s=="object"&&s!==null&&"__sentry_template_string__"in s&&"__sentry_template_values__"in s}function Wr(s){return s===null||Nn(s)||typeof s!="object"&&typeof s!="function"}function os(s){return hs(s,"Object")}function br(s){return typeof Event<"u"&&Ht(s,Event)}function _r(s){return!!(s&&s.then&&typeof s.then=="function")}function Ht(s,e){try{return s instanceof e}catch{return!1}}function Mo(s){return!(typeof s!="object"||s===null||!s.__isVue&&!s._isVue)}const En=pe;function Io(s,e={}){if(!s)return"<unknown>";try{let t=s;const r=5,a=[];let i=0,l=0;const c=" > ",d=c.length;let m;const g=Array.isArray(e)?e:e.keyAttrs,_=!Array.isArray(e)&&e.maxStringLength||80;for(;t&&i++<r&&(m=_u(t,g),!(m==="html"||i>1&&l+a.length*d+m.length>=_));)a.push(m),l+=m.length,t=t.parentNode;return a.reverse().join(c)}catch{return"<unknown>"}}function _u(s,e){const t=s,r=[];if(!t||!t.tagName)return"";if(En.HTMLElement&&t instanceof HTMLElement&&t.dataset){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}r.push(t.tagName.toLowerCase());const a=e&&e.length?e.filter(l=>t.getAttribute(l)).map(l=>[l,t.getAttribute(l)]):null;if(a&&a.length)a.forEach(l=>{r.push(`[${l[0]}="${l[1]}"]`)});else{t.id&&r.push(`#${t.id}`);const l=t.className;if(l&&ft(l)){const c=l.split(/\s+/);for(const d of c)r.push(`.${d}`)}}const i=["aria-label","type","name","title","alt"];for(const l of i){const c=t.getAttribute(l);c&&r.push(`[${l}="${c}"]`)}return r.join("")}function ns(s,e=0){return typeof s!="string"||e===0||s.length<=e?s:`${s.slice(0,e)}...`}function $a(s,e){if(!Array.isArray(s))return"";const t=[];for(let r=0;r<s.length;r++){const a=s[r];try{Mo(a)?t.push("[VueViewModel]"):t.push(String(a))}catch{t.push("[value cannot be serialized]")}}return t.join(e)}function xu(s,e,t=!1){return!!ft(s)&&(hs(e,"RegExp")?e.test(s):!!ft(e)&&(t?s===e:s.includes(e)))}function Ds(s,e=[],t=!1){return e.some(r=>xu(s,r,t))}function Ye(s,e,t){if(!(e in s))return;const r=s[e],a=t(r);typeof a=="function"&&Oo(a,r);try{s[e]=a}catch{Zt&&Z.log(`Failed to replace method "${e}" in object`,s)}}function Kt(s,e,t){try{Object.defineProperty(s,e,{value:t,writable:!0,configurable:!0})}catch{Zt&&Z.log(`Failed to add non-enumerable property "${e}" to object`,s)}}function Oo(s,e){try{const t=e.prototype||{};s.prototype=e.prototype=t,Kt(s,"__sentry_original__",e)}catch{}}function Tn(s){return s.__sentry_original__}function Po(s){if(Cn(s))return{message:s.message,name:s.name,stack:s.stack,...Ga(s)};if(br(s)){const e={type:s.type,target:Ja(s.target),currentTarget:Ja(s.currentTarget),...Ga(s)};return typeof CustomEvent<"u"&&Ht(s,CustomEvent)&&(e.detail=s.detail),e}return s}function Ja(s){try{return e=s,typeof Element<"u"&&Ht(e,Element)?Io(s):Object.prototype.toString.call(s)}catch{return"<unknown>"}var e}function Ga(s){if(typeof s=="object"&&s!==null){const e={};for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t]);return e}return{}}function Qe(s){return Hr(s,new Map)}function Hr(s,e){if(function(t){if(!os(t))return!1;try{const r=Object.getPrototypeOf(t).constructor.name;return!r||r==="Object"}catch{return!0}}(s)){const t=e.get(s);if(t!==void 0)return t;const r={};e.set(s,r);for(const a of Object.getOwnPropertyNames(s))s[a]!==void 0&&(r[a]=Hr(s[a],e));return r}if(Array.isArray(s)){const t=e.get(s);if(t!==void 0)return t;const r=[];return e.set(s,r),s.forEach(a=>{r.push(Hr(a,e))}),r}return s}function Ts(){return Date.now()/1e3}const vt=function(){const{performance:s}=pe;if(!s||!s.now)return Ts;const e=Date.now()-s.now(),t=s.timeOrigin==null?e:s.timeOrigin;return()=>(t+s.now())/1e3}();function Xe(){const s=pe,e=s.crypto||s.msCrypto;let t=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(t=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(15&t())>>r/4).toString(16))}function Lo(s){return s.exception&&s.exception.values?s.exception.values[0]:void 0}function Nt(s){const{message:e,event_id:t}=s;if(e)return e;const r=Lo(s);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||t||"<unknown>":t||"<unknown>"}function Kr(s,e,t){const r=s.exception=s.exception||{},a=r.values=r.values||[],i=a[0]=a[0]||{};i.value||(i.value=e||""),i.type||(i.type="Error")}function ls(s,e){const t=Lo(s);if(!t)return;const r=t.mechanism;if(t.mechanism={type:"generic",handled:!0,...r,...e},e&&"data"in e){const a={...r&&r.data,...e.data};t.mechanism.data=a}}function za(s){if(function(e){try{return e.__sentry_captured__}catch{}}(s))return!0;try{Kt(s,"__sentry_captured__",!0)}catch{}return!1}var mt;function Qt(s){return new Ke(e=>{e(s)})}function or(s){return new Ke((e,t)=>{t(s)})}(()=>{const{performance:s}=pe;!s||!s.now||(s.now(),s.timing&&s.timing.navigationStart)})(),function(s){s[s.PENDING=0]="PENDING",s[s.RESOLVED=1]="RESOLVED",s[s.REJECTED=2]="REJECTED"}(mt||(mt={}));class Ke{constructor(e){Ke.prototype.__init.call(this),Ke.prototype.__init2.call(this),Ke.prototype.__init3.call(this),Ke.prototype.__init4.call(this),this._state=mt.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(t){this._reject(t)}}then(e,t){return new Ke((r,a)=>{this._handlers.push([!1,i=>{if(e)try{r(e(i))}catch(l){a(l)}else r(i)},i=>{if(t)try{r(t(i))}catch(l){a(l)}else a(i)}]),this._executeHandlers()})}catch(e){return this.then(t=>t,e)}finally(e){return new Ke((t,r)=>{let a,i;return this.then(l=>{i=!1,a=l,e&&e()},l=>{i=!0,a=l,e&&e()}).then(()=>{i?r(a):t(a)})})}__init(){this._resolve=e=>{this._setResult(mt.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(mt.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===mt.PENDING&&(_r(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===mt.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(t=>{t[0]||(this._state===mt.RESOLVED&&t[1](this._value),this._state===mt.REJECTED&&t[2](this._value),t[0]=!0)})}}}function wu(s){const e=vt(),t={sid:Xe(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(r){return Qe({sid:`${r.sid}`,init:r.init,started:new Date(1e3*r.started).toISOString(),timestamp:new Date(1e3*r.timestamp).toISOString(),status:r.status,errors:r.errors,did:typeof r.did=="number"||typeof r.did=="string"?`${r.did}`:void 0,duration:r.duration,abnormal_mechanism:r.abnormal_mechanism,attrs:{release:r.release,environment:r.environment,ip_address:r.ipAddress,user_agent:r.userAgent}})}(t)};return s&&cs(t,s),t}function cs(s,e={}){if(e.user&&(!s.ipAddress&&e.user.ip_address&&(s.ipAddress=e.user.ip_address),s.did||e.did||(s.did=e.user.id||e.user.email||e.user.username)),s.timestamp=e.timestamp||vt(),e.abnormal_mechanism&&(s.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(s.ignoreDuration=e.ignoreDuration),e.sid&&(s.sid=e.sid.length===32?e.sid:Xe()),e.init!==void 0&&(s.init=e.init),!s.did&&e.did&&(s.did=`${e.did}`),typeof e.started=="number"&&(s.started=e.started),s.ignoreDuration)s.duration=void 0;else if(typeof e.duration=="number")s.duration=e.duration;else{const t=s.timestamp-s.started;s.duration=t>=0?t:0}e.release&&(s.release=e.release),e.environment&&(s.environment=e.environment),!s.ipAddress&&e.ipAddress&&(s.ipAddress=e.ipAddress),!s.userAgent&&e.userAgent&&(s.userAgent=e.userAgent),typeof e.errors=="number"&&(s.errors=e.errors),e.status&&(s.status=e.status)}function Ya(){return Xe()}function Qr(){return Xe().substring(16)}function xr(s,e,t=2){if(!e||typeof e!="object"||t<=0)return e;if(s&&e&&Object.keys(e).length===0)return s;const r={...s};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=xr(r[a],e[a],t-1));return r}const Xr="_sentrySpan";function Wa(s,e){e?Kt(s,Xr,e):delete s[Xr]}function Ha(s){return s[Xr]}class An{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Ya(),spanId:Qr()}}clone(){const e=new An;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Wa(e,Ha(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&cs(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return t===null?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t=typeof e=="function"?e(this):e,[r,a]=t instanceof Ot?[t.getScopeData(),t.getRequestSession()]:os(t)?[e,e.requestSession]:[],{tags:i,extra:l,user:c,contexts:d,level:m,fingerprint:g=[],propagationContext:_}=r||{};return this._tags={...this._tags,...i},this._extra={...this._extra,...l},this._contexts={...this._contexts,...d},c&&Object.keys(c).length&&(this._user=c),m&&(this._level=m),g.length&&(this._fingerprint=g),_&&(this._propagationContext=_),a&&(this._requestSession=a),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Wa(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Ya()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const r=typeof t=="number"?t:100;if(r<=0)return this;const a={timestamp:Ts(),...e};return this._breadcrumbs.push(a),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Ha(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=xr(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:Qr(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,t){const r=t&&t.event_id?t.event_id:Xe();if(!this._client)return Z.warn("No client configured on scope - will not capture exception!"),r;const a=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:a,...t,event_id:r},this),r}captureMessage(e,t,r){const a=r&&r.event_id?r.event_id:Xe();if(!this._client)return Z.warn("No client configured on scope - will not capture message!"),a;const i=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:i,...r,event_id:a},this),a}captureEvent(e,t){const r=t&&t.event_id?t.event_id:Xe();return this._client?(this._client.captureEvent(e,{...t,event_id:r},this),r):(Z.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const Ot=An;class Su{constructor(e,t){let r,a;r=e||new Ot,a=t||new Ot,this._stack=[{scope:r}],this._isolationScope=a}withScope(e){const t=this._pushScope();let r;try{r=e(t)}catch(a){throw this._popScope(),a}return _r(r)?r.then(a=>(this._popScope(),a),a=>{throw this._popScope(),a}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function us(){const s=kn(yr());return s.stack=s.stack||new Su(ar("defaultCurrentScope",()=>new Ot),ar("defaultIsolationScope",()=>new Ot))}function ju(s){return us().withScope(s)}function ku(s,e){const t=us();return t.withScope(()=>(t.getStackTop().scope=s,e(s)))}function Ka(s){return us().withScope(()=>s(us().getIsolationScope()))}function Mn(s){const e=kn(s);return e.acs?e.acs:{withIsolationScope:Ka,withScope:ju,withSetScope:ku,withSetIsolationScope:(t,r)=>Ka(r),getCurrentScope:()=>us().getScope(),getIsolationScope:()=>us().getIsolationScope()}}function es(){return Mn(yr()).getCurrentScope()}function As(){return Mn(yr()).getIsolationScope()}function Re(){return es().getClient()}function Cu(s){const e=s.getPropagationContext(),{traceId:t,spanId:r,parentSpanId:a}=e;return Qe({trace_id:t,span_id:r,parent_span_id:a})}function Nu(s){const e=s._sentryMetrics;if(!e)return;const t={};for(const[,[r,a]]of e)(t[r]||(t[r]=[])).push(Qe(a));return t}const Eu=/^sentry-/;function Tu(s){const e=function(r){if(!(!r||!ft(r)&&!Array.isArray(r)))return Array.isArray(r)?r.reduce((a,i)=>{const l=Qa(i);return Object.entries(l).forEach(([c,d])=>{a[c]=d}),a},{}):Qa(r)}(s);if(!e)return;const t=Object.entries(e).reduce((r,[a,i])=>(a.match(Eu)&&(r[a.slice(7)]=i),r),{});return Object.keys(t).length>0?t:void 0}function Qa(s){return s.split(",").map(e=>e.split("=").map(t=>decodeURIComponent(t.trim()))).reduce((e,[t,r])=>(t&&r&&(e[t]=r),e),{})}let Xa=!1;function Au(s){const{spanId:e,traceId:t,isRemote:r}=s.spanContext();return Qe({parent_span_id:r?e:In(s).parent_span_id,span_id:r?Qr():e,trace_id:t})}function Za(s){return typeof s=="number"?ei(s):Array.isArray(s)?s[0]+s[1]/1e9:s instanceof Date?ei(s.getTime()):vt()}function ei(s){return s>9999999999?s/1e3:s}function In(s){if(function(e){return typeof e.getSpanJSON=="function"}(s))return s.getSpanJSON();try{const{spanId:e,traceId:t}=s.spanContext();if(function(r){const a=r;return!!(a.attributes&&a.startTime&&a.name&&a.endTime&&a.status)}(s)){const{attributes:r,startTime:a,name:i,endTime:l,parentSpanId:c,status:d}=s;return Qe({span_id:e,trace_id:t,data:r,description:i,parent_span_id:c,start_timestamp:Za(a),timestamp:Za(l)||void 0,status:Mu(d),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:Nu(s)})}return{span_id:e,trace_id:t}}catch{return{}}}function Mu(s){if(s&&s.code!==0)return s.code===1?"ok":s.message||"unknown_error"}function Do(s){return s._sentryRootSpan||s}function Iu(){Xa||(Es(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")}),Xa=!0)}const On="production";function Ro(s,e){const t=e.getOptions(),{publicKey:r}=e.getDsn()||{},a=Qe({environment:t.environment||On,release:t.release,public_key:r,trace_id:s});return e.emit("createDsc",a),a}function Ou(s){const e=Re();if(!e)return{};const t=Do(s),r=t._frozenDsc;if(r)return r;const a=t.spanContext().traceState,i=a&&a.get("sentry.dsc"),l=i&&Tu(i);if(l)return l;const c=Ro(s.spanContext().traceId,e),d=In(t),m=d.data||{},g=m["sentry.sample_rate"];g!=null&&(c.sample_rate=`${g}`);const _=m["sentry.source"],T=d.description;return _!=="url"&&T&&(c.transaction=T),function(N){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const k=Re(),y=k&&k.getOptions();return!!y&&(y.enableTracing||"tracesSampleRate"in y||"tracesSampler"in y)}()&&(c.sampled=String(function(N){const{traceFlags:k}=N.spanContext();return k===1}(t))),e.emit("createDsc",c,t),c}const Pu=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function lr(s,e=!1){const{host:t,path:r,pass:a,port:i,projectId:l,protocol:c,publicKey:d}=s;return`${c}://${d}${e&&a?`:${a}`:""}@${t}${i?`:${i}`:""}/${r&&`${r}/`}${l}`}function ti(s){return{protocol:s.protocol,publicKey:s.publicKey||"",pass:s.pass||"",host:s.host,port:s.port||"",path:s.path||"",projectId:s.projectId}}function Lu(s){const e=typeof s=="string"?function(t){const r=Pu.exec(t);if(!r)return void Es(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});const[a,i,l="",c="",d="",m=""]=r.slice(1);let g="",_=m;const T=_.split("/");if(T.length>1&&(g=T.slice(0,-1).join("/"),_=T.pop()),_){const N=_.match(/^\d+/);N&&(_=N[0])}return ti({host:c,pass:l,path:g,projectId:_,port:d,protocol:a,publicKey:i})}(s):ti(s);if(e&&function(t){if(!Zt)return!0;const{port:r,projectId:a,protocol:i}=t;return!(["protocol","publicKey","host","projectId"].find(l=>!t[l]&&(Z.error(`Invalid Sentry Dsn: ${l} missing`),!0))||(a.match(/^\d+$/)?function(l){return l==="http"||l==="https"}(i)?r&&isNaN(parseInt(r,10))&&(Z.error(`Invalid Sentry Dsn: Invalid port ${r}`),1):(Z.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),1):(Z.error(`Invalid Sentry Dsn: Invalid projectId ${a}`),1)))}(e))return e}function pt(s,e=100,t=1/0){try{return Zr("",s,e,t)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function Fo(s,e=3,t=102400){const r=pt(s,e);return a=r,function(i){return~-encodeURI(i).split(/%..|./).length}(JSON.stringify(a))>t?Fo(s,e-1,t):r;var a}function Zr(s,e,t=1/0,r=1/0,a=function(){const i=typeof WeakSet=="function",l=i?new WeakSet:[];return[function(c){if(i)return!!l.has(c)||(l.add(c),!1);for(let d=0;d<l.length;d++)if(l[d]===c)return!0;return l.push(c),!1},function(c){if(i)l.delete(c);else for(let d=0;d<l.length;d++)if(l[d]===c){l.splice(d,1);break}}]}()){const[i,l]=a;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const c=function(N,k){try{if(N==="domain"&&k&&typeof k=="object"&&k._events)return"[Domain]";if(N==="domainEmitter")return"[DomainEmitter]";if(typeof globalThis<"u"&&k===globalThis)return"[Global]";if(typeof window<"u"&&k===window)return"[Window]";if(typeof document<"u"&&k===document)return"[Document]";if(Mo(k))return"[VueViewModel]";if(os(y=k)&&"nativeEvent"in y&&"preventDefault"in y&&"stopPropagation"in y)return"[SyntheticEvent]";if(typeof k=="number"&&!Number.isFinite(k))return`[${k}]`;if(typeof k=="function")return`[Function: ${It(k)}]`;if(typeof k=="symbol")return`[${String(k)}]`;if(typeof k=="bigint")return`[BigInt: ${String(k)}]`;const w=function(C){const I=Object.getPrototypeOf(C);return I?I.constructor.name:"null prototype"}(k);return/^HTML(\w*)Element$/.test(w)?`[HTMLElement: ${w}]`:`[object ${w}]`}catch(w){return`**non-serializable** (${w})`}var y}(s,e);if(!c.startsWith("[object "))return c;if(e.__sentry_skip_normalization__)return e;const d=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:t;if(d===0)return c.replace("object ","");if(i(e))return"[Circular ~]";const m=e;if(m&&typeof m.toJSON=="function")try{return Zr("",m.toJSON(),d-1,r,a)}catch{}const g=Array.isArray(e)?[]:{};let _=0;const T=Po(e);for(const N in T){if(!Object.prototype.hasOwnProperty.call(T,N))continue;if(_>=r){g[N]="[MaxProperties ~]";break}const k=T[N];g[N]=Zr(N,k,d-1,r,a),_++}return l(e),g}function Ns(s,e=[]){return[s,e]}function Du(s,e){const[t,r]=s;return[t,[...r,e]]}function si(s,e){const t=s[1];for(const r of t)if(e(r,r[0].type))return!0;return!1}function en(s){return pe.__SENTRY__&&pe.__SENTRY__.encodePolyfill?pe.__SENTRY__.encodePolyfill(s):new TextEncoder().encode(s)}function Ru(s){const[e,t]=s;let r=JSON.stringify(e);function a(i){typeof r=="string"?r=typeof i=="string"?r+i:[en(r),i]:r.push(typeof i=="string"?en(i):i)}for(const i of t){const[l,c]=i;if(a(`
${JSON.stringify(l)}
`),typeof c=="string"||c instanceof Uint8Array)a(c);else{let d;try{d=JSON.stringify(c)}catch{d=JSON.stringify(pt(c))}a(d)}}return typeof r=="string"?r:function(i){const l=i.reduce((m,g)=>m+g.length,0),c=new Uint8Array(l);let d=0;for(const m of i)c.set(m,d),d+=m.length;return c}(r)}function Fu(s){const e=typeof s.data=="string"?en(s.data):s.data;return[Qe({type:"attachment",length:e.length,filename:s.filename,content_type:s.contentType,attachment_type:s.attachmentType}),e]}const Vu={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function ri(s){return Vu[s]}function Vo(s){if(!s||!s.sdk)return;const{name:e,version:t}=s.sdk;return{name:e,version:t}}function Uu(s,e,t,r){const a=Vo(t),i=s.type&&s.type!=="replay_event"?s.type:"event";(function(c,d){d&&(c.sdk=c.sdk||{},c.sdk.name=c.sdk.name||d.name,c.sdk.version=c.sdk.version||d.version,c.sdk.integrations=[...c.sdk.integrations||[],...d.integrations||[]],c.sdk.packages=[...c.sdk.packages||[],...d.packages||[]])})(s,t&&t.sdk);const l=function(c,d,m,g){const _=c.sdkProcessingMetadata&&c.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:c.event_id,sent_at:new Date().toISOString(),...d&&{sdk:d},...!!m&&g&&{dsn:lr(g)},..._&&{trace:Qe({..._})}}}(s,a,r,e);return delete s.sdkProcessingMetadata,Ns(l,[[{type:i},s]])}function tn(s,e,t,r=0){return new Ke((a,i)=>{const l=s[r];if(e===null||typeof l!="function")a(e);else{const c=l({...e},t);Se&&l.id&&c===null&&Z.log(`Event processor "${l.id}" dropped event`),_r(c)?c.then(d=>tn(s,d,t,r+1).then(a)).then(null,i):tn(s,c,t,r+1).then(a).then(null,i)}})}let Rs,ni,Er;function qu(s,e){const{fingerprint:t,span:r,breadcrumbs:a,sdkProcessingMetadata:i}=e;(function(l,c){const{extra:d,tags:m,user:g,contexts:_,level:T,transactionName:N}=c,k=Qe(d);k&&Object.keys(k).length&&(l.extra={...k,...l.extra});const y=Qe(m);y&&Object.keys(y).length&&(l.tags={...y,...l.tags});const w=Qe(g);w&&Object.keys(w).length&&(l.user={...w,...l.user});const C=Qe(_);C&&Object.keys(C).length&&(l.contexts={...C,...l.contexts}),T&&(l.level=T),N&&l.type!=="transaction"&&(l.transaction=N)})(s,e),r&&function(l,c){l.contexts={trace:Au(c),...l.contexts},l.sdkProcessingMetadata={dynamicSamplingContext:Ou(c),...l.sdkProcessingMetadata};const d=Do(c),m=In(d).description;m&&!l.transaction&&l.type==="transaction"&&(l.transaction=m)}(s,r),function(l,c){l.fingerprint=l.fingerprint?Array.isArray(l.fingerprint)?l.fingerprint:[l.fingerprint]:[],c&&(l.fingerprint=l.fingerprint.concat(c)),l.fingerprint&&!l.fingerprint.length&&delete l.fingerprint}(s,t),function(l,c){const d=[...l.breadcrumbs||[],...c];l.breadcrumbs=d.length?d:void 0}(s,a),function(l,c){l.sdkProcessingMetadata={...l.sdkProcessingMetadata,...c}}(s,i)}function ai(s,e){const{extra:t,tags:r,user:a,contexts:i,level:l,sdkProcessingMetadata:c,breadcrumbs:d,fingerprint:m,eventProcessors:g,attachments:_,propagationContext:T,transactionName:N,span:k}=e;Fs(s,"extra",t),Fs(s,"tags",r),Fs(s,"user",a),Fs(s,"contexts",i),s.sdkProcessingMetadata=xr(s.sdkProcessingMetadata,c,2),l&&(s.level=l),N&&(s.transactionName=N),k&&(s.span=k),d.length&&(s.breadcrumbs=[...s.breadcrumbs,...d]),m.length&&(s.fingerprint=[...s.fingerprint,...m]),g.length&&(s.eventProcessors=[...s.eventProcessors,...g]),_.length&&(s.attachments=[...s.attachments,..._]),s.propagationContext={...s.propagationContext,...T}}function Fs(s,e,t){s[e]=xr(s[e],t,1)}function Bu(s,e,t,r,a,i){const{normalizeDepth:l=3,normalizeMaxBreadth:c=1e3}=s,d={...e,event_id:e.event_id||t.event_id||Xe(),timestamp:e.timestamp||Ts()},m=t.integrations||s.integrations.map(k=>k.name);(function(k,y){const{environment:w,release:C,dist:I,maxValueLength:E=250}=y;k.environment=k.environment||w||On,!k.release&&C&&(k.release=C),!k.dist&&I&&(k.dist=I),k.message&&(k.message=ns(k.message,E));const O=k.exception&&k.exception.values&&k.exception.values[0];O&&O.value&&(O.value=ns(O.value,E));const p=k.request;p&&p.url&&(p.url=ns(p.url,E))})(d,s),function(k,y){y.length>0&&(k.sdk=k.sdk||{},k.sdk.integrations=[...k.sdk.integrations||[],...y])}(d,m),a&&a.emit("applyFrameMetadata",e),e.type===void 0&&function(k,y){const w=function(C){const I=pe._sentryDebugIds;if(!I)return{};const E=Object.keys(I);return Er&&E.length===ni||(ni=E.length,Er=E.reduce((O,p)=>{Rs||(Rs={});const B=Rs[p];if(B)O[B[0]]=B[1];else{const K=C(p);for(let R=K.length-1;R>=0;R--){const he=K[R],A=he&&he.filename,z=I[p];if(A&&z){O[A]=z,Rs[p]=[A,z];break}}}return O},{})),Er}(y);try{k.exception.values.forEach(C=>{C.stacktrace.frames.forEach(I=>{w&&I.filename&&(I.debug_id=w[I.filename])})})}catch{}}(d,s.stackParser);const g=function(k,y){if(!y)return k;const w=k?k.clone():new Ot;return w.update(y),w}(r,t.captureContext);t.mechanism&&ls(d,t.mechanism);const _=a?a.getEventProcessors():[],T=ar("globalScope",()=>new Ot).getScopeData();i&&ai(T,i.getScopeData()),g&&ai(T,g.getScopeData());const N=[...t.attachments||[],...T.attachments];return N.length&&(t.attachments=N),qu(d,T),tn([..._,...T.eventProcessors],d,t).then(k=>(k&&function(y){const w={};try{y.exception.values.forEach(I=>{I.stacktrace.frames.forEach(E=>{E.debug_id&&(E.abs_path?w[E.abs_path]=E.debug_id:E.filename&&(w[E.filename]=E.debug_id),delete E.debug_id)})})}catch{}if(Object.keys(w).length===0)return;y.debug_meta=y.debug_meta||{},y.debug_meta.images=y.debug_meta.images||[];const C=y.debug_meta.images;Object.entries(w).forEach(([I,E])=>{C.push({type:"sourcemap",code_file:I,debug_id:E})})}(k),typeof l=="number"&&l>0?function(y,w,C){if(!y)return null;const I={...y,...y.breadcrumbs&&{breadcrumbs:y.breadcrumbs.map(E=>({...E,...E.data&&{data:pt(E.data,w,C)}}))},...y.user&&{user:pt(y.user,w,C)},...y.contexts&&{contexts:pt(y.contexts,w,C)},...y.extra&&{extra:pt(y.extra,w,C)}};return y.contexts&&y.contexts.trace&&I.contexts&&(I.contexts.trace=y.contexts.trace,y.contexts.trace.data&&(I.contexts.trace.data=pt(y.contexts.trace.data,w,C))),y.spans&&(I.spans=y.spans.map(E=>({...E,...E.data&&{data:pt(E.data,w,C)}}))),y.contexts&&y.contexts.flags&&I.contexts&&(I.contexts.flags=pt(y.contexts.flags,3,C)),I}(k,l,c):k))}function ii(s,e){return es().captureEvent(s,e)}function oi(s){const e=Re(),t=As(),r=es(),{release:a,environment:i=On}=e&&e.getOptions()||{},{userAgent:l}=pe.navigator||{},c=wu({release:a,environment:i,user:r.getUser()||t.getUser(),...l&&{userAgent:l},...s}),d=t.getSession();return d&&d.status==="ok"&&cs(d,{status:"exited"}),Uo(),t.setSession(c),r.setSession(c),c}function Uo(){const s=As(),e=es(),t=e.getSession()||s.getSession();t&&function(r,a){let i={};r.status==="ok"&&(i={status:"exited"}),cs(r,i)}(t),qo(),s.setSession(),e.setSession()}function qo(){const s=As(),e=es(),t=Re(),r=e.getSession()||s.getSession();r&&t&&t.captureSession(r)}function li(s=!1){s?Uo():qo()}function $u(s,e,t){return e||`${function(r){return`${function(a){const i=a.protocol?`${a.protocol}:`:"",l=a.port?`:${a.port}`:"";return`${i}//${a.host}${l}${a.path?`/${a.path}`:""}/api/`}(r)}${r.projectId}/envelope/`}(s)}?${function(r,a){const i={sentry_version:"7"};return r.publicKey&&(i.sentry_key=r.publicKey),a&&(i.sentry_client=`${a.name}/${a.version}`),new URLSearchParams(i).toString()}(s,t)}`}const ci=[];function ui(s,e){for(const t of e)t&&t.afterAllSetup&&t.afterAllSetup(s)}function di(s,e,t){if(t[e.name])Se&&Z.log(`Integration skipped because it was already installed: ${e.name}`);else{if(t[e.name]=e,ci.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),ci.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(s),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);s.on("preprocessEvent",(a,i)=>r(a,i,s))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),a=Object.assign((i,l)=>r(i,l,s),{id:e.name});s.addEventProcessor(a)}Se&&Z.log(`Integration installed: ${e.name}`)}}class tt extends Error{constructor(e,t="warn"){super(e),this.message=e,this.logLevel=t}}const hi="Not capturing exception because it's already been captured.";class Ju{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Lu(e.dsn):Se&&Z.warn("No DSN provided, client will not send events."),this._dsn){const r=$u(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:r})}const t=["enableTracing","tracesSampleRate","tracesSampler"].find(r=>r in e&&e[r]==null);t&&Es(()=>{console.warn(`[Sentry] Deprecation warning: \`${t}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)})}captureException(e,t,r){const a=Xe();if(za(e))return Se&&Z.log(hi),a;const i={event_id:a,...t};return this._process(this.eventFromException(e,i).then(l=>this._captureEvent(l,i,r))),i.event_id}captureMessage(e,t,r,a){const i={event_id:Xe(),...r},l=Nn(e)?e:String(e),c=Wr(e)?this.eventFromMessage(l,t,i):this.eventFromException(e,i);return this._process(c.then(d=>this._captureEvent(d,i,a))),i.event_id}captureEvent(e,t,r){const a=Xe();if(t&&t.originalException&&za(t.originalException))return Se&&Z.log(hi),a;const i={event_id:a,...t},l=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,i,l||r)),i.event_id}captureSession(e){typeof e.release!="string"?Se&&Z.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),cs(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>t.flush(e).then(a=>r&&a))):Qt(!0)}close(e){return this.flush(e).then(t=>(this.getOptions().enabled=!1,this.emit("close"),t))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];di(this,e,this._integrations),t||ui(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let r=Uu(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of t.attachments||[])r=Du(r,Fu(i));const a=this.sendEnvelope(r);a&&a.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){const t=function(r,a,i,l){const c=Vo(i);return Ns({sent_at:new Date().toISOString(),...c&&{sdk:c},...!!l&&a&&{dsn:lr(a)}},["aggregates"in r?[{type:"sessions"},r]:[{type:"session"},r.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(t)}recordDroppedEvent(e,t,r){if(this._options.sendClientReports){const a=typeof r=="number"?r:1,i=`${e}:${t}`;Se&&Z.log(`Recording outcome: "${i}"${a>1?` (${a} times)`:""}`),this._outcomes[i]=(this._outcomes[i]||0)+a}}on(e,t){const r=this._hooks[e]=this._hooks[e]||[];return r.push(t),()=>{const a=r.indexOf(t);a>-1&&r.splice(a,1)}}emit(e,...t){const r=this._hooks[e];r&&r.forEach(a=>a(...t))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,t=>(Se&&Z.error("Error while sending envelope:",t),t)):(Se&&Z.error("Transport disabled"),Qt({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(t,r){const a={};return r.forEach(i=>{i&&di(t,i,a)}),a}(this,e),ui(this,e)}_updateSessionFromEvent(e,t){let r=t.level==="fatal",a=!1;const i=t.exception&&t.exception.values;if(i){a=!0;for(const c of i){const d=c.mechanism;if(d&&d.handled===!1){r=!0;break}}}const l=e.status==="ok";(l&&e.errors===0||l&&r)&&(cs(e,{...r&&{status:"crashed"},errors:e.errors||Number(a||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Ke(t=>{let r=0;const a=setInterval(()=>{this._numProcessing==0?(clearInterval(a),t(!0)):(r+=1,e&&r>=e&&(clearInterval(a),t(!1)))},1)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,t,r=es(),a=As()){const i=this.getOptions(),l=Object.keys(this._integrations);return!t.integrations&&l.length>0&&(t.integrations=l),this.emit("preprocessEvent",e,t),e.type||a.setLastEventId(e.event_id||t.event_id),Bu(i,e,t,r,this,a).then(c=>{if(c===null)return c;c.contexts={trace:Cu(r),...c.contexts};const d=function(m,g){const _=g.getPropagationContext();return _.dsc||Ro(_.traceId,m)}(this,r);return c.sdkProcessingMetadata={dynamicSamplingContext:d,...c.sdkProcessingMetadata},c})}_captureEvent(e,t={},r){return this._processEvent(e,t,r).then(a=>a.event_id,a=>{Se&&(a instanceof tt&&a.logLevel==="log"?Z.log(a.message):Z.warn(a))})}_processEvent(e,t,r){const a=this.getOptions(),{sampleRate:i}=a,l=pi(e),c=mi(e),d=e.type||"error",m=`before send for type \`${d}\``,g=i===void 0?void 0:function(N){if(typeof N=="boolean")return Number(N);const k=typeof N=="string"?parseFloat(N):N;if(!(typeof k!="number"||isNaN(k)||k<0||k>1))return k;Se&&Z.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(N)} of type ${JSON.stringify(typeof N)}.`)}(i);if(c&&typeof g=="number"&&Math.random()>g)return this.recordDroppedEvent("sample_rate","error",e),or(new tt(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));const _=d==="replay_event"?"replay":d,T=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,r,T).then(N=>{if(N===null)throw this.recordDroppedEvent("event_processor",_,e),new tt("An event processor returned `null`, will not send event.","log");if(t.data&&t.data.__sentry__===!0)return N;const k=function(y,w,C,I){const{beforeSend:E,beforeSendTransaction:O,beforeSendSpan:p}=w;if(mi(C)&&E)return E(C,I);if(pi(C)){if(C.spans&&p){const B=[];for(const K of C.spans){const R=p(K);R?B.push(R):(Iu(),y.recordDroppedEvent("before_send","span"))}C.spans=B}if(O){if(C.spans){const B=C.spans.length;C.sdkProcessingMetadata={...C.sdkProcessingMetadata,spanCountBeforeProcessing:B}}return O(C,I)}}return C}(this,a,N,t);return function(y,w){const C=`${w} must return \`null\` or a valid event.`;if(_r(y))return y.then(I=>{if(!os(I)&&I!==null)throw new tt(C);return I},I=>{throw new tt(`${w} rejected with ${I}`)});if(!os(y)&&y!==null)throw new tt(C);return y}(k,m)}).then(N=>{if(N===null){if(this.recordDroppedEvent("before_send",_,e),l){const w=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",w)}throw new tt(`${m} returned \`null\`, will not send event.`,"log")}const k=r&&r.getSession();if(!l&&k&&this._updateSessionFromEvent(k,N),l){const w=(N.sdkProcessingMetadata&&N.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(N.spans?N.spans.length:0);w>0&&this.recordDroppedEvent("before_send","span",w)}const y=N.transaction_info;if(l&&y&&N.transaction!==e.transaction){const w="custom";N.transaction_info={...y,source:w}}return this.sendEvent(N,t),N}).then(null,N=>{throw N instanceof tt?N:(this.captureException(N,{data:{__sentry__:!0},originalException:N}),new tt(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${N}`))})}_process(e){this._numProcessing++,e.then(t=>(this._numProcessing--,t),t=>(this._numProcessing--,t))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([t,r])=>{const[a,i]=t.split(":");return{reason:a,category:i,quantity:r}})}_flushOutcomes(){Se&&Z.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0)return void(Se&&Z.log("No outcomes to send"));if(!this._dsn)return void(Se&&Z.log("No dsn provided, will not send outcomes"));Se&&Z.log("Sending outcomes:",e);const t=(r=e,Ns((a=this._options.tunnel&&lr(this._dsn))?{dsn:a}:{},[[{type:"client_report"},{timestamp:Ts(),discarded_events:r}]]));var r,a;this.sendEnvelope(t)}}function mi(s){return s.type===void 0}function pi(s){return s.type==="transaction"}function Gu(s){const e=[];function t(r){return e.splice(e.indexOf(r),1)[0]||Promise.resolve(void 0)}return{$:e,add:function(r){if(!(s===void 0||e.length<s))return or(new tt("Not adding Promise because buffer limit was reached."));const a=r();return e.indexOf(a)===-1&&e.push(a),a.then(()=>t(a)).then(null,()=>t(a).then(null,()=>{})),a},drain:function(r){return new Ke((a,i)=>{let l=e.length;if(!l)return a(!0);const c=setTimeout(()=>{r&&r>0&&a(!1)},r);e.forEach(d=>{Qt(d).then(()=>{--l||(clearTimeout(c),a(!0))},i)})})}}}function zu(s,{statusCode:e,headers:t},r=Date.now()){const a={...s},i=t&&t["x-sentry-rate-limits"],l=t&&t["retry-after"];if(i)for(const c of i.trim().split(",")){const[d,m,,,g]=c.split(":",5),_=parseInt(d,10),T=1e3*(isNaN(_)?60:_);if(m)for(const N of m.split(";"))N==="metric_bucket"&&g&&!g.split(";").includes("custom")||(a[N]=r+T);else a.all=r+T}else l?a.all=r+function(c,d=Date.now()){const m=parseInt(`${c}`,10);if(!isNaN(m))return 1e3*m;const g=Date.parse(`${c}`);return isNaN(g)?6e4:g-d}(l,r):e===429&&(a.all=r+6e4);return a}function Yu(s,e,t=Gu(s.bufferSize||64)){let r={};return{send:function(a){const i=[];if(si(a,(d,m)=>{const g=ri(m);if(function(_,T,N=Date.now()){return function(k,y){return k[y]||k.all||0}(_,T)>N}(r,g)){const _=fi(d,m);s.recordDroppedEvent("ratelimit_backoff",g,_)}else i.push(d)}),i.length===0)return Qt({});const l=Ns(a[0],i),c=d=>{si(l,(m,g)=>{const _=fi(m,g);s.recordDroppedEvent(d,ri(g),_)})};return t.add(()=>e({body:Ru(l)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&Se&&Z.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=zu(r,d),d),d=>{throw c("network_error"),d})).then(d=>d,d=>{if(d instanceof tt)return Se&&Z.error("Skipped sending event because buffer is full."),c("queue_overflow"),Qt({});throw d})},flush:a=>t.drain(a)}}function fi(s,e){if(e==="event"||e==="transaction")return Array.isArray(s)?s[1]:void 0}const Wu=100;function Rt(s,e){const t=Re(),r=As();if(!t)return;const{beforeBreadcrumb:a=null,maxBreadcrumbs:i=Wu}=t.getOptions();if(i<=0)return;const l={timestamp:Ts(),...s},c=a?Es(()=>a(l,e)):l;c!==null&&(t.emit&&t.emit("beforeAddBreadcrumb",c,e),r.addBreadcrumb(c,i))}let gi;const vi=new WeakMap,Hu=()=>({name:"FunctionToString",setupOnce(){gi=Function.prototype.toString;try{Function.prototype.toString=function(...s){const e=Tn(this),t=vi.has(Re())&&e!==void 0?e:this;return gi.apply(t,s)}}catch{}},setup(s){vi.set(s,!0)}}),Ku=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],Qu=(s={})=>({name:"InboundFilters",processEvent(e,t,r){const a=r.getOptions(),i=function(l={},c={}){return{allowUrls:[...l.allowUrls||[],...c.allowUrls||[]],denyUrls:[...l.denyUrls||[],...c.denyUrls||[]],ignoreErrors:[...l.ignoreErrors||[],...c.ignoreErrors||[],...l.disableErrorDefaults?[]:Ku],ignoreTransactions:[...l.ignoreTransactions||[],...c.ignoreTransactions||[]],ignoreInternal:l.ignoreInternal===void 0||l.ignoreInternal}}(s,a);return function(l,c){return c.ignoreInternal&&function(d){try{return d.exception.values[0].type==="SentryError"}catch{}return!1}(l)?(Se&&Z.warn(`Event dropped due to being internal Sentry Error.
Event: ${Nt(l)}`),!0):function(d,m){return d.type||!m||!m.length?!1:function(g){const _=[];g.message&&_.push(g.message);let T;try{T=g.exception.values[g.exception.values.length-1]}catch{}return T&&T.value&&(_.push(T.value),T.type&&_.push(`${T.type}: ${T.value}`)),_}(d).some(g=>Ds(g,m))}(l,c.ignoreErrors)?(Se&&Z.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Nt(l)}`),!0):function(d){return d.type||!d.exception||!d.exception.values||d.exception.values.length===0?!1:!d.message&&!d.exception.values.some(m=>m.stacktrace||m.type&&m.type!=="Error"||m.value)}(l)?(Se&&Z.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Nt(l)}`),!0):function(d,m){if(d.type!=="transaction"||!m||!m.length)return!1;const g=d.transaction;return!!g&&Ds(g,m)}(l,c.ignoreTransactions)?(Se&&Z.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Nt(l)}`),!0):function(d,m){if(!m||!m.length)return!1;const g=Vs(d);return!!g&&Ds(g,m)}(l,c.denyUrls)?(Se&&Z.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Nt(l)}.
Url: ${Vs(l)}`),!0):function(d,m){if(!m||!m.length)return!0;const g=Vs(d);return!g||Ds(g,m)}(l,c.allowUrls)?!1:(Se&&Z.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Nt(l)}.
Url: ${Vs(l)}`),!0)}(e,i)?null:e}});function Vs(s){try{let e;try{e=s.exception.values[0].stacktrace.frames}catch{}return e?function(t=[]){for(let r=t.length-1;r>=0;r--){const a=t[r];if(a&&a.filename!=="<anonymous>"&&a.filename!=="[native code]")return a.filename||null}return null}(e):null}catch{return Se&&Z.error(`Cannot extract url for event ${Nt(s)}`),null}}function Xu(s,e,t=250,r,a,i,l){if(!(i.exception&&i.exception.values&&l&&Ht(l.originalException,Error)))return;const c=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;var d,m;c&&(i.exception.values=(d=sn(s,e,a,l.originalException,r,i.exception.values,c,0),m=t,d.map(g=>(g.value&&(g.value=ns(g.value,m)),g))))}function sn(s,e,t,r,a,i,l,c){if(i.length>=t+1)return i;let d=[...i];if(Ht(r[a],Error)){yi(l,c);const m=s(e,r[a]),g=d.length;bi(m,a,g,c),d=sn(s,e,t,r[a],a,[m,...d],m,g)}return Array.isArray(r.errors)&&r.errors.forEach((m,g)=>{if(Ht(m,Error)){yi(l,c);const _=s(e,m),T=d.length;bi(_,`errors[${g}]`,T,c),d=sn(s,e,t,m,a,[_,...d],_,T)}}),d}function yi(s,e){s.mechanism=s.mechanism||{type:"generic",handled:!0},s.mechanism={...s.mechanism,...s.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function bi(s,e,t,r){s.mechanism=s.mechanism||{type:"generic",handled:!0},s.mechanism={...s.mechanism,type:"chained",source:e,exception_id:t,parent_id:r}}function Tr(s){if(!s)return{};const e=s.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const t=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:t,hash:r,relative:e[5]+t+r}}function Zu(){"console"in pe&&Yr.forEach(function(s){s in pe.console&&Ye(pe.console,s,function(e){return ir[s]=e,function(...t){st("console",{args:t,level:s});const r=ir[s];r&&r.apply(pe.console,t)}})})}function ed(s){return s==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(s)?s:"log"}const td=()=>{let s;return{name:"Dedupe",processEvent(e){if(e.type)return e;try{if(function(t,r){return r?!!(function(a,i){const l=a.message,c=i.message;return!(!l&&!c||l&&!c||!l&&c||l!==c||!xi(a,i)||!_i(a,i))}(t,r)||function(a,i){const l=wi(i),c=wi(a);return!(!l||!c||l.type!==c.type||l.value!==c.value||!xi(a,i)||!_i(a,i))}(t,r)):!1}(e,s))return Se&&Z.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return s=e}}};function _i(s,e){let t=Ua(s),r=Ua(e);if(!t&&!r)return!0;if(t&&!r||!t&&r||r.length!==t.length)return!1;for(let a=0;a<r.length;a++){const i=r[a],l=t[a];if(i.filename!==l.filename||i.lineno!==l.lineno||i.colno!==l.colno||i.function!==l.function)return!1}return!0}function xi(s,e){let t=s.fingerprint,r=e.fingerprint;if(!t&&!r)return!0;if(t&&!r||!t&&r)return!1;try{return t.join("")===r.join("")}catch{return!1}}function wi(s){return s.exception&&s.exception.values&&s.exception.values[0]}function Si(s){return s===void 0?void 0:s>=400&&s<500?"warning":s>=500?"error":void 0}const Ar=pe;function rn(s){return s&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(s.toString())}function sd(){if(typeof EdgeRuntime=="string")return!0;if(!function(){if(!("fetch"in Ar))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}())return!1;if(rn(Ar.fetch))return!0;let s=!1;const e=Ar.document;if(e&&typeof e.createElement=="function")try{const t=e.createElement("iframe");t.hidden=!0,e.head.appendChild(t),t.contentWindow&&t.contentWindow.fetch&&(s=rn(t.contentWindow.fetch)),e.head.removeChild(t)}catch(t){Zt&&Z.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return s}function rd(s,e){const t="fetch";zt(t,s),Yt(t,()=>function(r,a=!1){a&&!sd()||Ye(pe,"fetch",function(i){return function(...l){const c=new Error,{method:d,url:m}=function(_){if(_.length===0)return{method:"GET",url:""};if(_.length===2){const[N,k]=_;return{url:ji(N),method:nn(k,"method")?String(k.method).toUpperCase():"GET"}}const T=_[0];return{url:ji(T),method:nn(T,"method")?String(T.method).toUpperCase():"GET"}}(l),g={args:l,fetchData:{method:d,url:m},startTimestamp:1e3*vt(),virtualError:c};return r||st("fetch",{...g}),i.apply(pe,l).then(async _=>(r?r(_):st("fetch",{...g,endTimestamp:1e3*vt(),response:_}),_),_=>{throw st("fetch",{...g,endTimestamp:1e3*vt(),error:_}),Cn(_)&&_.stack===void 0&&(_.stack=c.stack,Kt(_,"framesToPop",1)),_})}})}(void 0,e))}function nn(s,e){return!!s&&typeof s=="object"&&!!s[e]}function ji(s){return typeof s=="string"?s:s?nn(s,"url")?s.url:s.toString?s.toString():"":""}const Us=pe,Ie=pe;let an=0;function ki(){return an>0}function ds(s,e={}){if(!function(r){return typeof r=="function"}(s))return s;try{const r=s.__sentry_wrapped__;if(r)return typeof r=="function"?r:s;if(Tn(s))return s}catch{return s}const t=function(...r){try{const a=r.map(i=>ds(i,e));return s.apply(this,a)}catch(a){throw an++,setTimeout(()=>{an--}),function(...i){const l=Mn(yr());if(i.length===2){const[c,d]=i;return c?l.withSetScope(c,d):l.withScope(d)}l.withScope(i[0])}(i=>{var l;i.addEventProcessor(c=>(e.mechanism&&(Kr(c,void 0),ls(c,e.mechanism)),c.extra={...c.extra,arguments:r},c)),l=a,es().captureException(l,void 0)}),a}};try{for(const r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}catch{}Oo(t,s),Kt(s,"__sentry_wrapped__",t);try{Object.getOwnPropertyDescriptor(t,"name").configurable&&Object.defineProperty(t,"name",{get:()=>s.name})}catch{}return t}const wr=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function Pn(s,e){const t=Ln(s,e),r={type:id(e),value:od(e)};return t.length&&(r.stacktrace={frames:t}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function nd(s,e,t,r){const a=Re(),i=a&&a.getOptions().normalizeDepth,l=function(m){for(const g in m)if(Object.prototype.hasOwnProperty.call(m,g)){const _=m[g];if(_ instanceof Error)return _}}(e),c={__serialized__:Fo(e,i)};if(l)return{exception:{values:[Pn(s,l)]},extra:c};const d={exception:{values:[{type:br(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:ld(e,{isUnhandledRejection:r})}]},extra:c};if(t){const m=Ln(s,t);m.length&&(d.exception.values[0].stacktrace={frames:m})}return d}function Mr(s,e){return{exception:{values:[Pn(s,e)]}}}function Ln(s,e){const t=e.stacktrace||e.stack||"",r=function(i){return i&&ad.test(i.message)?1:0}(e),a=function(i){return typeof i.framesToPop=="number"?i.framesToPop:0}(e);try{return s(t,r,a)}catch{}return[]}const ad=/Minified React error #\d+;/i;function Bo(s){return typeof WebAssembly<"u"&&WebAssembly.Exception!==void 0&&s instanceof WebAssembly.Exception}function id(s){const e=s&&s.name;return!e&&Bo(s)?s.message&&Array.isArray(s.message)&&s.message.length==2?s.message[0]:"WebAssembly.Exception":e}function od(s){const e=s&&s.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:Bo(s)&&Array.isArray(s.message)&&s.message.length==2?s.message[1]:e:"No error message"}function on(s,e,t,r,a){let i;if(Ao(e)&&e.error)return Mr(s,e.error);if(Ba(e)||hs(e,"DOMException")){const l=e;if("stack"in e)i=Mr(s,e);else{const c=l.name||(Ba(l)?"DOMError":"DOMException"),d=l.message?`${c}: ${l.message}`:c;i=ln(s,d,t,r),Kr(i,d)}return"code"in l&&(i.tags={...i.tags,"DOMException.code":`${l.code}`}),i}return Cn(e)?Mr(s,e):os(e)||br(e)?(i=nd(s,e,t,a),ls(i,{synthetic:!0}),i):(i=ln(s,e,t,r),Kr(i,`${e}`),ls(i,{synthetic:!0}),i)}function ln(s,e,t,r){const a={};if(r&&t){const i=Ln(s,t);i.length&&(a.exception={values:[{value:e,stacktrace:{frames:i}}]}),ls(a,{synthetic:!0})}if(Nn(e)){const{__sentry_template_string__:i,__sentry_template_values__:l}=e;return a.logentry={message:i,params:l},a}return a.message=e,a}function ld(s,{isUnhandledRejection:e}){const t=function(a,i=40){const l=Object.keys(Po(a));l.sort();const c=l[0];if(!c)return"[object has no keys]";if(c.length>=i)return ns(c,i);for(let d=l.length;d>0;d--){const m=l.slice(0,d).join(", ");if(!(m.length>i))return d===l.length?m:ns(m,i)}return""}(s),r=e?"promise rejection":"exception";return Ao(s)?`Event \`ErrorEvent\` captured as ${r} with message \`${s.message}\``:br(s)?`Event \`${function(a){try{const i=Object.getPrototypeOf(a);return i?i.constructor.name:void 0}catch{}}(s)}\` (type=${s.type}) captured as ${r}`:`Object captured as ${r} with keys: ${t}`}class cd extends Ju{constructor(e){const t={parentSpanIsAlwaysRootSpan:!0,...e};(function(r,a,i=[a],l="npm"){const c=r._metadata||{};c.sdk||(c.sdk={name:`sentry.javascript.${a}`,packages:i.map(d=>({name:`${l}:@sentry/${d}`,version:Gt})),version:Gt}),r._metadata=c})(t,"browser",["browser"],Ie.SENTRY_SDK_SOURCE||"npm"),super(t),t.sendClientReports&&Ie.document&&Ie.document.addEventListener("visibilitychange",()=>{Ie.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,t){return function(r,a,i,l){const c=on(r,a,i&&i.syntheticException||void 0,l);return ls(c),c.level="error",i&&i.event_id&&(c.event_id=i.event_id),Qt(c)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",r){return function(a,i,l="info",c,d){const m=ln(a,i,c&&c.syntheticException||void 0,d);return m.level=l,c&&c.event_id&&(m.event_id=c.event_id),Qt(m)}(this._options.stackParser,e,t,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(wr&&Z.warn("SDK not enabled, will not capture user feedback."));const t=function(r,{metadata:a,tunnel:i,dsn:l}){const c={event_id:r.event_id,sent_at:new Date().toISOString(),...a&&a.sdk&&{sdk:{name:a.sdk.name,version:a.sdk.version}},...!!i&&!!l&&{dsn:lr(l)}};return Ns(c,[function(m){return[{type:"user_report"},m]}(r)])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(t)}_prepareEvent(e,t,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,r)}}const ud=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,qe=pe;let Ci,Ir,Or,qs;function dd(){if(!qe.document)return;const s=st.bind(null,"dom"),e=Ni(s,!0);qe.document.addEventListener("click",e,!1),qe.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(t=>{const r=qe[t],a=r&&r.prototype;a&&a.hasOwnProperty&&a.hasOwnProperty("addEventListener")&&(Ye(a,"addEventListener",function(i){return function(l,c,d){if(l==="click"||l=="keypress")try{const m=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},g=m[l]=m[l]||{refCount:0};if(!g.handler){const _=Ni(s);g.handler=_,i.call(this,l,_,d)}g.refCount++}catch{}return i.call(this,l,c,d)}}),Ye(a,"removeEventListener",function(i){return function(l,c,d){if(l==="click"||l=="keypress")try{const m=this.__sentry_instrumentation_handlers__||{},g=m[l];g&&(g.refCount--,g.refCount<=0&&(i.call(this,l,g.handler,d),g.handler=void 0,delete m[l]),Object.keys(m).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return i.call(this,l,c,d)}}))})}function Ni(s,e=!1){return t=>{if(!t||t._sentryCaptured)return;const r=function(i){try{return i.target}catch{return null}}(t);if(function(i,l){return i==="keypress"&&(!l||!l.tagName||l.tagName!=="INPUT"&&l.tagName!=="TEXTAREA"&&!l.isContentEditable)}(t.type,r))return;Kt(t,"_sentryCaptured",!0),r&&!r._sentryId&&Kt(r,"_sentryId",Xe());const a=t.type==="keypress"?"input":t.type;(function(i){if(i.type!==Ir)return!1;try{if(!i.target||i.target._sentryId!==Or)return!1}catch{}return!0})(t)||(s({event:t,name:a,global:e}),Ir=t.type,Or=r?r._sentryId:void 0),clearTimeout(Ci),Ci=qe.setTimeout(()=>{Or=void 0,Ir=void 0},1e3)}}function $o(s){const e="history";zt(e,s),Yt(e,hd)}function hd(){if(!function(){const t=Us.chrome,r=t&&t.app&&t.app.runtime,a="history"in Us&&!!Us.history.pushState&&!!Us.history.replaceState;return!r&&a}())return;const s=qe.onpopstate;function e(t){return function(...r){const a=r.length>2?r[2]:void 0;if(a){const i=qs,l=String(a);qs=l,st("history",{from:i,to:l})}return t.apply(this,r)}}qe.onpopstate=function(...t){const r=qe.location.href,a=qs;if(qs=r,st("history",{from:a,to:r}),s)try{return s.apply(this,t)}catch{}},Ye(qe.history,"pushState",e),Ye(qe.history,"replaceState",e)}const Ys={};function Ei(s){Ys[s]=void 0}const ys="__sentry_xhr_v3__";function md(){if(!qe.XMLHttpRequest)return;const s=XMLHttpRequest.prototype;s.open=new Proxy(s.open,{apply(e,t,r){const a=new Error,i=1e3*vt(),l=ft(r[0])?r[0].toUpperCase():void 0,c=function(m){if(ft(m))return m;try{return m.toString()}catch{}}(r[1]);if(!l||!c)return e.apply(t,r);t[ys]={method:l,url:c,request_headers:{}},l==="POST"&&c.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const d=()=>{const m=t[ys];if(m&&t.readyState===4){try{m.status_code=t.status}catch{}st("xhr",{endTimestamp:1e3*vt(),startTimestamp:i,xhr:t,virtualError:a})}};return"onreadystatechange"in t&&typeof t.onreadystatechange=="function"?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply:(m,g,_)=>(d(),m.apply(g,_))}):t.addEventListener("readystatechange",d),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(m,g,_){const[T,N]=_,k=g[ys];return k&&ft(T)&&ft(N)&&(k.request_headers[T.toLowerCase()]=N),m.apply(g,_)}}),e.apply(t,r)}}),s.send=new Proxy(s.send,{apply(e,t,r){const a=t[ys];return a?(r[0]!==void 0&&(a.body=r[0]),st("xhr",{startTimestamp:1e3*vt(),xhr:t}),e.apply(t,r)):e.apply(t,r)}})}function pd(s,e=function(t){const r=Ys[t];if(r)return r;let a=qe[t];if(rn(a))return Ys[t]=a.bind(qe);const i=qe.document;if(i&&typeof i.createElement=="function")try{const l=i.createElement("iframe");l.hidden=!0,i.head.appendChild(l);const c=l.contentWindow;c&&c[t]&&(a=c[t]),i.head.removeChild(l)}catch(l){ud&&Z.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,l)}return a&&(Ys[t]=a.bind(qe))}("fetch")){let t=0,r=0;return Yu(s,function(a){const i=a.body.length;t+=i,r++;const l={body:a.body,method:"POST",referrerPolicy:"origin",headers:s.headers,keepalive:t<=6e4&&r<15,...s.fetchOptions};if(!e)return Ei("fetch"),or("No fetch implementation available");try{return e(s.url,l).then(c=>(t-=i,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return Ei("fetch"),t-=i,r--,or(c)}})}function Pr(s,e,t,r){const a={filename:s,function:e==="<anonymous>"?Ut:e,in_app:!0};return t!==void 0&&(a.lineno=t),r!==void 0&&(a.colno=r),a}const fd=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,gd=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,vd=/\((\S*)(?::(\d+))(?::(\d+))\)/,yd=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,bd=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,_d=function(...s){const e=s.sort((t,r)=>t[0]-r[0]).map(t=>t[1]);return(t,r=0,a=0)=>{const i=[],l=t.split(`
`);for(let c=r;c<l.length;c++){const d=l[c];if(d.length>1024)continue;const m=Ra.test(d)?d.replace(Ra,"$1"):d;if(!m.match(/\S*Error: /)){for(const g of e){const _=g(m);if(_){i.push(_);break}}if(i.length>=50+a)break}}return function(c){if(!c.length)return[];const d=Array.from(c);return/sentryWrapped/.test(Ls(d).function||"")&&d.pop(),d.reverse(),Fa.test(Ls(d).function||"")&&(d.pop(),Fa.test(Ls(d).function||"")&&d.pop()),d.slice(0,50).map(m=>({...m,filename:m.filename||Ls(d).filename,function:m.function||Ut}))}(i.slice(a))}}([30,s=>{const e=fd.exec(s);if(e){const[,r,a,i]=e;return Pr(r,Ut,+a,+i)}const t=gd.exec(s);if(t){if(t[2]&&t[2].indexOf("eval")===0){const i=vd.exec(t[2]);i&&(t[2]=i[1],t[3]=i[2],t[4]=i[3])}const[r,a]=Ti(t[1]||Ut,t[2]);return Pr(a,r,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],[50,s=>{const e=yd.exec(s);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const a=bd.exec(e[3]);a&&(e[1]=e[1]||"eval",e[3]=a[1],e[4]=a[2],e[5]="")}let t=e[3],r=e[1]||Ut;return[r,t]=Ti(r,t),Pr(t,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]),Ti=(s,e)=>{const t=s.indexOf("safari-extension")!==-1,r=s.indexOf("safari-web-extension")!==-1;return t||r?[s.indexOf("@")!==-1?s.split("@")[0]:Ut,t?`safari-extension:${e}`:`safari-web-extension:${e}`]:[s,e]},Ai=1024,xd=(s={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...s};return{name:"Breadcrumbs",setup(t){var r;e.console&&function(a){const i="console";zt(i,a),Yt(i,Zu)}(function(a){return function(i){if(Re()!==a)return;const l={category:"console",data:{arguments:i.args,logger:"console"},level:ed(i.level),message:$a(i.args," ")};if(i.level==="assert"){if(i.args[0]!==!1)return;l.message=`Assertion failed: ${$a(i.args.slice(1)," ")||"console.assert"}`,l.data.arguments=i.args.slice(1)}Rt(l,{input:i.args,level:i.level})}}(t)),e.dom&&(r=function(a,i){return function(l){if(Re()!==a)return;let c,d,m=typeof i=="object"?i.serializeAttribute:void 0,g=typeof i=="object"&&typeof i.maxStringLength=="number"?i.maxStringLength:void 0;g&&g>Ai&&(wr&&Z.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${g} was configured. Sentry will use 1024 instead.`),g=Ai),typeof m=="string"&&(m=[m]);try{const T=l.event,N=function(k){return!!k&&!!k.target}(T)?T.target:T;c=Io(N,{keyAttrs:m,maxStringLength:g}),d=function(k){if(!En.HTMLElement)return null;let y=k;for(let w=0;w<5;w++){if(!y)return null;if(y instanceof HTMLElement){if(y.dataset.sentryComponent)return y.dataset.sentryComponent;if(y.dataset.sentryElement)return y.dataset.sentryElement}y=y.parentNode}return null}(N)}catch{c="<unknown>"}if(c.length===0)return;const _={category:`ui.${l.name}`,message:c};d&&(_.data={"ui.component_name":d}),Rt(_,{event:l.event,name:l.name,global:l.global})}}(t,e.dom),zt("dom",r),Yt("dom",dd)),e.xhr&&function(a){zt("xhr",a),Yt("xhr",md)}(function(a){return function(i){if(Re()!==a)return;const{startTimestamp:l,endTimestamp:c}=i,d=i.xhr[ys];if(!l||!c||!d)return;const{method:m,url:g,status_code:_,body:T}=d,N={method:m,url:g,status_code:_},k={xhr:i.xhr,input:T,startTimestamp:l,endTimestamp:c};Rt({category:"xhr",data:N,type:"http",level:Si(_)},k)}}(t)),e.fetch&&rd(function(a){return function(i){if(Re()!==a)return;const{startTimestamp:l,endTimestamp:c}=i;if(c&&(!i.fetchData.url.match(/sentry_key/)||i.fetchData.method!=="POST"))if(i.error)Rt({category:"fetch",data:i.fetchData,level:"error",type:"http"},{data:i.error,input:i.args,startTimestamp:l,endTimestamp:c});else{const d=i.response,m={...i.fetchData,status_code:d&&d.status},g={input:i.args,response:d,startTimestamp:l,endTimestamp:c};Rt({category:"fetch",data:m,type:"http",level:Si(m.status_code)},g)}}}(t)),e.history&&$o(function(a){return function(i){if(Re()!==a)return;let l=i.from,c=i.to;const d=Tr(Ie.location.href);let m=l?Tr(l):void 0;const g=Tr(c);m&&m.path||(m=d),d.protocol===g.protocol&&d.host===g.host&&(c=g.relative),d.protocol===m.protocol&&d.host===m.host&&(l=m.relative),Rt({category:"navigation",data:{from:l,to:c}})}}(t)),e.sentry&&t.on("beforeSendEvent",function(a){return function(i){Re()===a&&Rt({category:"sentry."+(i.type==="transaction"?"transaction":"event"),event_id:i.event_id,level:i.level,message:Nt(i)},{event:i})}}(t))}}},wd=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Sd=(s={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...s};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&Ye(Ie,"setTimeout",Mi),e.setInterval&&Ye(Ie,"setInterval",Mi),e.requestAnimationFrame&&Ye(Ie,"requestAnimationFrame",jd),e.XMLHttpRequest&&"XMLHttpRequest"in Ie&&Ye(XMLHttpRequest.prototype,"send",kd);const t=e.eventTarget;t&&(Array.isArray(t)?t:wd).forEach(Cd)}}};function Mi(s){return function(...e){const t=e[0];return e[0]=ds(t,{mechanism:{data:{function:It(s)},handled:!1,type:"instrument"}}),s.apply(this,e)}}function jd(s){return function(e){return s.apply(this,[ds(e,{mechanism:{data:{function:"requestAnimationFrame",handler:It(s)},handled:!1,type:"instrument"}})])}}function kd(s){return function(...e){const t=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(r=>{r in t&&typeof t[r]=="function"&&Ye(t,r,function(a){const i={mechanism:{data:{function:r,handler:It(a)},handled:!1,type:"instrument"}},l=Tn(a);return l&&(i.mechanism.data.handler=It(l)),ds(a,i)})}),s.apply(this,e)}}function Cd(s){const e=Ie[s],t=e&&e.prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(Ye(t,"addEventListener",function(r){return function(a,i,l){try{typeof i.handleEvent=="function"&&(i.handleEvent=ds(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:It(i),target:s},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[a,ds(i,{mechanism:{data:{function:"addEventListener",handler:It(i),target:s},handled:!1,type:"instrument"}}),l])}}),Ye(t,"removeEventListener",function(r){return function(a,i,l){try{const c=i.__sentry_wrapped__;c&&r.call(this,a,c,l)}catch{}return r.call(this,a,i,l)}}))}const Nd=()=>({name:"BrowserSession",setupOnce(){Ie.document!==void 0?(oi({ignoreDuration:!0}),li(),$o(({from:s,to:e})=>{s!==void 0&&s!==e&&(oi({ignoreDuration:!0}),li())})):wr&&Z.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),Ed=(s={})=>{const e={onerror:!0,onunhandledrejection:!0,...s};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(t){e.onerror&&(function(r){(function(a){const i="error";zt(i,a),Yt(i,yu)})(a=>{const{stackParser:i,attachStacktrace:l}=Oi();if(Re()!==r||ki())return;const{msg:c,url:d,line:m,column:g,error:_}=a,T=function(N,k,y,w){const C=N.exception=N.exception||{},I=C.values=C.values||[],E=I[0]=I[0]||{},O=E.stacktrace=E.stacktrace||{},p=O.frames=O.frames||[],B=w,K=y,R=ft(k)&&k.length>0?k:function(){try{return En.document.location.href}catch{return""}}();return p.length===0&&p.push({colno:B,filename:R,function:Ut,in_app:!0,lineno:K}),N}(on(i,_||c,void 0,l,!1),d,m,g);T.level="error",ii(T,{originalException:_,mechanism:{handled:!1,type:"onerror"}})})}(t),Ii("onerror")),e.onunhandledrejection&&(function(r){(function(a){const i="unhandledrejection";zt(i,a),Yt(i,bu)})(a=>{const{stackParser:i,attachStacktrace:l}=Oi();if(Re()!==r||ki())return;const c=function(m){if(Wr(m))return m;try{if("reason"in m)return m.reason;if("detail"in m&&"reason"in m.detail)return m.detail.reason}catch{}return m}(a),d=Wr(c)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(c)}`}]}}:on(i,c,void 0,l,!0);d.level="error",ii(d,{originalException:c,mechanism:{handled:!1,type:"onunhandledrejection"}})})}(t),Ii("onunhandledrejection"))}}};function Ii(s){wr&&Z.log(`Global Handler attached: ${s}`)}function Oi(){const s=Re();return s&&s.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Td=()=>({name:"HttpContext",preprocessEvent(s){if(!Ie.navigator&&!Ie.location&&!Ie.document)return;const e=s.request&&s.request.url||Ie.location&&Ie.location.href,{referrer:t}=Ie.document||{},{userAgent:r}=Ie.navigator||{},a={...s.request&&s.request.headers,...t&&{Referer:t},...r&&{"User-Agent":r}},i={...s.request,...e&&{url:e},headers:a};s.request=i}}),Ad=(s={})=>{const e=s.limit||5,t=s.key||"cause";return{name:"LinkedErrors",preprocessEvent(r,a,i){const l=i.getOptions();Xu(Pn,l.stackParser,l.maxValueLength,t,e,r,a)}}};var cn="new",Pi="loading",Li="loaded",cr="joining-meeting",Tt="joined-meeting",Ct="left-meeting",dt="error",Md="blocked",Id="off",Od="sendable",Pd="loading",Ld="interrupted",Jo="playable",Ws="unknown",Go="full",Dd="lobby",Rd="none",zo="base",Fd="*",Vd="ejected",Ud="nbf-room",qd="nbf-token",Bd="exp-room",$d="exp-token",un="no-room",Jd="meeting-full",Yo="end-of-life",Gd="not-allowed",Wo="connection-error",zd="cam-in-use",Yd="mic-in-use",Wd="cam-mic-in-use",Hd="permissions",Kd="undefined-mediadevices",Qd="not-found",Xd="constraints",Zd="unknown",Ho="iframe-ready-for-launch-config",Ko="iframe-launch-config",Qo="theme-updated",Xo="loading",Zo="load-attempt-failed",dn="loaded",el="started-camera",tl="camera-error",sl="joining-meeting",rl="joined-meeting",nl="left-meeting",al="participant-joined",il="participant-updated",ol="participant-left",ll="participant-counts-updated",cl="access-state-updated",ul="meeting-session-summary-updated",dl="meeting-session-state-updated",eh="meeting-session-data-error",hl="waiting-participant-added",ml="waiting-participant-updated",pl="waiting-participant-removed",fl="track-started",gl="track-stopped",vl="transcription-started",yl="transcription-stopped",bl="transcription-error",hn="recording-started",mn="recording-stopped",_l="recording-stats",xl="recording-error",wl="recording-upload-completed",Sl="recording-data",jl="app-message",kl="transcription-message",Cl="remote-media-player-started",Nl="remote-media-player-updated",El="remote-media-player-stopped",Tl="local-screen-share-started",Al="local-screen-share-stopped",Ml="local-screen-share-canceled",Il="active-speaker-change",Ol="active-speaker-mode-change",Pl="network-quality-change",Ll="network-connection",Dl="cpu-load-change",Rl="face-counts-updated",bs="fullscreen",_s="exited-fullscreen",Fl="live-streaming-started",Vl="live-streaming-updated",Ul="live-streaming-stopped",ql="live-streaming-error",Bl="lang-updated",$l="receive-settings-updated",pn="input-settings-updated",fn="nonfatal-error",gn="error",Lr=4096,Di=102400,Dr="iframe-call-message",Ri="local-screen-start",Fi="daily-method-update-live-streaming-endpoints",Bs="transmit-log",gt="daily-custom-track",Hs={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},Jl={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},vn={PLAY:"play",PAUSE:"pause"},Rr=["jpg","png","jpeg"],th="add-endpoints",sh="remove-endpoints",Vi="sip-call-transfer";function Ze(){return!ce()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function ce(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function Gl(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function rh(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&(function(s,e){if(!s||!e)return!0;switch(s){case"Chrome":return e.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(e.major===13&&e.minor===0&&e.point===0);case"Firefox":return e.major>=67}return!0}(Xt(),ur())||ce())}function Ui(){if(ce()||!document)return!1;var s=document.createElement("iframe");return!!s.requestFullscreen||!!s.webkitRequestFullscreen}var yn="none",nh="software",ah="hardware",ih=function(){try{var s,e=document.createElement("canvas"),t=!1;(s=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(t=!0,s=e.getContext("webgl2"));var r=s!=null;return e.remove(),r?t?nh:ah:yn}catch{return yn}}();function zl(){var s=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!ce()&&ih!==yn&&(s?function(){return Bi()?!1:["Chrome","Firefox"].includes(Xt())}():function(){if(Bi())return!1;var e=Xt();if(e==="Safari"){var t=Rn();if(t.major<15||t.major===15&&t.minor<4)return!1}return e==="Chrome"?Dn().major>=77:e==="Firefox"?Fn().major>=97:["Chrome","Firefox","Safari"].includes(e)}())}function Yl(){if(ce()||Wl()||typeof AudioWorkletNode>"u")return!1;switch(Xt()){case"Chrome":case"Firefox":return!0;case"Safari":var s=ur();return s.major>17||s.major===17&&s.minor>=4}return!1}function qi(){return Gl()&&!function(){var s,e=Xt();if(!Ze())return!0;switch(e){case"Chrome":return(s=Dn()).major&&s.major>0&&s.major<75;case"Firefox":return(s=Fn()).major<91;case"Safari":return(s=Rn()).major<13||s.major===13&&s.minor<1;default:return!0}}()}function Wl(){return Ze().match(/Linux; Android/)}function Bi(){var s,e=Ze(),t=e.match(/Mac/)&&(!ce()&&typeof window<"u"&&(s=window)!==null&&s!==void 0&&(s=s.navigator)!==null&&s!==void 0&&s.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(e.match(/Mobi/)||e.match(/Android/)||t)||!!Ze().match(/DailyAnd\//)||void 0}function Xt(){if(typeof window<"u"){var s=Ze();return Hl()?"Safari":s.indexOf("Edge")>-1?"Edge":s.match(/Chrome\//)?"Chrome":s.indexOf("Safari")>-1||Kl()?"Safari":s.indexOf("Firefox")>-1?"Firefox":s.indexOf("MSIE")>-1||s.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function ur(){switch(Xt()){case"Chrome":return Dn();case"Safari":return Rn();case"Firefox":return Fn();case"Edge":return function(){var s=0,e=0;if(typeof window<"u"){var t=Ze().match(/Edge\/(\d+).(\d+)/);if(t)try{s=parseInt(t[1]),e=parseInt(t[2])}catch{}}return{major:s,minor:e}}()}}function Dn(){var s=0,e=0,t=0,r=0,a=!1;if(typeof window<"u"){var i=Ze(),l=i.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(l)try{s=parseInt(l[1]),e=parseInt(l[2]),t=parseInt(l[3]),r=parseInt(l[4]),a=i.indexOf("OPR/")>-1}catch{}}return{major:s,minor:e,build:t,patch:r,opera:a}}function Hl(){return!!Ze().match(/iPad|iPhone|iPod/i)&&Gl()}function Kl(){return Ze().indexOf("AppleWebKit/605.1.15")>-1}function Rn(){var s=0,e=0,t=0;if(typeof window<"u"){var r=Ze().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(r)try{s=parseInt(r[1]),e=parseInt(r[2]),t=parseInt(r[4])}catch{}else(Hl()||Kl())&&(s=14,e=0,t=3)}return{major:s,minor:e,point:t}}function Fn(){var s=0,e=0;if(typeof window<"u"){var t=Ze().match(/Firefox\/(\d+).(\d+)/);if(t)try{s=parseInt(t[1]),e=parseInt(t[2])}catch{}}return{major:s,minor:e}}var Ql=function(){return He(function s(){We(this,s)},[{key:"addListenerForMessagesFromCallMachine",value:function(s,e,t){fs()}},{key:"addListenerForMessagesFromDailyJs",value:function(s,e,t){fs()}},{key:"sendMessageToCallMachine",value:function(s,e,t,r){fs()}},{key:"sendMessageToDailyJs",value:function(s,e){fs()}},{key:"removeListener",value:function(s){fs()}}])}();function $i(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,r)}return t}function Fr(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$i(Object(t),!0).forEach(function(r){lt(s,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):$i(Object(t)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(t,r))})}return s}function Xl(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xl=function(){return!!s})()}var oh=function(){function s(){var e,t,r,a;return We(this,s),t=this,r=rt(r=s),(e=fr(t,Xl()?Reflect.construct(r,[],rt(t).constructor):r.apply(t,a)))._wrappedListeners={},e._messageCallbacks={},e}return gr(s,Ql),He(s,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,r){var a=this,i=function(l){if(l.data&&l.data.what==="iframe-call-message"&&(!l.data.callClientId||l.data.callClientId===t)&&(!l.data.from||l.data.from!=="module")){var c=Fr({},l.data);if(delete c.from,c.callbackStamp&&a._messageCallbacks[c.callbackStamp]){var d=c.callbackStamp;a._messageCallbacks[d].call(r,c),delete a._messageCallbacks[d]}delete c.what,delete c.callbackStamp,e.call(r,c)}};this._wrappedListeners[e]=i,window.addEventListener("message",i)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,r){var a=function(i){var l;if(!(!i.data||i.data.what!==Dr||!i.data.action||i.data.from&&i.data.from!=="module"||i.data.callClientId&&t&&i.data.callClientId!==t||i!=null&&(l=i.data)!==null&&l!==void 0&&l.callFrameId)){var c=i.data;e.call(r,c)}};this._wrappedListeners[e]=a,window.addEventListener("message",a)}},{key:"sendMessageToCallMachine",value:function(e,t,r,a){if(!r)throw new Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var i=Fr({},e);if(i.what=Dr,i.from="module",i.callClientId=r,t){var l=vr();this._messageCallbacks[l]=t,i.callbackStamp=l}var c=a?a.contentWindow:window,d=this._callMachineTargetOrigin(a);d&&c.postMessage(i,d)}},{key:"sendMessageToDailyJs",value:function(e,t){e.what=Dr,e.callClientId=t,e.from="embedded",window.postMessage(e,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,t,r){var a=Fr({},e);a.callClientId=r;var i=t?t.contentWindow:window,l=this._callMachineTargetOrigin(t);l&&i.postMessage(a,l)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,t){var r=function(a){if(a.data&&a.data.what==="iframe-call-message"&&(!a.data.callClientId||a.data.callClientId===t)&&(!a.data.from||a.data.from!=="module")){var i=a.data;e(i)}};return this._wrappedListeners[e]=r,window.addEventListener("message",r),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"_callMachineTargetOrigin",value:function(e){return e?e.src?new URL(e.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return window.location.protocol==="file:"?"*":window.location.origin}}])}();function Ji(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,r)}return t}function Zl(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zl=function(){return!!s})()}var lh=function(){function s(){var e,t,r,a;return We(this,s),t=this,r=rt(r=s),e=fr(t,Zl()?Reflect.construct(r,[],rt(t).constructor):r.apply(t,a)),globalThis.callMachineToDailyJsEmitter=globalThis.callMachineToDailyJsEmitter||new zr.EventEmitter,globalThis.dailyJsToCallMachineEmitter=globalThis.dailyJsToCallMachineEmitter||new zr.EventEmitter,e._wrappedListeners={},e._messageCallbacks={},e}return gr(s,Ql),He(s,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,r){this._addListener(e,globalThis.callMachineToDailyJsEmitter,t,r,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,r){this._addListener(e,globalThis.dailyJsToCallMachineEmitter,t,r,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(e,t,r){this._sendMessage(e,globalThis.dailyJsToCallMachineEmitter,r,t,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(e,t){this._sendMessage(e,globalThis.callMachineToDailyJsEmitter,t,null,"sending message to daily-js")}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(globalThis.callMachineToDailyJsEmitter.removeListener("message",t),globalThis.dailyJsToCallMachineEmitter.removeListener("message",t),delete this._wrappedListeners[e])}},{key:"_addListener",value:function(e,t,r,a,i){var l=this,c=function(d){if(d.callClientId===r){if(d.callbackStamp&&l._messageCallbacks[d.callbackStamp]){var m=d.callbackStamp;l._messageCallbacks[m].call(a,d),delete l._messageCallbacks[m]}e.call(a,d)}};this._wrappedListeners[e]=c,t.addListener("message",c)}},{key:"_sendMessage",value:function(e,t,r,a,i){var l=function(d){for(var m=1;m<arguments.length;m++){var g=arguments[m]!=null?arguments[m]:{};m%2?Ji(Object(g),!0).forEach(function(_){lt(d,_,g[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):Ji(Object(g)).forEach(function(_){Object.defineProperty(d,_,Object.getOwnPropertyDescriptor(g,_))})}return d}({},e);if(l.callClientId=r,a){var c=vr();this._messageCallbacks[c]=a,l.callbackStamp=c}t.emit("message",l)}}])}(),bn="replace",_n="shallow-merge",Gi=[bn,_n],ch=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.data,r=e.mergeStrategy,a=r===void 0?bn:r;We(this,s),s._validateMergeStrategy(a),s._validateData(t,a),this.mergeStrategy=a,this.data=t}return He(s,[{key:"isNoOp",value:function(){return s.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,t){return Object.keys(e).length===0&&t===_n}},{key:"_validateMergeStrategy",value:function(e){if(!Gi.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(Gi,"]"))}},{key:"_validateData",value:function(e,t){if(!function(c){if(c==null||de(c)!=="object")return!1;var d=Object.getPrototypeOf(c);return d==null||d===Object.prototype}(e))throw Error("Meeting session data must be a plain (map-like) object");var r;try{if(r=JSON.stringify(e),t===bn){var a=JSON.parse(r);Ue(a,e)||console.warn("The meeting session data provided will be modified when serialized.",a,e)}else if(t===_n){for(var i in e)if(Object.hasOwnProperty.call(e,i)&&e[i]!==void 0){var l=JSON.parse(JSON.stringify(e[i]));Ue(e[i],l)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",l,e[i])}}}catch(c){throw Error("Meeting session data must be serializable to JSON: ".concat(c))}if(r.length>Di)throw Error("Meeting session data is too large (".concat(r.length," characters). Maximum size suppported is ").concat(Di,"."))}}])}();function ec(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ec=function(){return!!s})()}function xn(s){var e=typeof Map=="function"?new Map:void 0;return xn=function(t){if(t===null||!function(a){try{return Function.toString.call(a).indexOf("[native code]")!==-1}catch{return typeof a=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(a,i,l){if(ec())return Reflect.construct.apply(null,arguments);var c=[null];c.push.apply(c,i);var d=new(a.bind.apply(a,c));return l&&Cs(d,l.prototype),d}(t,arguments,rt(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Cs(r,t)},xn(s)}function tc(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tc=function(){return!!s})()}function zi(s){var e,t=(e=window._daily)===null||e===void 0?void 0:e.pendings;if(t){var r=t.indexOf(s);r!==-1&&t.splice(r,1)}}var uh=function(){return He(function s(e){We(this,s),this._currentLoad=null,this._callClientId=e},[{key:"load",value:function(){var s,e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;if(this.loaded)return window._daily.instances[this._callClientId].callMachine.reset(),void r(!0);s=this._callClientId,window._daily.pendings.push(s),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new dh(t,function(){r(!1)},function(i,l){l||zi(e._callClientId),a(i,l)}),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),zi(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}])}(),dh=function(){return He(function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;We(this,s),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=e,this._successCallback=t,this._failureCallback=r},[{key:"start",value:function(){var s=this;if(!this._currentAttempt){var e=function(t){s._currentAttempt.cancelled||(s._attemptsRemaining--,s._failureCallback(t,s._attemptsRemaining>0),s._attemptsRemaining<=0||setTimeout(function(){s._currentAttempt.cancelled||(s._currentAttempt=new Yi(s._dailyConfig,s._successCallback,e),s._currentAttempt.start())},3e3))};this._currentAttempt=new Yi(this._dailyConfig,this._successCallback,e),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}])}(),Vr=function(){function s(){return We(this,s),e=this,r=arguments,t=rt(t=s),fr(e,tc()?Reflect.construct(t,r||[],rt(e).constructor):t.apply(e,r));var e,t,r}return gr(s,xn(Error)),He(s)}(),dr=2e4,Yi=function(){return He(function e(t,r,a){We(this,e),this._loadAttemptImpl=ce()||!t.avoidEval?new hh(t,r,a):new mh(t,r,a)},[{key:"start",value:(s=Q(function*(){return this._loadAttemptImpl.start()}),function(){return s.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]);var s}(),hh=function(){return He(function a(i,l,c){We(this,a),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=i,this._successCallback=l,this._failureCallback=c},[{key:"start",value:(r=Q(function*(){var a=rr(this._dailyConfig);!(yield this._tryLoadFromIOSCache(a))&&this._loadFromNetwork(a)}),function(){return r.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(t=Q(function*(a){if(!this._iosCache)return!1;try{var i=yield this._iosCache.get(a);return!!this.cancelled||!!i&&(i.code?(Function('"use strict";'+i.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=i.refetchHeaders,!1))}catch{return!1}}),function(a){return t.apply(this,arguments)})},{key:"_loadFromNetwork",value:(e=Q(function*(a){var i=this;this._networkTimeout=setTimeout(function(){i._networkTimedOut=!0,i._failureCallback({msg:"Timed out (>".concat(dr," ms) when loading call object bundle ").concat(a),type:"timeout"})},dr);try{var l=this._refetchHeaders?{headers:this._refetchHeaders}:{},c=yield fetch(a,l);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new Vr;var d=yield this._getBundleCodeFromResponse(a,c);if(this.cancelled)throw new Vr;Function('"use strict";'+d)(),this._iosCache&&this._iosCache.set(a,d,c.headers),this.succeeded=!0,this._successCallback()}catch(m){if(clearTimeout(this._networkTimeout),m instanceof Vr||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(a,": ").concat(m),type:m.message})}}),function(a){return e.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(s=Q(function*(a,i){if(i.ok)return yield i.text();if(this._iosCache&&i.status===304)return(yield this._iosCache.renew(a,i.headers)).code;throw new Error("Received ".concat(i.status," response"))}),function(a,i){return s.apply(this,arguments)})}]);var s,e,t,r}(),mh=function(){return He(function s(e,t,r){We(this,s),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=e,this._successCallback=t,this._failureCallback=r,this._attemptId=vr(),this._networkTimeout=null,this._scriptElement=null},[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var s=rr(this._dailyConfig);(typeof document>"u"?"undefined":de(document))==="object"?this._startLoading(s):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(s){var e=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){e._stopLoading(),e._failureCallback({msg:"Timed out (>".concat(dr," ms) when loading call object bundle ").concat(s),type:"timeout"})},dr);var t=document.getElementsByTagName("head")[0],r=document.createElement("script");this._scriptElement=r,r.onload=function(){e._stopLoading(),e.succeeded=!0,e._successCallback()},r.onerror=function(a){e._stopLoading(),e._failureCallback({msg:"Failed to load call object bundle ".concat(a.target.src),type:a.message})},r.src=s,t.appendChild(r)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}])}(),$s=function(s,e,t){return fh(s.local,e,t)===!0},ph=function(s,e,t){return s.local.streams&&s.local.streams[e]&&s.local.streams[e].stream&&s.local.streams[e].stream["get".concat(t==="video"?"Video":"Audio","Tracks")]()[0]},rs=function(s,e,t,r){var a=gh(s,e,t,r);return a&&a.pendingTrack},fh=function(s,e,t){if(!s)return!1;var r=function(i){switch(i){case"avatar":return!0;case"staged":return i;default:return!!i}},a=s.public.subscribedTracks;return a&&a[e]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(t)===-1&&a[e].custom?[!0,"staged"].includes(a[e].custom)?r(a[e].custom):r(a[e].custom[t]):r(a[e][t]):!a||r(a.ALL)},gh=function(s,e,t,r){var a=Object.values(s.streams||{}).filter(function(i){return i.participantId===e&&i.type===t&&i.pendingTrack&&i.pendingTrack.kind===r}).sort(function(i,l){return new Date(l.starttime)-new Date(i.starttime)});return a&&a[0]},vh=function(s,e){var t=s.local.public.customTracks;if(t&&t[e])return t[e].track};function Wi(s,e){for(var t=e.getState(),r=0,a=["cam","screen"];r<a.length;r++)for(var i=a[r],l=0,c=["video","audio"];l<c.length;l++){var d=c[l],m=i==="cam"?d:"screen".concat(d.charAt(0).toUpperCase()+d.slice(1)),g=s.tracks[m];if(g){var _=s.local?ph(t,i,d):rs(t,s.session_id,i,d);g.state==="playable"&&(g.track=_),g.persistentTrack=_}}}function Hi(s,e){try{var t=e.getState();for(var r in s.tracks)if(!yh(r)){var a=s.tracks[r].kind;if(a){var i=s.tracks[r];if(i){var l=s.local?vh(t,r):rs(t,s.session_id,r,a);i.state==="playable"&&(s.tracks[r].track=l),i.persistentTrack=l}}else console.error("unknown type for custom track")}}catch(c){console.error(c)}}function yh(s){return["video","audio","screenVideo","screenAudio"].includes(s)}function Ki(s,e,t){var r=t.getState();if(s.local){if(s.audio)try{s.audioTrack=r.local.streams.cam.stream.getAudioTracks()[0],s.audioTrack||(s.audio=!1)}catch{}if(s.video)try{s.videoTrack=r.local.streams.cam.stream.getVideoTracks()[0],s.videoTrack||(s.video=!1)}catch{}if(s.screen)try{s.screenVideoTrack=r.local.streams.screen.stream.getVideoTracks()[0],s.screenAudioTrack=r.local.streams.screen.stream.getAudioTracks()[0],s.screenVideoTrack||s.screenAudioTrack||(s.screen=!1)}catch{}}else{var a=!0;try{var i=r.participants[s.session_id];i&&i.public&&i.public.rtcType&&i.public.rtcType.impl==="peer-to-peer"&&i.private&&!["connected","completed"].includes(i.private.peeringState)&&(a=!1)}catch(g){console.error(g)}if(!a)return s.audio=!1,s.audioTrack=!1,s.video=!1,s.videoTrack=!1,s.screen=!1,void(s.screenTrack=!1);try{if(r.streams,s.audio&&$s(r,s.session_id,"cam-audio")){var l=rs(r,s.session_id,"cam","audio");l&&(e&&e.audioTrack&&e.audioTrack.id===l.id?s.audioTrack=l:l.muted||(s.audioTrack=l)),s.audioTrack||(s.audio=!1)}if(s.video&&$s(r,s.session_id,"cam-video")){var c=rs(r,s.session_id,"cam","video");c&&(e&&e.videoTrack&&e.videoTrack.id===c.id?s.videoTrack=c:c.muted||(s.videoTrack=c)),s.videoTrack||(s.video=!1)}if(s.screen&&$s(r,s.session_id,"screen-audio")){var d=rs(r,s.session_id,"screen","audio");d&&(e&&e.screenAudioTrack&&e.screenAudioTrack.id===d.id?s.screenAudioTrack=d:d.muted||(s.screenAudioTrack=d))}if(s.screen&&$s(r,s.session_id,"screen-video")){var m=rs(r,s.session_id,"screen","video");m&&(e&&e.screenVideoTrack&&e.screenVideoTrack.id===m.id?s.screenVideoTrack=m:m.muted||(s.screenVideoTrack=m))}s.screenVideoTrack||s.screenAudioTrack||(s.screen=!1)}catch(g){console.error("unexpected error matching up tracks",g)}}}function bh(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return Qi(d,m);var g={}.toString.call(d).slice(8,-1);return g==="Object"&&d.constructor&&(g=d.constructor.name),g==="Map"||g==="Set"?Array.from(d):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?Qi(d,m):void 0}}(s))||e){t&&(s=t);var r=0,a=function(){};return{s:a,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function Qi(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,r=Array(e);t<e;t++)r[t]=s[t];return r}var it=new Map,as=null;function _h(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return Xi(d,m);var g={}.toString.call(d).slice(8,-1);return g==="Object"&&d.constructor&&(g=d.constructor.name),g==="Map"||g==="Set"?Array.from(d):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?Xi(d,m):void 0}}(s))||e){t&&(s=t);var r=0,a=function(){};return{s:a,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function Xi(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,r=Array(e);t<e;t++)r[t]=s[t];return r}var ot=new Map,ws=null;function xh(s){sc()?function(e){it.has(e)||(it.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(t){it.has(e)&&(it.get(e).lastDevicesString=JSON.stringify(t),as||(as=function(){var r=Q(function*(){var a,i=yield navigator.mediaDevices.enumerateDevices(),l=bh(it.keys());try{for(l.s();!(a=l.n()).done;){var c=a.value,d=JSON.stringify(i);d!==it.get(c).lastDevicesString&&(it.get(c).lastDevicesString=d,c(i))}}catch(m){l.e(m)}finally{l.f()}});return function(){return r.apply(this,arguments)}}(),navigator.mediaDevices.addEventListener("devicechange",as)))}).catch(function(){}))}(s):function(e){ot.has(e)||(ot.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(t){ot.has(e)&&(ot.get(e).lastDevicesString=JSON.stringify(t),ws||(ws=setInterval(Q(function*(){var r,a=yield navigator.mediaDevices.enumerateDevices(),i=_h(ot.keys());try{for(i.s();!(r=i.n()).done;){var l=r.value,c=JSON.stringify(a);c!==ot.get(l).lastDevicesString&&(ot.get(l).lastDevicesString=c,l(a))}}catch(d){i.e(d)}finally{i.f()}}),3e3)))}))}(s)}function wh(s){sc()?function(e){it.has(e)&&(it.delete(e),it.size===0&&as&&(navigator.mediaDevices.removeEventListener("devicechange",as),as=null))}(s):function(e){ot.has(e)&&(ot.delete(e),ot.size===0&&ws&&(clearInterval(ws),ws=null))}(s)}function sc(){var s;return ce()||((s=navigator.mediaDevices)===null||s===void 0?void 0:s.ondevicechange)!==void 0}var Sh=new Set;function jh(s,e){return s&&s.readyState==="live"&&!function(t,r){return t.muted&&!Sh.has(t.id)}(s)}function Zi(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,r)}return t}function St(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Zi(Object(t),!0).forEach(function(r){lt(s,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Zi(Object(t)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(t,r))})}return s}var xs=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),kh=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),Ss=Object.values(xs),eo=["v","a","sv","sa","cv","ca"];Object.freeze(Ss.reduce(function(s,e,t){return s[e]=eo[t],s},{})),Object.freeze(eo.reduce(function(s,e,t){return s[e]=Ss[t],s},{}));var Ch=[xs.VIDEO,xs.AUDIO,xs.SCREEN_VIDEO,xs.SCREEN_AUDIO],to=Object.values(kh),so=["p","s","t"];Object.freeze(to.reduce(function(s,e,t){return s[e]=so[t],s},{})),Object.freeze(so.reduce(function(s,e,t){return s[e]=to[t],s},{}));var rc=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.base,r=e.byUserId,a=e.byParticipantId;We(this,s),this.base=t,this.byUserId=r,this.byParticipantId=a}return He(s,[{key:"clone",value:function(){var e=new s;if(this.base instanceof Pe?e.base=this.base.clone():e.base=this.base,this.byUserId!==void 0)for(var t in e.byUserId={},this.byUserId){var r=this.byUserId[t];e.byUserId[t]=r instanceof Pe?r.clone():r}if(this.byParticipantId!==void 0)for(var a in e.byParticipantId={},this.byParticipantId){var i=this.byParticipantId[a];e.byParticipantId[a]=i instanceof Pe?i.clone():i}return e}},{key:"toJSONObject",value:function(){var e={};if(typeof this.base=="boolean"?e.base=this.base:this.base instanceof Pe&&(e.base=this.base.toJSONObject()),this.byUserId!==void 0)for(var t in e.byUserId={},this.byUserId){var r=this.byUserId[t];e.byUserId[t]=r instanceof Pe?r.toJSONObject():r}if(this.byParticipantId!==void 0)for(var a in e.byParticipantId={},this.byParticipantId){var i=this.byParticipantId[a];e.byParticipantId[a]=i instanceof Pe?i.toJSONObject():i}return e}},{key:"toMinifiedJSONObject",value:function(){var e={};if(this.base!==void 0&&(typeof this.base=="boolean"?e.b=this.base:e.b=this.base.toMinifiedJSONObject()),this.byUserId!==void 0)for(var t in e.u={},this.byUserId){var r=this.byUserId[t];e.u[t]=typeof r=="boolean"?r:r.toMinifiedJSONObject()}if(this.byParticipantId!==void 0)for(var a in e.p={},this.byParticipantId){var i=this.byParticipantId[a];e.p[a]=typeof i=="boolean"?i:i.toMinifiedJSONObject()}return e}},{key:"normalize",value:function(){return this.base instanceof Pe&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map(function(e){var t=Fe(e,2),r=t[0],a=t[1];return[r,a instanceof Pe?a.normalize():a]}))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map(function(e){var t=Fe(e,2),r=t[0],a=t[1];return[r,a instanceof Pe?a.normalize():a]}))),this}}],[{key:"fromJSONObject",value:function(e){var t,r,a;if(e.base!==void 0&&(t=typeof e.base=="boolean"?e.base:Pe.fromJSONObject(e.base)),e.byUserId!==void 0)for(var i in r={},e.byUserId){var l=e.byUserId[i];r[i]=typeof l=="boolean"?l:Pe.fromJSONObject(l)}if(e.byParticipantId!==void 0)for(var c in a={},e.byParticipantId){var d=e.byParticipantId[c];a[c]=typeof d=="boolean"?d:Pe.fromJSONObject(d)}return new s({base:t,byUserId:r,byParticipantId:a})}},{key:"fromMinifiedJSONObject",value:function(e){var t,r,a;if(e.b!==void 0&&(t=typeof e.b=="boolean"?e.b:Pe.fromMinifiedJSONObject(e.b)),e.u!==void 0)for(var i in r={},e.u){var l=e.u[i];r[i]=typeof l=="boolean"?l:Pe.fromMinifiedJSONObject(l)}if(e.p!==void 0)for(var c in a={},e.p){var d=e.p[c];a[c]=typeof d=="boolean"?d:Pe.fromMinifiedJSONObject(d)}return new s({base:t,byUserId:r,byParticipantId:a})}},{key:"validateJSONObject",value:function(e){if(de(e)!=="object")return[!1,"canReceive must be an object"];for(var t=["base","byUserId","byParticipantId"],r=0,a=Object.keys(e);r<a.length;r++){var i=a[r];if(!t.includes(i))return[!1,"canReceive can only contain keys (".concat(t.join(", "),")")];if(i==="base"){var l=Fe(Pe.validateJSONObject(e.base,!0),2),c=l[0],d=l[1];if(!c)return[!1,d]}else{if(de(e[i])!=="object")return[!1,"invalid (non-object) value for field '".concat(i,"' in canReceive")];for(var m=0,g=Object.values(e[i]);m<g.length;m++){var _=g[m],T=Fe(Pe.validateJSONObject(_),2),N=T[0],k=T[1];if(!N)return[!1,k]}}}return[!0]}}])}(),Pe=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.video,r=e.audio,a=e.screenVideo,i=e.screenAudio,l=e.customVideo,c=e.customAudio;We(this,s),this.video=t,this.audio=r,this.screenVideo=a,this.screenAudio=i,this.customVideo=l,this.customAudio=c}return He(s,[{key:"clone",value:function(){var e=new s;return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=St({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=St({},this.customAudio)),e}},{key:"toJSONObject",value:function(){var e={};return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=St({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=St({},this.customAudio)),e}},{key:"toMinifiedJSONObject",value:function(){var e={};return this.video!==void 0&&(e.v=this.video),this.audio!==void 0&&(e.a=this.audio),this.screenVideo!==void 0&&(e.sv=this.screenVideo),this.screenAudio!==void 0&&(e.sa=this.screenAudio),this.customVideo!==void 0&&(e.cv=St({},this.customVideo)),this.customAudio!==void 0&&(e.ca=St({},this.customAudio)),e}},{key:"normalize",value:function(){function e(t,r){return t&&Object.keys(t).length===1&&t["*"]===r}return!(this.video!==!0||this.audio!==!0||this.screenVideo!==!0||this.screenAudio!==!0||!e(this.customVideo,!0)||!e(this.customAudio,!0))||(this.video!==!1||this.audio!==!1||this.screenVideo!==!1||this.screenAudio!==!1||!e(this.customVideo,!1)||!e(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(e){return new s({video:e,audio:e,screenVideo:e,screenAudio:e,customVideo:{"*":e},customAudio:{"*":e}})}},{key:"fromJSONObject",value:function(e){return new s({video:e.video,audio:e.audio,screenVideo:e.screenVideo,screenAudio:e.screenAudio,customVideo:e.customVideo!==void 0?St({},e.customVideo):void 0,customAudio:e.customAudio!==void 0?St({},e.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(e){return new s({video:e.v,audio:e.a,screenVideo:e.sv,screenAudio:e.sa,customVideo:e.cv,customAudio:e.ca})}},{key:"validateJSONObject",value:function(e,t){if(typeof e=="boolean")return[!0];if(de(e)!=="object")return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var r=Object.keys(e),a=0,i=r;a<i.length;a++){var l=i[a];if(!Ss.includes(l))return[!1,"invalid media type '".concat(l,"' in canReceive")];if(Ch.includes(l)){if(typeof e[l]!="boolean")return[!1,"invalid (non-boolean) value for media type '".concat(l,"' in canReceive")]}else{if(de(e[l])!=="object")return[!1,"invalid (non-object) value for media type '".concat(l,"' in canReceive")];for(var c=0,d=Object.values(e[l]);c<d.length;c++)if(typeof d[c]!="boolean")return[!1,"invalid (non-boolean) value for entry within '".concat(l,"' in canReceive")];if(t&&e[l]["*"]===void 0)return[!1,`canReceive "base" permission must specify "*" as an entry within '`.concat(l,"'")]}}return t&&r.length!==Ss.length?[!1,'canReceive "base" permission must specify all media types: '.concat(Ss.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])}(),Nh=["result"],Eh=["preserveIframe"];function ro(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,r)}return t}function G(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ro(Object(t),!0).forEach(function(r){lt(s,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):ro(Object(t)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(t,r))})}return s}function nc(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nc=function(){return!!s})()}function no(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return ao(d,m);var g={}.toString.call(d).slice(8,-1);return g==="Object"&&d.constructor&&(g=d.constructor.name),g==="Map"||g==="Set"?Array.from(d):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?ao(d,m):void 0}}(s))||e){t&&(s=t);var r=0,a=function(){};return{s:a,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function ao(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,r=Array(e);t<e;t++)r[t]=s[t];return r}var Ft={},io="video",Th="voice",oo=ce()?{data:{}}:{data:{},topology:"none"},lo={present:0,hidden:0},ac={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},Ur=Object.keys(ac),co=["state","volume","simulcastEncodings"],uo={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},hr={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},wn={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},Vt={customIntegrations:{validate:mc,help:dc()},customTrayButtons:{validate:hc,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(hr))},url:{validate:function(s){return typeof s=="string"},help:"url should be a string"},baseUrl:{validate:function(s){return typeof s=="string"},help:"baseUrl should be a string"},token:{validate:function(s){return typeof s=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(s,e){try{return e.validateDailyConfig(s),!0}catch(t){console.error("Failed to validate dailyConfig",t)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(s){return pc(s,uo)},help:"reactNativeConfig should look like ".concat(JSON.stringify(uo),", all fields optional")},lang:{validate:function(s){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(s)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(s){try{return ic(s),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(s,e){if(typeof s=="boolean")return e._preloadCache.allowLocalVideo=s,!0;var t;if(s instanceof MediaStreamTrack)e._sharedTracks.videoTrack=s,t={customTrack:gt};else{if(delete e._sharedTracks.videoTrack,typeof s!="string")return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;t={deviceId:s}}return e._updatePreloadCacheInputSettings({video:{settings:t}},!1),!0}},audioSource:{validate:function(s,e){if(typeof s=="boolean")return e._preloadCache.allowLocalAudio=s,!0;var t;if(s instanceof MediaStreamTrack)e._sharedTracks.audioTrack=s,t={customTrack:gt};else{if(delete e._sharedTracks.audioTrack,typeof s!="string")return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;t={deviceId:s}}return e._updatePreloadCacheInputSettings({audio:{settings:t}},!1),!0}},subscribeToTracksAutomatically:{validate:function(s,e){return e._preloadCache.subscribeToTracksAutomatically=s,!0}},theme:{validate:function(s){var e=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],t=function(r){for(var a=0,i=Object.keys(r);a<i.length;a++){var l=i[a];if(!e.includes(l))return console.error('unsupported color "'.concat(l,'". Valid colors: ').concat(e.join(", "))),!1;if(!r[l].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(l,' theme color should be provided in valid hex color format. Received: "').concat(r[l],'"')),!1}return!0};return de(s)==="object"&&("light"in s&&"dark"in s||"colors"in s)?"light"in s&&"dark"in s?"colors"in s.light?"colors"in s.dark?t(s.light.colors)&&t(s.dark.colors):(console.error('Dark theme is missing "colors" property.',s),!1):(console.error('Light theme is missing "colors" property.',s),!1):t(s.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',s),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(s){if("grid"in s){var e=s.grid;if("maxTilesPerPage"in e){if(!Number.isInteger(e.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(e.maxTilesPerPage,".")),!1;if(e.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in e){if(!Number.isInteger(e.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(e.minTilesPerPage,".")),!1;if(e.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in e&&e.minTilesPerPage>e.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(s){return oc(s,{allowAllParticipantsKey:!1})},help:uc({allowAllParticipantsKey:!1})},sendSettings:{validate:function(s,e){return!!function(t,r){try{return r.validateUpdateSendSettings(t),!0}catch(a){return console.error("Failed to validate send settings",a),!1}}(s,e)&&(e._preloadCache.sendSettings=s,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(s,e){var t;return!!lc(s)&&(e._inputSettings||(e._inputSettings={}),cc(s,(t=e.properties)===null||t===void 0?void 0:t.dailyConfig,e._sharedTracks),e._updatePreloadCacheInputSettings(s,!0),!0)},help:Sn()},layout:{validate:function(s){return s==="custom-v1"||s==="browser"||s==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},Js={styles:{validate:function(s){for(var e in s)if(e!=="cam"&&e!=="screen")return!1;if(s.cam){for(var t in s.cam)if(t!=="div"&&t!=="video")return!1}if(s.screen){for(var r in s.screen)if(r!=="div"&&r!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(s,e){if(e._preloadCache.subscribeToTracksAutomatically)return!1;var t=[!0,!1,"staged"];if(t.includes(s)||!ce()&&s==="avatar")return!0;var r=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],a=function(i){var l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var c in i)if(c==="custom"){if(!t.includes(i[c])&&!a(i[c],!0))return!1}else{var d=!l&&!r.includes(c),m=!t.includes(i[c]);if(d||m)return!1}return!0};return a(s)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(ce()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(s){return s===!1},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(s){for(var e=0,t=Object.entries(s);e<t.length;e++){var r=Fe(t[e],2),a=r[0],i=r[1];switch(a){case"hasPresence":if(typeof i!="boolean")return!1;break;case"canSend":if(i instanceof Set||i instanceof Array||Array.isArray(i)){var l,c=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],d=no(i);try{for(d.s();!(l=d.n()).done;){var m=l.value;if(!c.includes(m))return!1}}catch(C){d.e(C)}finally{d.f()}}else if(typeof i!="boolean")return!1;(i instanceof Array||Array.isArray(i))&&(s.canSend=new Set(i));break;case"canReceive":var g=Fe(rc.validateJSONObject(i),2),_=g[0],T=g[1];if(!_)return console.error(T),!1;break;case"canAdmin":if(i instanceof Set||i instanceof Array||Array.isArray(i)){var N,k=["participants","streaming","transcription"],y=no(i);try{for(y.s();!(N=y.n()).done;){var w=N.value;if(!k.includes(w))return!1}}catch(C){y.e(C)}finally{y.f()}}else if(typeof i!="boolean")return!1;(i instanceof Array||Array.isArray(i))&&(s.canAdmin=new Set(i));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};Promise.any||(Promise.any=function(){var s=Q(function*(e){return new Promise(function(t,r){var a=[];e.forEach(function(i){return Promise.resolve(i).then(function(l){t(l)}).catch(function(l){a.push(l),a.length===e.length&&r(a)})})})});return function(e){return s.apply(this,arguments)}}());var Ah=function(){function s(o){var h,u,f,v,x,M,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(We(this,s),f=this,v=rt(v=s),lt(u=fr(f,nc()?Reflect.construct(v,[],rt(f).constructor):v.apply(f,x)),"startListeningForDeviceChanges",function(){xh(u.handleDeviceChange)}),lt(u,"stopListeningForDeviceChanges",function(){wh(u.handleDeviceChange)}),lt(u,"handleDeviceChange",function(te){te=te.map(function(ne){return JSON.parse(JSON.stringify(ne))}),u.emitDailyJSEvent({action:"available-devices-updated",availableDevices:te})}),lt(u,"handleNativeAppStateChange",function(){var te=Q(function*(ne){if(ne==="destroyed")return console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),void(yield u.destroy());var Je=ne==="active";u.disableReactNativeAutoDeviceManagement("video")||(Je?u.camUnmutedBeforeLosingNativeActiveState&&u.setLocalVideo(!0):(u.camUnmutedBeforeLosingNativeActiveState=u.localVideo(),u.camUnmutedBeforeLosingNativeActiveState&&u.setLocalVideo(!1)))});return function(ne){return te.apply(this,arguments)}}()),lt(u,"handleNativeAudioFocusChange",function(te){u.disableReactNativeAutoDeviceManagement("audio")||(u._hasNativeAudioFocus=te,u.toggleParticipantAudioBasedOnNativeAudioFocus(),u._hasNativeAudioFocus?u.micUnmutedBeforeLosingNativeAudioFocus&&u.setLocalAudio(!0):(u.micUnmutedBeforeLosingNativeAudioFocus=u.localAudio(),u.setLocalAudio(!1)))}),lt(u,"handleNativeSystemScreenCaptureStop",function(){u.stopScreenShare()}),u.strictMode=L.strictMode===void 0||L.strictMode,u.allowMultipleCallInstances=(h=L.allowMultipleCallInstances)!==null&&h!==void 0&&h,Object.keys(Ft).length&&(u._logDuplicateInstanceAttempt(),!u.allowMultipleCallInstances)){if(u.strictMode)throw new Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),u.callClientId=vr(),Ft[(M=u).callClientId]=M,window._daily.instances[u.callClientId]={},u._sharedTracks={},window._daily.instances[u.callClientId].tracks=u._sharedTracks,L.dailyJsVersion=s.version(),u._iframe=o,u._callObjectMode=L.layout==="none"&&!u._iframe,u._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},L.showLocalVideo!==void 0?u._callObjectMode?console.error("showLocalVideo is not available in call object mode"):u._showLocalVideo=!!L.showLocalVideo:u._showLocalVideo=!0,L.showParticipantsBar!==void 0?u._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):u._showParticipantsBar=!!L.showParticipantsBar:u._showParticipantsBar=!0,L.customIntegrations!==void 0?u._callObjectMode?console.error("customIntegrations is not available in call object mode"):u._customIntegrations=L.customIntegrations:u._customIntegrations={},L.customTrayButtons!==void 0?u._callObjectMode?console.error("customTrayButtons is not available in call object mode"):u._customTrayButtons=L.customTrayButtons:u._customTrayButtons={},L.activeSpeakerMode!==void 0?u._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):u._activeSpeakerMode=!!L.activeSpeakerMode:u._activeSpeakerMode=!1,L.receiveSettings?u._callObjectMode?u._receiveSettings=L.receiveSettings:console.error("receiveSettings is only available in call object mode"):u._receiveSettings={},u.validateProperties(L),u.properties=G({},L),u._inputSettings||(u._inputSettings={}),u._callObjectLoader=u._callObjectMode?new uh(u.callClientId):null,u._callState=cn,u._isPreparingToJoin=!1,u._accessState={access:Ws},u._meetingSessionSummary={},u._finalSummaryOfPrevSession={},u._meetingSessionState=$r(oo,u._callObjectMode),u._nativeInCallAudioMode=io,u._participants={},u._isScreenSharing=!1,u._participantCounts=lo,u._rmpPlayerState={},u._waitingParticipants={},u._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},u._activeSpeaker={},u._localAudioLevel=0,u._isLocalAudioLevelObserverRunning=!1,u._remoteParticipantsAudioLevel={},u._isRemoteParticipantsAudioLevelObserverRunning=!1,u._maxAppMessageSize=Lr,u._messageChannel=ce()?new lh:new oh,u._iframe&&(u._iframe.requestFullscreen?u._iframe.addEventListener("fullscreenchange",function(){document.fullscreenElement===u._iframe?(u.emitDailyJSEvent({action:bs}),u.sendMessageToCallMachine({action:bs})):(u.emitDailyJSEvent({action:_s}),u.sendMessageToCallMachine({action:_s}))}):u._iframe.webkitRequestFullscreen&&u._iframe.addEventListener("webkitfullscreenchange",function(){document.webkitFullscreenElement===u._iframe?(u.emitDailyJSEvent({action:bs}),u.sendMessageToCallMachine({action:bs})):(u.emitDailyJSEvent({action:_s}),u.sendMessageToCallMachine({action:_s}))})),ce()){var V=u.nativeUtils();V.addAudioFocusChangeListener&&V.removeAudioFocusChangeListener&&V.addAppStateChangeListener&&V.removeAppStateChangeListener&&V.addSystemScreenCaptureStopListener&&V.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),u._hasNativeAudioFocus=!0,V.addAudioFocusChangeListener(u.handleNativeAudioFocusChange),V.addAppStateChangeListener(u.handleNativeAppStateChange),V.addSystemScreenCaptureStopListener(u.handleNativeSystemScreenCaptureStop)}return u._callObjectMode&&u.startListeningForDeviceChanges(),u._messageChannel.addListenerForMessagesFromCallMachine(u.handleMessageFromCallMachine,u.callClientId,u),u}return gr(s,Ps),He(s,[{key:"destroy",value:(Ee=Q(function*(){var o;try{yield this.leave()}catch{}var h=this._iframe;if(h){var u=h.parentElement;u&&u.removeChild(h)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),ce()){var f=this.nativeUtils();f.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),f.removeAppStateChangeListener(this.handleNativeAppStateChange),f.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete Ft[this.callClientId],!((o=window)===null||o===void 0||(o=o._daily)===null||o===void 0)&&o.instances&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)}),function(){return Ee.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(o){var h=o.bodyClass,u=o.cssFile,f=o.cssText;return ie(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(u),bodyClass:h,cssText:f}),this}},{key:"iframe",value:function(){return ie(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return et(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return et(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(o,h){for(var u in h){if(!Js[u])throw new Error("unrecognized updateParticipant property ".concat(u));if(Js[u].validate&&!Js[u].validate(h[u],this,this._participants[o]))throw new Error(Js[u].help)}}},{key:"updateParticipant",value:function(o,h){return this._participants.local&&this._participants.local.session_id===o&&(o="local"),o&&h&&(this.validateParticipantProperties(o,h),this.sendMessageToCallMachine({action:"update-participant",id:o,properties:h})),this}},{key:"updateParticipants",value:function(o){var h=this._participants.local&&this._participants.local.session_id;for(var u in o)u===h&&(u="local"),u&&o[u]&&this.validateParticipantProperties(u,o[u]);return this.sendMessageToCallMachine({action:"update-participants",participants:o}),this}},{key:"updateWaitingParticipant",value:(b=Q(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(et(this._callObjectMode,"updateWaitingParticipant()"),ve(this._callState,"updateWaitingParticipant()"),typeof h!="string"||de(u)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(f,v){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:h,updates:u},function(x){x.error&&v(x.error),x.id||v(new Error("unknown error in updateWaitingParticipant()")),f({id:x.id})})})}),function(){return b.apply(this,arguments)})},{key:"updateWaitingParticipants",value:($e=Q(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(et(this._callObjectMode,"updateWaitingParticipants()"),ve(this._callState,"updateWaitingParticipants()"),de(h)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(u,f){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:h},function(v){v.error&&f(v.error),v.ids||f(new Error("unknown error in updateWaitingParticipants()")),u({ids:v.ids})})})}),function(){return $e.apply(this,arguments)})},{key:"requestAccess",value:(ut=Q(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=h.access,f=u===void 0?{level:Go}:u,v=h.name,x=v===void 0?"":v;return et(this._callObjectMode,"requestAccess()"),ve(this._callState,"requestAccess()"),new Promise(function(M,L){o.sendMessageToCallMachine({action:"daily-method-request-access",access:f,name:x},function(V){V.error&&L(V.error),V.access||L(new Error("unknown error in requestAccess()")),M({access:V.access,granted:V.granted})})})}),function(){return ut.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"forceDiscardTrack"in h&&(ce()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),h={}):o&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),h={})),this.sendMessageToCallMachine({action:"local-audio",state:o,options:h}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(o){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:o}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(o){return this.sendMessageToCallMachine({action:"local-video",state:o}),this}},{key:"_setAllowLocalAudio",value:function(o){if(this._preloadCache.allowLocalAudio=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:o}),this}},{key:"_setAllowLocalVideo",value:function(o){if(this._preloadCache.allowLocalVideo=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:o}),this}},{key:"getReceiveSettings",value:(Pt=Q(function*(o){var h=this,u=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,f=u!==void 0&&u;if(et(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(de(o)){case"string":return new Promise(function(v){h.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:o,showInheritedValues:f},function(x){v(x.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}}),function(o){return Pt.apply(this,arguments)})},{key:"updateReceiveSettings",value:(W=Q(function*(o){var h=this;if(et(this._callObjectMode,"updateReceiveSettings()"),!oc(o,{allowAllParticipantsKey:!0}))throw new Error(uc({allowAllParticipantsKey:!0}));return ve(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise(function(u){h.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:o},function(f){u({receiveSettings:f.receiveSettings})})})}),function(o){return W.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(o,h){if(o){var u={};if(o.audio){var f,v,x;o.audio.settings&&(!Object.keys(o.audio.settings).length&&h||(u.audio={settings:G({},o.audio.settings)})),h&&(f=u.audio)!==null&&f!==void 0&&(f=f.settings)!==null&&f!==void 0&&f.customTrack&&(u.audio.settings={customTrack:this._sharedTracks.audioTrack});var M=((v=o.audio.processor)===null||v===void 0?void 0:v.type)==="none"&&((x=o.audio.processor)===null||x===void 0?void 0:x._isDefaultWhenNone);if(o.audio.processor&&!M){var L=G({},o.audio.processor);delete L._isDefaultWhenNone,u.audio=G(G({},u.audio),{},{processor:L})}}if(o.video){var V,te,ne;o.video.settings&&(!Object.keys(o.video.settings).length&&h||(u.video={settings:G({},o.video.settings)})),h&&(V=u.video)!==null&&V!==void 0&&(V=V.settings)!==null&&V!==void 0&&V.customTrack&&(u.video.settings={customTrack:this._sharedTracks.videoTrack});var Je=((te=o.video.processor)===null||te===void 0?void 0:te.type)==="none"&&((ne=o.video.processor)===null||ne===void 0?void 0:ne._isDefaultWhenNone);if(o.video.processor&&!Je){var nt=G({},o.video.processor);delete nt._isDefaultWhenNone,u.video=G(G({},u.video),{},{processor:nt})}}return u}}},{key:"getInputSettings",value:function(){var o=this;return ie(),new Promise(function(h){h(o._getInputSettings())})}},{key:"_getInputSettings",value:function(){var o,h,u,f,v,x,M={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(o=((u=this._inputSettings)===null||u===void 0?void 0:u.video)||M,h=((f=this._inputSettings)===null||f===void 0?void 0:f.audio)||M):(o=((v=this._preloadCache)===null||v===void 0||(v=v.inputSettings)===null||v===void 0?void 0:v.video)||M,h=((x=this._preloadCache)===null||x===void 0||(x=x.inputSettings)===null||x===void 0?void 0:x.audio)||M);var L={audio:h,video:o};return this._prepInputSettingsForSharing(L,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(o,h){var u=this._inputSettings||{},f={};if(o.video){var v,x,M;f.video={},o.video.settings?(f.video.settings={},h||o.video.settings.customTrack||(M=u.video)===null||M===void 0||!M.settings?f.video.settings=o.video.settings:f.video.settings=G(G({},u.video.settings),o.video.settings),Object.keys(f.video.settings).length||delete f.video.settings):(v=u.video)!==null&&v!==void 0&&v.settings&&(f.video.settings=u.video.settings),o.video.processor?f.video.processor=o.video.processor:(x=u.video)!==null&&x!==void 0&&x.processor&&(f.video.processor=u.video.processor)}else u.video&&(f.video=u.video);if(o.audio){var L,V,te;f.audio={},o.audio.settings?(f.audio.settings={},h||o.audio.settings.customTrack||(te=u.audio)===null||te===void 0||!te.settings?f.audio.settings=o.audio.settings:f.audio.settings=G(G({},u.audio.settings),o.audio.settings),Object.keys(f.audio.settings).length||delete f.audio.settings):(L=u.audio)!==null&&L!==void 0&&L.settings&&(f.audio.settings=u.audio.settings),o.audio.processor?f.audio.processor=o.audio.processor:(V=u.audio)!==null&&V!==void 0&&V.processor&&(f.audio.processor=u.audio.processor)}else u.audio&&(f.audio=u.audio);this._maybeUpdateInputSettings(f)}},{key:"_devicesFromInputSettings",value:function(o){var h,u,f=(o==null||(h=o.video)===null||h===void 0||(h=h.settings)===null||h===void 0?void 0:h.deviceId)||null,v=(o==null||(u=o.audio)===null||u===void 0||(u=u.settings)===null||u===void 0?void 0:u.deviceId)||null,x=this._preloadCache.outputDeviceId||null;return{camera:f?{deviceId:f}:{},mic:v?{deviceId:v}:{},speaker:x?{deviceId:x}:{}}}},{key:"updateInputSettings",value:(Te=Q(function*(o){var h=this;return ie(),lc(o)?o.video||o.audio?(cc(o,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(o,!0),this._getInputSettings()):new Promise(function(u,f){h.sendMessageToCallMachine({action:"update-input-settings",inputSettings:o},function(v){if(v.error)f(v.error);else{if(v.returnPreloadCache)return h._updatePreloadCacheInputSettings(o,!0),void u(h._getInputSettings());h._maybeUpdateInputSettings(v.inputSettings),u(h._prepInputSettingsForSharing(v.inputSettings,!0))}})})):this._getInputSettings():(console.error(Sn()),Promise.reject(Sn()))}),function(o){return Te.apply(this,arguments)})},{key:"setBandwidth",value:function(o){var h=o.kbs,u=o.trackConstraints;if(ie(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:h,trackConstraints:u}),this}},{key:"getDailyLang",value:function(){var o=this;if(ie(),this._callMachineInitialized)return new Promise(function(h){o.sendMessageToCallMachine({action:"get-daily-lang"},function(u){delete u.action,delete u.callbackStamp,h(u)})})}},{key:"setDailyLang",value:function(o){return ie(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:o}),this}},{key:"setProxyUrl",value:function(o){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:o}),this}},{key:"setIceConfig",value:function(o){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:o}),this}},{key:"meetingSessionSummary",value:function(){return[Ct,dt].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(ae=Q(function*(){var o=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),ve(this._callState,"getMeetingSession()"),new Promise(function(h){o.sendMessageToCallMachine({action:"get-meeting-session"},function(u){delete u.action,delete u.callbackStamp,h(u)})})}),function(){return ae.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return ve(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"replace";et(this._callObjectMode,"setMeetingSessionData()"),ve(this._callState,"setMeetingSessionData");try{(function(u,f){new ch({data:u,mergeStrategy:f})})(o,h)}catch(u){throw console.error(u),u}try{this.sendMessageToCallMachine({action:"set-session-data",data:o,mergeStrategy:h})}catch(u){throw new Error("Error setting meeting session data: ".concat(u))}}},{key:"setUserName",value:function(o,h){var u=this;return this.properties.userName=o,new Promise(function(f){u.sendMessageToCallMachine({action:"set-user-name",name:o??"",thisMeetingOnly:ce()||!!h&&!!h.thisMeetingOnly},function(v){delete v.action,delete v.callbackStamp,f(v)})})}},{key:"setUserData",value:(D=Q(function*(o){var h=this;try{ic(o)}catch(u){throw console.error(u),u}if(this.properties.userData=o,this._callMachineInitialized)return new Promise(function(u){try{h.sendMessageToCallMachine({action:"set-user-data",userData:o},function(f){delete f.action,delete f.callbackStamp,u(f)})}catch(f){throw new Error("Error setting user data: ".concat(f))}})}),function(o){return D.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(o){if(o&&(o<100||typeof o!="number"))throw new Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(o){var h=this;if(typeof AudioWorkletNode>"u"&&!ce())throw new Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise(function(u,f){h.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:o},function(v){h._isLocalAudioLevelObserverRunning=!v.error,v.error?f({error:v.error}):u()})});this._preloadCache.localAudioLevelObserver={enabled:!0,interval:o}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(o){var h=this;if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise(function(u,f){h.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:o},function(v){h._isRemoteParticipantsAudioLevelObserverRunning=!v.error,v.error?f({error:v.error}):u()})});this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:o}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(F=Q(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(et(this._callObjectMode,"startCamera()"),qr(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(h)}catch(u){return Promise.reject(u)}else{if(this._didPreAuth){if(h.url&&h.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(h.token&&h.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(h),this.properties=G(G({},this.properties),h)}return new Promise(function(u){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"start-camera",properties:ss(o.properties,o.callClientId),preloadCache:ss(o._preloadCache,o.callClientId)},function(f){u({camera:f.camera,mic:f.mic,speaker:f.speaker})})})}),function(){return F.apply(this,arguments)})},{key:"validateCustomTrack",value:function(o,h,u){if(u&&u.length>50)throw new Error("Custom track `trackName` must not be more than 50 characters");if(h&&h!=="music"&&h!=="speech"&&!(h instanceof Object))throw new Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(u&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(u))throw new Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(o instanceof MediaStreamTrack))throw new Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{track,mode,trackName};return ie(),ve(this._callState,"startCustomTrack()"),this.validateCustomTrack(h.track,h.mode,h.trackName),new Promise(function(u,f){o._sharedTracks.customTrack=h.track,h.track=gt,o.sendMessageToCallMachine({action:"start-custom-track",properties:h},function(v){v.error?f({error:v.error}):u(v.mediaTag)})})}},{key:"stopCustomTrack",value:function(o){var h=this;return ie(),ve(this._callState,"stopCustomTrack()"),new Promise(function(u){h.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:o},function(f){u(f.mediaTag)})})}},{key:"setCamera",value:function(o){var h=this;return gs(),Gs(this._callMachineInitialized,"setCamera()"),new Promise(function(u){h.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:o},function(f){u({device:f.device})})})}},{key:"setAudioDevice",value:(j=Q(function*(o){return gs(),this.nativeUtils().setAudioDevice(o),{deviceId:yield this.nativeUtils().getAudioDevice()}}),function(o){return j.apply(this,arguments)})},{key:"cycleCamera",value:function(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(u){o.sendMessageToCallMachine({action:"cycle-camera",properties:h},function(f){u({device:f.device})})})}},{key:"cycleMic",value:function(){var o=this;return ie(),new Promise(function(h){o.sendMessageToCallMachine({action:"cycle-mic"},function(u){h({device:u.device})})})}},{key:"getCameraFacingMode",value:function(){var o=this;return gs(),new Promise(function(h){o.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(u){h(u.facingMode)})})}},{key:"setInputDevicesAsync",value:(z=Q(function*(o){var h=this,u=o.audioDeviceId,f=o.videoDeviceId,v=o.audioSource,x=o.videoSource;if(ie(),v!==void 0&&(u=v),x!==void 0&&(f=x),typeof u=="boolean"&&(this._setAllowLocalAudio(u),u=void 0),typeof f=="boolean"&&(this._setAllowLocalVideo(f),f=void 0),!u&&!f)return yield this.getInputDevices();var M={};return u&&(u instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=u,u=gt,M.audio={settings:{customTrack:u}}):(delete this._sharedTracks.audioTrack,M.audio={settings:{deviceId:u}})),f&&(f instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=f,f=gt,M.video={settings:{customTrack:f}}):(delete this._sharedTracks.videoTrack,M.video={settings:{deviceId:f}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(M,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise(function(L){h.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:u,videoDeviceId:f},function(V){if(delete V.action,delete V.callbackStamp,V.returnPreloadCache)return h._updatePreloadCacheInputSettings(M,!1),void L(h._devicesFromInputSettings(h._inputSettings));L(V)})})}),function(o){return z.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(A=Q(function*(o){var h=this,u=o.outputDeviceId;return ie(),u&&(this._preloadCache.outputDeviceId=u),this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(f){h.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:u},function(v){delete v.action,delete v.callbackStamp,v.returnPreloadCache?f(h._devicesFromInputSettings(h._inputSettings)):f(v)})})}),function(o){return A.apply(this,arguments)})},{key:"getInputDevices",value:(he=Q(function*(){var o=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(h){o.sendMessageToCallMachine({action:"get-input-devices"},function(u){u.returnPreloadCache?h(o._devicesFromInputSettings(o._inputSettings)):h({camera:u.camera,mic:u.mic,speaker:u.speaker})})})}),function(){return he.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return gs(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(o){if(gs(),[io,Th].includes(o)){if(o!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=o,!this.disableReactNativeAutoDeviceManagement("audio")&&Ks(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",o)}},{key:"preAuth",value:(R=Q(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(et(this._callObjectMode,"preAuth()"),qr(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(h)),!h.url)throw new Error("preAuth() requires at least a url to be provided");return this.validateProperties(h),this.properties=G(G({},this.properties),h),new Promise(function(u,f){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"daily-method-preauth",properties:ss(o.properties,o.callClientId),preloadCache:ss(o._preloadCache,o.callClientId)},function(v){return v.error?f(v.error):v.access?(o._didPreAuth=!0,void u({access:v.access})):f(new Error("unknown error in preAuth()"))})})}),function(){return R.apply(this,arguments)})},{key:"load",value:(K=Q(function*(o){var h=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");if(o&&(this.validateProperties(o),this.properties=G(G({},this.properties),o)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");return this._updateCallState(Pi),this.emitDailyJSEvent({action:Xo}),this._callObjectMode?new Promise(function(u,f){h._callObjectLoader.cancel();var v=Date.now();h._callObjectLoader.load(h.properties.dailyConfig,function(x){h._bundleLoadTime=x?"no-op":Date.now()-v,h._updateCallState(Li),x&&h.emitDailyJSEvent({action:dn}),u()},function(x,M){if(h.emitDailyJSEvent({action:Zo}),!M){h._updateCallState(dt),h.resetMeetingDependentVars();var L={action:gn,errorMsg:x.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:x,bundleUrl:rr(h.properties.dailyConfig)}}};h._maybeSendToSentry(L),h.emitDailyJSEvent(L),f(x.msg)}})}):(this._iframe.src=Eo(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise(function(u,f){h._loadedCallback=function(v){h._callState!==dt?(h._updateCallState(Li),(h.properties.cssFile||h.properties.cssText)&&h.loadCss(h.properties),u()):f(v)}}))}}),function(o){return K.apply(this,arguments)})},{key:"join",value:(B=Q(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._testCallInProgress&&this.stopTestCallQuality();var u=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(h)}catch(f){return this.updateIsPreparingToJoin(!1),Promise.reject(f)}}else{if(u=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(h.url&&h.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(h.token&&h.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(h.url&&!this._callObjectMode&&h.url&&h.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(h.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(h),this.properties=G(G({},this.properties),h)}return h.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!h.showLocalVideo),h.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!h.showParticipantsBar),this._callState===Tt||this._callState===cr?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(cr,!1),this.emitDailyJSEvent({action:sl}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:ss(this.properties,this.callClientId),preloadCache:ss(this._preloadCache,this.callClientId)}),new Promise(function(f,v){o._joinedCallback=function(x,M){if(o._callState!==dt){if(o._updateCallState(Tt),x)for(var L in x){if(o._callObjectMode){var V=o._callMachine().store;Wi(x[L],V),Hi(x[L],V),Ki(x[L],o._participants[L],V)}o._participants[L]=G({},x[L]),o.toggleParticipantAudioBasedOnNativeAudioFocus()}u&&o.loadCss(o.properties),f(x)}else v(M)}}))}),function(){return B.apply(this,arguments)})},{key:"leave",value:(p=Q(function*(){var o=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise(function(h){o._callState===Ct||o._callState===dt?h():o._callObjectLoader&&!o._callObjectLoader.loaded?(o._callObjectLoader.cancel(),o._updateCallState(Ct),o.resetMeetingDependentVars(),o.emitDailyJSEvent({action:Ct}),h()):(o._resolveLeave=h,o.sendMessageToCallMachine({action:"leave-meeting"}))})}),function(){return p.apply(this,arguments)})},{key:"startScreenShare",value:(O=Q(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Gs(this._callMachineInitialized,"startScreenShare()"),h.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",h.screenVideoSendSettings),h.mediaStream&&(this._sharedTracks.screenMediaStream=h.mediaStream,h.mediaStream=gt),typeof DailyNativeUtils<"u"&&DailyNativeUtils.isIOS!==void 0&&DailyNativeUtils.isIOS){var u=this.nativeUtils();if(yield u.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:fn,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});u.setSystemScreenCaptureStartCallback(function(){u.setSystemScreenCaptureStartCallback(null),o.sendMessageToCallMachine({action:Ri,captureOptions:h})}),u.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:Ri,captureOptions:h})}),function(){return O.apply(this,arguments)})},{key:"stopScreenShare",value:function(){Gs(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=o.type;if(h&&h!=="cloud"&&h!=="raw-tracks"&&h!=="local")throw new Error("invalid type: ".concat(h,", allowed values 'cloud', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(G({action:"local-recording-start"},o))}},{key:"updateRecording",value:function(o){var h=o.layout,u=h===void 0?{preset:"default"}:h,f=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:u,instanceId:f})}},{key:"stopRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(G({action:"local-recording-stop"},o))}},{key:"startLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(G({action:"daily-method-start-live-streaming"},o))}},{key:"updateLiveStreaming",value:function(o){var h=o.layout,u=h===void 0?{preset:"default"}:h,f=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:u,instanceId:f})}},{key:"addLiveStreamingEndpoints",value:function(o){var h=o.endpoints,u=o.instanceId;this.sendMessageToCallMachine({action:Fi,endpointsOp:th,endpoints:h,instanceId:u})}},{key:"removeLiveStreamingEndpoints",value:function(o){var h=o.endpoints,u=o.instanceId;this.sendMessageToCallMachine({action:Fi,endpointsOp:sh,endpoints:h,instanceId:u})}},{key:"stopLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(G({action:"daily-method-stop-live-streaming"},o))}},{key:"validateDailyConfig",value:function(o){o.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(o.camSimulcastEncodings)),o.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),Wl()&&o.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,u=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(o){if(!(o instanceof Array||Array.isArray(o)))throw new Error("encodings must be an Array");if(!fo(o.length,1,3))throw new Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var f=0;f<o.length;f++){var v=o[f];for(var x in this._validateEncodingLayerHasValidProperties(v),v)if(Ur.includes(x)){if(typeof v[x]!="number")throw new Error("".concat(x," must be a number"));if(h){var M=h[x],L=M.min,V=M.max;if(!fo(v[x],L,V))throw new Error("".concat(x," value not in range. valid range: ").concat(L," to ").concat(V))}}else if(!["active","scalabilityMode"].includes(x))throw new Error("Invalid key ".concat(x,", valid keys are:")+Object.values(Ur));if(u&&!v.hasOwnProperty("maxBitrate"))throw new Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(E=Q(function*(o){var h=this,u=o.url,f=o.settings,v=f===void 0?{state:vn.PLAY}:f;try{(function(x){if(typeof x!="string")throw new Error('url parameter must be "string" type')})(u),po(v),function(x){for(var M in x)if(!co.includes(M))throw new Error("Invalid key ".concat(M,", valid keys are: ").concat(co));x.simulcastEncodings&&this.validateSimulcastEncodings(x.simulcastEncodings,ac,!0)}(v)}catch(x){throw console.error("invalid argument Error: ".concat(x)),console.error(`startRemoteMediaPlayer arguments must be of the form:
  { url: "playback url",
  settings?:
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),x}return new Promise(function(x,M){h.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:u,settings:v},function(L){L.error?M({error:L.error,errorMsg:L.errorMsg}):x({session_id:L.session_id,remoteMediaPlayerState:{state:L.state,settings:L.settings}})})})}),function(o){return E.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(I=Q(function*(o){var h=this;if(typeof o!="string")throw new Error(" remotePlayerID must be of type string");return new Promise(function(u,f){h.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:o},function(v){v.error?f({error:v.error,errorMsg:v.errorMsg}):u()})})}),function(o){return I.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(C=Q(function*(o){var h=this,u=o.session_id,f=o.settings;try{po(f)}catch(v){throw console.error("invalid argument Error: ".concat(v)),console.error(`updateRemoteMediaPlayer arguments must be of the form:
  session_id: "participant session",
  { settings?: {state: "play"|"pause"} }`),v}return new Promise(function(v,x){h.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:u,settings:f},function(M){M.error?x({error:M.error,errorMsg:M.errorMsg}):v({session_id:M.session_id,remoteMediaPlayerState:{state:M.state,settings:M.settings}})})})}),function(o){return C.apply(this,arguments)})},{key:"startTranscription",value:function(o){ve(this._callState,"startTranscription()"),this.sendMessageToCallMachine(G({action:"daily-method-start-transcription"},o))}},{key:"updateTranscription",value:function(o){if(ve(this._callState,"updateTranscription()"),!o)throw new Error("updateTranscription Error: options is mandatory");if(de(o)!=="object")throw new Error("updateTranscription Error: options must be object type");if(o.participants&&!Array.isArray(o.participants))throw new Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(G({action:"daily-method-update-transcription"},o))}},{key:"stopTranscription",value:function(o){if(ve(this._callState,"stopTranscription()"),o&&de(o)!=="object")throw new Error("stopTranscription Error: options must be object type");if(o&&!o.instanceId)throw new Error('"instanceId" not provided');this.sendMessageToCallMachine(G({action:"daily-method-stop-transcription"},o))}},{key:"startDialOut",value:(w=Q(function*(o){var h=this;ve(this._callState,"startDialOut()");var u=function(M){if(M){if(!Array.isArray(M))throw new Error("Error starting dial out: audio codec must be an array");if(M.length<=0)throw new Error("Error starting dial out: audio codec array specified but empty");M.forEach(function(L){if(typeof L!="string")throw new Error("Error starting dial out: audio codec must be a string");if(L!=="OPUS"&&L!=="PCMU"&&L!=="PCMA"&&L!=="G722")throw new Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")})}};if(!o.sipUri&&!o.phoneNumber)throw new Error("Error starting dial out: either a sip uri or phone number must be provided");if(o.sipUri&&o.phoneNumber)throw new Error("Error starting dial out: only one of sip uri or phone number must be provided");if(o.sipUri){if(typeof o.sipUri!="string")throw new Error("Error starting dial out: sipUri must be a string");if(!o.sipUri.startsWith("sip:"))throw new Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(o.video&&typeof o.video!="boolean")throw new Error("Error starting dial out: video must be a boolean value");(function(M){if(M&&(u(M.audio),M.video)){if(!Array.isArray(M.video))throw new Error("Error starting dial out: video codec must be an array");if(M.video.length<=0)throw new Error("Error starting dial out: video codec array specified but empty");M.video.forEach(function(L){if(typeof L!="string")throw new Error("Error starting dial out: video codec must be a string");if(L!=="H264"&&L!=="VP8")throw new Error("Error starting dial out: video codec must be H264 or VP8")})}})(o.codecs)}if(o.phoneNumber){if(typeof o.phoneNumber!="string")throw new Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(o.phoneNumber))throw new Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");o.codecs&&u(o.codecs.audio)}if(o.callerId){if(typeof o.callerId!="string")throw new Error("Error starting dial out: callerId must be a string");if(o.sipUri)throw new Error("Error starting dial out: callerId not allowed with sipUri")}if(o.displayName){if(typeof o.displayName!="string")throw new Error("Error starting dial out: displayName must be a string");if(o.displayName.length>=200)throw new Error("Error starting dial out: displayName length must be less than 200")}if(o.userId){if(typeof o.userId!="string")throw new Error("Error starting dial out: userId must be a string");if(o.userId.length>36)throw new Error("Error starting dial out: userId length must be less than or equal to 36")}if(o.permissions&&o.permissions.canReceive){var f=Fe(rc.validateJSONObject(o.permissions.canReceive),2),v=f[0],x=f[1];if(!v)throw new Error(x)}return new Promise(function(M,L){h.sendMessageToCallMachine(G({action:"dialout-start"},o),function(V){V.error?L(V.error):M(V)})})}),function(o){return w.apply(this,arguments)})},{key:"stopDialOut",value:function(o){var h=this;return ve(this._callState,"stopDialOut()"),new Promise(function(u,f){h.sendMessageToCallMachine(G({action:"dialout-stop"},o),function(v){v.error?f(v.error):u(v)})})}},{key:"sipCallTransfer",value:(y=Q(function*(o){var h=this;if(ve(this._callState,"sipCallTransfer()"),!o)throw new Error("sipCallTransfer() requires a sessionId and toEndPoint");return o.useSipRefer=!1,mo(o,"sipCallTransfer"),new Promise(function(u,f){h.sendMessageToCallMachine(G({action:Vi},o),function(v){v.error?f(v.error):u(v)})})}),function(o){return y.apply(this,arguments)})},{key:"sipRefer",value:(k=Q(function*(o){var h=this;if(ve(this._callState,"sipRefer()"),!o)throw new Error("sessionId and toEndPoint are mandatory parameter");return o.useSipRefer=!0,mo(o,"sipRefer"),new Promise(function(u,f){h.sendMessageToCallMachine(G({action:Vi},o),function(v){v.error?f(v.error):u(v)})})}),function(o){return k.apply(this,arguments)})},{key:"sendDTMF",value:(N=Q(function*(o){var h=this;return ve(this._callState,"sendDTMF()"),function(u){var f=u.sessionId,v=u.tones;if(!f||!v)throw new Error("sessionId and tones are mandatory parameter");if(typeof f!="string"||typeof v!="string")throw new Error("sessionId and tones should be of string type");if(v.length>20)throw new Error("tones string must be upto 20 characters");var x=/[^0-9A-D*#]/g,M=v.match(x);if(M&&M[0])throw new Error("".concat(M[0]," is not valid DTMF tone"))}(o),new Promise(function(u,f){h.sendMessageToCallMachine(G({action:"send-dtmf"},o),function(v){v.error?f(v.error):u(v)})})}),function(o){return N.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var o=this;return this._callState!==Tt?Promise.resolve(G({stats:{latest:{}}},this._network)):new Promise(function(h){o.sendMessageToCallMachine({action:"get-calc-stats"},function(u){h(G(G({},o._network),{},{stats:u.stats}))})})}},{key:"testWebsocketConnectivity",value:(T=Q(function*(){var o=this;if(Br(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(h){return Promise.reject(h)}return new Promise(function(h,u){o.sendMessageToCallMachine({action:"test-websocket-connectivity"},function(f){f.error?u(f.error):h(f.results)})})}),function(){return T.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(o){return o?o instanceof MediaStreamTrack?!!jh(o)||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(_=Q(function*(){var o=this;ie(),et(this._callObjectMode,"testCallQuality()"),Gs(this._callMachineInitialized,"testCallQuality()",null,!0),qr(this._callState,this._isPreparingToJoin,"testCallQuality()");var h=this._testCallAlreadyInProgress,u=function(v){h||(o._testCallInProgress=v)};if(u(!0),this.needsLoad())try{var f=this._callState;yield this.load(),this._callState=f}catch(v){return u(!1),Promise.reject(v)}return new Promise(function(v){o.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:o.properties.dailyJsVersion},function(x){var M=x.results,L=M.result,V=Ta(M,Nh);if(L==="failed"){var te,ne=G({},V);(te=V.error)!==null&&te!==void 0&&te.details?(V.error.details=JSON.parse(V.error.details),ne.error=G(G({},ne.error),{},{details:G({},ne.error.details)}),ne.error.details.duringTest="testCallQuality"):(ne.error=ne.error?G({},ne.error):{},ne.error.details={duringTest:"testCallQuality"}),o._maybeSendToSentry(ne)}u(!1),v(G({result:L},V))})})}),function(){return _.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(g=Q(function*(o){var h;ce()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),h=yield this.testPeerToPeerCallQuality(o)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),h=yield this.testCallQuality());var u={result:h.result,secondsElapsed:h.secondsElapsed};return h.data&&(u.data={maxRTT:h.data.maxRoundTripTime,packetLoss:h.data.avgRecvPacketLoss}),u}),function(o){return g.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(m=Q(function*(o){var h=this;if(Br(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(v){return Promise.reject(v)}var u=o.videoTrack,f=o.duration;if(!this._validateVideoTrackForNetworkTests(u))throw new Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=u,new Promise(function(v,x){h.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:f},function(M){M.error?x(M.error):v(M.results)})})}),function(o){return m.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){ce()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(d=Q(function*(o){var h=this;if(Br(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(u){return Promise.reject(u)}if(!this._validateVideoTrackForNetworkTests(o))throw new Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=o,new Promise(function(u,f){h.sendMessageToCallMachine({action:"test-network-connectivity"},function(v){v.error?f(v.error):u(v.results)})})}),function(o){return d.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var o=this;return new Promise(function(h){o._callState===Tt?o.sendMessageToCallMachine({action:"get-cpu-load-stats"},function(u){h(u.cpuStats)}):h({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})})}},{key:"_validateEncodingLayerHasValidProperties",value:function(o){var h;if(!(((h=Object.keys(o))===null||h===void 0?void 0:h.length)>0))throw new Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(Ur))}},{key:"_validateVideoSendSettings",value:function(o,h){var u=o==="screenVideo"?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],f="Video send settings should be either an object or one of the supported presets: ".concat(u.join());if(typeof h=="string"){if(!u.includes(h))throw new Error(f)}else{if(de(h)!=="object")throw new Error(f);if(!h.maxQuality&&!h.encodings&&h.allowAdaptiveLayers===void 0)throw new Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(h.maxQuality&&["low","medium","high"].indexOf(h.maxQuality)===-1)throw new Error("maxQuality must be either low, medium or high");if(h.encodings){var v=!1;switch(Object.keys(h.encodings).length){case 1:v=!h.encodings.low;break;case 2:v=!h.encodings.low||!h.encodings.medium;break;case 3:v=!h.encodings.low||!h.encodings.medium||!h.encodings.high;break;default:v=!0}if(v)throw new Error("Encodings must be defined as: low, low and medium, or low, medium and high.");h.encodings.low&&this._validateEncodingLayerHasValidProperties(h.encodings.low),h.encodings.medium&&this._validateEncodingLayerHasValidProperties(h.encodings.medium),h.encodings.high&&this._validateEncodingLayerHasValidProperties(h.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(o){var h=this;if(!o||Object.keys(o).length===0)throw new Error("Send settings must contain at least information for one track!");Object.entries(o).forEach(function(u){var f=Fe(u,2),v=f[0],x=f[1];h._validateVideoSendSettings(v,x)})}},{key:"updateSendSettings",value:function(o){var h=this;return this.validateUpdateSendSettings(o),this.needsLoad()?(this._preloadCache.sendSettings=o,{sendSettings:this._preloadCache.sendSettings}):new Promise(function(u,f){h.sendMessageToCallMachine({action:"update-send-settings",sendSettings:o},function(v){v.error?f(v.error):u(v.sendSettings)})})}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return ie(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(o){return ie(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:o}),this}},{key:"activeSpeakerMode",value:function(){return ie(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(o){return ve(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=o,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:o}),this}},{key:"enumerateDevices",value:(c=Q(function*(){var o=this;if(this._callObjectMode){var h=yield navigator.mediaDevices.enumerateDevices();return Xt()==="Firefox"&&ur().major>115&&ur().major<123&&(h=h.filter(function(u){return u.kind!=="audiooutput"})),{devices:h.map(function(u){var f=JSON.parse(JSON.stringify(u));if(!ce()&&u.kind==="videoinput"&&u.getCapabilities){var v,x=u.getCapabilities();f.facing=(x==null||(v=x.facingMode)===null||v===void 0?void 0:v.length)>=1?x.facingMode[0]:void 0}return f})}}return new Promise(function(u){o.sendMessageToCallMachine({action:"enumerate-devices"},function(f){u({devices:f.devices})})})}),function(){return c.apply(this,arguments)})},{key:"sendAppMessage",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(ve(this._callState,"sendAppMessage()"),JSON.stringify(o).length>this._maxAppMessageSize)throw new Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:o,to:h}),this}},{key:"addFakeParticipant",value:function(o){return ie(),ve(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(G({action:"add-fake-participant"},o)),this}},{key:"setShowNamesMode",value:function(o){return Ge(this._callObjectMode,"setShowNamesMode()"),ie(),o&&o!=="always"&&o!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:o}),this)}},{key:"setShowLocalVideo",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return Ge(this._callObjectMode,"setShowLocalVideo()"),ie(),ve(this._callState,"setShowLocalVideo()"),typeof o!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:o}),this._showLocalVideo=o,this)}},{key:"showLocalVideo",value:function(){return Ge(this._callObjectMode,"showLocalVideo()"),ie(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return Ge(this._callObjectMode,"setShowParticipantsBar()"),ie(),ve(this._callState,"setShowParticipantsBar()"),typeof o!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:o}),this._showParticipantsBar=o,this)}},{key:"showParticipantsBar",value:function(){return Ge(this._callObjectMode,"showParticipantsBar()"),ie(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return ie(),Ge(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(o){return ie(),Ge(this._callObjectMode,"setCustomIntegrations()"),ve(this._callState,"setCustomIntegrations()"),mc(o)?(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:o}),this._customIntegrations=o,this):this}},{key:"startCustomIntegrations",value:function(o){var h=this;if(ie(),Ge(this._callObjectMode,"startCustomIntegrations()"),ve(this._callState,"startCustomIntegrations()"),Array.isArray(o)&&o.some(function(v){return typeof v!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("startCustomIntegrations() only accepts string | string[]"),this;var u=typeof o=="string"?[o]:o,f=u.filter(function(v){return!(v in h._customIntegrations)});return f.length?(console.error(`Can't find custom integration(s): "`.concat(f.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"start-custom-integrations",ids:u}),this)}},{key:"stopCustomIntegrations",value:function(o){var h=this;if(ie(),Ge(this._callObjectMode,"stopCustomIntegrations()"),ve(this._callState,"stopCustomIntegrations()"),Array.isArray(o)&&o.some(function(v){return typeof v!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var u=typeof o=="string"?[o]:o,f=u.filter(function(v){return!(v in h._customIntegrations)});return f.length?(console.error(`Can't find custom integration(s): "`.concat(f.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:u}),this)}},{key:"customTrayButtons",value:function(){return Ge(this._callObjectMode,"customTrayButtons()"),ie(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(o){return Ge(this._callObjectMode,"updateCustomTrayButtons()"),ie(),ve(this._callState,"updateCustomTrayButtons()"),hc(o)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:o}),this._customTrayButtons=o,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(hr))),this)}},{key:"theme",value:function(){return Ge(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(o){var h=this;return Ge(this._callObjectMode,"setTheme()"),new Promise(function(u,f){try{h.validateProperties({theme:o}),h.properties.theme=G({},o),h.sendMessageToCallMachine({action:"set-theme",theme:h.properties.theme});try{h.emitDailyJSEvent({action:Qo,theme:h.properties.theme})}catch(v){console.log("could not emit 'theme-updated'",v)}u(h.properties.theme)}catch(v){f(v)}})}},{key:"requestFullscreen",value:(l=Q(function*(){if(ie(),this._iframe&&!document.fullscreenElement&&Ui())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(o){console.log("could not make video call fullscreen",o)}}),function(){return l.apply(this,arguments)})},{key:"exitFullscreen",value:function(){ie(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(i=Q(function*(){var o=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise(function(h){o.sendMessageToCallMachine({action:"get-sidebar-view"},function(u){h(u.view)})})}),function(){return i.apply(this,arguments)})},{key:"setSidebarView",value:function(o){return this._callObjectMode?(console.error("setSidebarView is not available in callObject mode"),this):(this.sendMessageToCallMachine({action:"set-sidebar-view",view:o}),this)}},{key:"room",value:(a=Q(function*(){var o=this,h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,u=h===void 0||h;return this._accessState.access===Ws||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(f){o.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:u},function(v){delete v.action,delete v.callbackStamp,f(v)})})}),function(){return a.apply(this,arguments)})},{key:"geo",value:(r=Q(function*(){try{var o=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield o.json()).geo}}catch(h){return console.error("geo lookup failed",h),{current:""}}}),function(){return r.apply(this,arguments)})},{key:"setNetworkTopology",value:(t=Q(function*(o){var h=this;return ie(),ve(this._callState,"setNetworkTopology()"),new Promise(function(u,f){h.sendMessageToCallMachine({action:"set-network-topology",opts:o},function(v){v.error?f({error:v.error}):u({workerId:v.workerId})})})}),function(o){return t.apply(this,arguments)})},{key:"getNetworkTopology",value:(e=Q(function*(){var o=this;return new Promise(function(h,u){o.needsLoad()&&h({topology:"none"}),o.sendMessageToCallMachine({action:"get-network-topology"},function(f){f.error?u({error:f.error}):h({topology:f.topology})})})}),function(){return e.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(o){if(ie(),typeof o!="number"&&o!==!0&&o!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(o));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:o})}},{key:"on",value:function(o,h){return Ps.prototype.on.call(this,o,h)}},{key:"once",value:function(o,h){return Ps.prototype.once.call(this,o,h)}},{key:"off",value:function(o,h){return Ps.prototype.off.call(this,o,h)}},{key:"validateProperties",value:function(o){var h,u;if(o!=null&&(h=o.dailyConfig)!==null&&h!==void 0&&h.userMediaAudioConstraints){var f,v;ce()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var x=o.inputSettings||{};x.audio=((f=o.inputSettings)===null||f===void 0?void 0:f.audio)||{},x.audio.settings=((v=o.inputSettings)===null||v===void 0||(v=v.audio)===null||v===void 0?void 0:v.settings)||{},x.audio.settings=G(G({},x.audio.settings),o.dailyConfig.userMediaAudioConstraints),o.inputSettings=x,delete o.dailyConfig.userMediaAudioConstraints}if(o!=null&&(u=o.dailyConfig)!==null&&u!==void 0&&u.userMediaVideoConstraints){var M,L;ce()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var V=o.inputSettings||{};V.video=((M=o.inputSettings)===null||M===void 0?void 0:M.video)||{},V.video.settings=((L=o.inputSettings)===null||L===void 0||(L=L.video)===null||L===void 0?void 0:L.settings)||{},V.video.settings=G(G({},V.video.settings),o.dailyConfig.userMediaVideoConstraints),o.inputSettings=V,delete o.dailyConfig.userMediaVideoConstraints}for(var te in o){if(!Vt[te])throw new Error("unrecognized property '".concat(te,"'"));if(Vt[te].validate&&!Vt[te].validate(o[te],this))throw new Error("property '".concat(te,"': ").concat(Vt[te].help))}}},{key:"assembleMeetingUrl",value:function(){var o,h,u=G(G({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:(o=this.properties.dailyConfig)!==null&&o!==void 0&&o.proxyUrl?encodeURIComponent((h=this.properties.dailyConfig)===null||h===void 0?void 0:h.proxyUrl):void 0}),f=u.url.match(/\?/)?"&":"?";return u.url+f+Object.keys(Vt).filter(function(v){return Vt[v].queryString&&u[v]!==void 0}).map(function(v){return"".concat(Vt[v].queryString,"=").concat(u[v])}).join("&")}},{key:"needsLoad",value:function(){return[cn,Pi,Ct,dt].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(o,h){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(o,h,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(o){this._messageChannel.forwardPackagedMessageToCallMachine(o,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(o){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(o,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(o){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(o)}},{key:"handleMessageFromCallMachine",value:function(o){switch(o.action){case Ho:this.sendMessageToCallMachine(G({action:Ko},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var h={action:Bs,level:"log",code:1011,stats:{event:"bundle load",time:this._bundleLoadTime==="no-op"?0:this._bundleLoadTime,preLoaded:this._bundleLoadTime==="no-op",url:rr(this.properties.dailyConfig)}};this.sendMessageToCallMachine(h),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case dn:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(o);break;case rl:var u,f=G({},o);delete f.internal,this._maxAppMessageSize=((u=o.internal)===null||u===void 0?void 0:u._maxAppMessageSize)||Lr,this._joinedCallback&&(this._joinedCallback(o.participants),this._joinedCallback=null),this.emitDailyJSEvent(f);break;case al:case il:if(this._callState===Ct)return;if(o.participant&&o.participant.session_id){var v=o.participant.local?"local":o.participant.session_id;if(this._callObjectMode){var x=this._callMachine().store;Wi(o.participant,x),Hi(o.participant,x),Ki(o.participant,this._participants[v],x)}try{this.maybeParticipantTracksStopped(this._participants[v],o.participant),this.maybeParticipantTracksStarted(this._participants[v],o.participant),this.maybeEventRecordingStopped(this._participants[v],o.participant),this.maybeEventRecordingStarted(this._participants[v],o.participant)}catch(J){console.error("track events error",J)}this.compareEqualForParticipantUpdateEvent(o.participant,this._participants[v])||(this._participants[v]=G({},o.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(o))}break;case ol:if(o.participant&&o.participant.session_id){var M=this._participants[o.participant.session_id];M&&this.maybeParticipantTracksStopped(M,null),delete this._participants[o.participant.session_id],this.emitDailyJSEvent(o)}break;case ll:Ue(this._participantCounts,o.participantCounts)||(this._participantCounts=o.participantCounts,this.emitDailyJSEvent(o));break;case cl:var L={access:o.access};o.awaitingAccess&&(L.awaitingAccess=o.awaitingAccess),Ue(this._accessState,L)||(this._accessState=L,this.emitDailyJSEvent(o));break;case ul:if(o.meetingSession){this._meetingSessionSummary=o.meetingSession,this.emitDailyJSEvent(o);var V=G(G({},o),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(V)}break;case gn:var te;this._iframe&&!o.preserveIframe&&(this._iframe.src=""),this._updateCallState(dt),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(o.errorMsg),this._loadedCallback=null),o.preserveIframe;var ne=Ta(o,Eh);ne!=null&&(te=ne.error)!==null&&te!==void 0&&te.details&&(ne.error.details=JSON.parse(ne.error.details)),this._maybeSendToSentry(o),this._joinedCallback&&(this._joinedCallback(null,ne),this._joinedCallback=null),this.emitDailyJSEvent(ne);break;case nl:this._callState!==dt&&this._updateCallState(Ct),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(o);break;case"selected-devices-updated":o.devices&&this.emitDailyJSEvent(o);break;case Pl:var Je=o.state,nt=o.threshold,yt=o.quality,ke=Je.state,Be=Je.reasons;ke===this._network.networkState&&Ue(Be,this._network.networkStateReasons)&&nt===this._network.threshold&&yt===this._network.quality||(this._network.networkState=ke,this._network.networkStateReasons=Be,this._network.quality=yt,this._network.threshold=nt,o.networkState=ke,Be.length&&(o.networkStateReasons=Be),delete o.state,this.emitDailyJSEvent(o));break;case Dl:o&&o.cpuLoadState&&this.emitDailyJSEvent(o);break;case Rl:o&&o.faceCounts!==void 0&&this.emitDailyJSEvent(o);break;case Il:var at=o.activeSpeaker;this._activeSpeaker.peerId!==at.peerId&&(this._activeSpeaker.peerId=at.peerId,this.emitDailyJSEvent({action:o.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var bt=o.show;this._showLocalVideo=bt,this.emitDailyJSEvent({action:o.action,show:bt});break;case Ol:var Lt=o.enabled;this._activeSpeakerMode!==Lt&&(this._activeSpeakerMode=Lt,this.emitDailyJSEvent({action:o.action,enabled:this._activeSpeakerMode}));break;case hl:case ml:case pl:this._waitingParticipants=o.allWaitingParticipants,this.emitDailyJSEvent({action:o.action,participant:o.participant});break;case $l:Ue(this._receiveSettings,o.receiveSettings)||(this._receiveSettings=o.receiveSettings,this.emitDailyJSEvent({action:o.action,receiveSettings:o.receiveSettings}));break;case pn:this._maybeUpdateInputSettings(o.inputSettings);break;case"send-settings-updated":Ue(this._sendSettings,o.sendSettings)||(this._sendSettings=o.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:o.action,sendSettings:o.sendSettings}));break;case"local-audio-level":this._localAudioLevel=o.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=o.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case Cl:var _t=o.session_id;this._rmpPlayerState[_t]=o.playerState,this.emitDailyJSEvent(o);break;case El:delete this._rmpPlayerState[o.session_id],this.emitDailyJSEvent(o);break;case Nl:var S=o.session_id,U=this._rmpPlayerState[S];U&&this.compareEqualForRMPUpdateEvent(U,o.remoteMediaPlayerState)||(this._rmpPlayerState[S]=o.remoteMediaPlayerState,this.emitDailyJSEvent(o));break;case"custom-button-click":case"sidebar-view-changed":this.emitDailyJSEvent(o);break;case dl:var se=this._meetingSessionState.topology!==(o.meetingSessionState&&o.meetingSessionState.topology);this._meetingSessionState=$r(o.meetingSessionState,this._callObjectMode),(this._callObjectMode||se)&&this.emitDailyJSEvent(o);break;case Tl:this._isScreenSharing=!0,this.emitDailyJSEvent(o);break;case Al:case Ml:this._isScreenSharing=!1,this.emitDailyJSEvent(o);break;case hn:case mn:case _l:case xl:case wl:case vl:case yl:case bl:case el:case tl:case jl:case kl:case"test-completed":case Ll:case Sl:case Fl:case Vl:case Ul:case ql:case fn:case Bl:case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(o);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(o,h){var u="record";o&&(h.local||h[u]!==!1||o[u]===h[u]||this.emitDailyJSEvent({action:mn}))}},{key:"maybeEventRecordingStarted",value:function(o,h){var u="record";o&&(h.local||h[u]!==!0||o[u]===h[u]||this.emitDailyJSEvent({action:hn}))}},{key:"_trackStatePlayable",value:function(o){return!(!o||o.state!==Jo)}},{key:"_trackChanged",value:function(o,h){return(o==null?void 0:o.id)!==(h==null?void 0:h.id)}},{key:"maybeEventTrackStopped",value:function(o,h,u){var f,v,x=(f=h==null?void 0:h.tracks[o])!==null&&f!==void 0?f:null,M=(v=u==null?void 0:u.tracks[o])!==null&&v!==void 0?v:null,L=x==null?void 0:x.track;if(L){var V=this._trackStatePlayable(x),te=this._trackStatePlayable(M),ne=this._trackChanged(L,M==null?void 0:M.track);V&&(te&&!ne||this.emitDailyJSEvent({action:gl,track:L,participant:u??h,type:o}))}}},{key:"maybeEventTrackStarted",value:function(o,h,u){var f,v,x=(f=h==null?void 0:h.tracks[o])!==null&&f!==void 0?f:null,M=(v=u==null?void 0:u.tracks[o])!==null&&v!==void 0?v:null,L=M==null?void 0:M.track;if(L){var V=this._trackStatePlayable(x),te=this._trackStatePlayable(M),ne=this._trackChanged(x==null?void 0:x.track,L);te&&(V&&!ne||this.emitDailyJSEvent({action:fl,track:L,participant:u,type:o}))}}},{key:"maybeParticipantTracksStopped",value:function(o,h){if(o)for(var u in o.tracks)this.maybeEventTrackStopped(u,o,h)}},{key:"maybeParticipantTracksStarted",value:function(o,h){if(h)for(var u in h.tracks)this.maybeEventTrackStarted(u,o,h)}},{key:"compareEqualForRMPUpdateEvent",value:function(o,h){var u,f;return o.state===h.state&&((u=o.settings)===null||u===void 0?void 0:u.volume)===((f=h.settings)===null||f===void 0?void 0:f.volume)}},{key:"emitDailyJSEvent",value:function(o){try{o.callClientId=this.callClientId,this.emit(o.action,o)}catch(h){console.log("could not emit",o,h)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(o,h){return!!Ue(o,h)&&(!o.videoTrack||!h.videoTrack||o.videoTrack.id===h.videoTrack.id&&o.videoTrack.muted===h.videoTrack.muted&&o.videoTrack.enabled===h.videoTrack.enabled)&&(!o.audioTrack||!h.audioTrack||o.audioTrack.id===h.audioTrack.id&&o.audioTrack.muted===h.audioTrack.muted&&o.audioTrack.enabled===h.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return ce()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(o){this._updateCallState(this._callState,o)}},{key:"_updateCallState",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(o!==this._callState||h!==this._isPreparingToJoin){var u=this._callState,f=this._isPreparingToJoin;this._callState=o,this._isPreparingToJoin=h;var v=this._callState===Tt;this.updateShowAndroidOngoingMeetingNotification(v);var x=Ks(u,f),M=Ks(this._callState,this._isPreparingToJoin);x!==M&&(this.updateKeepDeviceAwake(M),this.updateDeviceAudioMode(M),this.updateNoOpRecordingEnsuringBackgroundContinuity(M))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=lo,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:Ws},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=$r(oo,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=Lr,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(o){ce()&&this.nativeUtils().setKeepDeviceAwake(o,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(o){if(ce()&&!this.disableReactNativeAutoDeviceManagement("audio")){var h=o?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(h)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(o){if(ce()&&this.nativeUtils().setShowOngoingMeetingNotification){var h,u,f,v;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var x=this.properties.reactNativeConfig.androidInCallNotification;h=x.title,u=x.subtitle,f=x.iconName,v=x.disableForCustomOverride}v&&(o=!1),this.nativeUtils().setShowOngoingMeetingNotification(o,h,u,f,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(o){ce()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(o)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var o;if(ce()){var h=(o=this._callMachine())===null||o===void 0||(o=o.store)===null||o===void 0?void 0:o.getState();for(var u in h==null?void 0:h.streams){var f=h.streams[u];f&&f.pendingTrack&&f.pendingTrack.kind==="audio"&&(f.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(o){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[o]}},{key:"absoluteUrl",value:function(o){if(o!==void 0){var h=document.createElement("a");return h.href=o,h.href}}},{key:"sayHello",value:function(){var o="hello, world.";return console.log(o),o}},{key:"_logUseAfterDestroy",value:function(){var o=Object.values(Ft)[0];if(this.needsLoad())if(o&&!o.needsLoad()){var h={action:Bs,level:"error",code:this.strictMode?9995:9997};o.sendMessageToCallMachine(h)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var u={action:Bs,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(u,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var o=0,h=Object.values(Ft);o<h.length;o++){var u=h[o];u._callMachineInitialized?(u.sendMessageToCallMachine({action:Bs,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),u._delayDuplicateInstanceLog=!1):u._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(o){var h,u,f,v;if(!((h=o.error)!==null&&h!==void 0&&h.type&&(![Wo,Yo,un].includes(o.error.type)||o.error.type===un&&o.error.msg.includes("deleted")))){var x=(u=this.properties)!==null&&u!==void 0&&u.url?new URL(this.properties.url):void 0,M="production";x&&x.host.includes(".staging.daily")&&(M="staging");var L,V,te,ne,Je,nt=function(_t){const S=[Qu(),Hu(),Sd(),xd(),Ed(),Ad(),td(),Td()];return _t.autoSessionTracking!==!1&&S.push(Nd()),S}({}).filter(function(_t){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(_t.name)}),yt=new cd({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:pd,stackParser:_d,integrations:nt,environment:M}),ke=new Ot;if(ke.setClient(yt),yt.init(),this.session_id&&ke.setExtra("sessionId",this.session_id),this.properties){var Be=G({},this.properties);Be.userName=Be.userName?"[Filtered]":void 0,Be.userData=Be.userData?"[Filtered]":void 0,Be.token=Be.token?"[Filtered]":void 0,ke.setExtra("properties",Be)}if(x){var at=x.searchParams.get("domain");if(!at){var bt=x.host.match(/(.*?)\./);at=bt&&bt[1]||""}at&&ke.setTag("domain",at)}o.error&&(ke.setTag("fatalErrorType",o.error.type),ke.setExtra("errorDetails",o.error.details),!((L=o.error.details)===null||L===void 0)&&L.uri&&ke.setTag("serverAddress",o.error.details.uri),!((V=o.error.details)===null||V===void 0)&&V.workerGroup&&ke.setTag("workerGroup",o.error.details.workerGroup),!((te=o.error.details)===null||te===void 0)&&te.geoGroup&&ke.setTag("geoGroup",o.error.details.geoGroup),!((ne=o.error.details)===null||ne===void 0)&&ne.on&&ke.setTag("connectionAttempt",o.error.details.on),(Je=o.error.details)!==null&&Je!==void 0&&Je.bundleUrl&&(ke.setTag("bundleUrl",o.error.details.bundleUrl),ke.setTag("bundleError",o.error.details.sourceError.type))),ke.setTags({callMode:this._callObjectMode?ce()?"reactNative":(f=this.properties)!==null&&f!==void 0&&(f=f.dailyConfig)!==null&&f!==void 0&&(f=f.callMode)!==null&&f!==void 0&&f.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:s.version()});var Lt=((v=o.error)===null||v===void 0?void 0:v.msg)||o.errorMsg;ke.captureException(new Error(Lt))}}},{key:"_callMachine",value:function(){var o;return(o=window._daily)===null||o===void 0||(o=o.instances)===null||o===void 0||(o=o[this.callClientId])===null||o===void 0?void 0:o.callMachine}},{key:"_maybeUpdateInputSettings",value:function(o){if(!Ue(this._inputSettings,o)){var h=this._getInputSettings();this._inputSettings=o;var u=this._getInputSettings();Ue(h,u)||this.emitDailyJSEvent({action:pn,inputSettings:u})}}}],[{key:"supportedBrowser",value:function(){if(ce())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var o=vu.getParser(Ze());return{supported:!!qi(),mobile:o.getPlatformType()==="mobile",name:o.getBrowserName(),version:o.getBrowserVersion(),supportsFullscreen:!!Ui(),supportsScreenShare:!!rh(),supportsSfu:!!qi(),supportsVideoProcessing:zl(),supportsAudioProcessing:Yl()}}},{key:"version",value:function(){return"0.80.0"}},{key:"createCallObject",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return o.layout="none",new s(null,o)}},{key:"wrap",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ie(),!o||!o.contentWindow||typeof o.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return h.layout||(h.customLayout?h.layout="custom-v1":h.layout="browser"),new s(o,h)}},{key:"createFrame",value:function(o,h){var u,f;ie(),o&&h?(u=o,f=h):o&&o.append?(u=o,f={}):(u=document.body,f=o||{});var v=f.iframeStyle;v||(v=u===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var x=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?x.allow="microphone, camera":x.allow="microphone; camera; autoplay; display-capture; screen-wake-lock",x.style.visibility="hidden",u.appendChild(x),x.style.visibility=null,Object.keys(v).forEach(function(M){return x.style[M]=v[M]}),f.layout||(f.customLayout?f.layout="custom-v1":f.layout="browser");try{return new s(x,f)}catch(M){throw u.removeChild(x),M}}},{key:"createTransparentFrame",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ie();var h=document.createElement("iframe");return h.allow="microphone; camera; autoplay",h.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(h),o.layout||(o.layout="custom-v1"),s.wrap(h,o)}},{key:"getCallInstance",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return o?Ft[o]:Object.values(Ft)[0]}}]);var e,t,r,a,i,l,c,d,m,g,_,T,N,k,y,w,C,I,E,O,p,B,K,R,he,A,z,j,F,D,ae,Te,W,Pt,ut,$e,b,Ee}();function ss(s,e){var t={};for(var r in s)if(s[r]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",r),t[r]=gt;else if(r==="dailyConfig"){if(s[r].modifyLocalSdpHook){var a=window._daily.instances[e].customCallbacks||{};a.modifyLocalSdpHook=s[r].modifyLocalSdpHook,window._daily.instances[e].customCallbacks=a,delete s[r].modifyLocalSdpHook}if(s[r].modifyRemoteSdpHook){var i=window._daily.instances[e].customCallbacks||{};i.modifyRemoteSdpHook=s[r].modifyRemoteSdpHook,window._daily.instances[e].customCallbacks=i,delete s[r].modifyRemoteSdpHook}t[r]=s[r]}else t[r]=s[r];return t}function ve(s){var e=arguments.length>2?arguments[2]:void 0;if(s!==Tt){var t="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," only supported after join.");throw e&&(t+=" ".concat(e)),console.error(t),new Error(t)}}function Ks(s,e){return[cr,Tt].includes(s)||e}function qr(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"This daily-js method",r=arguments.length>3?arguments[3]:void 0;if(Ks(s,e)){var a="".concat(t," not supported after joining a meeting.");throw r&&(a+=" ".concat(r)),console.error(a),new Error(a)}}function Gs(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method",t=arguments.length>2?arguments[2]:void 0;if(!s){var r="".concat(e,arguments.length>3&&arguments[3]!==void 0&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw t&&(r+=" ".concat(t)),console.error(r),new Error(r)}}function Br(s){if(s){var e="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(e),new Error(e)}}function et(s){if(!s){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(e),new Error(e)}}function Ge(s){if(s){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(e),new Error(e)}}function ie(){if(ce())throw new Error("This daily-js method is not currently supported in React Native")}function gs(){if(!ce())throw new Error("This daily-js method is only supported in React Native")}function ic(s){if(s===void 0)return!0;var e;if(typeof s=="string")e=s;else try{e=JSON.stringify(s),Ue(JSON.parse(e),s)||console.warn("The userData provided will be modified when serialized.")}catch(t){throw Error("userData must be serializable to JSON: ".concat(t))}if(e.length>4096)throw Error("userData is too large (".concat(e.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function oc(s,e){for(var t=e.allowAllParticipantsKey,r=function(_){var T=["local"];return t||T.push("*"),_&&!T.includes(_)},a=function(_){return!!(_.layer===void 0||Number.isInteger(_.layer)&&_.layer>=0||_.layer==="inherit")},i=function(_){return!!_&&!(_.video&&!a(_.video))&&!(_.screenVideo&&!a(_.screenVideo))},l=0,c=Object.entries(s);l<c.length;l++){var d=Fe(c[l],2),m=d[0],g=d[1];if(!r(m)||!i(g))return!1}return!0}function lc(s){if(de(s)!=="object")return!1;for(var e=0,t=Object.entries(s);e<t.length;e++){var r=Fe(t[e],2),a=r[0],i=r[1];switch(a){case"video":if(de(i)!=="object")return!1;for(var l=0,c=Object.entries(i);l<c.length;l++){var d=Fe(c[l],2),m=d[0],g=d[1];switch(m){case"processor":if(!Ih(g))return!1;break;case"settings":if(!ho(g))return!1;break;default:return!1}}break;case"audio":if(de(i)!=="object")return!1;for(var _=0,T=Object.entries(i);_<T.length;_++){var N=Fe(T[_],2),k=N[0],y=N[1];switch(k){case"processor":if(!Mh(y))return!1;break;case"settings":if(!ho(y))return!1;break;default:return!1}}break;default:return!1}}return!0}function cc(s,e,t){var r,a=[];s.video&&s.video.processor&&(zl((r=e==null?void 0:e.useLegacyVideoProcessor)!==null&&r!==void 0&&r)||(s.video.settings?delete s.video.processor:delete s.video,a.push("video"))),s.audio&&s.audio.processor&&(Yl()||(s.audio.settings?delete s.audio.processor:delete s.audio,a.push("audio"))),a.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(a.join(", "))),s.audio&&s.audio.settings&&(s.audio.settings.customTrack?(t.audioTrack=s.audio.settings.customTrack,s.audio.settings={customTrack:gt}):delete t.audioTrack),s.video&&s.video.settings&&(s.video.settings.customTrack?(t.videoTrack=s.video.settings.customTrack,s.video.settings={customTrack:gt}):delete t.videoTrack)}function Mh(s){if(ce())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type"];return!!s&&de(s)==="object"&&(Object.keys(s).filter(function(t){return!e.includes(t)}).forEach(function(t){console.warn("invalid key inputSettings -> audio -> processor : ".concat(t)),delete s[t]}),!!function(t){return typeof t!="string"?!1:Object.values(Jl).includes(t)?!0:(console.error("inputSettings audio processor type invalid"),!1)}(s.type))}function Ih(s){if(ce())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type","config"];return!s||de(s)!=="object"||!function(t){return typeof t!="string"?!1:Object.values(Hs).includes(t)?!0:(console.error("inputSettings video processor type invalid"),!1)}(s.type)||s.config&&(de(s.config)!=="object"||!function(t,r){var a=Object.keys(r);if(a.length===0)return!0;var i="invalid object in inputSettings -> video -> processor -> config";switch(t){case Hs.BGBLUR:return a.length>1||a[0]!=="strength"?(console.error(i),!1):!(typeof r.strength!="number"||r.strength<=0||r.strength>1||isNaN(r.strength))||(console.error("".concat(i,"; expected: {0 < strength <= 1}, got: ").concat(r.strength)),!1);case Hs.BGIMAGE:return!(r.source!==void 0&&!function(l){if(l.source==="default")return l.type="default",!0;if(l.source instanceof ArrayBuffer)return!0;if(nr(l.source))return l.type="url",!!function(m){var g=new URL(m),_=g.pathname;if(g.protocol==="data:")try{var T=_.substring(_.indexOf(":")+1,_.indexOf(";")).split("/")[1];return Rr.includes(T)}catch(k){return console.error("failed to deduce blob content type",k),!1}var N=_.split(".").at(-1).toLowerCase().trim();return Rr.includes(N)}(l.source)||(console.error("invalid image type; supported types: [".concat(Rr.join(", "),"]")),!1);return c=l.source,d=Number(c),isNaN(d)||!Number.isInteger(d)||d<=0||d>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(l.type="daily-preselect",!0);var c,d}(r));default:return!0}}(s.type,s.config))?!1:(Object.keys(s).filter(function(t){return!e.includes(t)}).forEach(function(t){console.warn("invalid key inputSettings -> video -> processor : ".concat(t)),delete s[t]}),!0)}function ho(s){return de(s)==="object"&&(!s.customTrack||s.customTrack instanceof MediaStreamTrack)}function Sn(){var s=Object.values(Hs).join(" | "),e=Object.values(Jl).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(s," ], config?: {} } }, audio?: { processor: {type: [ ").concat(e," ] } } }")}function uc(s){var e=s.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat(zo).concat(e?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function dc(){return"customIntegrations should be an object of type ".concat(JSON.stringify(wn),".")}function hc(s){if(s&&de(s)!=="object"||Array.isArray(s))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(hr),".")),!1;if(s)for(var e=0,t=Object.entries(s);e<t.length;e++)for(var r=Fe(t[e],1)[0],a=0,i=Object.entries(s[r]);a<i.length;a++){var l=Fe(i[a],2),c=l[0],d=l[1],m=hr.id[c];if(!m)return console.error("customTrayButton does not support key ".concat(c)),!1;switch(c){case"iconPath":case"iconPathDarkMode":if(!nr(d))return console.error("customTrayButton ".concat(c," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(d))return console.error("customTrayButton ".concat(c," should be ").concat(m,". Got: ").concat(d)),!1;break;default:if(de(d)!==m)return console.error("customTrayButton ".concat(c," should be a ").concat(m,".")),!1}}return!0}function mc(s){if(!s||s&&de(s)!=="object"||Array.isArray(s))return console.error(dc()),!1;for(var e=function(_){return"".concat(_," should be ").concat(wn.id[_])},t=function(_,T){return console.error("customIntegration ".concat(_,": ").concat(T))},r=0,a=Object.entries(s);r<a.length;r++){var i=Fe(a[r],1)[0];if(!("label"in s[i]))return t(i,"label is required"),!1;if(!("location"in s[i]))return t(i,"location is required"),!1;if(!("src"in s[i])&&!("srcdoc"in s[i]))return t(i,"src or srcdoc is required"),!1;for(var l=0,c=Object.entries(s[i]);l<c.length;l++){var d=Fe(c[l],2),m=d[0],g=d[1];switch(m){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if(typeof g!="string")return t(i,e(m)),!1;break;case"iconURL":if(!nr(g))return t(i,"".concat(m," should be a url")),!1;break;case"src":if("srcdoc"in s[i])return t(i,"cannot have both src and srcdoc"),!1;if(!nr(g))return t(i,'src "'.concat(g,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in s[i])return t(i,"cannot have both src and srcdoc"),!1;if(typeof g!="string")return t(i,e(m)),!1;break;case"location":if(!["main","sidebar"].includes(g))return t(i,e(m)),!1;break;case"controlledBy":if(g!=="*"&&g!=="owners"&&(!Array.isArray(g)||g.some(function(_){return typeof _!="string"})))return t(i,e(m)),!1;break;case"shared":if((!Array.isArray(g)||g.some(function(_){return typeof _!="string"}))&&g!=="owners"&&typeof g!="boolean")return t(i,e(m)),!1;break;default:if(!wn.id[m])return console.error("customIntegration does not support key ".concat(m)),!1}}}return!0}function pc(s,e){if(e===void 0)return!1;switch(de(e)){case"string":return de(s)===e;case"object":if(de(s)!=="object")return!1;for(var t in s)if(!pc(s[t],e[t]))return!1;return!0;default:return!1}}function mo(s,e){var t=s.sessionId,r=s.toEndPoint,a=s.callerId,i=s.useSipRefer;if(!t||!r)throw new Error("".concat(e,"() requires a sessionId and toEndPoint"));if(typeof t!="string"||typeof r!="string")throw new Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(i&&!r.startsWith("sip:"))throw new Error('"toEndPoint" must be a "sip" address');if(!r.startsWith("sip:")&&!r.startsWith("+"))throw new Error("toEndPoint: ".concat(r,' must starts with either "sip:" or "+"'));if(a&&typeof a!="string")throw new Error("callerId must be of type string");if(a&&!r.startsWith("+"))throw new Error("callerId is only valid when transferring to a PSTN number")}function po(s){if(de(s)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(s.state&&!Object.values(vn).includes(s.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(vn));if(s.volume){if(typeof s.volume!="number")throw new Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(s.volume<0||s.volume>2)throw new Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function fo(s,e,t){return!(typeof s!="number"||s<e||s>t)}function $r(s,e){return s&&!e&&delete s.data,s}const Oh=Object.freeze(Object.defineProperty({__proto__:null,DAILY_ACCESS_LEVEL_FULL:Go,DAILY_ACCESS_LEVEL_LOBBY:Dd,DAILY_ACCESS_LEVEL_NONE:Rd,DAILY_ACCESS_UNKNOWN:Ws,DAILY_CAMERA_ERROR_CAM_AND_MIC_IN_USE:Wd,DAILY_CAMERA_ERROR_CAM_IN_USE:zd,DAILY_CAMERA_ERROR_CONSTRAINTS:Xd,DAILY_CAMERA_ERROR_MIC_IN_USE:Yd,DAILY_CAMERA_ERROR_NOT_FOUND:Qd,DAILY_CAMERA_ERROR_PERMISSIONS:Hd,DAILY_CAMERA_ERROR_UNDEF_MEDIADEVICES:Kd,DAILY_CAMERA_ERROR_UNKNOWN:Zd,DAILY_EVENT_ACCESS_STATE_UPDATED:cl,DAILY_EVENT_ACTIVE_SPEAKER_CHANGE:Il,DAILY_EVENT_ACTIVE_SPEAKER_MODE_CHANGE:Ol,DAILY_EVENT_APP_MSG:jl,DAILY_EVENT_CAMERA_ERROR:tl,DAILY_EVENT_CPU_LOAD_CHANGE:Dl,DAILY_EVENT_ERROR:gn,DAILY_EVENT_EXIT_FULLSCREEN:_s,DAILY_EVENT_FACE_COUNTS_UPDATED:Rl,DAILY_EVENT_FULLSCREEN:bs,DAILY_EVENT_IFRAME_LAUNCH_CONFIG:Ko,DAILY_EVENT_IFRAME_READY_FOR_LAUNCH_CONFIG:Ho,DAILY_EVENT_INPUT_SETTINGS_UPDATED:pn,DAILY_EVENT_JOINED_MEETING:rl,DAILY_EVENT_JOINING_MEETING:sl,DAILY_EVENT_LANG_UPDATED:Bl,DAILY_EVENT_LEFT_MEETING:nl,DAILY_EVENT_LIVE_STREAMING_ERROR:ql,DAILY_EVENT_LIVE_STREAMING_STARTED:Fl,DAILY_EVENT_LIVE_STREAMING_STOPPED:Ul,DAILY_EVENT_LIVE_STREAMING_UPDATED:Vl,DAILY_EVENT_LOADED:dn,DAILY_EVENT_LOADING:Xo,DAILY_EVENT_LOAD_ATTEMPT_FAILED:Zo,DAILY_EVENT_LOCAL_SCREEN_SHARE_CANCELED:Ml,DAILY_EVENT_LOCAL_SCREEN_SHARE_STARTED:Tl,DAILY_EVENT_LOCAL_SCREEN_SHARE_STOPPED:Al,DAILY_EVENT_MEETING_SESSION_DATA_ERROR:eh,DAILY_EVENT_MEETING_SESSION_STATE_UPDATED:dl,DAILY_EVENT_MEETING_SESSION_SUMMARY_UPDATED:ul,DAILY_EVENT_NETWORK_CONNECTION:Ll,DAILY_EVENT_NETWORK_QUALITY_CHANGE:Pl,DAILY_EVENT_NONFATAL_ERROR:fn,DAILY_EVENT_PARTICIPANT_COUNTS_UPDATED:ll,DAILY_EVENT_PARTICIPANT_JOINED:al,DAILY_EVENT_PARTICIPANT_LEFT:ol,DAILY_EVENT_PARTICIPANT_UPDATED:il,DAILY_EVENT_RECEIVE_SETTINGS_UPDATED:$l,DAILY_EVENT_RECORDING_DATA:Sl,DAILY_EVENT_RECORDING_ERROR:xl,DAILY_EVENT_RECORDING_STARTED:hn,DAILY_EVENT_RECORDING_STATS:_l,DAILY_EVENT_RECORDING_STOPPED:mn,DAILY_EVENT_RECORDING_UPLOAD_COMPLETED:wl,DAILY_EVENT_REMOTE_MEDIA_PLAYER_STARTED:Cl,DAILY_EVENT_REMOTE_MEDIA_PLAYER_STOPPED:El,DAILY_EVENT_REMOTE_MEDIA_PLAYER_UPDATED:Nl,DAILY_EVENT_STARTED_CAMERA:el,DAILY_EVENT_THEME_UPDATED:Qo,DAILY_EVENT_TRACK_STARTED:fl,DAILY_EVENT_TRACK_STOPPED:gl,DAILY_EVENT_TRANSCRIPTION_ERROR:bl,DAILY_EVENT_TRANSCRIPTION_MSG:kl,DAILY_EVENT_TRANSCRIPTION_STARTED:vl,DAILY_EVENT_TRANSCRIPTION_STOPPED:yl,DAILY_EVENT_WAITING_PARTICIPANT_ADDED:hl,DAILY_EVENT_WAITING_PARTICIPANT_REMOVED:pl,DAILY_EVENT_WAITING_PARTICIPANT_UPDATED:ml,DAILY_FATAL_ERROR_CONNECTION:Wo,DAILY_FATAL_ERROR_EJECTED:Vd,DAILY_FATAL_ERROR_EOL:Yo,DAILY_FATAL_ERROR_EXP_ROOM:Bd,DAILY_FATAL_ERROR_EXP_TOKEN:$d,DAILY_FATAL_ERROR_MEETING_FULL:Jd,DAILY_FATAL_ERROR_NBF_ROOM:Ud,DAILY_FATAL_ERROR_NBF_TOKEN:qd,DAILY_FATAL_ERROR_NOT_ALLOWED:Gd,DAILY_FATAL_ERROR_NO_ROOM:un,DAILY_RECEIVE_SETTINGS_ALL_PARTICIPANTS_KEY:Fd,DAILY_RECEIVE_SETTINGS_BASE_KEY:zo,DAILY_STATE_ERROR:dt,DAILY_STATE_JOINED:Tt,DAILY_STATE_JOINING:cr,DAILY_STATE_LEFT:Ct,DAILY_STATE_NEW:cn,DAILY_TRACK_STATE_BLOCKED:Md,DAILY_TRACK_STATE_INTERRUPTED:Ld,DAILY_TRACK_STATE_LOADING:Pd,DAILY_TRACK_STATE_OFF:Id,DAILY_TRACK_STATE_PLAYABLE:Jo,DAILY_TRACK_STATE_SENDABLE:Od,default:Ah},Symbol.toStringTag,{value:"Module"})),Ph=Fc(Oh);var Vn={exports:{}},is=typeof Reflect=="object"?Reflect:null,go=is&&typeof is.apply=="function"?is.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},Qs;is&&typeof is.ownKeys=="function"?Qs=is.ownKeys:Object.getOwnPropertySymbols?Qs=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Qs=function(e){return Object.getOwnPropertyNames(e)};function Lh(s){console&&console.warn&&console.warn(s)}var fc=Number.isNaN||function(e){return e!==e};function fe(){fe.init.call(this)}Vn.exports=fe;Vn.exports.once=Vh;fe.EventEmitter=fe;fe.prototype._events=void 0;fe.prototype._eventsCount=0;fe.prototype._maxListeners=void 0;var vo=10;function Sr(s){if(typeof s!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}Object.defineProperty(fe,"defaultMaxListeners",{enumerable:!0,get:function(){return vo},set:function(s){if(typeof s!="number"||s<0||fc(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");vo=s}});fe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};fe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||fc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function gc(s){return s._maxListeners===void 0?fe.defaultMaxListeners:s._maxListeners}fe.prototype.getMaxListeners=function(){return gc(this)};fe.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var a=e==="error",i=this._events;if(i!==void 0)a=a&&i.error===void 0;else if(!a)return!1;if(a){var l;if(t.length>0&&(l=t[0]),l instanceof Error)throw l;var c=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw c.context=l,c}var d=i[e];if(d===void 0)return!1;if(typeof d=="function")go(d,this,t);else for(var m=d.length,g=xc(d,m),r=0;r<m;++r)go(g[r],this,t);return!0};function vc(s,e,t,r){var a,i,l;if(Sr(t),i=s._events,i===void 0?(i=s._events=Object.create(null),s._eventsCount=0):(i.newListener!==void 0&&(s.emit("newListener",e,t.listener?t.listener:t),i=s._events),l=i[e]),l===void 0)l=i[e]=t,++s._eventsCount;else if(typeof l=="function"?l=i[e]=r?[t,l]:[l,t]:r?l.unshift(t):l.push(t),a=gc(s),a>0&&l.length>a&&!l.warned){l.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=s,c.type=e,c.count=l.length,Lh(c)}return s}fe.prototype.addListener=function(e,t){return vc(this,e,t,!1)};fe.prototype.on=fe.prototype.addListener;fe.prototype.prependListener=function(e,t){return vc(this,e,t,!0)};function Dh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function yc(s,e,t){var r={fired:!1,wrapFn:void 0,target:s,type:e,listener:t},a=Dh.bind(r);return a.listener=t,r.wrapFn=a,a}fe.prototype.once=function(e,t){return Sr(t),this.on(e,yc(this,e,t)),this};fe.prototype.prependOnceListener=function(e,t){return Sr(t),this.prependListener(e,yc(this,e,t)),this};fe.prototype.removeListener=function(e,t){var r,a,i,l,c;if(Sr(t),a=this._events,a===void 0)return this;if(r=a[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete a[e],a.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(i=-1,l=r.length-1;l>=0;l--)if(r[l]===t||r[l].listener===t){c=r[l].listener,i=l;break}if(i<0)return this;i===0?r.shift():Rh(r,i),r.length===1&&(a[e]=r[0]),a.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};fe.prototype.off=fe.prototype.removeListener;fe.prototype.removeAllListeners=function(e){var t,r,a;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),l;for(a=0;a<i.length;++a)l=i[a],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this};function bc(s,e,t){var r=s._events;if(r===void 0)return[];var a=r[e];return a===void 0?[]:typeof a=="function"?t?[a.listener||a]:[a]:t?Fh(a):xc(a,a.length)}fe.prototype.listeners=function(e){return bc(this,e,!0)};fe.prototype.rawListeners=function(e){return bc(this,e,!1)};fe.listenerCount=function(s,e){return typeof s.listenerCount=="function"?s.listenerCount(e):_c.call(s,e)};fe.prototype.listenerCount=_c;function _c(s){var e=this._events;if(e!==void 0){var t=e[s];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}fe.prototype.eventNames=function(){return this._eventsCount>0?Qs(this._events):[]};function xc(s,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=s[r];return t}function Rh(s,e){for(;e+1<s.length;e++)s[e]=s[e+1];s.pop()}function Fh(s){for(var e=new Array(s.length),t=0;t<e.length;++t)e[t]=s[t].listener||s[t];return e}function Vh(s,e){return new Promise(function(t,r){function a(l){s.removeListener(e,i),r(l)}function i(){typeof s.removeListener=="function"&&s.removeListener("error",a),t([].slice.call(arguments))}wc(s,e,i,{once:!0}),e!=="error"&&Uh(s,a,{once:!0})})}function Uh(s,e,t){typeof s.on=="function"&&wc(s,"error",e,t)}function wc(s,e,t,r){if(typeof s.on=="function")r.once?s.once(e,t):s.on(e,t);else if(typeof s.addEventListener=="function")s.addEventListener(e,function a(i){r.once&&s.removeEventListener(e,a),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof s)}var qh=Vn.exports,jr={},At={};Object.defineProperty(At,"__esModule",{value:!0});At.Api=At.HttpClient=At.ContentType=void 0;var q;(function(s){s.Json="application/json",s.JsonApi="application/vnd.api+json",s.FormData="multipart/form-data",s.UrlEncoded="application/x-www-form-urlencoded",s.Text="text/plain"})(q||(At.ContentType=q={}));class Sc{constructor(e={}){ee(this,"baseUrl","https://api.vapi.ai");ee(this,"securityData",null);ee(this,"securityWorker");ee(this,"abortControllers",new Map);ee(this,"customFetch",(...e)=>fetch(...e));ee(this,"baseApiParams",{credentials:"same-origin",headers:{},redirect:"follow",referrerPolicy:"no-referrer"});ee(this,"setSecurityData",e=>{this.securityData=e});ee(this,"contentFormatters",{[q.Json]:e=>e!==null&&(typeof e=="object"||typeof e=="string")?JSON.stringify(e):e,[q.JsonApi]:e=>e!==null&&(typeof e=="object"||typeof e=="string")?JSON.stringify(e):e,[q.Text]:e=>e!==null&&typeof e!="string"?JSON.stringify(e):e,[q.FormData]:e=>Object.keys(e||{}).reduce((t,r)=>{const a=e[r];return t.append(r,a instanceof Blob?a:typeof a=="object"&&a!==null?JSON.stringify(a):`${a}`),t},new FormData),[q.UrlEncoded]:e=>this.toQueryString(e)});ee(this,"createAbortSignal",e=>{if(this.abortControllers.has(e)){const r=this.abortControllers.get(e);return r?r.signal:void 0}const t=new AbortController;return this.abortControllers.set(e,t),t.signal});ee(this,"abortRequest",e=>{const t=this.abortControllers.get(e);t&&(t.abort(),this.abortControllers.delete(e))});ee(this,"request",async({body:e,secure:t,path:r,type:a,query:i,format:l,baseUrl:c,cancelToken:d,...m})=>{const g=(typeof t=="boolean"?t:this.baseApiParams.secure)&&this.securityWorker&&await this.securityWorker(this.securityData)||{},_=this.mergeRequestParams(m,g),T=i&&this.toQueryString(i),N=this.contentFormatters[a||q.Json],k=l||_.format;return this.customFetch(`${c||this.baseUrl||""}${r}${T?`?${T}`:""}`,{..._,headers:{..._.headers||{},...a&&a!==q.FormData?{"Content-Type":a}:{}},signal:(d?this.createAbortSignal(d):_.signal)||null,body:typeof e>"u"||e===null?null:N(e)}).then(async y=>{const w=y.clone();w.data=null,w.error=null;const C=k?await y[k]().then(I=>(w.ok?w.data=I:w.error=I,w)).catch(I=>(w.error=I,w)):w;if(d&&this.abortControllers.delete(d),!y.ok)throw C;return C})});Object.assign(this,e)}encodeQueryParam(e,t){return`${encodeURIComponent(e)}=${encodeURIComponent(typeof t=="number"?t:`${t}`)}`}addQueryParam(e,t){return this.encodeQueryParam(t,e[t])}addArrayQueryParam(e,t){return e[t].map(a=>this.encodeQueryParam(t,a)).join("&")}toQueryString(e){const t=e||{};return Object.keys(t).filter(a=>typeof t[a]<"u").map(a=>Array.isArray(t[a])?this.addArrayQueryParam(t,a):this.addQueryParam(t,a)).join("&")}addQueryParams(e){const t=this.toQueryString(e);return t?`?${t}`:""}mergeRequestParams(e,t){return{...this.baseApiParams,...e,...t||{},headers:{...this.baseApiParams.headers||{},...e.headers||{},...t&&t.headers||{}}}}}At.HttpClient=Sc;class Bh extends Sc{constructor(){super(...arguments);ee(this,"call",{callControllerCreate:(t,r={})=>this.request({path:"/call",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),callControllerFindAll:(t,r={})=>this.request({path:"/call",method:"GET",query:t,secure:!0,format:"json",...r}),callControllerFindOne:(t,r={})=>this.request({path:`/call/${t}`,method:"GET",secure:!0,format:"json",...r}),callControllerUpdate:(t,r,a={})=>this.request({path:`/call/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),callControllerDeleteCallData:(t,r={})=>this.request({path:`/call/${t}`,method:"DELETE",secure:!0,format:"json",...r}),callControllerCreatePhoneCall:(t,r={})=>this.request({path:"/call/phone",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),callControllerCreateWebCall:(t,r={})=>this.request({path:"/call/web",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r})});ee(this,"v2",{callControllerExportCalls:(t,r={})=>this.request({path:"/v2/call/export",method:"GET",query:t,secure:!0,...r}),callControllerFindAllPaginated:(t,r={})=>this.request({path:"/v2/call",method:"GET",query:t,secure:!0,format:"json",...r}),callControllerFindAllMetadataPaginated:(t,r={})=>this.request({path:"/v2/call/metadata",method:"GET",query:t,secure:!0,format:"json",...r}),assistantControllerFindAllPaginated:(t,r={})=>this.request({path:"/v2/assistant",method:"GET",query:t,secure:!0,format:"json",...r}),phoneNumberControllerFindAllPaginated:(t,r={})=>this.request({path:"/v2/phone-number",method:"GET",query:t,secure:!0,format:"json",...r})});ee(this,"chat",{chatControllerListChats:(t,r={})=>this.request({path:"/chat",method:"GET",query:t,secure:!0,format:"json",...r}),chatControllerCreateChat:(t,r={})=>this.request({path:"/chat",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),chatControllerGetChat:(t,r={})=>this.request({path:`/chat/${t}`,method:"GET",secure:!0,format:"json",...r}),chatControllerDeleteChat:(t,r={})=>this.request({path:`/chat/${t}`,method:"DELETE",secure:!0,format:"json",...r}),chatControllerCreateOpenAiChat:(t,r={})=>this.request({path:"/chat/responses",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),chatControllerCreateWebChat:(t,r={})=>this.request({path:"/chat/web",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),chatControllerCreateOpenAiWebChat:(t,r={})=>this.request({path:"/chat/web/responses",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r})});ee(this,"campaign",{campaignControllerCreate:(t,r={})=>this.request({path:"/campaign",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),campaignControllerFindAll:(t,r={})=>this.request({path:"/campaign",method:"GET",query:t,secure:!0,format:"json",...r}),campaignControllerFindAllPaginated:(t,r={})=>this.request({path:"/campaign/paginated",method:"GET",query:t,secure:!0,format:"json",...r}),campaignControllerFindOne:(t,r={})=>this.request({path:`/campaign/${t}`,method:"GET",secure:!0,format:"json",...r}),campaignControllerUpdate:(t,r,a={})=>this.request({path:`/campaign/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),campaignControllerRemove:(t,r={})=>this.request({path:`/campaign/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"session",{sessionControllerCreate:(t,r={})=>this.request({path:"/session",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),sessionControllerFindAllPaginated:(t,r={})=>this.request({path:"/session",method:"GET",query:t,secure:!0,format:"json",...r}),sessionControllerFindOne:(t,r={})=>this.request({path:`/session/${t}`,method:"GET",secure:!0,format:"json",...r}),sessionControllerUpdate:(t,r,a={})=>this.request({path:`/session/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),sessionControllerRemove:(t,r={})=>this.request({path:`/session/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"support",{supportControllerCreateTicket:(t,r={})=>this.request({path:"/support/ticket",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r})});ee(this,"assistant",{assistantControllerCreate:(t,r={})=>this.request({path:"/assistant",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),assistantControllerFindAll:(t,r={})=>this.request({path:"/assistant",method:"GET",query:t,secure:!0,format:"json",...r}),assistantControllerFindOne:(t,r={})=>this.request({path:`/assistant/${t}`,method:"GET",secure:!0,format:"json",...r}),assistantControllerUpdate:(t,r,a={})=>this.request({path:`/assistant/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),assistantControllerReplace:(t,r,a={})=>this.request({path:`/assistant/${t}`,method:"PUT",body:r,secure:!0,type:q.Json,format:"json",...a}),assistantControllerRemove:(t,r={})=>this.request({path:`/assistant/${t}`,method:"DELETE",secure:!0,format:"json",...r}),assistantControllerFindVersions:(t,r,a={})=>this.request({path:`/assistant/${t}/version`,method:"GET",query:r,secure:!0,format:"json",...a})});ee(this,"phoneNumber",{phoneNumberControllerImportTwilio:(t,r={})=>this.request({path:"/phone-number/import/twilio",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),phoneNumberControllerImportVonage:(t,r={})=>this.request({path:"/phone-number/import/vonage",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),phoneNumberControllerCreate:(t,r={})=>this.request({path:"/phone-number",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),phoneNumberControllerFindAll:(t,r={})=>this.request({path:"/phone-number",method:"GET",query:t,secure:!0,format:"json",...r}),phoneNumberControllerFindOne:(t,r={})=>this.request({path:`/phone-number/${t}`,method:"GET",secure:!0,format:"json",...r}),phoneNumberControllerUpdate:(t,r,a={})=>this.request({path:`/phone-number/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),phoneNumberControllerRemove:(t,r={})=>this.request({path:`/phone-number/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"tool",{toolControllerCreate:(t,r={})=>this.request({path:"/tool",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),toolControllerFindAll:(t,r={})=>this.request({path:"/tool",method:"GET",query:t,secure:!0,format:"json",...r}),toolControllerFindOne:(t,r={})=>this.request({path:`/tool/${t}`,method:"GET",secure:!0,format:"json",...r}),toolControllerUpdate:(t,r,a={})=>this.request({path:`/tool/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),toolControllerRemove:(t,r={})=>this.request({path:`/tool/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"file",{fileControllerCreateDeprecated:(t,r={})=>this.request({path:"/file/upload",method:"POST",body:t,secure:!0,type:q.FormData,format:"json",...r}),fileControllerCreate:(t,r={})=>this.request({path:"/file",method:"POST",body:t,secure:!0,type:q.FormData,format:"json",...r}),fileControllerFindAll:(t={})=>this.request({path:"/file",method:"GET",secure:!0,format:"json",...t}),fileControllerFindOne:(t,r={})=>this.request({path:`/file/${t}`,method:"GET",secure:!0,format:"json",...r}),fileControllerUpdate:(t,r,a={})=>this.request({path:`/file/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),fileControllerRemove:(t,r={})=>this.request({path:`/file/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"knowledgeBase",{knowledgeBaseControllerCreate:(t,r={})=>this.request({path:"/knowledge-base",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),knowledgeBaseControllerFindAll:(t,r={})=>this.request({path:"/knowledge-base",method:"GET",query:t,secure:!0,format:"json",...r}),knowledgeBaseControllerFindOne:(t,r={})=>this.request({path:`/knowledge-base/${t}`,method:"GET",secure:!0,format:"json",...r}),knowledgeBaseControllerUpdate:(t,r,a={})=>this.request({path:`/knowledge-base/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),knowledgeBaseControllerRemove:(t,r={})=>this.request({path:`/knowledge-base/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"workflow",{workflowControllerFindAll:(t={})=>this.request({path:"/workflow",method:"GET",secure:!0,format:"json",...t}),workflowControllerCreate:(t,r={})=>this.request({path:"/workflow",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),workflowControllerFindOne:(t,r={})=>this.request({path:`/workflow/${t}`,method:"GET",secure:!0,format:"json",...r}),workflowControllerDelete:(t,r={})=>this.request({path:`/workflow/${t}`,method:"DELETE",secure:!0,format:"json",...r}),workflowControllerUpdate:(t,r,a={})=>this.request({path:`/workflow/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),workflowControllerGenerateFromTranscripts:(t,r={})=>this.request({path:"/workflow/generate",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r})});ee(this,"squad",{squadControllerCreate:(t,r={})=>this.request({path:"/squad",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),squadControllerFindAll:(t,r={})=>this.request({path:"/squad",method:"GET",query:t,secure:!0,format:"json",...r}),squadControllerFindOne:(t,r={})=>this.request({path:`/squad/${t}`,method:"GET",secure:!0,format:"json",...r}),squadControllerUpdate:(t,r,a={})=>this.request({path:`/squad/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),squadControllerRemove:(t,r={})=>this.request({path:`/squad/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"testSuite",{testSuiteControllerFindAllPaginated:(t,r={})=>this.request({path:"/test-suite",method:"GET",query:t,secure:!0,format:"json",...r}),testSuiteControllerCreate:(t,r={})=>this.request({path:"/test-suite",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),testSuiteControllerFindOne:(t,r={})=>this.request({path:`/test-suite/${t}`,method:"GET",secure:!0,format:"json",...r}),testSuiteControllerUpdate:(t,r,a={})=>this.request({path:`/test-suite/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),testSuiteControllerRemove:(t,r={})=>this.request({path:`/test-suite/${t}`,method:"DELETE",secure:!0,format:"json",...r}),testSuiteTestControllerFindAllPaginated:(t,r,a={})=>this.request({path:`/test-suite/${t}/test`,method:"GET",query:r,secure:!0,format:"json",...a}),testSuiteTestControllerCreate:(t,r,a={})=>this.request({path:`/test-suite/${t}/test`,method:"POST",body:r,secure:!0,type:q.Json,format:"json",...a}),testSuiteTestControllerFindOne:(t,r,a={})=>this.request({path:`/test-suite/${t}/test/${r}`,method:"GET",secure:!0,format:"json",...a}),testSuiteTestControllerUpdate:(t,r,a,i={})=>this.request({path:`/test-suite/${t}/test/${r}`,method:"PATCH",body:a,secure:!0,type:q.Json,format:"json",...i}),testSuiteTestControllerRemove:(t,r,a={})=>this.request({path:`/test-suite/${t}/test/${r}`,method:"DELETE",secure:!0,format:"json",...a}),testSuiteRunControllerFindAllPaginated:(t,r,a={})=>this.request({path:`/test-suite/${t}/run`,method:"GET",query:r,secure:!0,format:"json",...a}),testSuiteRunControllerCreate:(t,r,a={})=>this.request({path:`/test-suite/${t}/run`,method:"POST",body:r,secure:!0,type:q.Json,format:"json",...a}),testSuiteRunControllerFindOne:(t,r,a={})=>this.request({path:`/test-suite/${t}/run/${r}`,method:"GET",secure:!0,format:"json",...a}),testSuiteRunControllerUpdate:(t,r,a,i={})=>this.request({path:`/test-suite/${t}/run/${r}`,method:"PATCH",body:a,secure:!0,type:q.Json,format:"json",...i}),testSuiteRunControllerRemove:(t,r,a={})=>this.request({path:`/test-suite/${t}/run/${r}`,method:"DELETE",secure:!0,format:"json",...a})});ee(this,"analytics",{analyticsControllerQuery:(t,r={})=>this.request({path:"/analytics",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r})});ee(this,"log",{loggingControllerCallLogsQuery:(t,r={})=>this.request({path:"/log",method:"GET",query:t,secure:!0,format:"json",...r}),loggingControllerCallLogsDeleteQuery:(t,r={})=>this.request({path:"/log",method:"DELETE",query:t,secure:!0,...r})});ee(this,"logs",{loggingControllerLogsQuery:(t,r={})=>this.request({path:"/logs",method:"GET",query:t,secure:!0,format:"json",...r}),loggingControllerLogsDeleteQuery:(t,r={})=>this.request({path:"/logs",method:"DELETE",query:t,secure:!0,...r})});ee(this,"org",{orgControllerCreate:(t,r={})=>this.request({path:"/org",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),orgControllerFindAll:(t={})=>this.request({path:"/org",method:"GET",secure:!0,format:"json",...t}),orgControllerFindOne:(t,r={})=>this.request({path:`/org/${t}`,method:"GET",secure:!0,format:"json",...r}),orgControllerUpdate:(t,r,a={})=>this.request({path:`/org/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),orgControllerDeleteOrg:(t,r={})=>this.request({path:`/org/${t}`,method:"DELETE",secure:!0,...r}),orgControllerFindAllUsers:(t,r={})=>this.request({path:`/org/${t}/user`,method:"GET",secure:!0,format:"json",...r}),orgControllerOrgLeave:(t,r={})=>this.request({path:`/org/${t}/leave`,method:"DELETE",secure:!0,...r}),orgControllerOrgRemoveUser:(t,r,a={})=>this.request({path:`/org/${t}/member/${r}/leave`,method:"DELETE",secure:!0,...a}),orgControllerUsersInvite:(t,r,a={})=>this.request({path:`/org/${t}/invite`,method:"POST",body:r,secure:!0,type:q.Json,...a}),orgControllerUserUpdate:(t,r,a={})=>this.request({path:`/org/${t}/role`,method:"PATCH",body:r,secure:!0,type:q.Json,...a}),orgControllerOrgToken:(t,r={})=>this.request({path:`/org/${t}/auth`,method:"GET",secure:!0,format:"json",...r})});ee(this,"token",{tokenControllerCreate:(t,r={})=>this.request({path:"/token",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),tokenControllerFindAll:(t,r={})=>this.request({path:"/token",method:"GET",query:t,secure:!0,format:"json",...r}),tokenControllerFindOne:(t,r={})=>this.request({path:`/token/${t}`,method:"GET",secure:!0,format:"json",...r}),tokenControllerUpdate:(t,r,a={})=>this.request({path:`/token/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),tokenControllerRemove:(t,r={})=>this.request({path:`/token/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"credential",{credentialControllerCreate:(t,r={})=>this.request({path:"/credential",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),credentialControllerFindAll:(t,r={})=>this.request({path:"/credential",method:"GET",query:t,secure:!0,format:"json",...r}),credentialControllerFindOne:(t,r={})=>this.request({path:`/credential/${t}`,method:"GET",secure:!0,format:"json",...r}),credentialControllerUpdate:(t,r,a={})=>this.request({path:`/credential/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),credentialControllerRemove:(t,r={})=>this.request({path:`/credential/${t}`,method:"DELETE",secure:!0,format:"json",...r}),credentialControllerGenerateSession:(t,r={})=>this.request({path:"/credential/session",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),credentialControllerHandleWebhook:(t,r={})=>this.request({path:"/credential/webhook",method:"POST",body:t,type:q.Json,...r}),credentialControllerCredentialActionTrigger:(t,r={})=>this.request({path:"/credential/trigger",method:"POST",body:t,secure:!0,type:q.Json,...r})});ee(this,"template",{templateControllerCreate:(t,r={})=>this.request({path:"/template",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),templateControllerFindAll:(t,r={})=>this.request({path:"/template",method:"GET",query:t,secure:!0,format:"json",...r}),templateControllerFindAllPinned:(t={})=>this.request({path:"/template/pinned",method:"GET",secure:!0,format:"json",...t}),templateControllerFindOne:(t,r={})=>this.request({path:`/template/${t}`,method:"GET",secure:!0,format:"json",...r}),templateControllerUpdate:(t,r,a={})=>this.request({path:`/template/${t}`,method:"PATCH",body:r,secure:!0,type:q.Json,format:"json",...a}),templateControllerRemove:(t,r={})=>this.request({path:`/template/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"voiceLibrary",{voiceLibraryControllerVoiceGetByProvider:(t,r,a={})=>this.request({path:`/voice-library/${t}`,method:"GET",query:r,secure:!0,format:"json",...a}),voiceLibraryControllerVoiceGetAccentsByProvider:(t,r={})=>this.request({path:`/voice-library/${t}/accents`,method:"GET",secure:!0,format:"json",...r}),voiceLibraryControllerVoiceLibrarySyncByProvider:(t,r={})=>this.request({path:`/voice-library/sync/${t}`,method:"POST",secure:!0,format:"json",...r}),voiceLibraryControllerVoiceLibrarySyncDefaultVoices:(t,r={})=>this.request({path:"/voice-library/sync",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...r}),voiceLibraryControllerVoiceLibraryCreateSesameVoice:(t,r={})=>this.request({path:"/voice-library/create-sesame-voice",method:"POST",body:t,secure:!0,type:q.Json,...r})});ee(this,"provider",{providerControllerGetWorkflows:(t,r,a={})=>this.request({path:`/${t}/workflows`,method:"GET",query:r,secure:!0,format:"json",...a}),providerControllerGetWorkflowTriggerHook:(t,r,a={})=>this.request({path:`/${t}/workflows/${r}/hooks`,method:"GET",secure:!0,format:"json",...a}),providerControllerGetLocations:(t,r={})=>this.request({path:`/${t}/locations`,method:"GET",secure:!0,format:"json",...r}),voiceProviderControllerSearchVoices:(t,r,a={})=>this.request({path:`/${t}/voices/search`,method:"GET",query:r,secure:!0,format:"json",...a}),voiceProviderControllerSearchVoice:(t,r,a={})=>this.request({path:`/${t}/voice/search`,method:"GET",query:r,secure:!0,format:"json",...a}),voiceProviderControllerAddVoices:(t,r,a={})=>this.request({path:`/${t}/voices/add`,method:"POST",body:r,secure:!0,type:q.Json,format:"json",...a}),voiceProviderControllerAddVoice:(t,r,a={})=>this.request({path:`/${t}/voice/add`,method:"POST",body:r,secure:!0,type:q.Json,format:"json",...a})});ee(this,"v11Labs",{voiceProviderControllerCloneVoices:(t,r={})=>this.request({path:"/11labs/voice/clone",method:"POST",body:t,secure:!0,type:q.FormData,...r})})}}At.Api=Bh;Object.defineProperty(jr,"__esModule",{value:!0});jr.client=void 0;const $h=At,Jh=new $h.Api({baseUrl:"https://api.vapi.ai",baseApiParams:{secure:!0},securityWorker:async s=>{if(s)return{headers:{Authorization:`Bearer ${s}`}}}});jr.client=Jh;var jc=ya&&ya.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ko,"__esModule",{value:!0});const Gh=jc(Ph),zh=jc(qh),Jr=jr;async function Yh(s,e){s.muted=!1,s.autoplay=!0,e!=null&&(s.srcObject=new MediaStream([e]),await s.play())}async function Wh(s,e){const t=document.createElement("audio");return t.dataset.participantId=e,document.body.appendChild(t),await Yh(t,s),t}function Hh(s){const e=document.querySelector(`audio[data-participant-id="${s}"]`);e==null||e.remove()}function Kh(s,e,t,r){s.participant.local||e.updateParticipant(s.participant.session_id,{setSubscribedTracks:{audio:!0,video:t||r}})}class Qh extends zh.default{on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}emit(e,...t){return super.emit(e,...t)}removeListener(e,t){return super.removeListener(e,t),this}removeAllListeners(e){return super.removeAllListeners(e),this}}class Xh extends Qh{constructor(t,r,a,i){super();ee(this,"started",!1);ee(this,"call",null);ee(this,"speakingTimeout",null);ee(this,"dailyCallConfig",{});ee(this,"dailyCallObject",{});ee(this,"hasEmittedCallEndedStatus",!1);Jr.client.baseUrl=r??"https://api.vapi.ai",Jr.client.setSecurityData(t),this.dailyCallConfig=a??{},this.dailyCallObject=i??{}}cleanup(){var t;this.started=!1,this.hasEmittedCallEndedStatus=!1,(t=this.call)==null||t.destroy(),this.call=null,this.speakingTimeout=null}isMobileDevice(){if(typeof navigator>"u")return!1;const t=navigator.userAgent;return/android|iphone|ipad|ipod|iemobile|blackberry|bada/i.test(t.toLowerCase())}async sleep(t){return new Promise(r=>setTimeout(r,t))}async start(t,r,a,i,l){var d,m,g,_,T,N,k;const c=Date.now();if(!t&&!a&&!i){const y=new Error("Assistant or Squad or Workflow must be provided.");throw this.emit("error",{type:"validation-error",stage:"input-validation",message:y.message,timestamp:new Date().toISOString()}),y}if(this.started)return this.emit("call-start-progress",{stage:"validation",status:"failed",timestamp:new Date().toISOString(),metadata:{reason:"already-started"}}),null;this.emit("call-start-progress",{stage:"initialization",status:"started",timestamp:new Date().toISOString(),metadata:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i}}),this.started=!0;try{this.emit("call-start-progress",{stage:"web-call-creation",status:"started",timestamp:new Date().toISOString()});const y=Date.now(),w=(await Jr.client.call.callControllerCreateWebCall({assistant:typeof t=="string"?void 0:t,assistantId:typeof t=="string"?t:void 0,assistantOverrides:r,squad:typeof a=="string"?void 0:a,squadId:typeof a=="string"?a:void 0,workflow:typeof i=="string"?void 0:i,workflowId:typeof i=="string"?i:void 0,workflowOverrides:l})).data,C=Date.now()-y;this.emit("call-start-progress",{stage:"web-call-creation",status:"completed",duration:C,timestamp:new Date().toISOString(),metadata:{callId:(w==null?void 0:w.id)||"unknown",videoRecordingEnabled:((d=w==null?void 0:w.artifactPlan)==null?void 0:d.videoRecordingEnabled)??!1,voiceProvider:((g=(m=w==null?void 0:w.assistant)==null?void 0:m.voice)==null?void 0:g.provider)||"unknown"}}),this.call&&(this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"started",timestamp:new Date().toISOString(),metadata:{action:"cleanup-existing"}}),this.cleanup());const I=((_=w==null?void 0:w.artifactPlan)==null?void 0:_.videoRecordingEnabled)??!1,E=((N=(T=w==null?void 0:w.assistant)==null?void 0:T.voice)==null?void 0:N.provider)==="tavus";this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"started",timestamp:new Date().toISOString(),metadata:{audioSource:this.dailyCallObject.audioSource??!0,videoSource:this.dailyCallObject.videoSource??I,isVideoRecordingEnabled:I,isVideoEnabled:E}});const O=Date.now();try{this.call=Gh.default.createCallObject({audioSource:this.dailyCallObject.audioSource??!0,videoSource:this.dailyCallObject.videoSource??I,dailyConfig:this.dailyCallConfig});const A=Date.now()-O;this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"completed",duration:A,timestamp:new Date().toISOString()})}catch(A){const z=Date.now()-O;throw this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"failed",duration:z,timestamp:new Date().toISOString(),metadata:{error:A==null?void 0:A.toString()}}),this.emit("error",{type:"daily-call-object-creation-error",stage:"daily-call-object-creation",error:A,timestamp:new Date().toISOString()}),A}(k=this.call.iframe())==null||k.style.setProperty("display","none"),this.call.on("left-meeting",()=>{var A;this.emit("call-end"),this.hasEmittedCallEndedStatus||(this.emit("message",{type:"status-update",status:"ended",endedReason:"customer-ended-call"}),this.hasEmittedCallEndedStatus=!0),I&&((A=this.call)==null||A.stopRecording()),this.cleanup()}),this.call.on("error",A=>{var z;this.emit("error",A),I&&((z=this.call)==null||z.stopRecording())}),this.call.on("camera-error",A=>{this.emit("camera-error",A)}),this.call.on("network-quality-change",A=>{this.emit("network-quality-change",A)}),this.call.on("network-connection",A=>{this.emit("network-connection",A)}),this.call.on("track-started",async A=>{var z,j,F;!A||!A.participant||(z=A.participant)!=null&&z.local||((j=A.participant)==null?void 0:j.user_name)==="Vapi Speaker"&&(A.track.kind==="video"&&this.emit("video",A.track),A.track.kind==="audio"&&await Wh(A.track,A.participant.session_id),(F=this.call)==null||F.sendAppMessage("playable"))}),this.call.on("participant-joined",A=>{!A||!this.call||Kh(A,this.call,I,E)}),this.call.on("participant-updated",A=>{A&&this.emit("daily-participant-updated",A.participant)}),this.call.on("participant-left",A=>{A&&Hh(A.participant.session_id)});const p=this.isMobileDevice();if(this.emit("call-start-progress",{stage:"mobile-permissions",status:"started",timestamp:new Date().toISOString(),metadata:{isMobile:p}}),p){const A=Date.now();await this.sleep(1e3);const z=Date.now()-A;this.emit("call-start-progress",{stage:"mobile-permissions",status:"completed",duration:z,timestamp:new Date().toISOString(),metadata:{action:"permissions-wait"}})}else this.emit("call-start-progress",{stage:"mobile-permissions",status:"completed",timestamp:new Date().toISOString(),metadata:{action:"skipped-not-mobile"}});this.emit("call-start-progress",{stage:"daily-call-join",status:"started",timestamp:new Date().toISOString()});const B=Date.now();try{await this.call.join({url:w.webCallUrl,subscribeToTracksAutomatically:!1});const A=Date.now()-B;this.emit("call-start-progress",{stage:"daily-call-join",status:"completed",duration:A,timestamp:new Date().toISOString()})}catch(A){const z=Date.now()-B;throw this.emit("call-start-progress",{stage:"daily-call-join",status:"failed",duration:z,timestamp:new Date().toISOString(),metadata:{error:A==null?void 0:A.toString()}}),this.emit("error",{type:"daily-call-join-error",stage:"daily-call-join",error:A,duration:z,timestamp:new Date().toISOString()}),A}if(I){this.emit("call-start-progress",{stage:"video-recording-setup",status:"started",timestamp:new Date().toISOString()});const A=new Date().getTime(),z=Date.now();try{this.call.startRecording({width:1280,height:720,backgroundColor:"#FF1F2D3D",layout:{preset:"default"}});const j=Date.now()-z;this.emit("call-start-progress",{stage:"video-recording-setup",status:"completed",duration:j,timestamp:new Date().toISOString()}),this.call.on("recording-started",()=>{const F=(new Date().getTime()-A)/1e3;this.emit("call-start-progress",{stage:"video-recording-started",status:"completed",timestamp:new Date().toISOString(),metadata:{delaySeconds:F}}),this.send({type:"control",control:"say-first-message",videoRecordingStartDelaySeconds:F})})}catch(j){const F=Date.now()-z;this.emit("call-start-progress",{stage:"video-recording-setup",status:"failed",duration:F,timestamp:new Date().toISOString(),metadata:{error:j==null?void 0:j.toString()}}),this.emit("error",{type:"video-recording-setup-error",stage:"video-recording-setup",error:j,timestamp:new Date().toISOString()})}}else this.emit("call-start-progress",{stage:"video-recording-setup",status:"completed",timestamp:new Date().toISOString(),metadata:{action:"skipped-not-enabled"}});this.emit("call-start-progress",{stage:"audio-observer-setup",status:"started",timestamp:new Date().toISOString()});const K=Date.now();try{this.call.startRemoteParticipantsAudioLevelObserver(100);const A=Date.now()-K;this.emit("call-start-progress",{stage:"audio-observer-setup",status:"completed",duration:A,timestamp:new Date().toISOString()})}catch(A){const z=Date.now()-K;this.emit("call-start-progress",{stage:"audio-observer-setup",status:"failed",duration:z,timestamp:new Date().toISOString(),metadata:{error:A==null?void 0:A.toString()}}),this.emit("error",{type:"audio-observer-setup-error",stage:"audio-observer-setup",error:A,timestamp:new Date().toISOString()})}this.call.on("remote-participants-audio-level",A=>{A&&this.handleRemoteParticipantsAudioLevel(A)}),this.call.on("app-message",A=>this.onAppMessage(A)),this.call.on("nonfatal-error",A=>{var z;(A==null?void 0:A.type)==="audio-processor-error"&&((z=this.call)==null||z.updateInputSettings({audio:{processor:{type:"none"}}}).then(()=>{var j;(j=this.call)==null||j.setLocalAudio(!0)}))}),this.emit("call-start-progress",{stage:"audio-processing-setup",status:"started",timestamp:new Date().toISOString()});const R=Date.now();try{this.call.updateInputSettings({audio:{processor:{type:"noise-cancellation"}}});const A=Date.now()-R;this.emit("call-start-progress",{stage:"audio-processing-setup",status:"completed",duration:A,timestamp:new Date().toISOString()})}catch(A){const z=Date.now()-R;this.emit("call-start-progress",{stage:"audio-processing-setup",status:"failed",duration:z,timestamp:new Date().toISOString(),metadata:{error:A==null?void 0:A.toString()}}),this.emit("error",{type:"audio-processing-setup-error",stage:"audio-processing-setup",error:A,timestamp:new Date().toISOString()})}const he=Date.now()-c;return this.emit("call-start-success",{totalDuration:he,callId:(w==null?void 0:w.id)||"unknown",timestamp:new Date().toISOString()}),w}catch(y){const w=Date.now()-c;return this.emit("call-start-failed",{stage:"unknown",totalDuration:w,error:(y==null?void 0:y.toString())||"Unknown error occurred",errorStack:y instanceof Error?y.stack:"No stack trace available",timestamp:new Date().toISOString(),context:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i,isMobile:this.isMobileDevice()}}),this.emit("error",{type:"start-method-error",stage:"unknown",error:y,totalDuration:w,timestamp:new Date().toISOString(),context:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i,isMobile:this.isMobileDevice()}}),this.cleanup(),null}}onAppMessage(t){if(t)try{if(t.data==="listening")return this.emit("call-start");try{const r=JSON.parse(t.data);this.emit("message",r),r&&"type"in r&&"status"in r&&r.type==="status-update"&&r.status==="ended"&&(this.hasEmittedCallEndedStatus=!0)}catch(r){console.log("Error parsing message data: ",r)}}catch(r){console.error(r)}}handleRemoteParticipantsAudioLevel(t){const r=Object.values(t.participantsAudioLevel).reduce((i,l)=>i+l,0);this.emit("volume-level",Math.min(1,r/.15)),r>.01&&(this.speakingTimeout?(clearTimeout(this.speakingTimeout),this.speakingTimeout=null):this.emit("speech-start"),this.speakingTimeout=setTimeout(()=>{this.emit("speech-end"),this.speakingTimeout=null},1e3))}stop(){var t;this.started=!1,(t=this.call)==null||t.destroy(),this.call=null}send(t){var r;(r=this.call)==null||r.sendAppMessage(JSON.stringify(t))}setMuted(t){if(!this.call)throw new Error("Call object is not available.");this.call.setLocalAudio(!t)}isMuted(){return this.call?this.call.localAudio()===!1:!1}say(t,r,a,i){this.send({type:"say",message:t,endCallAfterSpoken:r,interruptionsEnabled:a??!1,interruptAssistantEnabled:i??!1})}setInputDevicesAsync(t){var r;(r=this.call)==null||r.setInputDevicesAsync(t)}async increaseMicLevel(t){if(!this.call)throw new Error("Call object is not available.");try{const r=await navigator.mediaDevices.getUserMedia({audio:!0}),a=new AudioContext,i=a.createMediaStreamSource(r),l=a.createGain();l.gain.value=t,i.connect(l);const c=a.createMediaStreamDestination();l.connect(c);const[d]=c.stream.getAudioTracks();await this.call.setInputDevicesAsync({audioSource:d})}catch(r){console.error("Error adjusting microphone level:",r)}}setOutputDeviceAsync(t){var r;(r=this.call)==null||r.setOutputDeviceAsync(t)}getDailyCallObject(){return this.call}startScreenSharing(t,r){var a;(a=this.call)==null||a.startScreenShare({displayMediaOptions:t,screenVideoSendSettings:r})}stopScreenSharing(){var t;(t=this.call)==null||t.stopScreenShare()}}var vs=ko.default=Xh;const Zh=({agentId:s,agentName:e="AI Assistant",agentConfig:t,onCallStart:r,onCallEnd:a,onError:i})=>{const l="eb3b26e3-7dbb-4fd6-a545-a954756a43aa",c=Y.useRef(null),d=Y.useRef(null),[m,g]=Y.useState({isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,volumeLevel:0,callDuration:0,status:"idle",callId:void 0}),[_,T]=Y.useState([]),N=Y.useRef(null),k=l!=="your-vapi-public-key-here";console.log("🔍 VAPI Debug Info:"),console.log("- Vapi class available:",typeof vs),console.log("- Public API Key:",`${l.substring(0,8)}...`),console.log("- Is configured:",k),Y.useEffect(()=>{console.log("🔧 Initializing VAPI for agent:",s),console.log("🔑 Public API Key:",`${l.substring(0,8)}...`),console.log("✅ Is VAPI Configured:",k);try{console.log("🧪 Testing VAPI import..."),console.log("- Vapi constructor:",vs),console.log("- typeof Vapi:",typeof vs),typeof vs=="function"?console.log("✅ VAPI import successful"):console.error("❌ VAPI import failed - not a constructor")}catch(j){console.error("❌ VAPI import test failed:",j)}try{c.current=new vs(l),console.log("✅ VAPI instance created successfully"),y()}catch(j){console.error("❌ Failed to initialize VAPI:",j),X.error("Failed to initialize VAPI. Please check your API key.")}return()=>{c.current&&c.current.stop(),N.current&&clearInterval(N.current),d.current&&(d.current.getTracks().forEach(j=>j.stop()),d.current=null)}},[l,s]);const y=()=>{c.current&&(c.current.on("call-start",()=>{console.log("🎙️ VAPI call started"),g(j=>({...j,isConnected:!0,isConnecting:!1,status:"connected",callId:Date.now().toString()})),w(),X.success("Call connected! You can now speak."),r==null||r()}),c.current.on("call-end",()=>{console.log("📞 VAPI call ended successfully"),g(j=>({...j,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"ended",callId:void 0})),N.current&&(clearInterval(N.current),N.current=null),d.current&&(d.current.getTracks().forEach(j=>j.stop()),d.current=null),X.success("Call ended successfully"),a==null||a()}),c.current.on("error",j=>{console.error("❌ VAPI call error:",j),g(F=>({...F,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"error",callId:void 0})),N.current&&(clearInterval(N.current),N.current=null),X.error(`Call error: ${j.message||"Unknown error"}`),i==null||i(j)}),c.current.on("speech-start",()=>{console.log("🗣️ Speech started")}),c.current.on("speech-end",()=>{console.log("🤐 Speech ended")}),c.current.on("volume-level",j=>{g(F=>({...F,volumeLevel:j}))}),c.current.on("message",j=>{if(console.log("📨 VAPI message:",j),j.type==="transcript"&&j.transcript){const F={role:j.role||"assistant",content:j.transcript,timestamp:new Date,type:"transcript"};T(D=>[...D,F])}}),c.current.on("error",j=>{console.error("❌ VAPI error:",j),g(D=>({...D,isConnected:!1,isConnecting:!1,status:"error"}));let F="Unknown error";j.message&&(F=j.message,j.message.includes("assistant")&&j.message.includes("not found")?F="Assistant not found in VAPI. Please ensure the agent is properly synced with VAPI dashboard.":j.message.includes("unauthorized")||j.message.includes("401")?F="Unauthorized access. Please check your VAPI API key configuration.":(j.message.includes("microphone")||j.message.includes("permission"))&&(F="Microphone permission denied. Please allow microphone access and try again.")),X.error(`Call error: ${F}`),i==null||i(j)}))},w=()=>{N.current=setInterval(()=>{g(j=>({...j,callDuration:j.callDuration+1}))},1e3)},C=j=>{const F=Math.floor(j/60),D=j%60;return`${F}:${D.toString().padStart(2,"0")}`},I=()=>{const j={name:e,firstMessage:(t==null?void 0:t.firstMessage)||`Hello! I'm ${e}. How can I help you today?`,model:{provider:"openai",model:"gpt-4",temperature:.7,messages:[{role:"system",content:(t==null?void 0:t.systemMessage)||`You are ${e}, a helpful AI assistant. Keep responses conversational and under 30 words when possible.`}]},voice:{provider:"vapi",voiceId:(t==null?void 0:t.voiceId)||"Cole"}};return console.log("📋 Assistant config created:",j),j},E=async()=>{if(console.log("🚀 Starting VAPI agent call for:",s),console.log("🔑 VAPI Public Key:",`${l.substring(0,8)}...`),console.log("🤖 Agent Config:",t),!c.current){X.error("VAPI not initialized. Please check your API key configuration.");return}try{g(F=>({...F,isConnecting:!0,status:"connecting",callDuration:0})),T([]);const j=(t==null?void 0:t.assistant_id)||(t==null?void 0:t.assistantId);if(j){console.log("📞 Using existing assistant ID from database:",j);const F={metadata:{portalAgentId:s,agentName:e,initiatedFrom:"portal"}};console.log("📋 Starting call with assistant ID:",j),console.log("📋 Assistant overrides:",F),await c.current.start(j,F)}else{console.log("🔄 Creating assistant configuration...");const F=I();console.log("📞 Starting agent call with assistant config"),console.log("🤖 Agent Name:",e);const D=F;console.log("📋 Call config:",D),await new Promise(ae=>setTimeout(ae,100)),await c.current.start(D)}}catch(j){console.error("❌ Error starting agent call:",j),g(D=>({...D,isConnecting:!1,status:"error"}));let F="Failed to start call";j.message?(F=j.message,j.message.includes("Authentication")||j.message.includes("401")?F="Authentication failed. Please check your VAPI API key.":j.message.includes("assistant")||j.message.includes("404")?F="Assistant not found. The assistant may not exist in VAPI.":j.message.includes("permission")||j.message.includes("microphone")?F="Microphone permission denied. Please allow microphone access.":(j.message.includes("network")||j.message.includes("fetch"))&&(F="Network error. Please check your internet connection.")):j.code?F=`Error code: ${j.code}`:typeof j=="string"&&(F=j),X.error(`Failed to start call: ${F}`),console.error("📋 Full error details:",j)}},O=()=>{console.log("🛑 Stopping VAPI agent call...");try{c.current?(console.log("📞 VAPI instance found, stopping call..."),c.current.stop(),g(j=>({...j,isConnecting:!1})),console.log("✅ VAPI stop method called successfully")):(console.warn("⚠️ No VAPI instance found to stop"),X.warning("No active call to end"))}catch(j){console.error("❌ Error stopping call:",j),X.error(`Failed to end call: ${(j==null?void 0:j.message)||"Unknown error"}`),g(F=>({...F,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"ended",callId:void 0})),d.current&&(d.current.getTracks().forEach(F=>F.stop()),d.current=null)}},p=async()=>{try{if(!d.current){const j=await navigator.mediaDevices.getUserMedia({audio:!0});d.current=j}return d.current}catch(j){throw console.error("Error initializing media stream:",j),j}},B=()=>{try{if(!m.isConnected||!c.current){X.warning("No active call to mute");return}const j=!m.isMuted;c.current.setMuted(j),g(F=>({...F,isMuted:j})),X.info(j?"Microphone muted":"Microphone unmuted"),console.log(`🎤 Mute toggled: ${j}`)}catch(j){console.error("Error toggling mute:",j),X.error(`Failed to toggle mute: ${(j==null?void 0:j.message)||"Unknown error"}`),K()}},K=async()=>{try{console.log("🔄 Using fallback mute method...");const F=(await p()).getAudioTracks();if(F.length>0){const D=!m.isMuted;F.forEach(ae=>{ae.enabled=!D}),g(ae=>({...ae,isMuted:D})),X.info(D?"Microphone muted (fallback)":"Microphone unmuted (fallback)")}else X.error("No audio tracks found")}catch(j){console.error("Fallback mute also failed:",j),X.error("Failed to toggle mute. Please check microphone permissions.")}},R=async()=>{try{if(!m.isConnected){X.warning("No active call to hold");return}const j=!m.isOnHold;(await p()).getAudioTracks().forEach(ae=>{ae.enabled=!j}),g(ae=>({...ae,isOnHold:j,isMuted:j})),X.info(j?"Call on hold":"Call resumed")}catch(j){console.error("Error toggling hold:",j),X.error("Failed to toggle hold. Please check microphone permissions.")}},he=()=>{const j=document.getElementById("call-button-container");return console.log("🎯 Looking for call-button-container:",j),j?(console.log("🎯 Rendering call button, call state:",m),Vc.createPortal(n.jsxs("div",{className:"flex items-center gap-2",children:[m.isConnected&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"text-sm font-mono font-semibold text-gray-800 bg-white px-3 py-1 rounded-md border border-gray-200",children:C(m.callDuration)}),n.jsx(je,{onClick:B,variant:"outline",size:"sm",className:`border-gray-300 ${m.isMuted?"bg-red-50 text-red-700 hover:bg-red-100":"bg-white hover:bg-gray-50 text-gray-700"}`,title:m.isMuted?"Unmute microphone":"Mute microphone",children:m.isMuted?n.jsx(Ac,{className:"h-4 w-4"}):n.jsx(Wt,{className:"h-4 w-4"})}),n.jsx(je,{onClick:R,variant:"outline",size:"sm",className:`border-gray-300 ${m.isOnHold?"bg-yellow-50 text-yellow-700 hover:bg-yellow-100":"bg-white hover:bg-gray-50 text-gray-700"}`,title:m.isOnHold?"Resume call":"Hold call",children:m.isOnHold?n.jsx(_o,{className:"h-4 w-4"}):n.jsx(xo,{className:"h-4 w-4"})}),n.jsx(je,{variant:"outline",size:"sm",className:"border-gray-300 bg-white hover:bg-gray-50 text-gray-700",title:"Volume control",children:n.jsx(js,{className:"h-4 w-4"})})]}),!m.isConnected&&!m.isConnecting?n.jsxs(je,{onClick:E,size:"sm",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-md transition-all duration-200",children:[n.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Call"]}):m.isConnecting?n.jsxs(je,{size:"sm",className:"px-4 py-2 bg-amber-500 text-white text-sm font-medium rounded-md",disabled:!0,children:[n.jsx(Mt,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting"]}):n.jsxs(je,{onClick:O,size:"sm",className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md transition-all duration-200",children:[n.jsx(Mc,{className:"h-4 w-4 mr-2"}),"End Call"]})]}),j)):(console.warn("⚠️ call-button-container not found!"),null)};console.log("🎯 VapiAgentCall render - isVapiConfigured:",k),console.log("🎯 VapiAgentCall render - callState:",m),console.log("🎯 VapiAgentCall render - agentId:",s),console.log("🎯 VapiAgentCall render - agentName:",e);const[A,z]=Y.useState(!1);return Y.useEffect(()=>{const j=()=>document.getElementById("call-button-container")?(console.log("✅ Found call-button-container"),z(!0),!0):(console.warn("❌ call-button-container not found"),!1);if(j())return;const F=setInterval(()=>{j()&&clearInterval(F)},100);return()=>{clearInterval(F)}},[]),n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[he(),n.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[n.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:n.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[n.jsx(Xs,{className:"h-4 w-4"}),"Conversation"]})}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-white",children:_.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 py-12",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:n.jsx(Xs,{className:"h-8 w-8 text-gray-400"})}),n.jsx("p",{className:"text-center text-sm",children:m.isConnected?"Conversation will appear here...":"Start a call to begin the conversation"})]}):n.jsx("div",{className:"space-y-6",children:_.map((j,F)=>n.jsxs("div",{className:`flex gap-3 ${j.role==="user"?"justify-end":"justify-start"}`,children:[j.role==="assistant"&&n.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0",children:n.jsx(ct,{className:"h-4 w-4 text-gray-600"})}),n.jsxs("div",{className:`max-w-[75%] ${j.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800 border border-gray-200"} rounded-lg px-4 py-3`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`text-xs font-medium ${j.role==="user"?"text-blue-100":"text-gray-500"}`,children:j.role==="user"?"You":e}),n.jsx("span",{className:`text-xs ${j.role==="user"?"text-blue-200":"text-gray-400"}`,children:j.timestamp.toLocaleTimeString()})]}),n.jsx("p",{className:"text-sm leading-relaxed",children:j.content})]}),j.role==="user"&&n.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:n.jsx(wo,{className:"h-4 w-4 text-blue-600"})})]},F))})})]}),n.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-wide mb-1",children:"Assistant"}),n.jsx("p",{className:"font-medium text-gray-900",children:e})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-wide mb-1",children:"Connection"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${m.status==="connected"?"bg-green-500":m.status==="connecting"?"bg-amber-500 animate-pulse":m.status==="error"?"bg-red-500":"bg-gray-400"}`}),n.jsx("span",{className:"text-gray-700 capitalize",children:m.status==="idle"?"Ready":m.status==="connecting"?"Connecting":m.status==="connected"?"Active":m.status==="ended"?"Ended":"Error"})]})]})]})})]})},em=({open:s,onOpenChange:e,onTemplateSelect:t,onCreateCustom:r})=>{const[a,i]=Y.useState(""),[l,c]=Y.useState("all"),[d,m]=Y.useState("initial"),{data:g,isLoading:_}=er({queryKey:["defaultAssistantTemplates",{category:l!=="all"?l:void 0}],queryFn:()=>{const O={is_active:!0};return l!=="all"&&(O.category=l),nu(O)},enabled:s}),{data:T}=er({queryKey:["templateCategories"],queryFn:au,enabled:s}),N=(g==null?void 0:g.data)||[],k=(T==null?void 0:T.data)||[],y=N.filter(O=>O.name.toLowerCase().includes(a.toLowerCase())||O.description.toLowerCase().includes(a.toLowerCase())||O.category.toLowerCase().includes(a.toLowerCase())),w=async O=>{try{const p=await iu(O.template_id);t(p.data),e(!1)}catch(p){console.error("Error using template:",p)}},C=()=>{m("initial"),i(""),c("all")},I=O=>{O||C(),e(O)},E=O=>({Business:"bg-blue-100 text-blue-800",Sales:"bg-green-100 text-green-800",Support:"bg-purple-100 text-purple-800",Scheduling:"bg-orange-100 text-orange-800",General:"bg-gray-100 text-gray-800"})[O]||"bg-gray-100 text-gray-800";return n.jsx(qt,{open:s,onOpenChange:I,children:n.jsxs(Bt,{className:`
    max-w-7xl min-h-[700px] overflow-hidden
    bg-[#020617]
    border border-cyan-400/30
    shadow-[0_0_30px_rgba(34,211,238,0.35)]
    text-slate-200
  `,children:[n.jsx($t,{children:n.jsxs(Jt,{className:"flex items-center gap-2 text-white",children:[n.jsx(ct,{className:"h-5 w-5 text-white"}),d==="initial"?"Choose How to Create Your Assistant":"Select AI Service Provider"]})}),d==="initial"?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs(Ae,{className:`  cursor-pointer
  bg-cyan-500/10
  border border-cyan-400/30
  hover:shadow-[0_0_30px_rgba(34,211,238,0.45)]
  transition`,children:[n.jsx(Le,{className:"pb-3",children:n.jsxs(De,{className:"flex items-center gap-2 text-white",children:[n.jsx(So,{className:"h-5 w-5 text-white"}),"Use Default Template"]})}),n.jsxs(Me,{children:[n.jsx("p",{className:"text-white text-sm mb-4",children:"Start with a pre-configured template designed for specific use cases. Perfect for quick setup with proven configurations."}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-white",children:[n.jsx(Ic,{className:"h-3 w-3 text-white"}),"Recommended for beginners"]})]})]}),n.jsxs(Ae,{className:`cursor-pointer bg-cyan-500/10
  border border-cyan-400/30
  hover:shadow-[0_0_30px_rgba(34,211,238,0.45)] transition`,onClick:()=>m("service_selection"),children:[n.jsx(Le,{className:"pb-3",children:n.jsxs(De,{className:"flex items-center gap-2 text-white",children:[n.jsx(jo,{className:"h-5 w-5 text-white"}),"Create Custom Assistant"]})}),n.jsxs(Me,{children:[n.jsx("p",{className:"text-white text-sm mb-4",children:"Build your assistant from scratch with full control over all settings. Ideal for specific requirements and advanced users."}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-white",children:[n.jsx(ct,{className:"h-3 w-3 text-white"}),"Full customization available"]})]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium",children:"Available Templates"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative",children:[n.jsx(jn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white h-4 w-4  z-10"}),n.jsx(ye,{placeholder:"Search templates...",value:a,onChange:O=>i(O.target.value),className:` pl-10 w-64
    bg-black/40
    border border-cyan-400/30
    text-slate-200
    placeholder:text-slate-500
    focus:ring-cyan-400/50`})]}),n.jsxs(be,{value:l,onValueChange:c,children:[n.jsxs(_e,{className:`
    w-48
    bg-black/40
    border border-cyan-400/30
    text-slate-200
  `,children:[n.jsx(Oc,{className:"h-4 w-4 mr-2"}),n.jsx(xe,{placeholder:"Category"})]}),n.jsxs(we,{className:"bg-[#020617] text-white border border-cyan-400/30",children:[n.jsx(re,{value:"all",children:"All Categories"}),k.map(O=>n.jsxs(re,{value:O.category,children:[O.category," (",O.count,")"]},O.category))]})]})]})]}),n.jsx("div",{className:"max-h-96 overflow-y-auto",children:_?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((O,p)=>n.jsxs(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,children:[n.jsxs(Le,{children:[n.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),n.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),n.jsx(Me,{children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"h-3 bg-gray-200 rounded"}),n.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})})]},p))}):y.length===0?n.jsx(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,children:n.jsxs(Me,{className:"p-8 text-center",children:[n.jsx(ct,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No templates found"}),n.jsx("p",{className:"text-gray-600 mb-4",children:a||l!=="all"?"Try adjusting your search or filter criteria.":"No templates are currently available."}),n.jsx(je,{onClick:()=>m("service_selection"),children:"Create Custom Assistant Instead"})]})}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(O=>n.jsxs(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,onClick:()=>w(O),children:[n.jsx(Le,{className:"pb-3",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx(De,{className:"text-white flex items-center gap-2",children:O.name}),n.jsx("div",{className:"flex items-center gap-2 mt-2",children:n.jsx(Et,{className:E(O.category),children:O.category})})]}),n.jsx(Pc,{className:"h-4 w-4 text-gray-400"})]})}),n.jsxs(Me,{className:"pt-0",children:[n.jsx("p",{className:"text-white/60 text-sm mb-3 line-clamp-2",children:O.description}),n.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500",children:n.jsx(je,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs bg-primary text-white w-full ",children:"Use Template"})})]})]},O.template_id))})})]})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(je,{variant:"ghost",onClick:()=>m("initial"),className:"text-white/60 hover:text-white",children:[n.jsx(Lc,{className:"h-4 w-4 mr-2"}),"Back"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4",children:[n.jsxs(Ae,{className:"cursor-pointer bg-blue-500/10 border border-blue-400/30 hover:shadow-[0_0_30px_rgba(59,130,246,0.45)] transition group",onClick:()=>{r("vapi"),e(!1)},children:[n.jsx(Le,{children:n.jsxs(De,{className:"flex items-center gap-3 text-white text-2xl",children:[n.jsx("div",{className:"p-3 rounded-lg bg-blue-500/20 group-hover:bg-blue-500/30 transition-colors",children:n.jsx(Wt,{className:"h-8 w-8 text-blue-400"})}),"Vapi Service"]})}),n.jsxs(Me,{className:"space-y-4",children:[n.jsx("p",{className:"text-white/80",children:"Advanced voice AI platform with ultra-low latency. Best for complex conversational flows and extensive customization."}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx(Et,{variant:"outline",className:"border-blue-400/30 text-blue-300",children:"Customizable"}),n.jsx(Et,{variant:"outline",className:"border-blue-400/30 text-blue-300",children:"Real-time"})]})]})]}),n.jsxs(Ae,{className:"cursor-pointer bg-purple-500/10 border border-purple-400/30 hover:shadow-[0_0_30px_rgba(168,85,247,0.45)] transition group",onClick:()=>{r("retell"),e(!1)},children:[n.jsx(Le,{children:n.jsxs(De,{className:"flex items-center gap-3 text-white text-2xl",children:[n.jsx("div",{className:"p-3 rounded-lg bg-purple-500/20 group-hover:bg-purple-500/30 transition-colors",children:n.jsx(Zs,{className:"h-8 w-8 text-purple-400"})}),"Retell AI"]})}),n.jsxs(Me,{className:"space-y-4",children:[n.jsx("p",{className:"text-white/80",children:"Powerful telephony and voice agent integration. Ideal for phone-based assistants and seamless call handling."}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx(Et,{variant:"outline",className:"border-purple-400/30 text-purple-300",children:"Telephony"}),n.jsx(Et,{variant:"outline",className:"border-purple-400/30 text-purple-300",children:"Resilient"})]})]})]})]}),n.jsx("div",{className:"text-center text-sm text-white/50 pt-4",children:"Select the service provider that best fits your use case"})]})]})})};function tm({isOpen:s,onClose:e,onSelectVoice:t,voices:r}){const[a,i]=Y.useState("all"),[l,c]=Y.useState(""),[d,m]=Y.useState("all"),[g,_]=Y.useState("all"),[T,N]=Y.useState(null),k=Y.useRef(null);Y.useEffect(()=>{s||y()},[s]);const y=()=>{k.current&&(k.current.pause(),k.current.currentTime=0),N(null)},w=(E,O)=>{var B,K;if(T===E){(B=k.current)!=null&&B.paused?k.current.play():((K=k.current)==null||K.pause(),N(null));return}if(y(),!O)return;const p=new Audio(O);p.onended=()=>N(null),p.onerror=()=>{console.error("Error playing audio preview"),N(null)},k.current=p,p.play().catch(R=>console.error("Play error:",R)),N(E)},C=Y.useMemo(()=>r.filter(E=>{var O,p,B,K,R;if(a!=="all"){const he=((O=E.provider)==null?void 0:O.toLowerCase())||"";if(a==="elevenlabs"&&!he.includes("eleven")||a==="openai"&&!he.includes("openai")||a==="cartesia"&&!he.includes("cartesia")||a==="minimax"&&!he.includes("minimax"))return!1}if(l){const he=l.toLowerCase(),A=((p=E.voice_name)==null?void 0:p.toLowerCase())||"",z=((B=E.voice_id)==null?void 0:B.toLowerCase())||"";if(!A.includes(he)&&!z.includes(he))return!1}return!(d!=="all"&&(((K=E.gender)==null?void 0:K.toLowerCase())||"")!==d||g!=="all"&&!(((R=E.accent)==null?void 0:R.toLowerCase())||"").includes(g))}),[r,a,l,d,g]),I=Y.useMemo(()=>{const E=new Set;return r.forEach(O=>{O.accent&&E.add(O.accent.toLowerCase())}),Array.from(E)},[r]);return n.jsx(qt,{open:s,onOpenChange:E=>!E&&e(),children:n.jsxs(Bt,{className:"sm:max-w-[1200px] rounded-lg h-[80vh] flex flex-col bg-[#0b0f2e] border-white/10 text-white p-0 gap-0",children:[n.jsx($t,{className:"p-6 pb-2 border-b border-white/5",children:n.jsx(Jt,{className:"text-xl font-bold flex items-center gap-2",children:"Select Voice"})}),n.jsxs("div",{className:"p-6 space-y-6 flex-1 overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx(mr,{value:a,onValueChange:i,className:"w-full",children:n.jsxs(pr,{className:"bg-white/5 h-auto p-1 flex-wrap justify-start gap-1 w-full sm:w-auto",children:[n.jsx(Oe,{value:"all",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs px-4 py-2",children:"All"}),n.jsx(Oe,{value:"elevenlabs",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs px-4 py-2",children:"ElevenLabs"}),n.jsx(Oe,{value:"cartesia",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs px-4 py-2",children:"Cartesia"}),n.jsx(Oe,{value:"minimax",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs px-4 py-2",children:"MiniMax"}),n.jsx(Oe,{value:"openai",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs px-4 py-2",children:"OpenAI"})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/40"}),n.jsx(ye,{placeholder:"Search voices...",value:l,onChange:E=>c(E.target.value),className:"pl-9 bg-white/5 border-white/10 text-white focus:border-orange-500/50 placeholder:text-white/30"})]}),n.jsxs(be,{value:d,onValueChange:m,children:[n.jsx(_e,{className:"w-full sm:w-[150px] bg-white/5 border-white/10 text-white focus:border-orange-500/50",children:n.jsx(xe,{placeholder:"Gender"})}),n.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(re,{value:"all",className:"focus:bg-white/10 focus:text-white",children:"All Genders"}),n.jsx(re,{value:"male",className:"focus:bg-white/10 focus:text-white",children:"Male"}),n.jsx(re,{value:"female",className:"focus:bg-white/10 focus:text-white",children:"Female"})]})]}),n.jsxs(be,{value:g,onValueChange:_,children:[n.jsx(_e,{className:"w-full sm:w-[180px] bg-white/5 border-white/10 text-white focus:border-orange-500/50",children:n.jsx(xe,{placeholder:"Accent"})}),n.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(re,{value:"all",className:"focus:bg-white/10 focus:text-white",children:"All Accents"}),I.map(E=>n.jsx(re,{value:E,className:"focus:bg-white/10 focus:text-white capitalize",children:E},E))]})]})]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto neon-fire-scroll rounded-lg border border-white/5 bg-black/20",children:C.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/40 p-8",children:[n.jsx(Wt,{className:"h-12 w-12 mb-4 opacity-20"}),n.jsx("p",{children:"No voices found matching your criteria"})]}):n.jsx("div",{className:"grid grid-cols-1 divide-y divide-white/5",children:C.map(E=>n.jsxs("div",{className:"group flex flex-col sm:flex-row items-center gap-4 p-4 hover:bg-white/5 transition-colors",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(je,{size:"icon",variant:"ghost",className:Zc("h-10 w-10 rounded-full border border-white/10 hover:border-orange-500 hover:text-orange-500",T===E.voice_id&&"border-orange-500 text-orange-500 bg-orange-500/10"),onClick:O=>{O.stopPropagation(),w(E.voice_id,E.preview_audio_url)},children:T===E.voice_id?n.jsx(xo,{className:"h-4 w-4"}):n.jsx(_o,{className:"h-4 w-4 ml-1"})})}),n.jsxs("div",{className:"flex-1 w-full sm:w-auto flex items-center gap-4 cursor-pointer",onClick:()=>t(E.voice_id),children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-orange-500/20 to-purple-500/20 flex items-center justify-center border border-white/10",children:n.jsx(wo,{className:"h-5 w-5 text-white/60"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-medium text-white truncate",children:E.voice_name||"Unnamed Voice"}),n.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-white/5 text-white/40 border border-white/5",children:E.provider||"Retell"})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-white/40",children:[E.gender&&n.jsx("span",{className:"capitalize",children:E.gender}),E.gender&&E.accent&&n.jsx("span",{children:"•"}),E.accent&&n.jsx("span",{className:"capitalize",children:E.accent}),n.jsx("span",{className:"hidden sm:inline-block ml-2 opacity-50 font-mono",children:E.voice_id})]})]})]}),n.jsx("div",{className:"flex-shrink-0 w-full sm:w-auto flex justify-end",children:n.jsx(je,{variant:"outline",className:"bg-transparent border-white/10 hover:bg-orange-500 hover:text-white hover:border-orange-500 text-xs h-8",onClick:()=>t(E.voice_id),children:"Select"})})]},E.voice_id))})})]})]})})}const sm=[{value:"default",label:"Default"},{value:"eleven_turbo_v2",label:"Eleven Turbo v2"},{value:"eleven_flash_v2",label:"Eleven Flash v2"},{value:"eleven_turbo_v2_5",label:"Eleven Turbo v2.5"},{value:"eleven_flash_v2_5",label:"Eleven Flash v2.5"},{value:"eleven_multilingual_v2",label:"Eleven Multilingual v2"},{value:"sonic-2",label:"Sonic 2"},{value:"sonic-3",label:"Sonic 3"},{value:"sonic-3-latest",label:"Sonic 3 Latest"},{value:"sonic-turbo",label:"Sonic Turbo"},{value:"tts-1",label:"TTS-1"},{value:"gpt-4o-mini-tts",label:"GPT-4o Mini TTS"},{value:"speech-02-turbo",label:"Speech 02 Turbo"}],rm=[{value:"none",label:"None (Default)"},{value:"calm",label:"Calm"},{value:"sympathetic",label:"Sympathetic"},{value:"happy",label:"Happy"},{value:"sad",label:"Sad"},{value:"angry",label:"Angry"},{value:"fearful",label:"Fearful"},{value:"surprised",label:"Surprised"}],nm=[{value:"none",label:"None"},{value:"coffee-shop",label:"Coffee Shop"},{value:"convention-hall",label:"Convention Hall"},{value:"summer-outdoor",label:"Summer Outdoor"},{value:"mountain-outdoor",label:"Mountain Outdoor"},{value:"static-noise",label:"Static Noise"},{value:"call-center",label:"Call Center"}],am=[{value:"en-US",label:"English (US)"},{value:"en-GB",label:"English (UK)"},{value:"en-AU",label:"English (Australia)"},{value:"en-IN",label:"English (India)"},{value:"es-ES",label:"Spanish (Spain)"},{value:"es-419",label:"Spanish (Latin America)"},{value:"fr-FR",label:"French (France)"},{value:"fr-CA",label:"French (Canada)"},{value:"de-DE",label:"German"},{value:"it-IT",label:"Italian"},{value:"pt-BR",label:"Portuguese (Brazil)"},{value:"pt-PT",label:"Portuguese (Portugal)"},{value:"zh-CN",label:"Chinese (Simplified)"},{value:"ja-JP",label:"Japanese"},{value:"ko-KR",label:"Korean"},{value:"hi-IN",label:"Hindi"},{value:"ar-SA",label:"Arabic"},{value:"nl-NL",label:"Dutch"},{value:"pl-PL",label:"Polish"},{value:"ru-RU",label:"Russian"},{value:"tr-TR",label:"Turkish"},{value:"multi",label:"Multilingual"}],im=[{value:"fast",label:"Fast"},{value:"accurate",label:"Accurate"},{value:"custom",label:"Custom"}],om=[{value:"general",label:"General"},{value:"medical",label:"Medical"}],lm=[{value:"none",label:"None"},{value:"noise-cancellation",label:"Noise Cancellation"},{value:"noise-and-background-speech-cancellation",label:"Noise + Background Speech Cancellation"}],cm=[{value:"everything",label:"Everything"},{value:"everything_except_pii",label:"Everything except PII"},{value:"basic_attributes_only",label:"Basic Attributes Only"}],um=[{value:"gpt-4.1-mini",label:"GPT-4.1 Mini (Default)"},{value:"gpt-4.1",label:"GPT-4.1"},{value:"gpt-4.1-nano",label:"GPT-4.1 Nano"},{value:"claude-4.5-sonnet",label:"Claude 4.5 Sonnet"},{value:"claude-4.5-haiku",label:"Claude 4.5 Haiku"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"}],dm=[{value:"gpt-4.1",label:"GPT-4.1"},{value:"gpt-4.1-mini",label:"GPT-4.1 Mini"},{value:"gpt-4.1-nano",label:"GPT-4.1 Nano"},{value:"gpt-5",label:"GPT-5"},{value:"gpt-5-mini",label:"GPT-5 Mini"},{value:"claude-4.5-sonnet",label:"Claude 4.5 Sonnet"},{value:"claude-4.5-haiku",label:"Claude 4.5 Haiku"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"gemini-3.0-flash",label:"Gemini 3.0 Flash"}],hm=[{value:"single_prompt",label:"Single Prompt Agent",description:"Simple AI agent using one LLM for all conversations"},{value:"conversation_flow",label:"Conversation Flow Agent",description:"Advanced agent with workflow logic (requires workflow configuration in Retell dashboard)"},{value:"custom_llm",label:"Custom LLM",description:"Use your own LLM via webhook (requires webhook URL configuration)"},{value:"multi_prompt_legacy",label:"Multi-Prompt Agent (Legacy)",description:"Deprecated - Use Single Prompt instead"}];function mm({isOpen:s,onClose:e,onSuccess:t}){var W,Pt,ut,$e;const[r,a]=Y.useState([]),[i,l]=Y.useState([]),[c,d]=Y.useState([]),[m,g]=Y.useState(!1),[_,T]=Y.useState(!1),[N,k]=Y.useState("voice"),[y,w]=Y.useState(!1),[C,I]=Y.useState(!1),[E,O]=Y.useState(!1),[p,B]=Y.useState({agent_type:"single_prompt",agent_name:"",version_description:"",voice_id:"",voice_model:"default",fallback_voice_ids:"",voice_temperature:1,voice_speed:1,volume:1,voice_emotion:"none",llm_id:"",new_llm_model:"gpt-4.1",new_llm_begin_message:"",new_llm_general_prompt:"",new_llm_start_speaker:"agent",new_llm_temperature:0,workflow_id:"",create_new_workflow:!1,new_workflow_name:"",new_workflow_steps:"",custom_llm_websocket_url:"",custom_llm_api_key:"",responsiveness:1,interruption_sensitivity:1,enable_backchannel:!1,backchannel_frequency:.8,backchannel_words:"",reminder_trigger_ms:1e4,reminder_max_count:1,ambient_sound:"none",ambient_sound_volume:1,begin_message_delay_ms:0,end_call_after_silence_ms:6e5,max_call_duration_ms:36e5,ring_duration_ms:3e4,language:"en-US",boosted_keywords:"",stt_mode:"fast",vocab_specialization:"general",denoising_mode:"noise-cancellation",normalize_for_speech:!0,enable_voicemail_detection:!1,voicemail_message:"",voicemail_detection_timeout_ms:3e4,webhook_url:"",webhook_timeout_ms:1e4,post_call_analysis_model:"gpt-4.1-mini",analysis_successful_prompt:"",analysis_summary_prompt:"",data_storage_setting:"everything",opt_in_signed_url:!1,allow_user_dtmf:!0,is_public:!1});Y.useEffect(()=>{s&&K()},[s]);const K=async()=>{g(!0);try{const[b,Ee]=await Promise.all([ps.get("/api/retell/voices"),ps.get("/api/retell/llms")]);a(b.data.data||[]),l(Ee.data.data||[])}catch(b){console.error("Error fetching Retell data:",b),X.error("Failed to load Retell options")}finally{g(!1)}},R=(b,Ee)=>{B(o=>({...o,[b]:Ee}))},he=async b=>{var Ee,o,h,u,f;b.preventDefault(),T(!0);try{let v=p.llm_id;if(y){if(!p.new_llm_general_prompt.trim()){X.error("General Prompt is required when creating a new LLM"),T(!1);return}I(!0);const M={model:p.new_llm_model,start_speaker:p.new_llm_start_speaker,model_temperature:p.new_llm_temperature,general_prompt:p.new_llm_general_prompt};p.new_llm_begin_message.trim()&&(M.begin_message=p.new_llm_begin_message),console.log("Creating new LLM:",M),v=(await ps.post("/api/retell/create-llm",M)).data.data.llm_id,console.log("New LLM created with ID:",v),X.success("LLM created successfully"),I(!1)}if(!v){if(p.agent_type==="custom_llm"&&!p.custom_llm_websocket_url){X.error("Custom LLM requires selecting an existing LLM or creating a new one (or provide webhook URL)"),T(!1);return}if(p.agent_type==="single_prompt"){X.error("Single Prompt Agent requires selecting an LLM or creating a new one"),T(!1);return}if(p.agent_type==="conversation_flow"){X.error("Conversation Flow requires selecting an LLM or creating a new one"),T(!1);return}X.error("Please select an LLM or create a new one"),T(!1);return}const x={agent_name:p.agent_name,voice_id:p.voice_id};switch(p.agent_type){case"single_prompt":case"multi_prompt_legacy":x.response_engine={type:"retell-llm",llm_id:v},p.agent_type==="multi_prompt_legacy"&&console.log("Note: Multi-Prompt Legacy is deprecated. It will appear as Single Prompt in Retell dashboard.");break;case"conversation_flow":try{console.log("Creating conversation flow for agent..."),X.info("Creating conversation flow...",{duration:3e3});const M={name:`${p.agent_name} Flow`,model_choice:{model:p.new_llm_model||"gpt-4o",type:"cascading"},start_speaker:"agent",start_node_id:"start",nodes:[{id:"start",type:"conversation",instruction:{type:"prompt",text:p.new_llm_general_prompt||"You are a helpful assistant."},edges:[{id:"edge_start_to_end",destination_node_id:"end",transition_condition:{type:"prompt",prompt:"User says goodbye or wants to end the call"}}]},{id:"end",type:"end"}]};console.log("Creating conversation flow with payload:",M);const L=await ps.post("/api/retell/create-conversation-flow",M),V=L.data.conversation_flow_id||((Ee=L.data.data)==null?void 0:Ee.conversation_flow_id)||L.data.id;if(!V)throw new Error("Conversation flow created but no ID returned");console.log("Conversation flow created successfully with ID:",V),X.success("Conversation flow created!"),x.response_engine={type:"conversation-flow",conversation_flow_id:V},console.log("Creating Conversation Flow agent with flow:",V)}catch(M){console.error("Error creating conversation flow:",M);const L=((h=(o=M.response)==null?void 0:o.data)==null?void 0:h.message)||M.message;X.error("Failed to create conversation flow: "+L,{duration:6e3}),T(!1);return}break;case"custom_llm":p.custom_llm_websocket_url?x.response_engine={type:"custom-llm",websocket_url:p.custom_llm_websocket_url,api_key:p.custom_llm_api_key}:(x.response_engine={type:"retell-llm",llm_id:v},console.log("Note: Custom LLM requires webhook URL. Using retell-llm as fallback."),X.info("Custom LLM created with standard engine. Add webhook URL for custom behavior.",{duration:5e3}));break;default:x.response_engine={type:"retell-llm",llm_id:v}}p.version_description&&(x.version_description=p.version_description),p.voice_model!=="default"&&(x.voice_model=p.voice_model),p.fallback_voice_ids.trim()&&(x.fallback_voice_ids=p.fallback_voice_ids.split(",").map(M=>M.trim()).filter(Boolean)),p.voice_temperature!==1&&(x.voice_temperature=p.voice_temperature),p.voice_speed!==1&&(x.voice_speed=p.voice_speed),p.volume!==1&&(x.volume=p.volume),p.voice_emotion!=="none"&&(x.voice_emotion=p.voice_emotion),p.responsiveness!==1&&(x.responsiveness=p.responsiveness),p.interruption_sensitivity!==1&&(x.interruption_sensitivity=p.interruption_sensitivity),p.enable_backchannel&&(x.enable_backchannel=!0,p.backchannel_frequency!==.8&&(x.backchannel_frequency=p.backchannel_frequency),p.backchannel_words.trim()&&(x.backchannel_words=p.backchannel_words.split(",").map(M=>M.trim()).filter(Boolean))),p.reminder_trigger_ms!==1e4&&(x.reminder_trigger_ms=p.reminder_trigger_ms),p.reminder_max_count!==1&&(x.reminder_max_count=p.reminder_max_count),p.ambient_sound!=="none"&&(x.ambient_sound=p.ambient_sound,p.ambient_sound_volume!==1&&(x.ambient_sound_volume=p.ambient_sound_volume)),p.begin_message_delay_ms>0&&(x.begin_message_delay_ms=p.begin_message_delay_ms),p.end_call_after_silence_ms!==6e5&&(x.end_call_after_silence_ms=p.end_call_after_silence_ms),p.max_call_duration_ms!==36e5&&(x.max_call_duration_ms=p.max_call_duration_ms),p.ring_duration_ms!==3e4&&(x.ring_duration_ms=p.ring_duration_ms),p.language!=="en-US"&&(x.language=p.language),p.boosted_keywords.trim()&&(x.boosted_keywords=p.boosted_keywords.split(",").map(M=>M.trim()).filter(Boolean)),p.stt_mode!=="fast"&&(x.stt_mode=p.stt_mode),p.vocab_specialization!=="general"&&(x.vocab_specialization=p.vocab_specialization),p.denoising_mode!=="noise-cancellation"&&(x.denoising_mode=p.denoising_mode),p.normalize_for_speech||(x.normalize_for_speech=!1),p.enable_voicemail_detection&&(x.enable_voicemail_detection=!0,p.voicemail_message&&(x.voicemail_message=p.voicemail_message),p.voicemail_detection_timeout_ms!==3e4&&(x.voicemail_detection_timeout_ms=p.voicemail_detection_timeout_ms)),p.webhook_url&&(x.webhook_url=p.webhook_url,p.webhook_timeout_ms!==1e4&&(x.webhook_timeout_ms=p.webhook_timeout_ms)),p.post_call_analysis_model!=="gpt-4.1-mini"&&(x.post_call_analysis_model=p.post_call_analysis_model),p.analysis_successful_prompt&&(x.analysis_successful_prompt=p.analysis_successful_prompt),p.analysis_summary_prompt&&(x.analysis_summary_prompt=p.analysis_summary_prompt),p.data_storage_setting!=="everything"&&(x.data_storage_setting=p.data_storage_setting),p.opt_in_signed_url&&(x.opt_in_signed_url=!0),p.allow_user_dtmf||(x.allow_user_dtmf=!1),p.is_public&&(x.is_public=!0),console.log("Creating Retell agent:",x),await ps.post("/api/retell/create-agent",x),X.success("Retell Agent Created Successfully"),t(),e()}catch(v){console.error("Error creating agent:",v),X.error("Failed to create agent: "+(((f=(u=v.response)==null?void 0:u.data)==null?void 0:f.message)||v.message))}finally{T(!1)}},A="bg-white/5 border-white/10 text-white focus:border-orange-500/50 placeholder:text-white/30",z="bg-white/5 border-white/10 text-white focus:border-orange-500/50",j="bg-[#0b0f2e] border-white/10 text-white",F="focus:bg-white/10 focus:text-white",D="text-white/70 text-sm",ae="space-y-4 p-4 rounded-xl bg-white/5",Te=({label:b,value:Ee,onChange:o,min:h,max:u,step:f,description:v})=>n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(H,{className:D,children:b}),n.jsx("span",{className:"text-sm text-orange-400 font-mono",children:Ee})]}),n.jsx(ou,{value:[Ee],onValueChange:([x])=>o(x),min:h,max:u,step:f,className:"[&_[role=slider]]:bg-orange-500"}),v&&n.jsx("p",{className:"text-xs text-white/40",children:v})]});return n.jsx(qt,{open:s,onOpenChange:e,children:n.jsxs(Bt,{className:"sm:max-w-[1300px] max-h-[90vh] overflow-y-auto bg-[#0b0f2e] border-white/10 text-white neon-fire-scroll p-0",children:[n.jsx($t,{className:"p-6 pb-0",children:n.jsxs(Jt,{className:"flex items-center gap-2 text-2xl font-bold text-orange-500",children:[n.jsx(ct,{className:"h-6 w-6"}),"Create Retell AI Agent"]})}),n.jsxs("form",{onSubmit:he,className:"flex flex-col h-full",children:[n.jsx("div",{className:"px-6 py-3",children:n.jsxs("div",{className:"p-3 rounded-lg bg-orange-500/10 border border-orange-500/20 flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-orange-500/20 rounded-full",children:n.jsx(So,{className:"h-4 w-4 text-orange-500"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-orange-400",children:"Retell AI Service"}),n.jsx("p",{className:"text-xs text-white/60",children:"Configure your AI voice agent with advanced settings"})]}),n.jsx("div",{className:"flex-1 max-w-xs",children:n.jsx(ye,{placeholder:"Agent Name *",value:p.agent_name,onChange:b=>R("agent_name",b.target.value),className:A,required:!0})})]})}),n.jsxs(mr,{value:N,onValueChange:k,className:"flex-1 flex flex-col",children:[n.jsx("div",{className:"px-6",children:n.jsxs(pr,{className:"w-full bg-white/5 p-1 rounded-lg grid grid-cols-6 gap-1",children:[n.jsxs(Oe,{value:"voice",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(js,{className:"h-3 w-3 mr-1"})," Voice"]}),n.jsxs(Oe,{value:"llm",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(ct,{className:"h-3 w-3 mr-1"})," LLM"]}),n.jsxs(Oe,{value:"call",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(Zs,{className:"h-3 w-3 mr-1"})," Call"]}),n.jsxs(Oe,{value:"transcriber",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(Wt,{className:"h-3 w-3 mr-1"})," STT"]}),n.jsxs(Oe,{value:"voicemail",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(fa,{className:"h-3 w-3 mr-1"})," Voicemail"]}),n.jsxs(Oe,{value:"advanced",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(ks,{className:"h-3 w-3 mr-1"})," Advanced"]})]})}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6 pt-4",children:[n.jsxs(ze,{value:"voice",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:ae,children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(js,{className:"h-4 w-4 text-orange-500"})," Voice Selection"]}),n.jsx(je,{type:"button",variant:"link",className:"text-orange-400 p-0 h-auto text-sm font-normal hover:text-orange-300",onClick:()=>O(!0),children:"Preview Voice"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Voice *"}),n.jsxs(be,{value:p.voice_id,onValueChange:b=>R("voice_id",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{placeholder:m?"Loading...":"Select voice"})}),n.jsx(we,{className:j,children:r.map(b=>n.jsxs(re,{value:b.voice_id,className:F,children:[b.voice_name||b.voice_id," (",b.provider||"Retell",")"]},b.voice_id))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Voice Model"}),n.jsxs(be,{value:p.voice_model,onValueChange:b=>R("voice_model",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:sm.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]})]})]}),n.jsxs("div",{className:ae,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Voice Parameters"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsx(Te,{label:"Speed",value:p.voice_speed,onChange:b=>R("voice_speed",b),min:.5,max:2,step:.1}),n.jsx(Te,{label:"Temperature",value:p.voice_temperature,onChange:b=>R("voice_temperature",b),min:0,max:2,step:.1}),n.jsx(Te,{label:"Volume",value:p.volume,onChange:b=>R("volume",b),min:0,max:2,step:.1})]})]}),n.jsxs("div",{className:ae,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Voice Emotion & Fallback"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Voice Emotion"}),n.jsxs(be,{value:p.voice_emotion,onValueChange:b=>R("voice_emotion",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:rm.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Fallback Voice IDs"}),n.jsx(ye,{placeholder:"openai-Alloy, deepgram-Angus",value:p.fallback_voice_ids,onChange:b=>R("fallback_voice_ids",b.target.value),className:A}),n.jsx("p",{className:"text-xs text-white/40",children:"Comma-separated, from different providers"})]})]})]})]}),n.jsxs(ze,{value:"llm",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:ae,children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(ct,{className:"h-4 w-4 text-orange-500"})," Response Engine (LLM)"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(H,{className:D,children:"Create New LLM"}),n.jsx(jt,{checked:y,onCheckedChange:w})]})]}),n.jsx("div",{className:"space-y-4",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Agent Type"}),n.jsxs(be,{value:p.agent_type,onValueChange:b=>R("agent_type",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:hm.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]})}),y?n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20",children:n.jsx("p",{className:"text-xs text-green-400",children:"A new LLM will be created when you submit this form"})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Model *"}),n.jsxs(be,{value:p.new_llm_model,onValueChange:b=>R("new_llm_model",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:dm.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Start Speaker"}),n.jsxs(be,{value:p.new_llm_start_speaker,onValueChange:b=>R("new_llm_start_speaker",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsxs(we,{className:j,children:[n.jsx(re,{value:"agent",className:F,children:"Agent (speaks first)"}),n.jsx(re,{value:"user",className:F,children:"User (waits for user)"})]})]})]})]}),n.jsx(Te,{label:"Model Temperature",value:p.new_llm_temperature,onChange:b=>R("new_llm_temperature",b),min:0,max:1,step:.1,description:"Lower = more deterministic, Higher = more random"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Begin Message (First Utterance)"}),n.jsx(ht,{placeholder:"Hey, I am a virtual assistant calling from [Company Name]. How can I help you today?",value:p.new_llm_begin_message,onChange:b=>R("new_llm_begin_message",b.target.value),className:A+" min-h-[80px]"}),n.jsx("p",{className:"text-xs text-white/40",children:'Leave empty for dynamic generation, or set to "" for user to speak first'})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"General Prompt (System Prompt) *"}),n.jsx(ht,{placeholder:"You are a friendly and professional AI assistant for [Company Name]. Your role is to help customers with their inquiries...",value:p.new_llm_general_prompt,onChange:b=>R("new_llm_general_prompt",b.target.value),className:A+" min-h-[200px]"}),n.jsx("p",{className:"text-xs text-white/40",children:"This prompt guides the agent's behavior and personality throughout the conversation"})]})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Select LLM *"}),n.jsxs(be,{value:p.llm_id,onValueChange:b=>R("llm_id",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{placeholder:m?"Loading...":"Select existing LLM"})}),n.jsx(we,{className:j,children:i.map(b=>n.jsx(re,{value:b.llm_id,className:F,children:n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("span",{children:[b.llm_id.substring(0,20),"..."]}),n.jsxs("span",{className:"text-xs text-white/50",children:["Model: ",b.model||"Default"]})]})},b.llm_id))})]}),n.jsx("p",{className:"text-xs text-white/40",children:'Select from existing LLMs in your Retell dashboard, or toggle "Create New" to configure a new one'})]}),p.agent_type==="conversation_flow"&&n.jsxs("div",{className:"p-4 rounded-lg bg-blue-500/10 border border-blue-500/20 space-y-3",children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"p-1.5 bg-blue-500/20 rounded-full mt-0.5",children:n.jsx(ct,{className:"h-3 w-3 text-blue-400"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-blue-400",children:"Conversation Flow Workflow"}),n.jsx("p",{className:"text-xs text-white/60 mt-1",children:"To create a true Conversation Flow agent, you need a workflow ID from your Retell dashboard."})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Workflow ID (Optional)"}),n.jsx(ye,{placeholder:"workflow_xxxxxxxxxxxxxxxx",value:p.workflow_id,onChange:b=>R("workflow_id",b.target.value),className:A}),n.jsx("p",{className:"text-xs text-white/40",children:"Leave empty to use LLM-based conversation (will show as Single Prompt), or paste a workflow ID from your Retell dashboard"})]}),n.jsxs("div",{className:"p-2 bg-white/5 rounded text-xs text-white/60",children:[n.jsx("span",{className:"font-semibold text-white",children:"How to get a Workflow ID:"}),n.jsxs("ol",{className:"list-decimal list-inside mt-1 space-y-0.5 ml-2",children:[n.jsxs("li",{children:["Go to ",n.jsx("a",{href:"https://dashboard.retellai.com/workflows",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline",children:"Retell Dashboard → Workflows"})]}),n.jsx("li",{children:"Create or select a workflow"}),n.jsx("li",{children:'Copy the workflow ID (starts with "workflow_")'}),n.jsx("li",{children:"Paste it above"})]})]})]}),p.llm_id&&i.find(b=>b.llm_id===p.llm_id)&&n.jsxs("div",{className:"p-3 rounded-lg bg-orange-500/10 border border-orange-500/20",children:[n.jsx("p",{className:"text-xs text-orange-400 mb-2",children:"Selected LLM Details"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-white/50",children:"Model:"})," ",n.jsx("span",{className:"text-white",children:((W=i.find(b=>b.llm_id===p.llm_id))==null?void 0:W.model)||"Default"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-white/50",children:"Start Speaker:"})," ",n.jsx("span",{className:"text-white",children:((Pt=i.find(b=>b.llm_id===p.llm_id))==null?void 0:Pt.start_speaker)||"agent"})]})]}),((ut=i.find(b=>b.llm_id===p.llm_id))==null?void 0:ut.begin_message)&&n.jsxs("div",{className:"mt-2",children:[n.jsx("span",{className:"text-white/50 text-xs",children:"Begin Message:"}),n.jsx("p",{className:"text-white text-xs mt-1 p-2 bg-white/5 rounded",children:($e=i.find(b=>b.llm_id===p.llm_id))==null?void 0:$e.begin_message})]})]})]})]}),n.jsxs("div",{className:ae,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Agent Version Description"}),n.jsx(ht,{className:A+" min-h-[100px]",placeholder:"Describe this agent version...",value:p.version_description,onChange:b=>R("version_description",b.target.value)})]})]}),n.jsxs(ze,{value:"call",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:ae,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(Zs,{className:"h-4 w-4 text-orange-500"})," Call Behavior"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(Te,{label:"Responsiveness",value:p.responsiveness,onChange:b=>R("responsiveness",b),min:0,max:1,step:.1,description:"How fast the agent responds"}),n.jsx(Te,{label:"Interruption Sensitivity",value:p.interruption_sensitivity,onChange:b=>R("interruption_sensitivity",b),min:0,max:1,step:.1,description:"How easily user can interrupt"})]})]}),n.jsxs("div",{className:ae,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Backchannel"}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx(H,{className:D,children:"Enable Backchannel"}),n.jsx("p",{className:"text-xs text-white/40",children:'Agent says "yeah", "uh-huh" during conversation'})]}),n.jsx(jt,{checked:p.enable_backchannel,onCheckedChange:b=>R("enable_backchannel",b)})]}),p.enable_backchannel&&n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(Te,{label:"Frequency",value:p.backchannel_frequency,onChange:b=>R("backchannel_frequency",b),min:0,max:1,step:.1}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Custom Words"}),n.jsx(ye,{placeholder:"yeah, uh-huh, right",value:p.backchannel_words,onChange:b=>R("backchannel_words",b.target.value),className:A})]})]})]}),n.jsxs("div",{className:ae,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Reminders & Ambient"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Reminder Trigger (ms)"}),n.jsx(ye,{type:"number",value:p.reminder_trigger_ms,onChange:b=>R("reminder_trigger_ms",parseInt(b.target.value)||1e4),className:A})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Reminder Max Count"}),n.jsx(ye,{type:"number",min:0,value:p.reminder_max_count,onChange:b=>R("reminder_max_count",parseInt(b.target.value)||1),className:A})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Ambient Sound"}),n.jsxs(be,{value:p.ambient_sound,onValueChange:b=>R("ambient_sound",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:nm.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]}),p.ambient_sound!=="none"&&n.jsx(Te,{label:"Ambient Volume",value:p.ambient_sound_volume,onChange:b=>R("ambient_sound_volume",b),min:0,max:2,step:.1})]})]}),n.jsxs("div",{className:ae,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Call Limits"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"End After Silence (ms)"}),n.jsx(ye,{type:"number",value:p.end_call_after_silence_ms,onChange:b=>R("end_call_after_silence_ms",parseInt(b.target.value)||6e5),className:A})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Max Duration (ms)"}),n.jsx(ye,{type:"number",value:p.max_call_duration_ms,onChange:b=>R("max_call_duration_ms",parseInt(b.target.value)||36e5),className:A})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Ring Duration (ms)"}),n.jsx(ye,{type:"number",value:p.ring_duration_ms,onChange:b=>R("ring_duration_ms",parseInt(b.target.value)||3e4),className:A})]})]})]})]}),n.jsxs(ze,{value:"transcriber",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:ae,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(yo,{className:"h-4 w-4 text-orange-500"})," Language & Recognition"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Language"}),n.jsxs(be,{value:p.language,onValueChange:b=>R("language",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:am.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"STT Mode"}),n.jsxs(be,{value:p.stt_mode,onValueChange:b=>R("stt_mode",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:im.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]})]})]}),n.jsxs("div",{className:ae,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Audio Processing"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Vocab Specialization"}),n.jsxs(be,{value:p.vocab_specialization,onValueChange:b=>R("vocab_specialization",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:om.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Denoising Mode"}),n.jsxs(be,{value:p.denoising_mode,onValueChange:b=>R("denoising_mode",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:lm.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between mt-4",children:[n.jsxs("div",{children:[n.jsx(H,{className:D,children:"Normalize for Speech"}),n.jsx("p",{className:"text-xs text-white/40",children:"Convert numbers, dates to spoken form"})]}),n.jsx(jt,{checked:p.normalize_for_speech,onCheckedChange:b=>R("normalize_for_speech",b)})]})]}),n.jsxs("div",{className:ae,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Boosted Keywords"}),n.jsx(ht,{placeholder:"retell, company name, product names...",value:p.boosted_keywords,onChange:b=>R("boosted_keywords",b.target.value),className:A+" min-h-[80px]"}),n.jsx("p",{className:"text-xs text-white/40 mt-1",children:"Comma-separated words to prioritize in transcription"})]})]}),n.jsx(ze,{value:"voicemail",className:"mt-0 space-y-4",children:n.jsxs("div",{className:ae,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(fa,{className:"h-4 w-4 text-orange-500"})," Voicemail Detection"]}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx(H,{className:D,children:"Enable Voicemail Detection"}),n.jsx("p",{className:"text-xs text-white/40",children:"Detect when call goes to voicemail"})]}),n.jsx(jt,{checked:p.enable_voicemail_detection,onCheckedChange:b=>R("enable_voicemail_detection",b)})]}),p.enable_voicemail_detection&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Voicemail Message"}),n.jsx(ht,{placeholder:"Hi, please give us a callback...",value:p.voicemail_message,onChange:b=>R("voicemail_message",b.target.value),className:A})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Detection Timeout (ms)"}),n.jsx(ye,{type:"number",value:p.voicemail_detection_timeout_ms,onChange:b=>R("voicemail_detection_timeout_ms",parseInt(b.target.value)||3e4),className:A})]})]})]})}),n.jsxs(ze,{value:"advanced",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:ae,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(Dc,{className:"h-4 w-4 text-orange-500"})," Webhooks"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Webhook URL"}),n.jsx(ye,{placeholder:"https://your-webhook.com/events",value:p.webhook_url,onChange:b=>R("webhook_url",b.target.value),className:A})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Webhook Timeout (ms)"}),n.jsx(ye,{type:"number",value:p.webhook_timeout_ms,onChange:b=>R("webhook_timeout_ms",parseInt(b.target.value)||1e4),className:A})]})]})]}),n.jsxs("div",{className:ae,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(ct,{className:"h-4 w-4 text-orange-500"})," Post-Call Analysis"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Analysis Model"}),n.jsxs(be,{value:p.post_call_analysis_model,onValueChange:b=>R("post_call_analysis_model",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:um.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Success Criteria Prompt"}),n.jsx(ht,{placeholder:"The agent finished the task and the call was complete...",value:p.analysis_successful_prompt,onChange:b=>R("analysis_successful_prompt",b.target.value),className:A})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Summary Prompt"}),n.jsx(ht,{placeholder:"Summarize the outcome of the conversation...",value:p.analysis_summary_prompt,onChange:b=>R("analysis_summary_prompt",b.target.value),className:A})]})]})]}),n.jsxs("div",{className:ae,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(bo,{className:"h-4 w-4 text-orange-500"})," Data & Privacy"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(H,{className:D,children:"Data Storage Setting"}),n.jsxs(be,{value:p.data_storage_setting,onValueChange:b=>R("data_storage_setting",b),children:[n.jsx(_e,{className:z,children:n.jsx(xe,{})}),n.jsx(we,{className:j,children:cm.map(b=>n.jsx(re,{value:b.value,className:F,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(H,{className:D,children:"Signed URLs"}),n.jsx("p",{className:"text-xs text-white/40",children:"Enable signed URLs for recordings/logs"})]}),n.jsx(jt,{checked:p.opt_in_signed_url,onCheckedChange:b=>R("opt_in_signed_url",b)})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(H,{className:D,children:"Allow DTMF Input"}),n.jsx("p",{className:"text-xs text-white/40",children:"Accept keypad input during calls"})]}),n.jsx(jt,{checked:p.allow_user_dtmf,onCheckedChange:b=>R("allow_user_dtmf",b)})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(H,{className:D,children:"Public Agent"}),n.jsx("p",{className:"text-xs text-white/40",children:"Make available for public preview"})]}),n.jsx(jt,{checked:p.is_public,onCheckedChange:b=>R("is_public",b)})]})]})]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 p-6 pt-4 border-t border-white/10",children:[n.jsx(je,{type:"button",variant:"outline",onClick:e,disabled:_,className:"border-white/10 bg-transparent text-white hover:bg-white/10",children:"Cancel"}),n.jsx(je,{type:"submit",className:"px-6 py-2 rounded-lg text-sm font-semibold text-white bg-orange-500/20 border border-orange-500/30 shadow-[0_2px_5px_rgba(249,115,22,0.45)] hover:shadow-[0_5px_10px_rgba(249,115,22,0.65)] hover:bg-orange-500/40 transition-all",disabled:_||!p.agent_name||!p.voice_id||(p.agent_type==="single_prompt"||p.agent_type==="custom_llm")&&!y&&!p.llm_id||!y&&!p.llm_id||y&&!p.new_llm_general_prompt.trim(),children:_?n.jsxs(n.Fragment,{children:[n.jsx(Mt,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Agent"})]})]}),n.jsx(tm,{isOpen:E,onClose:()=>O(!1),onSelectVoice:b=>{R("voice_id",b),O(!1)},voices:r})]})})}const pm={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_BASE_URL:"https://ai.research-hero.com",VITE_FACEBOOK_APP_ID:"1939628080270711",VITE_FACEBOOK_APP_SECRET:"9b4f0b6de06cf54cc1bcdd1c13c37995",VITE_FACEBOOK_REDIRECT_URI:"https://ai.research-hero.com/api/auth/facebook/callback",VITE_FRONTEND_URL:"https://aiagent.research-hero.com",VITE_GMAIL_CLIENT_ID:"686955346191-el9qo3bhbgfo7fk4juanq8bq7g7iis7d.apps.googleusercontent.com",VITE_GMAIL_REDIRECT_URI:"https://ai.research-hero.com/api/gmail/auth/callback",VITE_GOOGLE_MAPS_API_KEY:"YOUR_ACTUAL_API_KEY_HERE",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_51S8GFm2MMm3Fy1PB45KAluHAtFTOmAY9qKUE4sITR1TA1zfX97ON36OAcAALplq6LbLgqXaTyY0hRB7ae55LzpBQ00DfkbC8oy",VITE_VAPI_BASE_URL:"https://api.vapi.ai",VITE_VAPI_PUBLIC_KEY:"eb3b26e3-7dbb-4fd6-a545-a954756a43aa"},Em=()=>{var bt,Lt,_t;lu();const[s,e]=Y.useState(""),[t,r]=Y.useState(null),[a,i]=Y.useState(null),[l,c]=Y.useState(!1),[d,m]=Y.useState(!1),[g,_]=Y.useState(!1),[T,N]=Y.useState(!1),[k,y]=Y.useState(!1),[w,C]=Y.useState(!1),[I,E]=Y.useState(!1),[O,p]=Y.useState(!1),[B,K]=Y.useState(!1),[R,he]=Y.useState(null),[A,z]=Y.useState(null),[j,F]=Y.useState(!1),[D,ae]=Y.useState(null),[Te,W]=Y.useState(new Set);console.log("🔍 Environment Debug:"),console.log("- VITE_VAPI_PUBLIC_KEY:",`${"eb3b26e3-7dbb-4fd6-a545-a954756a43aa".substring(0,8)}...`),console.log("- All env vars:",pm);const[Pt,ut]=Y.useState({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"office",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"vapi",voiceId:"Cole",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),$e=qc(),{user:b}=eu(),{data:Ee,isLoading:o}=er({queryKey:["syncedAgents",b==null?void 0:b.id,s],queryFn:()=>Jc(s),staleTime:0,refetchInterval:1e3,gcTime:5*60*1e3,enabled:!!(b!=null&&b.id),placeholderData:S=>S,retry:(S,U)=>{var J;return[404,204,402].includes((J=U==null?void 0:U.response)==null?void 0:J.status)?!1:S<2}}),{data:h}=er({queryKey:["retellAgents"],queryFn:Gc,staleTime:0,refetchInterval:1e3}),u=Uc.useMemo(()=>{const S=(Ee==null?void 0:Ee.data)||[],U=(h==null?void 0:h.data)||[],se=Array.isArray(U)?U.map(J=>({id:J.agent_id,name:J.agent_name||"Unnamed Retell Agent",firstMessage:"Retell Agent (Details not loaded)",model:{provider:"retell",model:J.llm_id||"Unknown"},voice:{provider:"retell",voiceId:J.voice_id||"Unknown"},transcriber:{provider:"retell"},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),isRetell:!0})):[];return[...S,...se]},[Ee,h]);kr({mutationFn:zc,onSuccess:S=>{console.log("✅ Assistant created successfully:",S),X.success(`Assistant "${Pt.name}" created successfully!`),_(!1),ut({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"office",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"11labs",voiceId:"21m00Tcm4TlvDq8ikWAM",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),$e.invalidateQueries({queryKey:["syncedAgents"]}),$e.invalidateQueries({queryKey:["agents"]})},onError:S=>{var se,J,oe,le,me,ue;console.error("❌ Error creating assistant:",S);let U="Failed to create assistant";(J=(se=S.response)==null?void 0:se.data)!=null&&J.message?U=S.response.data.message:(le=(oe=S.response)==null?void 0:oe.data)!=null&&le.error?U=S.response.data.error:S.message&&(U=S.message),X.error(`Creation failed: ${U}`),console.error("Detailed error:",{status:(me=S.response)==null?void 0:me.status,data:(ue=S.response)==null?void 0:ue.data,message:S.message})}});const f=kr({mutationFn:({id:S,data:U})=>Hc(S,U),onSuccess:(S,U)=>{console.log("✅ Assistant updated successfully:",S);const se=Object.keys(U.data)[0];X.success(`${se} updated successfully`),$e.invalidateQueries({queryKey:["syncedAgents",b==null?void 0:b.id]}),t&&L(t.id)},onError:(S,U)=>{var oe,le,me,ue,Ce,xt;console.error("❌ Error updating assistant:",S);let se="Failed to update assistant";(le=(oe=S.response)==null?void 0:oe.data)!=null&&le.message?se=S.response.data.message:(ue=(me=S.response)==null?void 0:me.data)!=null&&ue.error?se=S.response.data.error:S.message&&(se=S.message);const J=Object.keys(U.data)[0];X.error(`Failed to update ${J}: ${se}`),console.error("Update error details:",{field:J,value:U.data[J],status:(Ce=S.response)==null?void 0:Ce.status,data:(xt=S.response)==null?void 0:xt.data,message:S.message})}}),v=kr({mutationFn:({id:S,isRetell:U})=>U?Kc(S):Qc(S),onSuccess:S=>{console.log("✅ Delete success:",S),X.success(`Assistant "${D==null?void 0:D.name}" deleted successfully!`),F(!1),ae(null),t&&D&&t.id===D.id&&(r(null),i(null)),$e.invalidateQueries({queryKey:["syncedAgents",b==null?void 0:b.id]})},onError:S=>{var J,oe,le,me,ue,Ce;console.error("❌ Error deleting assistant:",S);let U="Unknown error occurred";(oe=(J=S.response)==null?void 0:J.data)!=null&&oe.message?U=S.response.data.message:(me=(le=S.response)==null?void 0:le.data)!=null&&me.error?U=S.response.data.error:S.message&&(U=S.message);const se=(D==null?void 0:D.name)||"Assistant";X.error(`Failed to delete ${se}: ${U}`),console.error("Delete error details:",{assistantId:D==null?void 0:D.id,assistantName:D==null?void 0:D.name,status:(ue=S.response)==null?void 0:ue.status,data:(Ce=S.response)==null?void 0:Ce.data,message:S.message})}}),x=(b==null?void 0:b.isSuperAdmin)||!1,M=(Ee==null?void 0:Ee.total)||u.length;Y.useEffect(()=>{if(u.length>0){console.log("🔍 Agent data structure (first agent):",u[0]),console.log("🔍 Total agents loaded:",u.length),console.log("👑 Pagination disabled (Super Admin):",x),console.log("📊 Total assistants available:",M);const S=new Set;u.forEach((U,se)=>{((U.assistant_data||{}).metadata||{}).published===!0&&S.add(String(U.id)),se<3&&console.log(`🔍 Agent ${se+1}:`,{name:U.name,localId:U.id,assistantId:U.assistant_id,hasAssistantId:!!U.assistant_id,structure:Object.keys(U)})}),W(S),console.log("📊 Initialized published agents from metadata:",Array.from(S))}},[u]),Y.useEffect(()=>{if(t&&t.id){const S=t.assistant_id||t.id;L(S,t.isRetell)}},[t]);const L=async(S,U=!1)=>{var se,J,oe,le,me,ue,Ce,xt,ms,Un,qn,Bn,$n,Jn,Gn,zn,Yn,Wn,Hn,Kn,Qn,Xn,Zn,ea,ta,sa,ra,na,aa,ia,oa,la,ca,ua,da,ha,ma;c(!0);try{const wt=String(S);if(U){console.log("🔍 Fetching complete Retell details for agent:",wt);const Dt=await Yc(wt);console.log("📋 Complete Retell agent details:",Dt),i(Dt.data||Dt)}else{console.log("🔍 Fetching complete VAPI details for agent:",wt);const Dt=await Wc(wt);console.log("📋 Complete VAPI agent details:",Dt);const $=Dt.data||Dt;i({name:$.name||(t==null?void 0:t.name),firstMessage:$.firstMessage||(t==null?void 0:t.firstMessage),firstMessageMode:$.firstMessageMode||"assistant-speaks-first",firstMessageInterruptionsEnabled:$.firstMessageInterruptionsEnabled||!1,model:{provider:((se=$.model)==null?void 0:se.provider)||"openai",model:((J=$.model)==null?void 0:J.model)||"gpt-4",temperature:((oe=$.model)==null?void 0:oe.temperature)||.7,maxTokens:((le=$.model)==null?void 0:le.maxTokens)||1e3,numFastTurns:((me=$.model)==null?void 0:me.numFastTurns)||0,messages:((ue=$.model)==null?void 0:ue.messages)||[],tools:((Ce=$.model)==null?void 0:Ce.tools)||[],toolIds:((xt=$.model)==null?void 0:xt.toolIds)||[],knowledgeBase:(ms=$.model)==null?void 0:ms.knowledgeBase,knowledgeBaseId:(Un=$.model)==null?void 0:Un.knowledgeBaseId,emotionRecognitionEnabled:((qn=$.model)==null?void 0:qn.emotionRecognitionEnabled)||!1,thinking:((Bn=$.model)==null?void 0:Bn.thinking)||{type:"disabled"}},voice:{provider:(($n=$.voice)==null?void 0:$n.provider)||"11labs",voiceId:((Jn=$.voice)==null?void 0:Jn.voiceId)||"21m00Tcm4TlvDq8ikWAM",speed:((Gn=$.voice)==null?void 0:Gn.speed)||1,stability:(zn=$.voice)==null?void 0:zn.stability,similarityBoost:(Yn=$.voice)==null?void 0:Yn.similarityBoost,cachingEnabled:((Wn=$.voice)==null?void 0:Wn.cachingEnabled)||!1,chunkPlan:((Hn=$.voice)==null?void 0:Hn.chunkPlan)||{enabled:!1},fallbackPlan:(Kn=$.voice)==null?void 0:Kn.fallbackPlan},transcriber:{provider:((Qn=$.transcriber)==null?void 0:Qn.provider)||"deepgram",model:((Xn=$.transcriber)==null?void 0:Xn.model)||"nova-2",language:((Zn=$.transcriber)==null?void 0:Zn.language)||"en",confidenceThreshold:((ea=$.transcriber)==null?void 0:ea.confidenceThreshold)||.4,endOfTurnConfidenceThreshold:((ta=$.transcriber)==null?void 0:ta.endOfTurnConfidenceThreshold)||.7,minEndOfTurnSilenceWhenConfident:((sa=$.transcriber)==null?void 0:sa.minEndOfTurnSilenceWhenConfident)||160,maxTurnSilence:((ra=$.transcriber)==null?void 0:ra.maxTurnSilence)||400,wordFinalizationMaxWaitTime:((na=$.transcriber)==null?void 0:na.wordFinalizationMaxWaitTime)||160,enableUniversalStreamingApi:((aa=$.transcriber)==null?void 0:aa.enableUniversalStreamingApi)||!1,formatTurns:((ia=$.transcriber)==null?void 0:ia.formatTurns)||!1,disablePartialTranscripts:((oa=$.transcriber)==null?void 0:oa.disablePartialTranscripts)||!1,keywords:((la=$.transcriber)==null?void 0:la.keywords)||[],wordBoost:((ca=$.transcriber)==null?void 0:ca.wordBoost)||[]},systemMessage:((ha=(da=(ua=$.model)==null?void 0:ua.messages)==null?void 0:da[0])==null?void 0:ha.content)||$.systemMessage||"You are a helpful AI assistant.",endCallMessage:$.endCallMessage,voicemailMessage:$.voicemailMessage,endCallPhrases:$.endCallPhrases||[],functions:$.functions||[],tools:$.tools||[],customFunctions:$.customFunctions,variableValues:$.variableValues,maxDurationSeconds:$.maxDurationSeconds||600,backgroundSound:$.backgroundSound||"off",modelOutputInMessagesEnabled:$.modelOutputInMessagesEnabled||!1,backgroundDenoisingEnabled:$.backgroundDenoisingEnabled||!1,clientMessages:$.clientMessages,serverMessages:$.serverMessages,transportConfigurations:$.transportConfigurations||[],server:$.server,observabilityPlan:$.observabilityPlan,startSpeakingPlan:$.startSpeakingPlan,stopSpeakingPlan:$.stopSpeakingPlan,credentialIds:$.credentialIds||[],metadata:$.metadata||{},createdAt:$.createdAt,updatedAt:$.updatedAt,_rawVapiData:$})}}catch(wt){console.error("Error loading agent details:",wt),console.error("Error details:",((ma=wt.response)==null?void 0:ma.data)||wt.message),i({model:{provider:"OpenAI",model:"GPT-4"},voice:{provider:"11Labs",voiceId:"Default Voice"},transcriber:{provider:"Deepgram"},systemMessage:"You are a helpful AI assistant."})}finally{c(!1)}},V=S=>S?S.split(" ").map(U=>U.charAt(0)).join("").toUpperCase().substring(0,2):"NA",te=S=>{var U,se,J,oe,le,me,ue,Ce,xt,ms;console.log("🎯 Template selected:",S),ut({name:S.name||"",firstMessage:S.first_message||"",systemMessage:S.system_message||"You are a helpful AI assistant.",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:S.end_call_message||"",voicemailMessage:"",endCallPhrases:S.end_call_phrases||[],maxDurationSeconds:S.max_duration_seconds||600,backgroundSound:S.background_sound||"off",model:{provider:((U=S.model)==null?void 0:U.provider)||"openai",model:((se=S.model)==null?void 0:se.model)||"gpt-4",temperature:((J=S.model)==null?void 0:J.temperature)||.7,maxTokens:((oe=S.model)==null?void 0:oe.maxTokens)||1e3,numFastTurns:((le=S.model)==null?void 0:le.numFastTurns)||0},voice:{provider:((me=S.voice)==null?void 0:me.provider)||"vapi",voiceId:((ue=S.voice)==null?void 0:ue.voiceId)||"Cole",speed:((Ce=S.voice)==null?void 0:Ce.speed)||1},transcriber:{provider:((xt=S.transcriber)==null?void 0:xt.provider)||"deepgram",model:"nova-2",language:((ms=S.transcriber)==null?void 0:ms.language)||"en"}}),_(!0)},ne=S=>{if(S==="retell"){y(!0);return}ut({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"off",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"11labs",voiceId:"21m00Tcm4TlvDq8ikWAM",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),_(!0)},Je=(S,U)=>{if(!S)return"";const se=S.toLowerCase().trim();return(U==="model"?{openai:"openai","open-ai":"openai",anthropic:"anthropic",groq:"groq",together:"together",anyscale:"anyscale"}:{"11labs":"11labs",elevenlabs:"11labs","eleven-labs":"11labs",openai:"openai","open-ai":"openai",azure:"azure",playht:"playht","play-ht":"playht",deepgram:"deepgram",cartesia:"cartesia",lmnt:"lmnt"})[se]||se},nt=(S,U)=>{if(!t){console.warn("No selected agent for field update");return}console.log("🔄 Field update:",S,"Value:",U,"Type:",typeof U,"Agent ID:",t.id),A&&clearTimeout(A),i(J=>{const oe={...J};if(S.includes(".")){const[le,me]=S.split(".");if(oe[le]={...oe[le],[me]:U},S==="model.provider"){const ue=ka(U);ue&&(oe.model.model=ue,console.log("🤖 Auto-selected model:",ue,"for provider:",U))}else if(S==="voice.provider"){const ue=Ca(U);ue&&(oe.voice.voiceId=ue,console.log("🎤 Auto-selected voice:",ue,"for provider:",U))}else if(S==="transcriber.provider"){const ue=Na(U);ue&&(oe.transcriber.model=ue,console.log("📝 Auto-selected transcriber model:",ue,"for provider:",U))}}else oe[S]=U;return oe});const se=setTimeout(()=>{const J={},oe=["status","published","publishedAt","systemMessage"];if(S.includes(".")){const[me,ue]=S.split(".");if(oe.includes(me)||oe.includes(ue)){console.log("⚠️ Skipping VAPI update for local-only field:",S);return}if(J[me]={...a[me],[ue]:U},S==="model.provider"){const Ce=ka(U);Ce&&(J.model.model=Ce)}else if(S==="voice.provider"){const Ce=Ca(U);Ce&&(J.voice.voiceId=Ce)}else if(S==="transcriber.provider"){const Ce=Na(U);Ce&&(J.transcriber.model=Ce)}}else{if(oe.includes(S)){console.log("⚠️ Skipping VAPI update for local-only field:",S);return}J[S]=U}console.log("🔄 Auto-saving field:",S,"with value:",U,"updateData:",J);const le=t.assistant_id||t.id;console.log("🔍 Using assistant ID for VAPI:",le,"Type:",typeof le),f.mutate({id:String(le),data:J})},1e3);z(se)},yt=S=>{if(!t){console.warn("No selected agent for system message update");return}console.log("🔄 System message update:",S),A&&clearTimeout(A),i(se=>{const J={...se};return J.systemMessage=S,J.model||(J.model={}),J.model.messages||(J.model.messages=[]),J.model.messages.length===0?J.model.messages.push({role:"system",content:S}):J.model.messages[0].role==="system"?J.model.messages[0].content=S:J.model.messages.unshift({role:"system",content:S}),J});const U=setTimeout(()=>{var me;const J=[...((me=a==null?void 0:a.model)==null?void 0:me.messages)||[]];J.length===0?J.push({role:"system",content:S}):J[0].role==="system"?J[0].content=S:J.unshift({role:"system",content:S});const oe={model:{...a==null?void 0:a.model,messages:J}};console.log("🔄 Auto-saving system message via model.messages:",oe);const le=t.assistant_id||t.id;console.log("🔍 Using assistant ID for system message update:",le),f.mutate({id:String(le),data:oe})},1e3);z(U)};Y.useEffect(()=>()=>{A&&clearTimeout(A)},[A]);const ke=S=>{ae(S),F(!0)},Be=()=>{if(D){const S=D.isRetell,U=D.assistant_id||D.agent_id||D.id;console.log(`🗑️ Deleting ${S?"Retell":"VAPI"} agent:`,D.id,"Using ID:",U),v.mutate({id:String(U),isRetell:S})}else X.error("No agent selected for deletion")},at=async S=>{var J,oe;if(!S||!S.id)return;const U=String(S.id),se=Te.has(U);try{console.log(`🔄 ${se?"Unpublishing":"Publishing"} agent:`,S.name);const le={metadata:{...a==null?void 0:a.metadata,published:!se,publishedAt:se?null:new Date().toISOString()}},me=S.assistant_id||S.id;console.log("🔍 Using assistant ID for VAPI publish:",me,"Type:",typeof me),await f.mutateAsync({id:String(me),data:le});const ue=new Set(Te);se?(ue.delete(U),X.success(`${S.name} unpublished successfully`)):(ue.add(U),X.success(`${S.name} published successfully`)),W(ue),t&&t.id===S.id&&i(Ce=>({...Ce,metadata:le.metadata}))}catch(le){console.error("❌ Error toggling publish status:",le);let me="Failed to update publish status";(oe=(J=le.response)==null?void 0:J.data)!=null&&oe.message?me=le.response.data.message:le.message&&(me=le.message),X.error(`Failed to ${se?"unpublish":"publish"} ${S.name}: ${me}`)}};return n.jsxs("div",{className:"app-shell-bg flex flex-col h-screen text-white overflow-hidden",children:[n.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:n.jsxs("div",{className:"max-w-full mx-auto space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between pb-6 border-b border-white/10",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-white/60",children:"Agents"}),n.jsx("p",{className:"text-white/50 text-sm mt-1",children:"Manage and configure your AI voice agents"})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"relative w-72",children:[n.jsx(jn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/40"}),n.jsx(ye,{className:"bg-white/5 border-white/10 text-white pl-10 h-10",placeholder:"Search assistants...",value:s,onChange:S=>e(S.target.value)})]}),n.jsxs("button",{className:"px-5 py-2 rounded-lg text-sm font-semibold text-white bg-[linear-gradient(180deg,rgba(90,110,255,0.45),rgba(36,46,151,0.35))] border border-white/15 hover:shadow-[0_5px_10px_rgba(90,110,255,0.65)] hover:bg-[linear-gradient(180deg,rgba(90,110,255,0.6),rgba(36,46,151,0.45))] transition-all flex items-center gap-2",onClick:()=>N(!0),children:[n.jsx(jo,{className:"h-4 w-4"}),"Create Assistant"]})]})]}),n.jsx("div",{className:"neo-card p-1 overflow-hidden border-white/10 bg-[#0b0f2e]/50 backdrop-blur-xl rounded-xl",children:n.jsxs(tu,{children:[n.jsx(su,{className:"bg-white/5",children:n.jsxs(Ms,{className:"border-white/10 hover:bg-transparent",children:[n.jsx(Is,{className:"text-white/70 font-semibold h-12",children:"Agent ID"}),n.jsx(Is,{className:"text-white/70 font-semibold h-12",children:"Agent"}),n.jsx(Is,{className:"text-white/70 font-semibold h-12",children:"Provider"}),n.jsx(Is,{className:"text-white/70 font-semibold h-12 text-right",children:"Actions"})]})}),n.jsx(ru,{children:o?n.jsx(Ms,{children:n.jsx(ts,{colSpan:5,className:"h-32 text-center",children:n.jsx(Mt,{className:"h-6 w-6 animate-spin text-white/20 mx-auto"})})}):u.filter(S=>(S==null?void 0:S.id)&&(S==null?void 0:S.name)).length===0?n.jsx(Ms,{children:n.jsx(ts,{colSpan:5,className:"h-48 text-center",children:n.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2 opacity-30",children:[n.jsx(ct,{className:"h-12 w-12"}),n.jsx("p",{children:"No assistants found"})]})})}):u.filter(S=>(S==null?void 0:S.id)&&(S==null?void 0:S.name)).map(S=>n.jsxs(Ms,{className:"border-white/5 hover:bg-white/5 transition-colors group",children:[n.jsxs(ts,{className:"text-white/80 font-mono text-xs",children:[String(S.assistant_id||S.id).substring(0,18),"..."]}),n.jsx(ts,{className:"py-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(tr,{className:"h-10 w-10 ring-2 ring-white/10 transition-transform group-hover:scale-105",children:n.jsx(sr,{className:"bg-gradient-to-br from-indigo-500 to-green-500 text-indigo-100 font-medium",children:V(S.name)})}),n.jsx("div",{className:"font-medium text-white",children:S.name})]})}),n.jsx(ts,{children:n.jsx(Et,{variant:"outline",className:`capitalize font-normal ${S.isRetell?"border-orange-500/30 text-orange-400 bg-orange-500/5":"border-blue-500/30 text-blue-400 bg-blue-500/5"}`,children:S.isRetell?"Retell":"Vapi"})}),n.jsx(ts,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(je,{variant:"ghost",size:"icon",className:"h-8 w-8 text-white/30 text-orange-400 hover:text-white hover:bg-white/10",onClick:()=>{r(S),E(!0)},title:"View Details",children:n.jsx(Rc,{className:"h-4 w-4"})}),n.jsx(je,{variant:"ghost",size:"icon",className:"h-8 w-8 text-cyan-400 hover:text-blue-400 hover:bg-blue-400/10",onClick:()=>{r(S),p(!0)},title:"Edit Agent",children:n.jsx(ga,{className:"h-4 w-4"})}),n.jsx(je,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-400 hover:bg-red-400/10",onClick:()=>ke(S),title:"Delete Agent",children:n.jsx(Gr,{className:"h-4 w-4"})})]})})]},S.id))})]})})]})}),n.jsx(qt,{open:I,onOpenChange:S=>{E(S),S||(r(null),i(null))},children:n.jsxs(Bt,{className:"bg-[#0b0f2e] border-white/10 text-white sm:max-w-[1200px] max-h-[95vh] overflow-y-auto neon-fire-scroll p-0",children:[n.jsx($t,{className:"sr-only",children:n.jsx(Jt,{children:"Agent Details"})}),t&&(t.isRetell?n.jsx(cu,{agent:t,details:a,isLoading:l,onEdit:()=>{E(!1),p(!0)},getInitials:V}):n.jsx(Ea,{agent:t,details:a,isLoading:l,onUpdateField:nt,onUpdateSystemMessage:yt,onDelete:ke,onPublishToggle:at,isPublished:Te.has(String(t.id)),isSaving:f.isPending,onTalkToAssistant:()=>m(!0),MODEL_PROVIDERS:ja,VOICE_PROVIDERS:Sa,TRANSCRIBER_PROVIDERS:wa,getProviderModels:xa,getProviderVoices:_a,getTranscriberModels:ba,normalizeProviderValue:Je,getInitials:V}))]})}),t&&t.isRetell?n.jsx(uu,{isOpen:O,onClose:()=>p(!1),onSuccess:()=>{$e.invalidateQueries({queryKey:["syncedAgents"]}),L(t.id,!0)},agentId:t.agent_id||t.id,initialData:a}):n.jsx(qt,{open:O,onOpenChange:p,children:n.jsxs(Bt,{className:"bg-[#0b0f2e] border-white/10 text-white sm:max-w-[1200px] max-h-[95vh] overflow-y-auto neon-fire-scroll p-0",children:[n.jsx($t,{className:"p-6 pb-0",children:n.jsxs(Jt,{className:"text-xl font-bold flex items-center gap-2",children:[n.jsx(ga,{className:"h-5 w-5 text-indigo-400"}),"Update Vapi Assistant"]})}),t&&n.jsx(Ea,{agent:t,details:a,isLoading:l,onUpdateField:nt,onUpdateSystemMessage:yt,onDelete:ke,onPublishToggle:at,isPublished:Te.has(String(t.id)),isSaving:f.isPending,onTalkToAssistant:()=>m(!0),MODEL_PROVIDERS:ja,VOICE_PROVIDERS:Sa,TRANSCRIBER_PROVIDERS:wa,getProviderModels:xa,getProviderVoices:_a,getTranscriberModels:ba,normalizeProviderValue:Je,getInitials:V})]})}),n.jsx(qt,{open:j,onOpenChange:F,children:n.jsxs(Bt,{className:"bg-[#0b0f2e] border-white/10 w-[500px] text-white sm:max-w-[425px]",children:[n.jsx($t,{children:n.jsxs(Jt,{className:"flex items-center gap-2 text-red-400",children:[n.jsx(va,{className:"h-5 w-5"}),"Delete Assistant"]})}),n.jsx("div",{className:"py-4",children:n.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-red-500/10 rounded-lg border border-red-400/30",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(va,{className:"h-8 w-8 text-red-400"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-sm font-medium text-red-300",children:"Are you sure you want to delete this assistant?"}),n.jsxs("div",{className:"mt-2 text-sm text-red-200/80",children:[n.jsxs("p",{children:[n.jsx("strong",{children:D==null?void 0:D.name})," will be permanently deleted from both the provider and your database. This action cannot be undone."]}),n.jsxs("div",{className:"mt-2 text-xs text-red-300/70",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Agent ID:"})," ",D==null?void 0:D.id]}),(D==null?void 0:D.assistant_id)&&n.jsxs("p",{children:[n.jsx("strong",{children:"Provider Assistant ID:"})," ",D.assistant_id]})]})]})]})]})}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx(je,{variant:"outline",onClick:()=>F(!1),disabled:v.isPending,className:"border-white/20 text-white/70 bg-white/10 hover:bg-white/10 hover:text-white",children:"Cancel"}),n.jsx(je,{variant:"destructive",onClick:Be,disabled:v.isPending,className:"bg-red-600 hover:bg-red-700",children:v.isPending?n.jsxs(n.Fragment,{children:[n.jsx(Mt,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Delete Assistant"]})})]})]})}),d&&n.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[n.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:()=>m(!1)}),n.jsxs("div",{className:"ml-auto relative bg-[#0b0f2e] w-1/2 h-full shadow-2xl border-l border-white/10 transform transition-transform duration-300 ease-in-out",children:[n.jsx("div",{className:"bg-[#0b0f2e] border-b border-white/10 p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(tr,{className:"h-10 w-10 ring-2 ring-white/10",children:n.jsx(sr,{className:"text-white bg-gradient-to-br from-indigo-500/30 to-purple-500/30 font-medium",children:V((t==null?void 0:t.name)||"")})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:t==null?void 0:t.name}),n.jsx("p",{className:"text-white/50 text-sm",children:"AI Voice Assistant"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{id:"call-button-container",className:"min-w-[100px] min-h-[40px] bg-red-500/20 border border-red-400/30 rounded flex items-center justify-center"}),n.jsx(je,{variant:"ghost",size:"sm",onClick:()=>m(!1),className:"text-white/40 hover:text-white hover:bg-white/10 h-8 w-8 p-0 rounded-full",children:"×"})]})]})}),n.jsx("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:t&&n.jsx(Zh,{agentId:String(t.id),agentName:t.name||"Unknown Agent",agentConfig:{...a,assistant_id:t.assistant_id||(a==null?void 0:a.assistant_id),firstMessage:(a==null?void 0:a.firstMessage)||`Hello! I'm ${t.name}. How can I help you today?`,systemMessage:((_t=(Lt=(bt=a==null?void 0:a.model)==null?void 0:bt.messages)==null?void 0:Lt[0])==null?void 0:_t.content)||`You are ${t.name}, a helpful AI assistant.`},onCallStart:()=>{console.log("🎙️ Started call with assistant:",t.name),X.success(`Connected to ${t.name}`)},onCallEnd:()=>{console.log("🎙️ Ended call with assistant:",t.name),X.info("Call ended")},onError:S=>{console.error("🎙️ Call error:",S),X.error(`Call error: ${S.message}`)}})})]})]}),n.jsx(em,{open:T,onOpenChange:N,onTemplateSelect:te,onCreateCustom:ne}),n.jsx(mm,{isOpen:k,onClose:()=>y(!1),onSuccess:()=>{$e.invalidateQueries({queryKey:["syncedAgents"]}),$e.invalidateQueries({queryKey:["agents"]})}})]})};export{Em as default};
//# sourceMappingURL=VapiStyleAgents-DQ1Bntxs.js.map
