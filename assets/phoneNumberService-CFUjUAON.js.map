{"version":3,"file":"phoneNumberService-CFUjUAON.js","sources":["../../src/api/services/phoneNumbers/phoneNumberService.ts"],"sourcesContent":["import axiosInstance from \"@/api/axios/axiosInstance\";\nimport { toast } from \"sonner\";\n\n// Types\nexport interface PhoneNumber {\n  id: string;\n  number: string;\n  friendlyName?: string;\n  provider?: string;\n  capabilities?: {\n    voice: boolean;\n    sms: boolean;\n    mms: boolean;\n  };\n  status: \"active\" | \"inactive\" | \"pending\";\n  assistantId?: string;\n  createdAt?: string;\n  updatedAt?: string;\n  // User information\n  user_id?: string;\n  user_name?: string;\n  user_email?: string;\n  created_by?: string;\n  local_created_at?: string;\n  // VAPI phone number properties\n  vapi_id?: string;\n  local_id?: string;\n  country_code?: string;\n  type?: string;\n  cost?: number;\n  first_name?: string;\n  last_name?: string;\n  assigned_at?: string;\n  updated_at?: string;\n  // Status flags\n  is_assigned?: boolean;\n  is_in_local_db?: boolean;\n}\n\nexport interface PhoneNumberConfig {\n  provider: string;\n  phoneNumber: string;\n  name?: string;\n  assistantId?: string;\n  squadId?: string;\n  workflowId?: string;\n  fallbackDestination?: string;\n  serverUrl?: string;\n  serverUrlSecret?: string;\n  // Provider-specific credentials\n  twilioAccountSid?: string;\n  twilioAuthToken?: string;\n  vonageApiKey?: string;\n  vonageApiSecret?: string;\n  telnyxApiKey?: string;\n  telnyxApiSecret?: string;\n  // VAPI specific\n  areaCode?: string;\n}\n\nexport interface AvailablePhoneNumber {\n  number: string;\n  friendlyName?: string;\n  locality?: string;\n  region?: string;\n  country?: string;\n  capabilities?: {\n    voice: boolean;\n    sms: boolean;\n    mms: boolean;\n  };\n  monthlyPrice?: number;\n}\n\nexport interface PhoneNumberSearchParams {\n  areaCode?: string;\n  contains?: string;\n  locality?: string;\n  region?: string;\n  country?: string;\n  limit?: number;\n}\n\n// Get all phone numbers\nexport async function getAllPhoneNumbers(page?: number, search?: string) {\n  try {\n    const res = await axiosInstance.get(\"/api/phone-numbers\", {\n      params: { page, search },\n    });\n    return res.data;\n  } catch (error) {\n    console.error(\"Error fetching phone numbers:\", error);\n    toast.error(\"Failed to fetch phone numbers\");\n    throw error;\n  }\n}\n\n// Get phone number by ID\nexport async function getPhoneNumberById(id: string) {\n  try {\n    const res = await axiosInstance.get(`/api/phone-numbers/${id}`);\n    return res.data;\n  } catch (error) {\n    console.error(\"Error fetching phone number:\", error);\n    toast.error(\"Failed to fetch phone number\");\n    throw error;\n  }\n}\n\n// Create phone number\nexport async function createPhoneNumber(data: PhoneNumberConfig) {\n  try {\n    const res = await axiosInstance.post(\"/api/phone-numbers\", data);\n    toast.success(\"Phone number created successfully\");\n    return res.data;\n  } catch (error: any) {\n    console.error(\"Error creating phone number:\", error);\n    const message = error.response?.data?.message || \"Failed to create phone number\";\n    toast.error(message);\n    throw error;\n  }\n}\n\n// Update phone number\nexport async function updatePhoneNumber(id: string, data: Partial<PhoneNumberConfig>) {\n  try {\n    const res = await axiosInstance.patch(`/api/phone-numbers/${id}`, data);\n    toast.success(\"Phone number updated successfully\");\n    return res.data;\n  } catch (error: any) {\n    console.error(\"Error updating phone number:\", error);\n    const message = error.response?.data?.message || \"Failed to update phone number\";\n    toast.error(message);\n    throw error;\n  }\n}\n\n// Delete phone number\nexport async function deletePhoneNumber(id: string) {\n  try {\n    const res = await axiosInstance.delete(`/api/phone-numbers/${id}`);\n    toast.success(\"Phone number deleted successfully\");\n    return res.data;\n  } catch (error: any) {\n    console.error(\"Error deleting phone number:\", error);\n    const message = error.response?.data?.message || \"Failed to delete phone number\";\n    toast.error(message);\n    throw error;\n  }\n}\n\n// Buy new phone number\nexport async function buyPhoneNumber(data: {\n  number: string;\n  friendlyName?: string;\n  assistantId?: string;\n}) {\n  try {\n    const res = await axiosInstance.post(\"/api/phone-numbers/buy\", data);\n    toast.success(\"Phone number purchased successfully\");\n    return res.data;\n  } catch (error: any) {\n    console.error(\"Error buying phone number:\", error);\n    const message = error.response?.data?.message || \"Failed to purchase phone number\";\n    toast.error(message);\n    throw error;\n  }\n}\n\n// Import Twilio phone number\nexport async function importTwilioPhoneNumber(data: {\n  twilioPhoneNumber: string;\n  twilioAccountSid: string;\n  twilioAuthToken: string;\n  twilioLabel: string;\n  assistantId?: string;\n  smsEnabled?: boolean;\n}) {\n  try {\n    const res = await axiosInstance.post(\"/api/phone-numbers/import/twilio\", data);\n    toast.success(\"Twilio phone number imported successfully\");\n    return res.data;\n  } catch (error: any) {\n    console.error(\"Error importing Twilio phone number:\", error);\n    const message = error.response?.data?.message || \"Failed to import Twilio phone number\";\n    toast.error(message);\n    throw error;\n  }\n}\n\n// Search available phone numbers\nexport async function searchAvailablePhoneNumbers(params: PhoneNumberSearchParams) {\n  try {\n    const res = await axiosInstance.get(\"/api/phone-numbers/search/available\", {\n      params,\n    });\n    return res.data;\n  } catch (error) {\n    console.error(\"Error searching available phone numbers:\", error);\n    toast.error(\"Failed to search available phone numbers\");\n    throw error;\n  }\n}\n\n// Super Admin Functions\n\n// Get all phone numbers for super admin\nexport async function getAllPhoneNumbersForAdmin() {\n  try {\n    const res = await axiosInstance.get(\"/api/phone-numbers/admin/all\");\n    return res.data;\n  } catch (error) {\n    console.error(\"Error fetching all phone numbers for admin:\", error);\n    toast.error(\"Failed to fetch phone numbers\");\n    throw error;\n  }\n}\n\n// Get all VAPI phone numbers with assignment info for super admin\nexport async function getAllVapiPhoneNumbersForAdmin() {\n  try {\n    const res = await axiosInstance.get(\"/api/phone-numbers/admin/vapi-all\");\n    return res.data;\n  } catch (error) {\n    console.error(\"Error fetching all VAPI phone numbers for admin:\", error);\n    toast.error(\"Failed to fetch VAPI phone numbers\");\n    throw error;\n  }\n}\n\n// Assign phone number to user\nexport async function assignPhoneNumberToUser(phoneNumberId: string, userId: string) {\n  try {\n    const res = await axiosInstance.post(`/api/phone-numbers/${phoneNumberId}/assign`, {\n      user_id: userId\n    });\n    return res.data;\n  } catch (error) {\n    console.error(\"Error assigning phone number:\", error);\n    toast.error(\"Failed to assign phone number\");\n    throw error;\n  }\n}\n\n// Unassign phone number\nexport async function unassignPhoneNumber(phoneNumberId: string) {\n  try {\n    const res = await axiosInstance.post(`/api/phone-numbers/${phoneNumberId}/unassign`);\n    return res.data;\n  } catch (error) {\n    console.error(\"Error unassigning phone number:\", error);\n    toast.error(\"Failed to unassign phone number\");\n    throw error;\n  }\n}\n"],"names":["getAllPhoneNumbers","page","search","axiosInstance","error","toast","getPhoneNumberById","id","createPhoneNumber","data","res","message","_b","_a","updatePhoneNumber","deletePhoneNumber","buyPhoneNumber","importTwilioPhoneNumber","searchAvailablePhoneNumbers","params","getAllVapiPhoneNumbersForAdmin","assignPhoneNumberToUser","phoneNumberId","userId","unassignPhoneNumber"],"mappings":"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"}