import{j as e,bg as ut,aB as Ke,T as ft,as as oe,aw as z,D as Ze,N as ys,b as gt,b5 as vs,H as jt,b2 as bt,ar as Cs,F as pt,aU as ws,bh as Nt,aX as yt,C as vt,aQ as Ct,bi as wt,M as St,bj as kt,bk as Et,bl as At,bm as Dt,b8 as Pt}from"./ui-S570Xcny.js";import{r as a}from"./vendor-DG599jyl.js";import{P as Ft}from"./Page-BJWqKr2O.js";import{c as It,b as Lt,d as _t,e as Mt,f as $t,u as Tt,r as Ut}from"./contactService-Dn3b2od7.js";import{createOutboundCall as Ht,unmuteCall as qt,muteCall as Bt,endCallViaControl as zt}from"./outboundService-Cg0vzci1.js";import{f as Rt}from"./agentService-CSD2ntxe.js";import{g as Ot}from"./phoneNumberService-okmGsQRH.js";import{s as Vt}from"./gmailService-BrHU3Xj1.js";import{g as Gt,f as Wt,h as Ss,a as Yt,b as Qt,c as Xt,C as Jt}from"./CallRecordingPlayer-ASK-9Eug.js";import{c as Kt,u as Zt}from"./router-BavLd_S0.js";import{u as ea,a as sa}from"./resolvers-BzctgYTE.js";import{o as ta,c as ks,b as aa,a as Y}from"./index.esm-C7RSptL2.js";import{B as d}from"./button-BSd9MMPp.js";import{I as j}from"./input-jxB46izN.js";import{L as y}from"./label-C1-UM1F-.js";import{S as ra,a as la,b as na,c as ca,d as ia}from"./sheet-C7DsuPAk.js";import{S as oa,a as da,b as ma,c as xa,d as ie}from"./select-D0_OqHwT.js";import{u as As,a as ha,d as Ds,t as n,e as ua,j as fa}from"./index-C95eVPAi.js";import{T as ga}from"./textarea-Cw4zrZDH.js";import{D as es,a as ss,b as ts,c as as,e as ja,f as ba}from"./dialog-DGdhV35L.js";import{B as Ge}from"./badge-ij7fArnn.js";import{A as We,a as Ye}from"./avatar-Cwu0Oo_-.js";import{T as pa,a as Na,b as Qe,c as Xe}from"./tabs-CbOWgAXT.js";import{u as ya}from"./usePermissions-BYlEuFrr.js";import{D as va,a as Ca,b as wa,e as Je,d as Es}from"./dropdown-menu-Bxst4dXB.js";import{A as Sa,a as ka,b as Ea,c as Aa,d as Da,e as Pa,f as Fa,g as Ia}from"./alert-dialog-CmVht1cJ.js";import{C as La}from"./ChatSidebar-CBNqHhyD.js";import"./scroll-area-C-pzVjaj.js";import"./index-BHBJ6RT-.js";import"./index-CWMUKvWL.js";import"./slider-DHO3HMwz.js";import"./index-HDeFwIcs.js";import"./query-Cab5P5bd.js";import"./messagingService-tb0qZaMs.js";const _a=ks().shape({listName:Y().required("List Name is required").min(2,"List Name must be at least 2 characters"),description:Y().required("Description is required"),type:Y().required("Type is required"),contacts:aa().of(ks().shape({fullName:Y().required("Full Name is required").min(2,"Full Name must be at least 2 characters"),email:Y().required("Email is required").email("Email is invalid"),phoneNumber:Y().required("Phone Number is required").matches(/^\+1[0-9]{10}$/,"Phone Number must start with +1 followed by 10 digits (e.g., +1234567890)")})).required("Contacts are required").min(1,"At least one contact is required")});function Ma(){a.useRef(null);const[R,P]=a.useState(!1),[de,L]=a.useState(0),{user:r}=As(),{isSuperAdmin:Ee}=ha(),{register:F,control:Q,handleSubmit:l,formState:{errors:h,isSubmitting:me},reset:xe,watch:Ae,setValue:he}=ea({resolver:ta(_a),defaultValues:{listName:"",description:"",type:"General",contacts:[{fullName:"",email:"",phoneNumber:""}]}}),{fields:_,append:De,remove:M}=sa({control:Q,name:"contacts"}),Pe=()=>{var c,v;const b=ua.getItem("token");if(!b)return console.log("No token found in storage"),null;try{const i=fa(b);console.log("Decoded token:",i);let p=null;return(c=i.user)!=null&&c.id?p=i.user.id:(v=i.user)!=null&&v.user_id?p=i.user.user_id:i.id?p=i.id:i.user_id&&(p=i.user_id),console.log("Extracted userId:",p),p}catch(i){return console.error("Error decoding token:",i),null}},rs=async b=>{if(!Ee)try{const i=(await Ds.get("/api/credits/balance")).data.data;if(!i||parseFloat(i.available_credits)<1){L((i==null?void 0:i.available_credits)||0),P(!0);return}}catch(v){console.error("Error checking credit balance:",v),n.error("Unable to verify credit balance. Please try again.");return}const c=Pe();if(!c){n.error("User ID not found. Please log in again.");return}try{const v=await It({listName:b.listName,description:b.description,type:b.type}),i=b.contacts.map($=>({email:$.email,contact_number:$.phoneNumber,first_name:$.fullName})),p={user_id:c,list_name:b.listName,list_description:b.description,contacts:i};await Lt(p),xe({listName:"",description:"",type:"General",contacts:[{fullName:"",email:"",phoneNumber:""}]}),n.success("Contact List created successfully!"),typeof window<"u"&&window.location.reload()}catch(v){console.error("Error submitting form:",v),n.error("Failed to create contact list. Please try again.")}};return e.jsxs(e.Fragment,{children:[e.jsx(ra,{className:"text-xl font-semibold jakarta bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-1",children:"Create Contact List"}),e.jsx(la,{className:"text-muted-foreground mb-6",children:"Create a new contact list for your voice AI agents to use for campaigns."}),e.jsxs("form",{onSubmit:l(rs),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ut,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"List Information"})]}),e.jsxs("div",{children:[e.jsxs(y,{htmlFor:"listName",className:"text-sm font-medium text-foreground mb-1.5 block",children:["List Name",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(j,{id:"listName",placeholder:"Enter contact list name",className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...F("listName")}),h.listName&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.listName.message})]}),e.jsxs("div",{children:[e.jsxs(y,{htmlFor:"description",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Description",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ga,{id:"description",placeholder:"Enter contact list description",className:"w-full min-h-[80px] border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...F("description")}),h.description&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.description.message})]}),e.jsxs("div",{children:[e.jsxs(y,{htmlFor:"type",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Type",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(oa,{value:Ae("type"),onValueChange:b=>he("type",b),children:[e.jsx(da,{className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",children:e.jsx(ma,{placeholder:"Select list type"})}),e.jsxs(xa,{children:[e.jsx(ie,{value:"General",children:"General"}),e.jsx(ie,{value:"Marketing",children:"Marketing"}),e.jsx(ie,{value:"Sales",children:"Sales"}),e.jsx(ie,{value:"Event",children:"Event"}),e.jsx(ie,{value:"Customer",children:"Customer"})]})]}),h.type&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:h.type.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ke,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Contacts"}),e.jsx("span",{className:"text-xs text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-4",children:[_.map((b,c)=>{var v,i,p,$,ue,fe,O,ge,T;return e.jsxs("div",{className:"border border-border/50 rounded-lg p-4 mb-4 relative bg-card/50",children:[_.length>1&&e.jsx("button",{type:"button",onClick:()=>M(c),className:"absolute top-3 right-3 text-muted-foreground hover:text-red-500 transition-colors",title:"Remove Contact",children:e.jsx(ft,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("div",{className:"h-6 w-6 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-primary",children:c+1})}),e.jsxs("h4",{className:"text-sm font-medium",children:["Contact ",c+1]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs(y,{htmlFor:`contacts.${c}.fullName`,className:"text-sm font-medium text-foreground mb-1.5 block",children:["Full Name",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"relative",children:e.jsx(j,{id:`contacts.${c}.fullName`,type:"text",placeholder:"Enter full name",className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...F(`contacts.${c}.fullName`)})}),((i=(v=h.contacts)==null?void 0:v[c])==null?void 0:i.fullName)&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:(p=h.contacts[c].fullName)==null?void 0:p.message})]}),e.jsxs("div",{children:[e.jsxs(y,{htmlFor:`contacts.${c}.email`,className:"text-sm font-medium text-foreground mb-1.5 block",children:["Email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{id:`contacts.${c}.email`,type:"email",placeholder:"Enter contact email",className:"w-full pl-10 border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...F(`contacts.${c}.email`)})]}),((ue=($=h.contacts)==null?void 0:$[c])==null?void 0:ue.email)&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:(fe=h.contacts[c].email)==null?void 0:fe.message})]}),e.jsxs("div",{children:[e.jsxs(y,{htmlFor:`contacts.${c}.phoneNumber`,className:"text-sm font-medium text-foreground mb-1.5 block",children:["Phone Number",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{id:`contacts.${c}.phoneNumber`,type:"tel",placeholder:"Enter phone number with +1 (e.g., +1234567890)",className:"w-full pl-10 border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...F(`contacts.${c}.phoneNumber`)})]}),((ge=(O=h.contacts)==null?void 0:O[c])==null?void 0:ge.phoneNumber)&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:(T=h.contacts[c].phoneNumber)==null?void 0:T.message})]})]})]},b.id)}),e.jsxs(d,{type:"button",variant:"outline",className:"w-full border-dashed border-border/50 hover:bg-muted/20 flex items-center justify-center gap-2 py-6",onClick:()=>De({fullName:"",email:"",phoneNumber:""}),children:[e.jsx(Ze,{className:"w-4 h-4"}),"Add Another Contact"]})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx(na,{asChild:!0,children:e.jsx(d,{type:"button",variant:"outline",className:"border-border/50 text-foreground hover:bg-muted/20",children:"Cancel"})}),e.jsx(d,{type:"submit",className:"btn-gradient text-white",disabled:me,children:me?"Creating...":"Create List"})]})]}),e.jsx(es,{open:R,onOpenChange:P,children:e.jsxs(ss,{className:"sm:max-w-md",children:[e.jsx(ts,{children:e.jsxs(as,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Insufficient Credits"}),e.jsx("p",{className:"text-sm text-gray-500 font-normal",children:"You need credits to create contact lists"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Current Balance:"}),e.jsxs("span",{className:"font-semibold",children:[de," credits"]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Required:"}),e.jsx("span",{className:"font-semibold text-red-600",children:"1 credit minimum"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{variant:"outline",onClick:()=>P(!1),className:"flex-1",children:"Cancel"}),e.jsx(d,{onClick:()=>{P(!1),window.location.href="/credits"},className:"flex-1 bg-primary hover:bg-primary/90",children:"Buy Credits"})]})]})]})})]})}const jr=()=>{Kt(),Zt();const{isSuperAdmin:R}=ya(),{user:P}=As(),[de,L]=a.useState([]),[r,Ee]=a.useState(null),[F,Q]=a.useState([]),[l,h]=a.useState(null),[me,xe]=a.useState(!0),[Ae,he]=a.useState(!1),[_,De]=a.useState(""),[M,Pe]=a.useState(""),[rs,b]=a.useState("list"),[c,v]=a.useState("list"),[i,p]=a.useState(1),[$,ue]=a.useState(0),[fe,O]=a.useState(!1),[ge,T]=a.useState(!1),[Ps,Fs]=a.useState(0),[je,X]=a.useState(!1),[C,J]=a.useState({fullName:"",email:"",phoneNumber:""}),[Is,be]=a.useState(!1),[S,V]=a.useState({fullName:"",email:"",phoneNumber:""}),[Ls,K]=a.useState(!1),[N,_s]=a.useState(null),[U,Ms]=a.useState([]),[ls,$s]=a.useState([]),[H,Fe]=a.useState(""),[G,Ie]=a.useState(""),[ns,cs]=a.useState(!1),[k,Le]=a.useState(null),[I,_e]=a.useState(!1),[Z,pe]=a.useState(!1),[q,Me]=a.useState(!1),[E,$e]=a.useState(null),[Ts,Ne]=a.useState(0),[ye,Te]=a.useState(null),[A,Ue]=a.useState(null),[is,He]=a.useState(null),[qe,Be]=a.useState([]),[Us,os]=a.useState(!1),[ds,ms]=a.useState(1),[xs,ze]=a.useState(0),[Hs,hs]=a.useState(null),[qs,us]=a.useState(!1),[Bs,fs]=a.useState(!1),[ve,gs]=a.useState(null),[zs,Ce]=a.useState(!1),[W,Rs]=a.useState(null),[u,B]=a.useState({to:"",cc:"",bcc:"",subject:"",body:"",attachments:[]}),[Re,js]=a.useState(!1),Os=async()=>{if(R){O(!0);return}try{const t=(await Ds.get("/api/credits/balance")).data.data;if(!t||parseFloat(t.available_credits)<1){Fs((t==null?void 0:t.available_credits)||0),T(!0);return}O(!0)}catch(s){console.error("Error checking credit balance:",s),n.error("Unable to verify credit balance. Please try again.")}},bs=async()=>{try{xe(!0);const s=await _t(1,_,R);if(s.success){const t=Array.isArray(s.data)?s.data:[];L(t)}else L([])}catch(s){console.error("Error fetching lists:",s),L([])}finally{xe(!1)}},we=async s=>{var t,f,m,w,ee,se,te,ae,re,x,g,le,ne,ke;try{he(!0);const o=await Mt(s.toString(),i,M);if(console.log("Full API response:",o),o.success){const ce=Array.isArray((t=o.data)==null?void 0:t.contacts)?o.data.contacts:[];console.log("Extracted contacts:",ce),Q(ce),ue(((m=(f=o.data)==null?void 0:f.pagination)==null?void 0:m.totalPages)||1)}else console.log("Response not successful:",o),Q([])}catch(o){console.error("Error fetching contacts:",o);const ce=D=>typeof D=="object"&&D!==null,ht=D=>typeof D=="object"&&D!==null&&"message"in D&&typeof D.message=="string";if(ce(o)&&(((w=o.response)==null?void 0:w.status)===404||((te=(se=(ee=o.response)==null?void 0:ee.data)==null?void 0:se.message)==null?void 0:te.toLowerCase().includes("not found"))||((x=(re=(ae=o.response)==null?void 0:ae.data)==null?void 0:re.error)==null?void 0:x.toLowerCase().includes("not found"))))console.error("Error details:",((ke=o.response)==null?void 0:ke.data)||o.message);else if(ce(o)){console.error("Error details:",((g=o.response)==null?void 0:g.data)||o.message);const D=((ne=(le=o.response)==null?void 0:le.data)==null?void 0:ne.error)||o.message||"Unknown error occurred";n.error(`Failed to fetch contacts: ${D}`)}else ht(o)?(console.error("Error details:",o.message),n.error(`Failed to fetch contacts: ${o.message}`)):(console.error("Error details:",String(o)),n.error("Failed to fetch contacts: Unknown error occurred"));Q([])}finally{he(!1)}};a.useEffect(()=>{bs()},[_,R]),a.useEffect(()=>{r&&we(r.id)},[r,i,M]),a.useEffect(()=>{l&&l.phoneNumber&&Ws(l)},[l,ds]);const Vs=s=>{if(s.is_deleted&&!R){n.error("This list has been disabled and is not accessible.");return}console.log("Selected list:",s),Ee(s),h(null),X(!1),be(!1),p(1)},Gs=s=>{h(s),Be([]),ms(1),ze(0)},Ws=async s=>{if(s.phoneNumber)try{os(!0);const t=await Gt(s.phoneNumber,ds,10);Be(t.calls),ze(t.totalCalls)}catch(t){console.error("Error fetching call history:",t),Be([]),ze(0)}finally{os(!1)}},Ys=async s=>{if(Ss(s))try{hs(s),us(!0)}catch(t){console.error("Error playing recording:",t),n.error("Failed to play recording")}},Qs=s=>{J({fullName:s.fullName||"",email:s.email||"",phoneNumber:s.phoneNumber||""}),X(!0)},Xs=async()=>{if(!l)return;const s=/^\+1[0-9]{10}$/;if(C.phoneNumber&&!s.test(C.phoneNumber)){n.error("Phone Number must start with +1 followed by 10 digits (e.g., +1234567890)");return}try{await Tt(l.id.toString(),C),n.success("Contact updated successfully"),X(!1),r&&we(r.id),h({...l,...C})}catch(t){console.error("Error updating contact:",t)}},Js=()=>{X(!1),J({fullName:"",email:"",phoneNumber:""})},Ks=async()=>{if(!r||!S.fullName||!S.email||!S.phoneNumber){n.error("Please fill in all required fields");return}if(!/^\+1[0-9]{10}$/.test(S.phoneNumber)){n.error("Phone Number must start with +1 followed by 10 digits (e.g., +1234567890)");return}try{await $t(r.id.toString(),{fullName:S.fullName,email:S.email,contact_number:S.phoneNumber,phoneNumber:S.phoneNumber}),n.success("Contact added successfully"),we(r.id),L(t=>t.map(f=>f.id===r.id?{...f,contactCount:f.contactCount+1}:f)),be(!1),V({fullName:"",email:"",phoneNumber:""})}catch(t){console.error("Error adding contact:",t)}},Zs=()=>{be(!1),V({fullName:"",email:"",phoneNumber:""})},et=async()=>{var s,t,f;try{const[m,w]=await Promise.all([Rt(""),Ot()]);console.log("🔍 Debug - Loaded dialer data:",{agentsCount:((s=m==null?void 0:m.data)==null?void 0:s.length)||0,phoneNumbersCount:((t=w==null?void 0:w.data)==null?void 0:t.length)||0,sampleAgent:(f=m==null?void 0:m.data)!=null&&f[0]?{id:m.data[0].id,assistant_id:m.data[0].assistant_id,name:m.data[0].name}:null}),Ms((m==null?void 0:m.data)||[]),$s((w==null?void 0:w.data)||[])}catch(m){console.error("Error loading dialer data:",m)}},ps=async s=>{if(!s.phoneNumber){n.error("Contact has no phone number");return}_s(s),K(!0),(U.length===0||ls.length===0)&&await et()},st=s=>{if(!s.phoneNumber){n.error("Contact has no phone number for messaging");return}gs(s),fs(!0)},tt=s=>{if(!s.email){n.error("Contact has no email address");return}Rs(s),B({to:s.email,cc:"",bcc:"",subject:"",body:"",attachments:[]}),Ce(!0)},at=async()=>{if(!u.to||!u.subject||!u.body){n.error("Please fill in To, Subject, and Body fields");return}js(!0);try{await Vt({to:u.to,cc:u.cc||void 0,bcc:u.bcc||void 0,subject:u.subject,body:u.body,isHtml:!1,attachments:u.attachments}),n.success("Email sent successfully!"),Ce(!1),B({to:"",cc:"",bcc:"",subject:"",body:"",attachments:[]})}catch(s){console.error("Error sending email:",s)}finally{js(!1)}},rt=s=>{let t=s.replace(/\D/g,"");if(t.length===10)t="1"+t;else if(!(t.length===11&&t.startsWith("1"))){if(t.length<10)throw new Error("Phone number is too short")}return"+"+t},lt=async()=>{var f,m,w,ee,se,te,ae,re;if(!N||!H||!G){n.error("Please select an agent and from number");return}console.log("🔍 Debug - Making call with:",{selectedAgent:H,availableAgents:U.map(x=>({id:x.id,assistant_id:x.assistant_id,name:x.name})),dialerContact:N.fullName,selectedFromNumber:G});let s=U.find(x=>x.id===H);if(s||(s=U.find(x=>x.assistant_id===H)),!s){console.error("❌ Selected agent not found in agents array:",{selectedAgent:H,availableAgentIds:U.map(x=>x.id),availableAssistantIds:U.map(x=>x.assistant_id)}),n.error("Selected agent not found");return}const t=s.assistant_id||s.id;console.log("Making call with:",{selectedAgentData:s,assistantUUID:t,originalPhoneNumber:N.phoneNumber,selectedFromNumber:G}),cs(!0);try{const x=rt(N.phoneNumber);console.log("Formatted phone number:",x);const g=await Ht({assistantId:t,phoneNumber:x,phoneNumberId:G,metadata:{contactId:N.id,contactName:N.fullName,listId:r==null?void 0:r.id,listName:r==null?void 0:r.list_name}});console.log("📞 Call response:",g),console.log("📞 Call response structure:",{id:g.id,callId:g.callId,data:g.data,monitor:g.monitor,dataMonitor:(f=g.data)==null?void 0:f.monitor,controlUrl:((m=g.monitor)==null?void 0:m.controlUrl)||((ee=(w=g.data)==null?void 0:w.monitor)==null?void 0:ee.controlUrl)}),n.success(`Call initiated to ${N.fullName}`),He(g);const le=g.id||g.callId||((se=g.data)==null?void 0:se.id),ne=((te=g.monitor)==null?void 0:te.controlUrl)||((re=(ae=g.data)==null?void 0:ae.monitor)==null?void 0:re.controlUrl);console.log("📞 Extracted call control data:",{callId:le,controlUrl:ne}),$e(le),Ue(ne),_e(!0),Ne(0);const ke=setInterval(()=>{Ne(o=>o+1)},1e3);Te(ke)}catch(x){console.error("Error making call:",x)}finally{cs(!1)}},nt=async()=>{if(console.log("🔇 Mute toggle - Call control data:",{currentCallId:E,callControlUrl:A,isMuted:Z,callData:is}),!E||!A){console.error("❌ Call control not available:",{currentCallId:E,callControlUrl:A}),n.error("Call control not available - missing call ID or control URL");return}try{Z?(await qt(E,A),pe(!1)):(await Bt(E,A),pe(!0))}catch(s){console.error("Error toggling mute:",s)}},ct=()=>{Me(!q),n.success(q?"Call resumed":"Call on hold")},it=async()=>{if(console.log("📞 End call - Call control data:",{currentCallId:E,callControlUrl:A,callData:is}),!E||!A){console.error("❌ Call control not available:",{currentCallId:E,callControlUrl:A}),ye&&(clearInterval(ye),Te(null)),_e(!1),pe(!1),Me(!1),$e(null),Ue(null),He(null),Ne(0),K(!1),Fe(""),Ie("");return}ye&&(clearInterval(ye),Te(null)),_e(!1),pe(!1),Me(!1),$e(null),Ue(null),He(null),Ne(0),K(!1),Fe(""),Ie("");try{zt(E,A).catch(s=>{console.error("Background call ending failed:",s)})}catch(s){console.error("Error initiating call end:",s)}},ot=s=>{const t=Math.floor(s/60),f=s%60;return`${t.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`},dt=()=>{r&&(h(null),X(!1),be(!0),V({fullName:"",email:"",phoneNumber:""}))},mt=s=>{Le(s)},xt=async()=>{if(!(!r||!k))try{await Ut(r.id.toString(),k.id.toString()),n.success("Contact removed from list successfully"),we(r.id),L(s=>s.map(t=>t.id===r.id?{...t,contactCount:Math.max(0,t.contactCount-1)}:t)),(l==null?void 0:l.id)===k.id&&h(null),Le(null)}catch(s){console.error("Error removing contact:",s)}},Ns=s=>s.substring(0,2).toUpperCase(),Oe=s=>s?s.replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3"):"N/A",Se=Array.isArray(de)?de.filter(s=>s.list_name.toLowerCase().includes(_.toLowerCase())):[],Ve=Array.isArray(F)?F.filter(s=>{var t;return s.email.toLowerCase().includes(M.toLowerCase())||((t=s.fullName)==null?void 0:t.toLowerCase().includes(M.toLowerCase()))}):[];return e.jsxs(Ft,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contacts"}),e.jsx(Ge,{variant:"secondary",className:"px-3 py-1 bg-red-100 text-red-600",children:e.jsx("span",{children:Se.length})}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Total Contact groups: ",Se.length]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(d,{onClick:Os,className:"bg-red-500 hover:bg-red-600",children:[e.jsx(Ze,{className:"h-4 w-8 mr-2"}),"Add"]})})]}),e.jsxs("div",{className:"flex h-[calc(100vh-200px)] gap-4",children:[e.jsxs("div",{className:"w-80 bg-white border border-gray-300 rounded-lg flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Contact Groups"}),e.jsxs("div",{className:"relative",children:[e.jsx(ys,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(j,{placeholder:"Search",value:_,onChange:s=>De(s.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:me?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading..."}):Se.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No groups found"}):e.jsx("div",{className:"p-2",children:Se.map(s=>e.jsx("div",{onClick:()=>Vs(s),className:`flex items-center p-3 rounded-lg cursor-pointer mb-1 transition-colors ${(r==null?void 0:r.id)===s.id?"bg-gray-900 text-white":"hover:bg-gray-100"} ${s.is_deleted?"opacity-50":""}`,children:e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(We,{className:"h-8 w-8",children:e.jsx(Ye,{className:(r==null?void 0:r.id)===s.id?"bg-gray-700":"bg-gray-200",children:s.list_name.substring(0,2).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:s.list_name}),e.jsxs("div",{className:`text-xs ${(r==null?void 0:r.id)===s.id?"text-gray-300":"text-gray-500"}`,children:[s.contactCount," contacts"]})]}),e.jsx(Ge,{variant:"secondary",className:"text-xs",children:s.contactCount})]})},s.id))})})]}),e.jsxs("div",{className:"flex-1 bg-white border border-gray-300 rounded-lg flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:r?r.list_name:"Default"}),r&&e.jsxs("p",{className:"text-sm text-gray-500",children:[Ve.length," contacts"]})]}),e.jsxs(va,{modal:!1,children:[e.jsx(Ca,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm","aria-label":"Contact options",children:e.jsx(gt,{className:"h-4 w-4"})})}),e.jsxs(wa,{align:"end",side:"bottom",sideOffset:5,children:[e.jsxs(Je,{onClick:()=>dt(),children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Add Contacts"]}),e.jsx(Es,{}),e.jsxs(Je,{onClick:()=>l&&Qs(l),disabled:!l,children:[e.jsx(jt,{className:"h-4 w-4 mr-2"}),"Edit Contact"]}),e.jsx(Es,{}),e.jsxs(Je,{onClick:()=>l&&mt(l),className:"text-red-600 focus:text-red-600",disabled:!l,children:[e.jsx(bt,{className:"h-4 w-4 mr-2"}),"Remove from List"]})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ys,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(j,{placeholder:"Search",value:M,onChange:s=>Pe(s.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:r?Ae?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading contacts..."}):Ve.length===0?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(oe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No contacts found in this group"})]})}):e.jsx("div",{className:"p-2",children:Ve.map(s=>e.jsx("div",{onClick:()=>Gs(s),className:`flex items-center p-3 rounded-lg cursor-pointer mb-1 transition-colors ${(l==null?void 0:l.id)===s.id?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(We,{className:"h-10 w-10",children:e.jsx(Ye,{className:"bg-green-100 text-green-600",children:Ns(s.email)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.fullName||"No Name"}),e.jsx("div",{className:"text-sm text-gray-500 truncate",children:s.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{size:"sm",className:"rounded-full bg-green-600 hover:bg-green-700 text-white shadow-md p-2",onClick:t=>{t.stopPropagation(),ps(s)},children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(d,{size:"sm",className:"rounded-full bg-orange-600 hover:bg-orange-700 text-white shadow-md p-2",onClick:t=>{t.stopPropagation(),tt(s)},children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx(d,{size:"sm",className:"rounded-full bg-blue-600 hover:bg-blue-700 text-white shadow-md p-2",onClick:t=>{t.stopPropagation(),st(s)},children:e.jsx(Cs,{className:"h-4 w-4"})})]})]})},s.id))}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ke,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Select a contact group to view contacts"})]})})})]}),e.jsx("div",{className:"w-96 bg-white border border-gray-300 rounded-lg flex flex-col",children:Is?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-16 w-16 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(vs,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Add New Contact"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Add contact to ",r==null?void 0:r.list_name]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:Zs,children:"Cancel"}),e.jsx(d,{size:"sm",onClick:Ks,children:"Save"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Contact Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx(j,{value:S.fullName,onChange:s=>V(t=>({...t,fullName:s.target.value})),placeholder:"Enter full name",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx(j,{type:"email",value:S.email,onChange:s=>V(t=>({...t,email:s.target.value})),placeholder:"Enter email address",className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),e.jsx(j,{type:"tel",value:S.phoneNumber,onChange:s=>V(t=>({...t,phoneNumber:s.target.value})),placeholder:"Enter phone number with +1 (e.g., +1234567890)",className:"w-full"})]})]})]})})})]}):l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(We,{className:"h-16 w-16",children:e.jsx(Ye,{className:"bg-green-100 text-green-600 text-xl",children:Ns(l.email)})}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(d,{size:"sm",className:"rounded-full bg-green-600 hover:bg-green-700 text-white shadow-md p-2",onClick:()=>l&&ps(l),children:e.jsx(z,{className:"h-4 w-4"})})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-1",children:je?C.fullName||"No Name":l.fullName||"No Name"}),e.jsx("p",{className:"text-sm text-gray-500",children:Oe(je?C.phoneNumber:l.phoneNumber)})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"General Info"}),je&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:Js,children:"Cancel"}),e.jsx(d,{size:"sm",onClick:Xs,children:"Save"})]})]}),je?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-900 block mb-1",children:"Full Name"}),e.jsx(j,{value:C.fullName,onChange:s=>J({...C,fullName:s.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-900 block mb-1",children:"Phone Number"}),e.jsx(j,{value:C.phoneNumber,onChange:s=>J({...C,phoneNumber:s.target.value}),placeholder:"Enter phone number with +1 (e.g., +1234567890)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-900 block mb-1",children:"Email Address"}),e.jsx(j,{value:C.email,onChange:s=>J({...C,email:s.target.value}),placeholder:"Enter email address",type:"email"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Phone Number"}),e.jsx("p",{className:"text-sm text-gray-500",children:Oe(l.phoneNumber)})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(oe,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Email Address"}),e.jsx("p",{className:"text-sm text-gray-500",children:l.email})]})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Labels"}),e.jsx(d,{variant:"ghost",size:"sm",children:e.jsx(Ze,{className:"h-4 w-4"})})]})}),e.jsx("div",{children:e.jsxs(pa,{defaultValue:"notes",className:"w-full",children:[e.jsxs(Na,{className:"grid w-full grid-cols-3",children:[e.jsx(Qe,{value:"notes",className:"text-xs",children:"Notes"}),e.jsx(Qe,{value:"calls",className:"text-xs",children:"Call History"}),e.jsx(Qe,{value:"chats",className:"text-xs",children:"Chat History"})]}),e.jsx(Xe,{value:"notes",className:"mt-4",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"No notes yet"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Add your first note using the text area above"})]})}),e.jsx(Xe,{value:"calls",className:"mt-4",children:Us?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ws,{className:"h-8 w-8 mx-auto mb-4 text-gray-400 animate-spin"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading call history..."})]}):qe.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(z,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No call history"})]}):e.jsxs("div",{className:"space-y-3",children:[qe.map(s=>{const t=Wt(s.status),f=Ss(s);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(z,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Yt(s.created_at)}),e.jsx(Ge,{variant:"secondary",className:`text-xs ${t.color}`,children:t.text})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[f&&e.jsx(d,{size:"sm",variant:"ghost",onClick:()=>Ys(s),className:"h-6 w-6 p-0",children:e.jsx(Nt,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-xs text-gray-500",children:Qt(s.duration)})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsx("span",{children:s.assistant_name||"Unknown Assistant"}),e.jsx("span",{children:Xt(s.cost)})]})]},s.call_id)}),xs>10&&e.jsx("div",{className:"text-center pt-4",children:e.jsx(d,{variant:"outline",size:"sm",onClick:()=>ms(s=>s+1),disabled:qe.length>=xs,children:"Load More"})})]})}),e.jsx(Xe,{value:"chats",className:"mt-4",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Cs,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No chat history"})]})})]})})]})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ke,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Select a contact to view details"})]})})})]}),e.jsx(es,{open:ge,onOpenChange:T,children:e.jsxs(ss,{className:"sm:max-w-md",children:[e.jsx(ts,{children:e.jsxs(as,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(yt,{className:"w-4 h-4 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Insufficient Credits"}),e.jsx("p",{className:"text-sm text-gray-500 font-normal",children:"You need credits to create contact lists"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Current Balance:"}),e.jsxs("span",{className:"font-semibold",children:[Ps," credits"]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Required:"}),e.jsx("span",{className:"font-semibold text-red-600",children:"1 credit minimum"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(d,{variant:"outline",onClick:()=>T(!1),className:"flex-1",children:"Cancel"}),e.jsx(d,{onClick:()=>{T(!1),window.location.href="/credits"},className:"flex-1 bg-primary hover:bg-primary/90",children:"Buy Credits"})]})]})]})}),e.jsx(ca,{open:fe,onOpenChange:s=>{O(s),s||bs()},children:e.jsx(ia,{size:"half",children:e.jsx(Ma,{})})}),e.jsx(Sa,{open:!!k,onOpenChange:()=>Le(null),children:e.jsxs(ka,{children:[e.jsxs(Ea,{children:[e.jsx(Aa,{children:"Remove Contact from List"}),e.jsxs(Da,{children:['Are you sure you want to remove "',(k==null?void 0:k.fullName)||(k==null?void 0:k.email),'" from this list? This action cannot be undone.']})]}),e.jsxs(Pa,{children:[e.jsx(Fa,{children:"Cancel"}),e.jsx(Ia,{onClick:xt,className:"bg-red-600 hover:bg-red-700",children:"Remove Contact"})]})]})}),Ls&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-sm mx-auto overflow-hidden",children:[e.jsx("div",{className:`px-6 py-4 text-white ${I?"bg-green-600":"bg-primary"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),I?"Active Call":"Make Call"]}),!I&&e.jsx("button",{onClick:()=>K(!1),className:"text-white hover:text-gray-200 transition-colors text-2xl leading-none",children:"×"}),I&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(vt,{className:"h-4 w-4"}),ot(Ts)]})]})}),e.jsx("div",{className:"px-6 py-6 bg-white",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-16 h-16 border-2 border-gray-300 rounded-full flex items-center justify-center shadow-sm ${I?"bg-green-500 animate-pulse":"bg-green-500"}`,children:e.jsx(Ct,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"rounded px-3 mb-2 bg-gray-50 flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Name"}),e.jsx("p",{className:"font-medium text-gray-900",children:N==null?void 0:N.fullName})]}),e.jsxs("div",{className:"rounded px-3 bg-gray-50 flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Number"}),e.jsx("p",{className:"font-medium text-gray-900",children:N==null?void 0:N.phoneNumber})]}),I&&e.jsx("div",{className:"mt-2 text-center",children:e.jsx("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${q?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:q?"On Hold":"Connected"})})]})]})}),!I&&e.jsxs("div",{className:"px-6 py-4 space-y-4 bg-white border-t border-gray-200",children:[e.jsx("div",{className:"border border-gray-300 rounded-lg bg-gray-50",children:e.jsxs("select",{value:H,onChange:s=>Fe(s.target.value),className:"w-full bg-transparent text-gray-900 px-4 py-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent appearance-none",children:[e.jsx("option",{value:"",children:"Agent"}),U.map(s=>e.jsx("option",{value:s.assistant_id||s.id,children:s.name||s.id},s.id))]})}),e.jsx("div",{className:"border border-gray-300 rounded-lg bg-gray-50",children:e.jsxs("select",{value:G,onChange:s=>Ie(s.target.value),className:"w-full bg-transparent text-gray-900 px-4 py-4 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent appearance-none",children:[e.jsx("option",{value:"",children:"From Number"}),ls.map(s=>e.jsx("option",{value:s.id,children:s.number||s.friendlyName},s.id))]})})]}),e.jsx("div",{className:"px-6 py-6 bg-white border-t border-gray-200",children:I?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[e.jsx("button",{onClick:nt,className:`w-16 h-16 rounded-full flex items-center justify-center transition-all ${Z?"bg-red-500 hover:bg-red-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:Z?e.jsx(wt,{className:"h-6 w-6"}):e.jsx(St,{className:"h-6 w-6"})}),e.jsx("button",{onClick:it,className:"w-20 h-20 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center transition-colors shadow-lg",children:e.jsx(kt,{className:"h-8 w-8"})}),e.jsx("button",{onClick:ct,className:`w-16 h-16 rounded-full flex items-center justify-center transition-all ${q?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700"}`,children:q?e.jsx(Et,{className:"h-6 w-6"}):e.jsx(At,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-6 text-xs text-gray-500",children:[e.jsx("span",{className:"w-16 text-center",children:Z?"Unmute":"Mute"}),e.jsx("span",{className:"w-20 text-center",children:"End Call"}),e.jsx("span",{className:"w-16 text-center",children:q?"Resume":"Hold"})]})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("button",{onClick:()=>K(!1),className:"flex-1 py-3 px-6 bg-red-700 text-white hover:bg-red-800 rounded-full font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:lt,disabled:!H||!G||ns,className:"flex-1 py-3 bg-green-700 hover:bg-green-800 text-white px-6 rounded-full font-medium disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:ns?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin mr-2"}),"Calling..."]}):"Call"})]})})]})}),e.jsx(Jt,{call:Hs,isOpen:qs,onClose:()=>{us(!1),hs(null)}}),ve&&e.jsx(La,{isOpen:Bs,contact:{id:ve.id.toString(),email:ve.email,contact_number:ve.phoneNumber,list_name:r==null?void 0:r.list_name},onClose:()=>{fs(!1),gs(null)}}),e.jsx(es,{open:zs,onOpenChange:Ce,children:e.jsxs(ss,{className:"max-w-7xl max-h-[80vh] flex flex-col",children:[e.jsxs(ts,{children:[e.jsxs(as,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5 text-orange-600"}),"Compose Email"]}),e.jsxs(ja,{children:["Send an email to ",(W==null?void 0:W.fullName)||(W==null?void 0:W.email)]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[e.jsxs("div",{children:[e.jsx(y,{htmlFor:"from",className:"text-sm font-medium text-gray-700 mb-1 block",children:"From"}),e.jsx(j,{id:"from",value:(P==null?void 0:P.email)||"",disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"to",className:"text-sm font-medium text-gray-700 mb-1 block",children:"To *"}),e.jsx(j,{id:"to",value:u.to,onChange:s=>B(t=>({...t,to:s.target.value})),placeholder:"Enter recipient email"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"cc",className:"text-sm font-medium text-gray-700 mb-1 block",children:"CC"}),e.jsx(j,{id:"cc",value:u.cc,onChange:s=>B(t=>({...t,cc:s.target.value})),placeholder:"Enter CC emails (comma separated)"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"bcc",className:"text-sm font-medium text-gray-700 mb-1 block",children:"BCC"}),e.jsx(j,{id:"bcc",value:u.bcc,onChange:s=>B(t=>({...t,bcc:s.target.value})),placeholder:"Enter BCC emails (comma separated)"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"subject",className:"text-sm font-medium text-gray-700 mb-1 block",children:"Subject *"}),e.jsx(j,{id:"subject",value:u.subject,onChange:s=>B(t=>({...t,subject:s.target.value})),placeholder:"Enter email subject"})]}),e.jsxs("div",{children:[e.jsx(y,{htmlFor:"body",className:"text-sm font-medium text-gray-700 mb-1 block",children:"Message *"}),e.jsx("textarea",{id:"body",value:u.body,onChange:s=>B(t=>({...t,body:s.target.value})),placeholder:"Enter your message...",className:"w-full min-h-[200px] p-3 border border-gray-300 rounded-md resize-y focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),e.jsxs("div",{children:[e.jsx(y,{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Attachments"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 border border-gray-300 rounded-md bg-gray-50",children:[e.jsx(Dt,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Attachment support coming soon"})]})]})]}),e.jsxs(ba,{className:"flex justify-between items-center pt-4 border-t",children:[e.jsx(d,{variant:"outline",onClick:()=>Ce(!1),disabled:Re,children:"Cancel"}),e.jsx(d,{onClick:at,disabled:Re||!u.to||!u.subject||!u.body,className:"bg-orange-600 hover:bg-orange-700",children:Re?e.jsxs(e.Fragment,{children:[e.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pt,{className:"h-4 w-4 mr-2"}),"Send Email"]})})]})]})})]})};export{jr as default};
//# sourceMappingURL=Lists-DZQohrje.js.map
