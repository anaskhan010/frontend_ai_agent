import{j as e,K as R,aI as U,aG as ne,M as P,X as ce,V as de,aS as oe,bz as D,N as xe,ax as me,aC as he,aq as ge}from"./ui-Tc0IGQ9z.js";import{r as n}from"./vendor-DG599jyl.js";import{t,q as je,z as ue,B as i,r as fe,s as pe,v as ye,x as Ne,L as g,I as N,S as E,f as $,g as k,h as I,i as v,C as o,c as j,d as u,b as x,n as F}from"./index-14XkMcJs.js";import{u as ve,b as C,c as K}from"./query-DVe5-rsJ.js";import{a as Ce,g as be,c as we,b as Se}from"./clinicalUserService-DWmow3lj.js";import{g as _e}from"./clinicalRoleService-i0ww6kn-.js";import{a as Ue}from"./clinicalSiteService-CJxPBNko.js";import"./router-BnJytTjr.js";const Te=()=>{const[r,M]=n.useState(""),[T,m]=n.useState(!1),[Fe,V]=n.useState(""),[Le,Ae]=n.useState(""),f=ve(),[l,L]=n.useState({name:"",email:"",phone:"",clinical_role:"",clinical_site:""}),[z,B]=n.useState(!1),[qe,Q]=n.useState(null),{data:b,isLoading:O,error:H}=C({queryKey:["clinicalUsers"],queryFn:Ce,retry:1}),{data:w,isLoading:p}=C({queryKey:["clinicalUserStats"],queryFn:be,retry:1}),{data:c,isLoading:G,error:Re}=C({queryKey:["clinicalRoles"],queryFn:_e,retry:1}),{data:S}=C({queryKey:["clinicalSites"],queryFn:Ue,retry:1}),J=(b==null?void 0:b.data)||[],y=(w==null?void 0:w.data)||{total_users:0,active_users:0,inactive_users:0,users_with_roles:0};c!=null&&c.data;const A=(c==null?void 0:c.data)||[],X=(S==null?void 0:S.data)||[],_=K({mutationFn:we,onSuccess:()=>{t.success("Clinical user created successfully"),f.invalidateQueries({queryKey:["clinicalUsers"]}),f.invalidateQueries({queryKey:["clinicalUserStats"]}),m(!1),L({name:"",email:"",phone:"",clinical_role:"",clinical_site:""})},onError:s=>{t.error("Failed to create clinical user"),console.error("Create user error:",s)}});K({mutationFn:({userId:s,roleData:a})=>Se(s,a),onSuccess:()=>{t.success("Role assigned successfully"),f.invalidateQueries({queryKey:["clinicalUsers"]}),f.invalidateQueries({queryKey:["clinicalUserStats"]}),m(!1),V("")},onError:s=>{var a,d;t.error(((d=(a=s.response)==null?void 0:a.data)==null?void 0:d.message)||"Failed to assign role")}});const h=(s,a)=>{L(d=>({...d,[s]:a}))},W=()=>{if(!l.name||!l.email){t.error("Please fill in all required fields");return}_.mutate(l)},Y=s=>{Q(s),t.info(`Opening edit form for ${s.first_name} ${s.last_name}`)},Z=s=>{t.info(`Opening study assignment for ${s.first_name} ${s.last_name}`)},ee=s=>{t.info(`Viewing profile for ${s.first_name} ${s.last_name}`)},se=()=>{B(!z)},q=J.filter(s=>{const a=`${s.first_name||""} ${s.last_name||""}`.trim(),d=s.email||"",te=s.clinical_role_display||"",ie=s.site_name||"",re=s.phone_number||s.phone||"";return a.toLowerCase().includes(r.toLowerCase())||d.toLowerCase().includes(r.toLowerCase())||te.toLowerCase().includes(r.toLowerCase())||ie.toLowerCase().includes(r.toLowerCase())||re.toLowerCase().includes(r.toLowerCase())}),ae=s=>s==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",le=s=>({"Principal Investigator":"bg-purple-100 text-purple-800","Study Coordinator":"bg-blue-100 text-blue-800","Site Manager":"bg-green-100 text-green-800",Recruiter:"bg-orange-100 text-orange-800","Data Entry Specialist":"bg-gray-100 text-gray-800",Biostatistician:"bg-indigo-100 text-indigo-800","Regulatory Affairs":"bg-red-100 text-red-800","Data Manager":"bg-cyan-100 text-cyan-800","Clinical Research Associate (CRA)":"bg-yellow-100 text-yellow-800","Clinical Research Coordinator (CRC)":"bg-pink-100 text-pink-800","Sub Investigator":"bg-violet-100 text-violet-800"})[s]||"bg-gray-100 text-gray-800";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Clinical Users"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage clinical research staff and role assignments"})]}),e.jsxs(je,{open:T,onOpenChange:m,children:[e.jsx(ue,{asChild:!0,children:e.jsxs(i,{children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Clinical User"]})}),e.jsxs(fe,{className:"max-w-md","aria-describedby":"user-form-description",children:[e.jsxs(pe,{children:[e.jsx(ye,{children:"Add New Clinical User"}),e.jsx(Ne,{id:"user-form-description",children:"Fill out the form below to add a new clinical staff member. All required fields must be completed."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"name",children:"Full Name *"}),e.jsx(N,{id:"name",placeholder:"Dr. John Smith",value:l.name,onChange:s=>h("name",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"email",children:"Email *"}),e.jsx(N,{id:"email",type:"email",placeholder:"john.smith@hospital.org",value:l.email,onChange:s=>h("email",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"phone",children:"Phone"}),e.jsx(N,{id:"phone",placeholder:"+1-555-0123",value:l.phone,onChange:s=>h("phone",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"role",children:"Clinical Role"}),e.jsxs(E,{value:l.clinical_role,onValueChange:s=>h("clinical_role",s),children:[e.jsx($,{children:e.jsx(k,{placeholder:"Select clinical role"})}),e.jsx(I,{children:G?e.jsx(v,{value:"loading",disabled:!0,children:"Loading roles..."}):A.length===0?e.jsx(v,{value:"no-roles",disabled:!0,children:"No roles available"}):A.map(s=>e.jsx(v,{value:s.name,children:s.display_name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(g,{htmlFor:"site",children:"Clinical Site"}),e.jsxs(E,{value:l.clinical_site,onValueChange:s=>h("clinical_site",s),children:[e.jsx($,{children:e.jsx(k,{placeholder:"Select clinical site"})}),e.jsx(I,{children:X.map(s=>e.jsx(v,{value:s.id.toString(),children:s.site_name||s.name},s.id))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(i,{onClick:W,disabled:_.isPending,children:_.isPending?"Creating...":"Create User"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[p?e.jsx("div",{className:"text-2xl font-bold",children:"--"}):e.jsx("div",{className:"text-2xl font-bold",children:y.total_users}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active clinical staff"})]})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Active Users"}),e.jsx(ne,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[p?e.jsx("div",{className:"text-2xl font-bold",children:"--"}):e.jsx("div",{className:"text-2xl font-bold",children:y.active_users}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently active"})]})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Users with Roles"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[p?e.jsx("div",{className:"text-2xl font-bold",children:"--"}):e.jsx("div",{className:"text-2xl font-bold",children:y.users_with_roles}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Assigned roles"})]})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Inactive Users"}),e.jsx(P,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[p?e.jsx("div",{className:"text-2xl font-bold",children:"--"}):e.jsx("div",{className:"text-2xl font-bold",children:y.inactive_users}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Need attention"})]})]})]}),e.jsxs(o,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(u,{children:"Clinical Staff Directory"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(N,{placeholder:"Search users...",value:r,onChange:s=>M(s.target.value),className:"pl-8 w-64"})]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:se,children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Filter"]})]})]})}),e.jsx(x,{children:O?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(oe,{className:"h-8 w-8 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading clinical users..."})]}):H?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(D,{className:"h-12 w-12 text-red-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Users"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to load clinical users. Please try again."})]}):q.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(U,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Users Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:r?"No users match your search criteria.":"No clinical users have been added yet."}),e.jsxs(i,{onClick:()=>m(!0),children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add First User"]})]}):e.jsx("div",{className:"space-y-4",children:q.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:`${s.first_name||""} ${s.last_name||""}`.trim()}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",s.id]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:ae("Active"),children:"Active"}),e.jsx(F,{className:le(s.clinical_role_display),children:s.clinical_role_display}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>Y(s),children:[e.jsx(xe,{className:"h-4 w-4 mr-1"}),"Edit"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(me,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(he,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Phone"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.phone_number||s.phone||"No phone provided"})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(P,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Site"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.site_name||"No site assigned"})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Last Login"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.last_login?new Date(s.last_login).toLocaleDateString():"Never logged in"})]})]})]}),e.jsx("div",{className:"pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Assigned Studies:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.assigned_studies>0?e.jsxs(F,{variant:"outline",className:"text-xs",children:[s.assigned_studies," studies assigned"]}):e.jsx("span",{className:"text-xs text-gray-500",children:"No studies assigned"})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>Z(s),children:"Assign Studies"}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>ee(s),children:"View Profile"})]})]})})]},s.id))})})]}),e.jsx(o,{className:"border-yellow-200 bg-yellow-50",children:e.jsxs(x,{className:"flex items-center space-x-3 pt-6",children:[e.jsx(D,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-yellow-800",children:"Clinical Users Management"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"This is a preview of the Clinical Users management system. Full functionality including user creation, role assignment, study assignment, and profile management will be implemented in the next phase."})]})]})})]})};export{Te as default};
//# sourceMappingURL=ClinicalUsers-NmeogKY3.js.map
