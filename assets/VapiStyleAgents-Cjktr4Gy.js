import{j as e,br as Qa,M as de,ar as ye,au as La,aT as X,bs as Ja,b5 as Ne,aM as Ie,aP as Xa,bt as Za,D as Sa,N as Da,bu as er,T as ka,B as Pa,O as sr,bv as ar,aQ as he}from"./ui-CNbESIMS.js";import{r as f,a as rr}from"./vendor-DG599jyl.js";import{u as tr,b as nr,c as ge}from"./query-DFkYe0MV.js";import{a as ir,c as lr,b as or,u as cr,d as dr}from"./agentService-XJiHAFON.js";import{t as v,u as mr}from"./index-CvuFKe2_.js";import{B as V}from"./button-BpHONB4D.js";import{I as j}from"./input-DOIJ2OtM.js";import{B as P}from"./badge-DO_1G0Ng.js";import{C as $,b as L,c as q,a as z}from"./card-pTI7iGfo.js";import{T as xr,a as ur,b as pe,c as D}from"./tabs-DYmQtUUn.js";import{A as je,a as fe}from"./avatar-NIDa_0ed.js";import{_ as ee}from"./vapi-CWmUDqtF.js";import{M as Ta,g as ve,V as se,a as be,T as Va,b as Ea,c as Fa,d as _a,e as Oa}from"./vapiProviders-1Om8H5t2.js";import{D as Ba,f as hr,a as Ra,b as Ua,c as $a}from"./dialog-MmBhddhZ.js";import{T as B}from"./textarea-BUHDDiup.js";import{S as I,a as w,b as C,c as M,d as o}from"./select-CSg3IHkG.js";import"./router-BavLd_S0.js";import"./index-HDeFwIcs.js";const gr=({agentId:R,agentName:_="AI Assistant",agentConfig:n,onCallStart:W,onCallEnd:a,onError:O})=>{const A="eb3b26e3-7dbb-4fd6-a545-a954756a43aa",b=f.useRef(null),[y,F]=f.useState({isConnected:!1,isConnecting:!1,isMuted:!1,volumeLevel:0,callDuration:0,status:"idle"}),[ae,G]=f.useState([]),H=f.useRef(null),re=A!=="your-vapi-public-key-here";console.log("ðŸ” VAPI Debug Info:"),console.log("- Vapi class available:",typeof ee),console.log("- Public API Key:",`${A.substring(0,8)}...`),console.log("- Is configured:",re),f.useEffect(()=>{console.log("ðŸ”§ Initializing VAPI for agent:",R),console.log("ðŸ”‘ Public API Key:",`${A.substring(0,8)}...`),console.log("âœ… Is VAPI Configured:",re);try{console.log("ðŸ§ª Testing VAPI import..."),console.log("- Vapi constructor:",ee),console.log("- typeof Vapi:",typeof ee),typeof ee=="function"?console.log("âœ… VAPI import successful"):console.error("âŒ VAPI import failed - not a constructor")}catch(r){console.error("âŒ VAPI import test failed:",r)}try{b.current=new ee(A),console.log("âœ… VAPI instance created successfully"),we()}catch(r){console.error("âŒ Failed to initialize VAPI:",r),v.error("Failed to initialize VAPI. Please check your API key.")}return()=>{b.current&&b.current.stop(),H.current&&clearInterval(H.current)}},[A,R]);const we=()=>{b.current&&(b.current.on("call-start",()=>{console.log("ðŸŽ™ï¸ VAPI call started"),F(r=>({...r,isConnected:!0,isConnecting:!1,status:"connected"})),Ce(),v.success("Call connected! You can now speak."),W==null||W()}),b.current.on("call-end",()=>{console.log("ðŸ“ž VAPI call ended"),F(r=>({...r,isConnected:!1,isConnecting:!1,status:"ended"})),H.current&&(clearInterval(H.current),H.current=null),v.info("Call ended"),a==null||a()}),b.current.on("speech-start",()=>{console.log("ðŸ—£ï¸ Speech started")}),b.current.on("speech-end",()=>{console.log("ðŸ¤ Speech ended")}),b.current.on("volume-level",r=>{F(m=>({...m,volumeLevel:r}))}),b.current.on("message",r=>{if(console.log("ðŸ“¨ VAPI message:",r),r.type==="transcript"&&r.transcript){const m={role:r.role||"assistant",content:r.transcript,timestamp:new Date,type:"transcript"};G(T=>[...T,m])}}),b.current.on("error",r=>{console.error("âŒ VAPI error:",r),F(T=>({...T,isConnected:!1,isConnecting:!1,status:"error"}));let m="Unknown error";r.message&&(m=r.message,r.message.includes("assistant")&&r.message.includes("not found")?m="Assistant not found in VAPI. Please ensure the agent is properly synced with VAPI dashboard.":r.message.includes("unauthorized")||r.message.includes("401")?m="Unauthorized access. Please check your VAPI API key configuration.":(r.message.includes("microphone")||r.message.includes("permission"))&&(m="Microphone permission denied. Please allow microphone access and try again.")),v.error(`Call error: ${m}`),O==null||O(r)}))},Ce=()=>{H.current=setInterval(()=>{F(r=>({...r,callDuration:r.callDuration+1}))},1e3)},U=r=>{const m=Math.floor(r/60),T=r%60;return`${m}:${T.toString().padStart(2,"0")}`},te=()=>{const r={name:_,firstMessage:(n==null?void 0:n.firstMessage)||`Hello! I'm ${_}. How can I help you today?`,model:{provider:"openai",model:"gpt-4",temperature:.7,messages:[{role:"system",content:(n==null?void 0:n.systemMessage)||`You are ${_}, a helpful AI assistant. Keep responses conversational and under 30 words when possible.`}]},voice:{provider:"vapi",voiceId:(n==null?void 0:n.voiceId)||"Cole"}};return console.log("ðŸ“‹ Assistant config created:",r),r},me=async()=>{if(console.log("ðŸš€ Starting VAPI agent call for:",R),console.log("ðŸ”‘ VAPI Public Key:",`${A.substring(0,8)}...`),console.log("ðŸ¤– Agent Config:",n),!b.current){v.error("VAPI not initialized. Please check your API key configuration.");return}try{F(m=>({...m,isConnecting:!0,status:"connecting",callDuration:0})),G([]);const r=(n==null?void 0:n.assistant_id)||(n==null?void 0:n.assistantId);if(r){console.log("ðŸ“ž Using existing assistant ID from database:",r);const m={metadata:{portalAgentId:R,agentName:_,initiatedFrom:"portal"}};console.log("ðŸ“‹ Starting call with assistant ID:",r),console.log("ðŸ“‹ Assistant overrides:",m),await b.current.start(r,m)}else{console.log("ðŸ”„ Creating assistant configuration...");const m=te();console.log("ðŸ“ž Starting agent call with assistant config"),console.log("ðŸ¤– Agent Name:",_);const T=m;console.log("ðŸ“‹ Call config:",T),await new Promise(k=>setTimeout(k,100)),await b.current.start(T)}}catch(r){console.error("âŒ Error starting agent call:",r),F(T=>({...T,isConnecting:!1,status:"error"}));let m="Failed to start call";r.message?(m=r.message,r.message.includes("Authentication")||r.message.includes("401")?m="Authentication failed. Please check your VAPI API key.":r.message.includes("assistant")||r.message.includes("404")?m="Assistant not found. The assistant may not exist in VAPI.":r.message.includes("permission")||r.message.includes("microphone")?m="Microphone permission denied. Please allow microphone access.":(r.message.includes("network")||r.message.includes("fetch"))&&(m="Network error. Please check your internet connection.")):r.code?m=`Error code: ${r.code}`:typeof r=="string"&&(m=r),v.error(`Failed to start call: ${m}`),console.error("ðŸ“‹ Full error details:",r)}},Q=()=>{console.log("ðŸ›‘ Stopping VAPI agent call..."),b.current&&b.current.stop()},u=()=>{if(b.current){const r=!y.isMuted;b.current.setMuted(r),F(m=>({...m,isMuted:r})),v.info(r?"Microphone muted":"Microphone unmuted")}},ne=()=>{const r=document.getElementById("call-button-container");return console.log("ðŸŽ¯ Looking for call-button-container:",r),r?(console.log("ðŸŽ¯ Rendering call button, call state:",y),rr.createPortal(e.jsxs("div",{className:"flex items-center gap-2",children:[y.isConnected&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-sm font-mono font-semibold text-gray-800 bg-white px-3 py-1 rounded-md border border-gray-200",children:U(y.callDuration)}),e.jsx(V,{onClick:u,variant:"outline",size:"sm",className:`border-gray-300 ${y.isMuted?"bg-red-50  text-red-700 hover:bg-red-100":"bg-white hover:bg-gray-50 text-gray-700"}`,children:y.isMuted?e.jsx(Qa,{className:"h-4 w-4"}):e.jsx(de,{className:"h-4 w-4"})}),e.jsx(V,{variant:"outline",size:"sm",className:"border-gray-300 bg-white hover:bg-gray-50 text-gray-700",children:e.jsx(ye,{className:"h-4 w-4"})})]}),!y.isConnected&&!y.isConnecting?e.jsxs(V,{onClick:me,size:"sm",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-md transition-all duration-200",children:[e.jsx(La,{className:"h-4 w-4 mr-2"}),"Call"]}):y.isConnecting?e.jsxs(V,{size:"sm",className:"px-4 py-2 bg-amber-500 text-white text-sm font-medium rounded-md",disabled:!0,children:[e.jsx(X,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting"]}):e.jsxs(V,{onClick:Q,size:"sm",className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md transition-all duration-200",children:[e.jsx(Ja,{className:"h-4 w-4 mr-2"}),"End Call"]})]}),r)):(console.warn("âš ï¸ call-button-container not found!"),null)};console.log("ðŸŽ¯ VapiAgentCall render - isVapiConfigured:",re),console.log("ðŸŽ¯ VapiAgentCall render - callState:",y),console.log("ðŸŽ¯ VapiAgentCall render - agentId:",R),console.log("ðŸŽ¯ VapiAgentCall render - agentName:",_);const[Y,ie]=f.useState(!1);return f.useEffect(()=>{const r=()=>document.getElementById("call-button-container")?(console.log("âœ… Found call-button-container"),ie(!0),!0):(console.warn("âŒ call-button-container not found"),!1);if(r())return;const m=setInterval(()=>{r()&&clearInterval(m)},100);return()=>{clearInterval(m)}},[]),e.jsxs("div",{className:"flex flex-col h-full bg-white",children:[ne(),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"Conversation"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-white",children:ae.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ne,{className:"h-8 w-8 text-gray-400"})}),e.jsx("p",{className:"text-center text-sm",children:y.isConnected?"Conversation will appear here...":"Start a call to begin the conversation"})]}):e.jsx("div",{className:"space-y-6",children:ae.map((r,m)=>e.jsxs("div",{className:`flex gap-3 ${r.role==="user"?"justify-end":"justify-start"}`,children:[r.role==="assistant"&&e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Ie,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{className:`max-w-[75%] ${r.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800 border border-gray-200"} rounded-lg px-4 py-3`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-xs font-medium ${r.role==="user"?"text-blue-100":"text-gray-500"}`,children:r.role==="user"?"You":_}),e.jsx("span",{className:`text-xs ${r.role==="user"?"text-blue-200":"text-gray-400"}`,children:r.timestamp.toLocaleTimeString()})]}),e.jsx("p",{className:"text-sm leading-relaxed",children:r.content})]}),r.role==="user"&&e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Xa,{className:"h-4 w-4 text-blue-600"})})]},m))})})]}),e.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-wide mb-1",children:"Assistant"}),e.jsx("p",{className:"font-medium text-gray-900",children:_})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-wide mb-1",children:"Connection"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${y.status==="connected"?"bg-green-500":y.status==="connecting"?"bg-amber-500 animate-pulse":y.status==="error"?"bg-red-500":"bg-gray-400"}`}),e.jsx("span",{className:"text-gray-700 capitalize",children:y.status==="idle"?"Ready":y.status==="connecting"?"Connecting":y.status==="connected"?"Active":y.status==="ended"?"Ended":"Error"})]})]})]})})]})},pr={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_BASE_URL:"https://ai.research-hero.com",VITE_FACEBOOK_REDIRECT_URI:"https://ai.research-hero.com/api/auth/facebook/callback",VITE_FRONTEND_URL:"https://aiagent.research-hero.com",VITE_GMAIL_CLIENT_ID:"686955346191-el9qo3bhbgfo7fk4juanq8bq7g7iis7d.apps.googleusercontent.com",VITE_GMAIL_REDIRECT_URI:"https://ai.research-hero.com/api/gmail/auth/callback",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_51S8GFm2MMm3Fy1PB45KAluHAtFTOmAY9qKUE4sITR1TA1zfX97ON36OAcAALplq6LbLgqXaTyY0hRB7ae55LzpBQ00DfkbC8oy",VITE_VAPI_BASE_URL:"https://api.vapi.ai",VITE_VAPI_PUBLIC_KEY:"eb3b26e3-7dbb-4fd6-a545-a954756a43aa"},Or=()=>{var Te,Ve,Ee,Fe,_e,Oe,Be,Re,Ue,$e,Le,qe,ze,Ae,Ke,We,He,Ye,Ge,Qe,Je,Xe,Ze,De,es,ss,as,rs,ts,ns,is,ls,os,cs,ds,ms,xs,us,hs,gs,ps,js,fs,vs,bs,ys,Ns,Is,ws,Cs,Ms,Ss,ks,Ps,Ts,Vs,Es,Fs,_s,Os,Bs,Rs,Us,$s,Ls,qs,zs,As,Ks,Ws,Hs,Ys,Gs,Qs,Js,Xs,Zs;const[R,_]=f.useState(""),[n,W]=f.useState(null),[a,O]=f.useState(null),[A,b]=f.useState(!1),[y,F]=f.useState(!1),[ae,G]=f.useState(!1),[H,re]=f.useState(!1),[we,Ce]=f.useState(null),[U,te]=f.useState(null),[me,Q]=f.useState(!1),[u,ne]=f.useState(null),[Y,ie]=f.useState(new Set);console.log("ðŸ” Environment Debug:"),console.log("- VITE_VAPI_PUBLIC_KEY:",`${"eb3b26e3-7dbb-4fd6-a545-a954756a43aa".substring(0,8)}...`),console.log("- All env vars:",pr);const[r,m]=f.useState({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"office",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"vapi",voiceId:"Cole",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),T=tr(),{user:k}=mr(),{data:J,isLoading:qa}=nr({queryKey:["syncedAgents",k==null?void 0:k.id,R],queryFn:()=>ir(R),staleTime:2*60*1e3,gcTime:5*60*1e3,enabled:!!(k!=null&&k.id),placeholderData:s=>s,retry:(s,t)=>{var l;return[404,204,402].includes((l=t==null?void 0:t.response)==null?void 0:l.status)?!1:s<2}}),le=ge({mutationFn:lr,onSuccess:s=>{console.log("âœ… Assistant created successfully:",s),v.success(`Assistant "${r.name}" created successfully!`),G(!1),m({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"office",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"11labs",voiceId:"21m00Tcm4TlvDq8ikWAM",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),T.invalidateQueries({queryKey:["syncedAgents"]}),T.invalidateQueries({queryKey:["agents"]})},onError:s=>{var d,l,x,h,p,g;console.error("âŒ Error creating assistant:",s);let t="Failed to create assistant";(l=(d=s.response)==null?void 0:d.data)!=null&&l.message?t=s.response.data.message:(h=(x=s.response)==null?void 0:x.data)!=null&&h.error?t=s.response.data.error:s.message&&(t=s.message),v.error(`Creation failed: ${t}`),console.error("Detailed error:",{status:(p=s.response)==null?void 0:p.status,data:(g=s.response)==null?void 0:g.data,message:s.message})}}),oe=ge({mutationFn:({id:s,data:t})=>cr(s,t),onSuccess:(s,t)=>{console.log("âœ… Assistant updated successfully:",s);const d=Object.keys(t.data)[0];v.success(`${d} updated successfully`),T.invalidateQueries({queryKey:["syncedAgents",k==null?void 0:k.id]}),n&&ke(n.id)},onError:(s,t)=>{var x,h,p,g,S,Z;console.error("âŒ Error updating assistant:",s);let d="Failed to update assistant";(h=(x=s.response)==null?void 0:x.data)!=null&&h.message?d=s.response.data.message:(g=(p=s.response)==null?void 0:p.data)!=null&&g.error?d=s.response.data.error:s.message&&(d=s.message);const l=Object.keys(t.data)[0];v.error(`Failed to update ${l}: ${d}`),console.error("Update error details:",{field:l,value:t.data[l],status:(S=s.response)==null?void 0:S.status,data:(Z=s.response)==null?void 0:Z.data,message:s.message})}}),ce=ge({mutationFn:dr,onSuccess:s=>{console.log("âœ… Delete success:",s),v.success(`Assistant "${u==null?void 0:u.name}" deleted successfully!`),Q(!1),ne(null),n&&u&&n.id===u.id&&(W(null),O(null)),T.invalidateQueries({queryKey:["syncedAgents",k==null?void 0:k.id]})},onError:s=>{var l,x,h,p,g,S;console.error("âŒ Error deleting assistant:",s);let t="Unknown error occurred";(x=(l=s.response)==null?void 0:l.data)!=null&&x.message?t=s.response.data.message:(p=(h=s.response)==null?void 0:h.data)!=null&&p.error?t=s.response.data.error:s.message&&(t=s.message);const d=(u==null?void 0:u.name)||"Assistant";v.error(`Failed to delete ${d}: ${t}`),console.error("Delete error details:",{assistantId:u==null?void 0:u.id,assistantName:u==null?void 0:u.name,status:(g=s.response)==null?void 0:g.status,data:(S=s.response)==null?void 0:S.data,message:s.message})}}),E=(J==null?void 0:J.data)||[],Me=(k==null?void 0:k.isSuperAdmin)||!1,Se=(J==null?void 0:J.total)||E.length;f.useEffect(()=>{if(E.length>0){console.log("ðŸ” Agent data structure (first agent):",E[0]),console.log("ðŸ” Total agents loaded:",E.length),console.log("ðŸ‘‘ Pagination disabled (Super Admin):",Me),console.log("ðŸ“Š Total assistants available:",Se);const s=new Set;E.forEach((t,d)=>{((t.assistant_data||{}).metadata||{}).published===!0&&s.add(String(t.id)),d<3&&console.log(`ðŸ” Agent ${d+1}:`,{name:t.name,localId:t.id,assistantId:t.assistant_id,hasAssistantId:!!t.assistant_id,structure:Object.keys(t)})}),ie(s),console.log("ðŸ“Š Initialized published agents from metadata:",Array.from(s))}},[E]),f.useEffect(()=>{var s,t;E.length>0&&!n&&(console.log("Available agents:",E),console.log("First agent ID:",(s=E[0])==null?void 0:s.id,"Type:",typeof((t=E[0])==null?void 0:t.id)),W(E[0]))},[E,n]),f.useEffect(()=>{if(n&&n.id){const s=n.assistant_id||n.id;console.log("ðŸ” Loading agent details:",{agentName:n.name,localId:n.id,assistantId:n.assistant_id,usingId:s,idType:n.assistant_id?"VAPI UUID":"Local ID"}),ke(s)}},[n]);const za=s=>/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s),ke=async s=>{var t,d,l,x,h,p,g,S,Z,Ds,ea,sa,aa,ra,ta,na,ia,la,oa,ca,da,ma,xa,ua,ha,ga,pa,ja,fa,va,ba,ya,Na,Ia,wa,Ca,Ma;b(!0);try{const K=String(s);za(K)||console.warn("Agent ID is not a valid UUID:",K,"- will try to load details anyway"),console.log("ðŸ” Fetching complete VAPI details for agent:",K);const ue=await or(K);console.log("ðŸ“‹ Complete VAPI agent details:",ue);const i=ue.data||ue;O({name:i.name||(n==null?void 0:n.name),firstMessage:i.firstMessage||(n==null?void 0:n.firstMessage),firstMessageMode:i.firstMessageMode||"assistant-speaks-first",firstMessageInterruptionsEnabled:i.firstMessageInterruptionsEnabled||!1,model:{provider:((t=i.model)==null?void 0:t.provider)||"openai",model:((d=i.model)==null?void 0:d.model)||"gpt-4",temperature:((l=i.model)==null?void 0:l.temperature)||.7,maxTokens:((x=i.model)==null?void 0:x.maxTokens)||1e3,numFastTurns:((h=i.model)==null?void 0:h.numFastTurns)||0,messages:((p=i.model)==null?void 0:p.messages)||[],tools:((g=i.model)==null?void 0:g.tools)||[],toolIds:((S=i.model)==null?void 0:S.toolIds)||[],knowledgeBase:(Z=i.model)==null?void 0:Z.knowledgeBase,knowledgeBaseId:(Ds=i.model)==null?void 0:Ds.knowledgeBaseId,emotionRecognitionEnabled:((ea=i.model)==null?void 0:ea.emotionRecognitionEnabled)||!1,thinking:((sa=i.model)==null?void 0:sa.thinking)||{type:"disabled"}},voice:{provider:((aa=i.voice)==null?void 0:aa.provider)||"11labs",voiceId:((ra=i.voice)==null?void 0:ra.voiceId)||"21m00Tcm4TlvDq8ikWAM",speed:((ta=i.voice)==null?void 0:ta.speed)||1,stability:(na=i.voice)==null?void 0:na.stability,similarityBoost:(ia=i.voice)==null?void 0:ia.similarityBoost,cachingEnabled:((la=i.voice)==null?void 0:la.cachingEnabled)||!1,chunkPlan:((oa=i.voice)==null?void 0:oa.chunkPlan)||{enabled:!1},fallbackPlan:(ca=i.voice)==null?void 0:ca.fallbackPlan},transcriber:{provider:((da=i.transcriber)==null?void 0:da.provider)||"deepgram",model:((ma=i.transcriber)==null?void 0:ma.model)||"nova-2",language:((xa=i.transcriber)==null?void 0:xa.language)||"en",confidenceThreshold:((ua=i.transcriber)==null?void 0:ua.confidenceThreshold)||.4,endOfTurnConfidenceThreshold:((ha=i.transcriber)==null?void 0:ha.endOfTurnConfidenceThreshold)||.7,minEndOfTurnSilenceWhenConfident:((ga=i.transcriber)==null?void 0:ga.minEndOfTurnSilenceWhenConfident)||160,maxTurnSilence:((pa=i.transcriber)==null?void 0:pa.maxTurnSilence)||400,wordFinalizationMaxWaitTime:((ja=i.transcriber)==null?void 0:ja.wordFinalizationMaxWaitTime)||160,enableUniversalStreamingApi:((fa=i.transcriber)==null?void 0:fa.enableUniversalStreamingApi)||!1,formatTurns:((va=i.transcriber)==null?void 0:va.formatTurns)||!1,disablePartialTranscripts:((ba=i.transcriber)==null?void 0:ba.disablePartialTranscripts)||!1,keywords:((ya=i.transcriber)==null?void 0:ya.keywords)||[],wordBoost:((Na=i.transcriber)==null?void 0:Na.wordBoost)||[]},systemMessage:((Ca=(wa=(Ia=i.model)==null?void 0:Ia.messages)==null?void 0:wa[0])==null?void 0:Ca.content)||i.systemMessage||"You are a helpful AI assistant.",endCallMessage:i.endCallMessage,voicemailMessage:i.voicemailMessage,endCallPhrases:i.endCallPhrases||[],functions:i.functions||[],tools:i.tools||[],customFunctions:i.customFunctions,variableValues:i.variableValues,maxDurationSeconds:i.maxDurationSeconds||600,backgroundSound:i.backgroundSound||"off",modelOutputInMessagesEnabled:i.modelOutputInMessagesEnabled||!1,backgroundDenoisingEnabled:i.backgroundDenoisingEnabled||!1,clientMessages:i.clientMessages,serverMessages:i.serverMessages,transportConfigurations:i.transportConfigurations||[],server:i.server,observabilityPlan:i.observabilityPlan,startSpeakingPlan:i.startSpeakingPlan,stopSpeakingPlan:i.stopSpeakingPlan,credentialIds:i.credentialIds||[],metadata:i.metadata||{},createdAt:i.createdAt,updatedAt:i.updatedAt,_rawVapiData:i})}catch(K){console.error("Error loading agent details:",K),console.error("Error details:",((Ma=K.response)==null?void 0:Ma.data)||K.message),O({model:{provider:"OpenAI",model:"GPT-4"},voice:{provider:"11Labs",voiceId:"Default Voice"},transcriber:{provider:"Deepgram"},systemMessage:"You are a helpful AI assistant."})}finally{b(!1)}},xe=s=>s?s.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().substring(0,2):"NA",N=(s,t)=>{if(s.includes(".")){const[d,l]=s.split(".");m(x=>({...x,[d]:{...x[d],[l]:t}}))}else m(d=>({...d,[s]:t}))},Aa=()=>{var t,d,l;const s=[];return(t=r.name)!=null&&t.trim()||s.push("Assistant name is required"),(d=r.firstMessage)!=null&&d.trim()||s.push("First message is required"),(l=r.systemMessage)!=null&&l.trim()||s.push("System message is required"),r.model.provider||s.push("Model provider is required"),r.model.model||s.push("Model selection is required"),(r.model.temperature<0||r.model.temperature>2)&&s.push("Temperature must be between 0 and 2"),(r.model.maxTokens<1||r.model.maxTokens>32e3)&&s.push("Max tokens must be between 1 and 32000"),r.voice.provider||s.push("Voice provider is required"),r.voice.voiceId||s.push("Voice selection is required"),(r.voice.speed<.25||r.voice.speed>4)&&s.push("Voice speed must be between 0.25 and 4"),r.transcriber.provider||s.push("Transcriber provider is required"),r.transcriber.model||s.push("Transcriber model is required"),r.transcriber.language||s.push("Transcriber language is required"),(r.maxDurationSeconds<10||r.maxDurationSeconds>43200)&&s.push("Max duration must be between 10 and 43200 seconds"),s},Ka=()=>{const s=Aa();if(s.length>0){v.error(`Please fix the following errors:
${s.join(`
`)}`);return}if(r.name.length>40){v.error("Assistant name must be 40 characters or less");return}if(r.endCallMessage&&r.endCallMessage.length>1e3){v.error("End call message must be 1000 characters or less");return}if(r.voicemailMessage&&r.voicemailMessage.length>1e3){v.error("Voicemail message must be 1000 characters or less");return}console.log("âœ… Form validation passed, creating assistant...");const t={...r,firstMessageMode:r.firstMessageMode,backgroundSound:r.backgroundSound,transcriber:{...r.transcriber,provider:r.transcriber.provider},voice:{...r.voice,provider:r.voice.provider},systemMessage:void 0,model:{...r.model,provider:r.model.provider,messages:[{role:"system",content:r.systemMessage}]}};console.log("ðŸ”„ Transformed form data for VAPI:",t),le.mutate(t)},Pe=(s,t)=>{if(!s)return"";const d=s.toLowerCase().trim();return(t==="model"?{openai:"openai","open-ai":"openai",anthropic:"anthropic",groq:"groq",together:"together",anyscale:"anyscale"}:{"11labs":"11labs",elevenlabs:"11labs","eleven-labs":"11labs",openai:"openai","open-ai":"openai",azure:"azure",playht:"playht","play-ht":"playht",deepgram:"deepgram",cartesia:"cartesia",lmnt:"lmnt"})[d]||d},c=(s,t)=>{if(!n){console.warn("No selected agent for field update");return}console.log("ðŸ”„ Field update:",s,"Value:",t,"Type:",typeof t,"Agent ID:",n.id),U&&clearTimeout(U),O(l=>{const x={...l};if(s.includes(".")){const[h,p]=s.split(".");if(x[h]={...x[h],[p]:t},s==="model.provider"){const g=Fa(t);g&&(x.model.model=g,console.log("ðŸ¤– Auto-selected model:",g,"for provider:",t))}else if(s==="voice.provider"){const g=_a(t);g&&(x.voice.voiceId=g,console.log("ðŸŽ¤ Auto-selected voice:",g,"for provider:",t))}else if(s==="transcriber.provider"){const g=Oa(t);g&&(x.transcriber.model=g,console.log("ðŸ“ Auto-selected transcriber model:",g,"for provider:",t))}}else x[s]=t;return x});const d=setTimeout(()=>{const l={},x=["status","published","publishedAt","systemMessage"];if(s.includes(".")){const[p,g]=s.split(".");if(x.includes(p)||x.includes(g)){console.log("âš ï¸ Skipping VAPI update for local-only field:",s);return}if(l[p]={...a[p],[g]:t},s==="model.provider"){const S=Fa(t);S&&(l.model.model=S)}else if(s==="voice.provider"){const S=_a(t);S&&(l.voice.voiceId=S)}else if(s==="transcriber.provider"){const S=Oa(t);S&&(l.transcriber.model=S)}}else{if(x.includes(s)){console.log("âš ï¸ Skipping VAPI update for local-only field:",s);return}l[s]=t}console.log("ðŸ”„ Auto-saving field:",s,"with value:",t,"updateData:",l);const h=n.assistant_id||n.id;console.log("ðŸ” Using assistant ID for VAPI:",h,"Type:",typeof h),oe.mutate({id:String(h),data:l})},1e3);te(d)},Wa=s=>{if(!n){console.warn("No selected agent for system message update");return}console.log("ðŸ”„ System message update:",s),U&&clearTimeout(U),O(d=>{const l={...d};return l.systemMessage=s,l.model||(l.model={}),l.model.messages||(l.model.messages=[]),l.model.messages.length===0?l.model.messages.push({role:"system",content:s}):l.model.messages[0].role==="system"?l.model.messages[0].content=s:l.model.messages.unshift({role:"system",content:s}),l});const t=setTimeout(()=>{var p;const l=[...((p=a==null?void 0:a.model)==null?void 0:p.messages)||[]];l.length===0?l.push({role:"system",content:s}):l[0].role==="system"?l[0].content=s:l.unshift({role:"system",content:s});const x={model:{...a==null?void 0:a.model,messages:l}};console.log("ðŸ”„ Auto-saving system message via model.messages:",x);const h=n.assistant_id||n.id;console.log("ðŸ” Using assistant ID for system message update:",h),oe.mutate({id:String(h),data:x})},1e3);te(t)};f.useEffect(()=>()=>{U&&clearTimeout(U)},[U]);const Ha=s=>{ne(s),Q(!0)},Ya=()=>{if(u){const s=u.assistant_id||u.id;console.log("ðŸ—‘ï¸ Deleting agent:",u.id,u.name,"Using assistant_id:",s),ce.mutate(String(s))}else v.error("No agent selected for deletion")},Ga=async s=>{var l,x;if(!s||!s.id)return;const t=String(s.id),d=Y.has(t);try{console.log(`ðŸ”„ ${d?"Unpublishing":"Publishing"} agent:`,s.name);const h={metadata:{...a==null?void 0:a.metadata,published:!d,publishedAt:d?null:new Date().toISOString()}},p=s.assistant_id||s.id;console.log("ðŸ” Using assistant ID for VAPI publish:",p,"Type:",typeof p),await oe.mutateAsync({id:String(p),data:h});const g=new Set(Y);d?(g.delete(t),v.success(`${s.name} unpublished successfully`)):(g.add(t),v.success(`${s.name} published successfully`)),ie(g),n&&n.id===s.id&&O(S=>({...S,metadata:h.metadata}))}catch(h){console.error("âŒ Error toggling publish status:",h);let p="Failed to update publish status";(x=(l=h.response)==null?void 0:l.data)!=null&&x.message?p=h.response.data.message:h.message&&(p=h.message),v.error(`Failed to ${d?"unpublish":"publish"} ${s.name}: ${p}`)}};return e.jsxs("div",{className:"flex h-screen bg-gradient-to-br from-slate-50 via-white to-gray-50",children:[e.jsxs("div",{className:"w-80 border-r border-gray-200 bg-white/80 backdrop-blur-sm flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Assistants"}),Me&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(P,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-700 border-blue-200",children:[e.jsx(Za,{className:"h-3 w-3 mr-1"}),"Super Admin View"]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Showing all ",Se," assistants"]})]})]}),e.jsxs(Ba,{open:ae,onOpenChange:G,children:[e.jsx(hr,{asChild:!0,children:e.jsxs(V,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Sa,{className:"h-4 w-4 mr-2"}),"Create Assistant"]})}),e.jsxs(Ra,{className:"sm:max-w-[1200px] max-h-[90vh] overflow-y-auto",children:[e.jsx(Ua,{children:e.jsxs($a,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),"Create New Assistant"]})}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Basic Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Name *"}),e.jsx(j,{value:r.name,onChange:s=>N("name",s.target.value),placeholder:"Enter assistant name",className:`mt-1 ${(Te=r.name)!=null&&Te.trim()?"":"border-red-300"}`,maxLength:40}),!((Ve=r.name)!=null&&Ve.trim())&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Assistant name is required"}),r.name&&r.name.length>40&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Name must be 40 characters or less"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"First Message *"}),e.jsx(B,{value:r.firstMessage,onChange:s=>N("firstMessage",s.target.value),placeholder:"Hello! How can I help you today?",className:`mt-1 ${(Ee=r.firstMessage)!=null&&Ee.trim()?"":"border-red-300"}`,rows:3}),!((Fe=r.firstMessage)!=null&&Fe.trim())&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"First message is required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"System Message *"}),e.jsx(B,{value:r.systemMessage,onChange:s=>N("systemMessage",s.target.value),placeholder:"You are a helpful AI assistant...",className:`mt-1 ${(_e=r.systemMessage)!=null&&_e.trim()?"":"border-red-300"}`,rows:4}),!((Oe=r.systemMessage)!=null&&Oe.trim())&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:"System message is required"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Model Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs(I,{value:r.model.provider,onValueChange:s=>N("model.provider",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsx(M,{children:Ta.map(s=>e.jsx(o,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Model"}),e.jsxs(I,{value:r.model.model,onValueChange:s=>N("model.model",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsx(M,{children:ve(r.model.provider).map(s=>e.jsx(o,{value:s.id,children:s.name},s.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Temperature"}),e.jsx(j,{type:"number",min:"0",max:"2",step:"0.1",value:r.model.temperature,onChange:s=>N("model.temperature",parseFloat(s.target.value)),className:"mt-1",placeholder:"0.7"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max Tokens"}),e.jsx(j,{type:"number",min:"1",max:"32000",value:r.model.maxTokens,onChange:s=>N("model.maxTokens",parseInt(s.target.value)),className:"mt-1",placeholder:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Fast Turns"}),e.jsx(j,{type:"number",min:"0",max:"10",value:r.model.numFastTurns,onChange:s=>N("model.numFastTurns",parseInt(s.target.value)),className:"mt-1",placeholder:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Voice Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs(I,{value:r.voice.provider,onValueChange:s=>N("voice.provider",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsx(M,{children:se.map(s=>e.jsx(o,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Voice"}),e.jsxs(I,{value:r.voice.voiceId,onValueChange:s=>N("voice.voiceId",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsx(M,{children:be(r.voice.provider).map(s=>e.jsx(o,{value:s.id,children:s.name},s.id))})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Speed"}),e.jsx(j,{type:"number",min:"0.25",max:"4",step:"0.1",value:r.voice.speed,onChange:s=>N("voice.speed",parseFloat(s.target.value)),className:"mt-1",placeholder:"1.0"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Transcriber Configuration"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs(I,{value:r.transcriber.provider,onValueChange:s=>N("transcriber.provider",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsx(M,{children:Va.map(s=>e.jsx(o,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Model"}),e.jsxs(I,{value:r.transcriber.model,onValueChange:s=>N("transcriber.model",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsx(M,{children:Ea(r.transcriber.provider).map(s=>e.jsx(o,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Language"}),e.jsxs(I,{value:r.transcriber.language,onValueChange:s=>N("transcriber.language",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"en",children:"English"}),e.jsx(o,{value:"es",children:"Spanish"}),e.jsx(o,{value:"fr",children:"French"}),e.jsx(o,{value:"de",children:"German"}),e.jsx(o,{value:"it",children:"Italian"}),e.jsx(o,{value:"pt",children:"Portuguese"}),e.jsx(o,{value:"ru",children:"Russian"}),e.jsx(o,{value:"ja",children:"Japanese"}),e.jsx(o,{value:"ko",children:"Korean"}),e.jsx(o,{value:"zh",children:"Chinese"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Advanced Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"First Message Mode"}),e.jsxs(I,{value:r.firstMessageMode,onValueChange:s=>N("firstMessageMode",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"assistant-speaks-first",children:"Assistant Speaks First"}),e.jsx(o,{value:"assistant-waits-for-user",children:"Assistant Waits for User"}),e.jsx(o,{value:"assistant-speaks-first-with-model-generated-message",children:"Model Generated First Message"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max Duration (seconds)"}),e.jsx(j,{type:"number",min:"10",max:"43200",value:r.maxDurationSeconds,onChange:s=>N("maxDurationSeconds",parseInt(s.target.value)),className:"mt-1",placeholder:"600"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Background Sound"}),e.jsxs(I,{value:r.backgroundSound,onValueChange:s=>N("backgroundSound",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"off",children:"Off"}),e.jsx(o,{value:"office",children:"Office"}),e.jsx(o,{value:"cafe",children:"Cafe"}),e.jsx(o,{value:"nature",children:"Nature"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-6",children:[e.jsx("input",{type:"checkbox",id:"firstMessageInterruptions",checked:r.firstMessageInterruptionsEnabled,onChange:s=>N("firstMessageInterruptionsEnabled",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"firstMessageInterruptions",className:"text-sm text-gray-700",children:"Allow First Message Interruptions"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"End Call Message"}),e.jsx(B,{value:r.endCallMessage,onChange:s=>N("endCallMessage",s.target.value),className:"mt-1",rows:2,placeholder:"Thank you for calling. Goodbye!"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Voicemail Message"}),e.jsx(B,{value:r.voicemailMessage,onChange:s=>N("voicemailMessage",s.target.value),className:"mt-1",rows:2,placeholder:"Please leave a message after the beep."})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(V,{variant:"outline",onClick:()=>G(!1),disabled:le.isPending,children:"Cancel"}),e.jsx(V,{onClick:Ka,disabled:le.isPending||!r.name||!r.firstMessage,className:"bg-blue-600 hover:bg-blue-700",children:le.isPending?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Sa,{className:"h-4 w-4 mr-2"}),"Create Assistant"]})})]})]})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Da,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(j,{placeholder:"Search Assistants",value:R,onChange:s=>_(s.target.value),className:"pl-10 bg-gray-50 border-gray-200"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:qa?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(X,{className:"h-6 w-6 animate-spin text-gray-400"})}):e.jsx("div",{className:"p-2",children:E.filter(s=>s&&s.id&&s.name).map(s=>e.jsx("div",{onClick:()=>W(s),className:`p-3 rounded-lg cursor-pointer transition-all duration-200 mb-2 ${(n==null?void 0:n.id)===s.id?"bg-green border border-blue-200":"hover:bg-gray-50 border border-transparent"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(je,{className:"h-10 w-10 bg-gray-600",children:e.jsx(fe,{className:"text-white bg-green font-medium",children:xe(s.name)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.name}),Y.has(String(s.id))&&e.jsx(P,{variant:"secondary",className:"bg-green-100 text-green-700 text-xs",children:"Published"})]}),e.jsx("div",{className:"text-sm text-gray-500 truncate",children:s.assistant_id?`${String(s.assistant_id).substring(0,12)}...`:"No Assistant ID"})]})]})},s.id))})})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-white/80 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(je,{className:"h-12 w-12 bg-gradient-to-br from-blue-500 to-purple-600",children:e.jsx(fe,{className:"text-white bg-green font-medium text-lg",children:xe(n.name)})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:n.name}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx(P,{variant:"secondary",className:"bg-green-100 text-green-700",children:"Active"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["ID: ",String(n.id).substring(0,12),"..."]}),oe.isPending&&e.jsxs("div",{className:"flex items-center text-xs text-blue-600",children:[e.jsx(X,{className:"h-3 w-3 mr-1 animate-spin"}),"Auto-saving..."]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(V,{size:"sm",onClick:()=>F(!0),className:"bg-gradient-to-r from-teal-500 to-cyan-600 hover:from-teal-600 hover:to-cyan-700 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(er,{className:"h-4 w-4 mr-2"}),"Talk to Assistant"]}),e.jsx(V,{variant:Y.has(String(n.id))?"default":"outline",size:"sm",onClick:()=>Ga(n),className:Y.has(String(n.id))?"bg-green-600 hover:bg-green-700 text-white":"text-gray-600 hover:text-gray-700 hover:bg-gray-50",children:Y.has(String(n.id))?"Published":"Unpublished"}),e.jsx(V,{variant:"outline",size:"sm",onClick:()=>Ha(n),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200",children:e.jsx(ka,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:A?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(X,{className:"h-8 w-8 animate-spin text-gray-400"})}):e.jsxs(xr,{defaultValue:"model",className:"w-full",children:[e.jsxs(ur,{className:"grid w-full grid-cols-11 mb-6",children:[e.jsxs(pe,{value:"model",className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"h-4 w-4"}),"Model"]}),e.jsxs(pe,{value:"voice",className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Voice"]}),e.jsxs(pe,{value:"transcriber",className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Transcriber"]})]}),e.jsxs(D,{value:"model",className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"h-5 w-5 text-blue-600"}),"Model Configuration"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs(I,{value:Pe(((Be=a==null?void 0:a.model)==null?void 0:Be.provider)||"","model"),onValueChange:s=>c("model.provider",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{placeholder:((Re=a==null?void 0:a.model)==null?void 0:Re.provider)||"Select provider"})}),e.jsx(M,{children:Ta.map(s=>e.jsx(o,{value:s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s.name}),s.requiresApiKey&&e.jsx(P,{variant:"outline",className:"text-xs",children:"API Key"})]})},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Model"}),e.jsxs(I,{value:((Ue=a==null?void 0:a.model)==null?void 0:Ue.model)||"",onValueChange:s=>c("model.model",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{placeholder:(($e=a==null?void 0:a.model)==null?void 0:$e.model)||"Select model"})}),e.jsxs(M,{children:[ve(((Le=a==null?void 0:a.model)==null?void 0:Le.provider)||"openai").map(s=>e.jsx(o,{value:s.id,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),s.description&&e.jsx("span",{className:"text-xs text-gray-500",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[s.supportsTools&&e.jsx(P,{variant:"outline",className:"text-xs",children:"Tools"}),s.supportsVision&&e.jsx(P,{variant:"outline",className:"text-xs",children:"Vision"}),s.costTier&&e.jsx(P,{variant:s.costTier==="low"?"secondary":s.costTier==="medium"?"default":"destructive",className:"text-xs",children:s.costTier})]})]})},s.id)),((qe=a==null?void 0:a.model)==null?void 0:qe.model)&&!ve(((ze=a==null?void 0:a.model)==null?void 0:ze.provider)||"openai").some(s=>s.id===a.model.model)&&e.jsxs(o,{value:a.model.model,children:[a.model.model," (Current)"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Temperature"}),e.jsx(j,{type:"number",min:"0",max:"2",step:"0.1",value:((Ae=a==null?void 0:a.model)==null?void 0:Ae.temperature)||.7,onChange:s=>c("model.temperature",parseFloat(s.target.value)),className:"mt-1",placeholder:"0.7"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max Tokens"}),e.jsx(j,{type:"number",min:"1",max:"32000",value:((Ke=a==null?void 0:a.model)==null?void 0:Ke.maxTokens)||1e3,onChange:s=>c("model.maxTokens",parseInt(s.target.value)),className:"mt-1",placeholder:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Fast Turns"}),e.jsx(j,{type:"number",min:"0",max:"10",value:((We=a==null?void 0:a.model)==null?void 0:We.numFastTurns)||0,onChange:s=>c("model.numFastTurns",parseInt(s.target.value)),className:"mt-1",placeholder:"0"})]})]})]})]}),e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-green-600"}),"Messages & Prompts"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"First Message"}),e.jsx(B,{value:(a==null?void 0:a.firstMessage)||(n==null?void 0:n.firstMessage)||"",onChange:s=>c("firstMessage",s.target.value),className:"mt-1",rows:3,placeholder:"Hello! How can I help you today?"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"First Message Mode"}),e.jsxs(I,{value:(a==null?void 0:a.firstMessageMode)||"assistant-speaks-first",onValueChange:s=>c("firstMessageMode",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"assistant-speaks-first",children:"Assistant Speaks First"}),e.jsx(o,{value:"assistant-waits-for-user",children:"Assistant Waits for User"}),e.jsx(o,{value:"assistant-speaks-first-with-model-generated-message",children:"Model Generated First Message"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-6",children:[e.jsx("input",{type:"checkbox",id:"firstMessageInterruptions",checked:(a==null?void 0:a.firstMessageInterruptionsEnabled)||!1,onChange:s=>c("firstMessageInterruptionsEnabled",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"firstMessageInterruptions",className:"text-sm text-gray-700",children:"Allow First Message Interruptions"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"System Message"}),e.jsx(B,{value:((Ge=(Ye=(He=a==null?void 0:a.model)==null?void 0:He.messages)==null?void 0:Ye[0])==null?void 0:Ge.content)||(a==null?void 0:a.systemMessage)||"",onChange:s=>Wa(s.target.value),className:"mt-1",rows:6,placeholder:"You are a helpful AI assistant..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"End Call Message"}),e.jsx(B,{value:(a==null?void 0:a.endCallMessage)||"",onChange:s=>c("endCallMessage",s.target.value),className:"mt-1",rows:2,placeholder:"Thank you for calling. Goodbye!"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Voicemail Message"}),e.jsx(B,{value:(a==null?void 0:a.voicemailMessage)||"",onChange:s=>c("voicemailMessage",s.target.value),className:"mt-1",rows:2,placeholder:"Please leave a message after the beep."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"End Call Phrases"}),e.jsx(B,{value:((Qe=a==null?void 0:a.endCallPhrases)==null?void 0:Qe.join(`
`))||"",onChange:s=>c("endCallPhrases",s.target.value.split(`
`).filter(t=>t.trim())),className:"mt-1",rows:3,placeholder:`goodbye
bye
end call
hang up`}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Phrases that will trigger the call to end (one per line, case insensitive)"})]})]})]})]}),e.jsx(D,{value:"voice",className:"space-y-6",children:e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-green-600"}),"Voice Configuration"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs(I,{value:Pe(((Je=a==null?void 0:a.voice)==null?void 0:Je.provider)||"","voice"),onValueChange:s=>c("voice.provider",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{placeholder:((Xe=a==null?void 0:a.voice)==null?void 0:Xe.provider)||"Select voice provider"})}),e.jsx(M,{children:se.map(s=>e.jsx(o,{value:s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s.name}),s.requiresApiKey&&e.jsx(P,{variant:"outline",className:"text-xs",children:"API Key"}),e.jsxs("div",{className:"flex gap-1",children:[s.supportsSpeed&&e.jsx(P,{variant:"secondary",className:"text-xs",children:"Speed"}),s.supportsStability&&e.jsx(P,{variant:"secondary",className:"text-xs",children:"Stability"})]})]})},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Voice"}),e.jsxs(I,{value:((Ze=a==null?void 0:a.voice)==null?void 0:Ze.voiceId)||"",onValueChange:s=>c("voice.voiceId",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{placeholder:"Select voice..."})}),e.jsxs(M,{children:[be(((De=a==null?void 0:a.voice)==null?void 0:De.provider)||"11labs").map(s=>e.jsx(o,{value:s.id,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),s.description&&e.jsx("span",{className:"text-xs text-gray-500",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[s.gender&&e.jsx(P,{variant:"outline",className:"text-xs",children:s.gender}),s.accent&&e.jsx(P,{variant:"secondary",className:"text-xs",children:s.accent})]})]})},s.id)),((es=a==null?void 0:a.voice)==null?void 0:es.voiceId)&&!be(((ss=a==null?void 0:a.voice)==null?void 0:ss.provider)||"11labs").some(s=>s.id===a.voice.voiceId)&&e.jsxs(o,{value:a.voice.voiceId,children:[a.voice.voiceId," (Current)"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[((as=se.find(s=>{var t;return s.id===((t=a==null?void 0:a.voice)==null?void 0:t.provider)}))==null?void 0:as.supportsSpeed)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Speed"}),e.jsx(j,{type:"number",min:"0.25",max:"4",step:"0.1",value:((rs=a==null?void 0:a.voice)==null?void 0:rs.speed)||1,onChange:s=>c("voice.speed",parseFloat(s.target.value)),className:"mt-1",placeholder:"1.0"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"0.25x to 4x speed"})]}),((ts=se.find(s=>{var t;return s.id===((t=a==null?void 0:a.voice)==null?void 0:t.provider)}))==null?void 0:ts.supportsStability)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Stability"}),e.jsx(j,{type:"number",min:"0",max:"1",step:"0.1",value:((ns=a==null?void 0:a.voice)==null?void 0:ns.stability)||.5,onChange:s=>c("voice.stability",parseFloat(s.target.value)),className:"mt-1",placeholder:"0.5"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Higher = more stable"})]}),((is=se.find(s=>{var t;return s.id===((t=a==null?void 0:a.voice)==null?void 0:t.provider)}))==null?void 0:is.supportsSimilarityBoost)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Similarity Boost"}),e.jsx(j,{type:"number",min:"0",max:"1",step:"0.1",value:((ls=a==null?void 0:a.voice)==null?void 0:ls.similarityBoost)||.5,onChange:s=>c("voice.similarityBoost",parseFloat(s.target.value)),className:"mt-1",placeholder:"0.5"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Higher = more similar to original"})]})]})]})]})}),e.jsxs(D,{value:"transcriber",className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-purple-600"}),"Transcriber Configuration"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs(I,{value:((os=a==null?void 0:a.transcriber)==null?void 0:os.provider)||"deepgram",onValueChange:s=>c("transcriber.provider",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsx(M,{children:Va.map(s=>e.jsx(o,{value:s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s.name}),s.requiresApiKey&&e.jsx(P,{variant:"outline",className:"text-xs",children:"API Key"}),s.supportsLanguages&&e.jsxs(P,{variant:"secondary",className:"text-xs",children:[s.supportsLanguages.length," Languages"]})]})},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Language"}),e.jsxs(I,{value:((cs=a==null?void 0:a.transcriber)==null?void 0:cs.language)||"en",onValueChange:s=>c("transcriber.language",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"en",children:"English"}),e.jsx(o,{value:"es",children:"Spanish"}),e.jsx(o,{value:"fr",children:"French"}),e.jsx(o,{value:"de",children:"German"}),e.jsx(o,{value:"it",children:"Italian"}),e.jsx(o,{value:"pt",children:"Portuguese"}),e.jsx(o,{value:"zh",children:"Chinese"}),e.jsx(o,{value:"ja",children:"Japanese"}),e.jsx(o,{value:"ko",children:"Korean"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Model"}),e.jsxs(I,{value:((ds=a==null?void 0:a.transcriber)==null?void 0:ds.model)||"nova-2",onValueChange:s=>c("transcriber.model",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsx(M,{children:Ea(((ms=a==null?void 0:a.transcriber)==null?void 0:ms.provider)||"deepgram").map(s=>e.jsx(o,{value:s.id,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),s.description&&e.jsx("span",{className:"text-xs text-gray-500",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[s.accuracy&&e.jsx(P,{variant:s.accuracy==="premium"?"default":s.accuracy==="enhanced"?"secondary":"outline",className:"text-xs",children:s.accuracy}),s.latency&&e.jsxs(P,{variant:"outline",className:"text-xs",children:[s.latency," latency"]})]})]})},s.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Keywords"}),e.jsx(j,{value:((us=(xs=a==null?void 0:a.transcriber)==null?void 0:xs.keywords)==null?void 0:us.join(", "))||"",onChange:s=>c("transcriber.keywords",s.target.value.split(",").map(t=>t.trim()).filter(t=>t)),className:"mt-1",placeholder:"Enter keywords separated by commas..."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Confidence Threshold"}),e.jsx(j,{type:"number",min:"0",max:"1",step:"0.1",value:((hs=a==null?void 0:a.transcriber)==null?void 0:hs.confidenceThreshold)||.4,onChange:s=>c("transcriber.confidenceThreshold",parseFloat(s.target.value)),className:"mt-1",placeholder:"0.4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"End of Turn Confidence"}),e.jsx(j,{type:"number",min:"0",max:"1",step:"0.1",value:((gs=a==null?void 0:a.transcriber)==null?void 0:gs.endOfTurnConfidenceThreshold)||.7,onChange:s=>c("transcriber.endOfTurnConfidenceThreshold",parseFloat(s.target.value)),className:"mt-1",placeholder:"0.7"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Min End Silence (ms)"}),e.jsx(j,{type:"number",min:"0",max:"5000",value:((ps=a==null?void 0:a.transcriber)==null?void 0:ps.minEndOfTurnSilenceWhenConfident)||160,onChange:s=>c("transcriber.minEndOfTurnSilenceWhenConfident",parseInt(s.target.value)),className:"mt-1",placeholder:"160"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max Turn Silence (ms)"}),e.jsx(j,{type:"number",min:"0",max:"10000",value:((js=a==null?void 0:a.transcriber)==null?void 0:js.maxTurnSilence)||400,onChange:s=>c("transcriber.maxTurnSilence",parseInt(s.target.value)),className:"mt-1",placeholder:"400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Word Finalization Wait (ms)"}),e.jsx(j,{type:"number",min:"0",max:"5000",value:((fs=a==null?void 0:a.transcriber)==null?void 0:fs.wordFinalizationMaxWaitTime)||160,onChange:s=>c("transcriber.wordFinalizationMaxWaitTime",parseInt(s.target.value)),className:"mt-1",placeholder:"160"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"enableUniversalStreamingApi",checked:((vs=a==null?void 0:a.transcriber)==null?void 0:vs.enableUniversalStreamingApi)||!1,onChange:s=>c("transcriber.enableUniversalStreamingApi",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"enableUniversalStreamingApi",className:"text-sm text-gray-700",children:"Enable Universal Streaming API"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"formatTurns",checked:((bs=a==null?void 0:a.transcriber)==null?void 0:bs.formatTurns)||!1,onChange:s=>c("transcriber.formatTurns",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"formatTurns",className:"text-sm text-gray-700",children:"Format Turns"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"disablePartialTranscripts",checked:((ys=a==null?void 0:a.transcriber)==null?void 0:ys.disablePartialTranscripts)||!1,onChange:s=>c("transcriber.disablePartialTranscripts",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"disablePartialTranscripts",className:"text-sm text-gray-700",children:"Disable Partial Transcripts"})]})]})]})]}),e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(sr,{className:"h-5 w-5 text-indigo-600"}),"Word Boost & Keywords"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Word Boost"}),e.jsx(B,{value:((Is=(Ns=a==null?void 0:a.transcriber)==null?void 0:Ns.wordBoost)==null?void 0:Is.join(`
`))||"",onChange:s=>c("transcriber.wordBoost",s.target.value.split(`
`).filter(t=>t.trim())),className:"mt-1",rows:4,placeholder:"Enter words to boost (one per line)..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Words that should be recognized more accurately. One word per line."})]}),((ws=a==null?void 0:a.transcriber)==null?void 0:ws.wordBoost)&&a.transcriber.wordBoost.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Current Word Boost"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:a.transcriber.wordBoost.map((s,t)=>e.jsx(P,{variant:"outline",className:"mr-2 mb-2",children:s},t))})]})]})]})]}),e.jsxs(D,{value:"advanced",className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(ar,{className:"h-5 w-5 text-indigo-600"}),"Call Configuration"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max Duration (seconds)"}),e.jsx(j,{type:"number",min:"10",max:"43200",value:(a==null?void 0:a.maxDurationSeconds)||600,onChange:s=>c("maxDurationSeconds",parseInt(s.target.value)),className:"mt-1",placeholder:"600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Background Sound"}),e.jsxs(I,{value:(a==null?void 0:a.backgroundSound)||"off",onValueChange:s=>c("backgroundSound",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"off",children:"Off"}),e.jsx(o,{value:"office",children:"Office"}),e.jsx(o,{value:"cafe",children:"Cafe"}),e.jsx(o,{value:"nature",children:"Nature"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"modelOutputInMessagesEnabled",checked:(a==null?void 0:a.modelOutputInMessagesEnabled)||!1,onChange:s=>c("modelOutputInMessagesEnabled",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"modelOutputInMessagesEnabled",className:"text-sm text-gray-700",children:"Model Output in Messages"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"backgroundDenoisingEnabled",checked:(a==null?void 0:a.backgroundDenoisingEnabled)||!1,onChange:s=>c("backgroundDenoisingEnabled",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"backgroundDenoisingEnabled",className:"text-sm text-gray-700",children:"Background Denoising (Deprecated)"})]})]})]})]}),e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-purple-600"}),"Speech & Interruption Settings"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Start Speaking Plan"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Wait Seconds"}),e.jsx(j,{type:"number",min:"0",max:"5",step:"0.1",value:((Cs=a==null?void 0:a.startSpeakingPlan)==null?void 0:Cs.waitSeconds)||.4,onChange:s=>c("startSpeakingPlan.waitSeconds",parseFloat(s.target.value)),className:"mt-1",placeholder:"0.4"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsx("input",{type:"checkbox",id:"smartEndpointingEnabled",checked:((Ms=a==null?void 0:a.startSpeakingPlan)==null?void 0:Ms.smartEndpointingEnabled)||!1,onChange:s=>c("startSpeakingPlan.smartEndpointingEnabled",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"smartEndpointingEnabled",className:"text-xs text-gray-700",children:"Smart Endpointing"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Stop Speaking Plan"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Num Words"}),e.jsx(j,{type:"number",min:"0",max:"10",value:((Ss=a==null?void 0:a.stopSpeakingPlan)==null?void 0:Ss.numWords)||0,onChange:s=>c("stopSpeakingPlan.numWords",parseInt(s.target.value)),className:"mt-1",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Voice Seconds"}),e.jsx(j,{type:"number",min:"0",max:"2",step:"0.1",value:((ks=a==null?void 0:a.stopSpeakingPlan)==null?void 0:ks.voiceSeconds)||.2,onChange:s=>c("stopSpeakingPlan.voiceSeconds",parseFloat(s.target.value)),className:"mt-1",placeholder:"0.2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-600",children:"Backoff Seconds"}),e.jsx(j,{type:"number",min:"0",max:"5",step:"0.1",value:((Ps=a==null?void 0:a.stopSpeakingPlan)==null?void 0:Ps.backoffSeconds)||1,onChange:s=>c("stopSpeakingPlan.backoffSeconds",parseFloat(s.target.value)),className:"mt-1",placeholder:"1"})]})]})]})]})]}),e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(La,{className:"h-5 w-5 text-blue-600"}),"Transport Configuration"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs(I,{value:((Vs=(Ts=a==null?void 0:a.transportConfigurations)==null?void 0:Ts[0])==null?void 0:Vs.provider)||"twilio",onValueChange:s=>c("transportConfigurations.0.provider",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"twilio",children:"Twilio"}),e.jsx(o,{value:"vonage",children:"Vonage"}),e.jsx(o,{value:"vapi",children:"VAPI"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Timeout (seconds)"}),e.jsx(j,{type:"number",min:"10",max:"300",value:((Fs=(Es=a==null?void 0:a.transportConfigurations)==null?void 0:Es[0])==null?void 0:Fs.timeout)||60,onChange:s=>c("transportConfigurations.0.timeout",parseInt(s.target.value)),className:"mt-1",placeholder:"60"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"recordEnabled",checked:((Os=(_s=a==null?void 0:a.transportConfigurations)==null?void 0:_s[0])==null?void 0:Os.record)||!1,onChange:s=>c("transportConfigurations.0.record",s.target.checked),className:"rounded border-gray-300"}),e.jsx("label",{htmlFor:"recordEnabled",className:"text-sm text-gray-700",children:"Enable Call Recording"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Recording Channels"}),e.jsxs(I,{value:((Rs=(Bs=a==null?void 0:a.transportConfigurations)==null?void 0:Bs[0])==null?void 0:Rs.recordingChannels)||"mono",onValueChange:s=>c("transportConfigurations.0.recordingChannels",s),children:[e.jsx(w,{className:"mt-1",children:e.jsx(C,{})}),e.jsxs(M,{children:[e.jsx(o,{value:"mono",children:"Mono"}),e.jsx(o,{value:"dual",children:"Dual"})]})]})]})]})]})]})]}),e.jsx(D,{value:"debug",className:"space-y-6",children:e.jsxs($,{children:[e.jsx(L,{children:e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5 text-red-600"}),"Debug Information"]})}),e.jsxs(z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Assistant ID"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg font-mono text-sm",children:n==null?void 0:n.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Organization ID"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg font-mono text-sm",children:(a==null?void 0:a.orgId)||"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Created At"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg text-sm",children:a!=null&&a.createdAt?new Date(a.createdAt).toLocaleString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Updated At"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg text-sm",children:a!=null&&a.updatedAt?new Date(a.updatedAt).toLocaleString():"N/A"})]})]}),(a==null?void 0:a.metadata)&&Object.keys(a.metadata).length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Metadata"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:e.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap",children:JSON.stringify(a.metadata,null,2)})})]}),(a==null?void 0:a._rawVapiData)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Raw VAPI Response"}),e.jsx("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"text-xs text-gray-600 whitespace-pre-wrap",children:JSON.stringify(a._rawVapiData,null,2)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("label",{className:"text-xs font-medium text-blue-700",children:"Model Values"}),e.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[e.jsxs("div",{children:['Provider: "',(Us=a==null?void 0:a.model)==null?void 0:Us.provider,'" (',typeof(($s=a==null?void 0:a.model)==null?void 0:$s.provider),")"]}),e.jsxs("div",{children:['Model: "',(Ls=a==null?void 0:a.model)==null?void 0:Ls.model,'" (',typeof((qs=a==null?void 0:a.model)==null?void 0:qs.model),")"]}),e.jsxs("div",{children:["Temperature: ",(zs=a==null?void 0:a.model)==null?void 0:zs.temperature," (",typeof((As=a==null?void 0:a.model)==null?void 0:As.temperature),")"]})]})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("label",{className:"text-xs font-medium text-green-700",children:"Voice Values"}),e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:[e.jsxs("div",{children:['Provider: "',(Ks=a==null?void 0:a.voice)==null?void 0:Ks.provider,'" (',typeof((Ws=a==null?void 0:a.voice)==null?void 0:Ws.provider),")"]}),e.jsxs("div",{children:['Voice ID: "',(Hs=a==null?void 0:a.voice)==null?void 0:Hs.voiceId,'" (',typeof((Ys=a==null?void 0:a.voice)==null?void 0:Ys.voiceId),")"]}),e.jsxs("div",{children:["Speed: ",(Gs=a==null?void 0:a.voice)==null?void 0:Gs.speed," (",typeof((Qs=a==null?void 0:a.voice)==null?void 0:Qs.speed),")"]})]})]})]})]})]})})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ie,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Assistant Selected"}),e.jsx("p",{className:"text-gray-500",children:"Select an assistant from the list to view details"})]})})}),e.jsx(Ba,{open:me,onOpenChange:Q,children:e.jsxs(Ra,{className:"sm:max-w-[425px]",children:[e.jsx(Ua,{children:e.jsxs($a,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(he,{className:"h-5 w-5"}),"Delete Assistant"]})}),e.jsx("div",{className:"py-4",children:e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-red-50 rounded-lg border border-red-200",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(he,{className:"h-8 w-8 text-red-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Are you sure you want to delete this assistant?"}),e.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:u==null?void 0:u.name})," will be permanently deleted from both VAPI and your database. This action cannot be undone."]}),e.jsxs("div",{className:"mt-2 text-xs text-red-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Agent ID:"})," ",u==null?void 0:u.id]}),(u==null?void 0:u.assistant_id)&&e.jsxs("p",{children:[e.jsx("strong",{children:"VAPI Assistant ID:"})," ",u.assistant_id]})]})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(V,{variant:"outline",onClick:()=>Q(!1),disabled:ce.isPending,children:"Cancel"}),e.jsx(V,{variant:"destructive",onClick:Ya,disabled:ce.isPending,className:"bg-red-600 hover:bg-red-700",children:ce.isPending?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ka,{className:"h-4 w-4 mr-2"}),"Delete Assistant"]})})]})]})}),y&&e.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[e.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm transition-opacity",onClick:()=>F(!1)}),e.jsxs("div",{className:"ml-auto relative bg-white w-1/2 h-full shadow-2xl border-l border-gray-200 transform transition-transform duration-300 ease-in-out",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(je,{className:"h-10 w-10 bg-gray-100 border border-gray-200",children:e.jsx(fe,{className:"text-gray-700 font-medium",children:xe((n==null?void 0:n.name)||"")})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n==null?void 0:n.name}),e.jsx("p",{className:"text-gray-500 text-sm",children:"AI Voice Assistant"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{id:"call-button-container",className:"min-w-[100px] min-h-[40px] bg-red-100 border  rounded flex items-center justify-center"}),e.jsx(V,{variant:"ghost",size:"sm",onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 h-8 w-8 p-0 rounded-full",children:"Ã—"})]})]})}),e.jsx("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:n&&e.jsx(gr,{agentId:String(n.id),agentName:n.name||"Unknown Agent",agentConfig:{...a,assistant_id:n.assistant_id||(a==null?void 0:a.assistant_id),firstMessage:(a==null?void 0:a.firstMessage)||`Hello! I'm ${n.name}. How can I help you today?`,systemMessage:((Zs=(Xs=(Js=a==null?void 0:a.model)==null?void 0:Js.messages)==null?void 0:Xs[0])==null?void 0:Zs.content)||`You are ${n.name}, a helpful AI assistant.`},onCallStart:()=>{console.log("ðŸŽ™ï¸ Started call with assistant:",n.name),console.log("ðŸ” Agent data:",n),console.log("ðŸ” Agent details:",a),v.success(`Connected to ${n.name}`)},onCallEnd:()=>{console.log("ðŸŽ™ï¸ Ended call with assistant:",n.name),v.info("Call ended")},onError:s=>{console.error("ðŸŽ™ï¸ Call error:",s),v.error(`Call error: ${s.message}`)}})})]})]})]})};export{Or as default};
//# sourceMappingURL=VapiStyleAgents-Cjktr4Gy.js.map
