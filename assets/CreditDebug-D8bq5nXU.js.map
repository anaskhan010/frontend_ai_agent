{"version":3,"file":"CreditDebug-D8bq5nXU.js","sources":["../../src/components/Debug/CreditDebug.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport axiosInstance from '@/api/axios/axiosInstance';\nimport secureLocalStorage from 'react-secure-storage';\n\nconst CreditDebug = () => {\n  const [debugInfo, setDebugInfo] = useState({});\n  const [loading, setLoading] = useState(false);\n\n  const runDebugTests = async () => {\n    setLoading(true);\n    const results = {};\n\n    try {\n      // Test 1: Check if user is logged in\n      const token = secureLocalStorage.getItem('token');\n      results.hasToken = !!token;\n      results.tokenPreview = token ? token.substring(0, 20) + '...' : 'No token';\n\n      // Test 2: Try demo login\n      try {\n        const loginResponse = await axiosInstance.post('/api/auth/demo-login', {});\n        results.demoLogin = {\n          success: true,\n          userId: loginResponse.data.data.user.id,\n          email: loginResponse.data.data.user.email\n        };\n        \n        // Store the token\n        secureLocalStorage.setItem('token', loginResponse.data.data.token);\n        results.tokenStored = true;\n      } catch (error) {\n        results.demoLogin = {\n          success: false,\n          error: error.response?.data?.message || error.message\n        };\n      }\n\n      // Test 3: Check credit balance\n      try {\n        const balanceResponse = await axiosInstance.get('/api/credits/balance');\n        results.creditBalance = {\n          success: true,\n          data: balanceResponse.data.data\n        };\n      } catch (error) {\n        results.creditBalance = {\n          success: false,\n          error: error.response?.data?.message || error.message,\n          status: error.response?.status\n        };\n      }\n\n      // Test 4: Check API connectivity\n      try {\n        const healthResponse = await axiosInstance.get('/api/credits/packages');\n        results.apiConnectivity = {\n          success: true,\n          packagesCount: healthResponse.data.data?.length || 0\n        };\n      } catch (error) {\n        results.apiConnectivity = {\n          success: false,\n          error: error.response?.data?.message || error.message\n        };\n      }\n\n      // Test 5: Check axios instance configuration\n      results.axiosConfig = {\n        baseURL: axiosInstance.defaults.baseURL,\n        timeout: axiosInstance.defaults.timeout,\n        headers: Object.keys(axiosInstance.defaults.headers.common || {})\n      };\n\n    } catch (error) {\n      results.generalError = error.message;\n    }\n\n    setDebugInfo(results);\n    setLoading(false);\n  };\n\n  const clearStorage = () => {\n    secureLocalStorage.clear();\n    setDebugInfo({});\n    window.location.reload();\n  };\n\n  useEffect(() => {\n    runDebugTests();\n  }, []);\n\n  return (\n    <Card className=\"w-full max-w-4xl mx-auto\">\n      <CardHeader>\n        <CardTitle>Credit System Debug</CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"flex gap-2\">\n          <Button onClick={runDebugTests} disabled={loading}>\n            {loading ? 'Running Tests...' : 'Run Debug Tests'}\n          </Button>\n          <Button onClick={clearStorage} variant=\"outline\">\n            Clear Storage & Reload\n          </Button>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          {/* Authentication Status */}\n          <div className=\"p-4 border rounded\">\n            <h3 className=\"font-semibold mb-2\">Authentication</h3>\n            <div className=\"text-sm space-y-1\">\n              <div>Has Token: {debugInfo.hasToken ? '✅' : '❌'}</div>\n              <div>Token: {debugInfo.tokenPreview}</div>\n              <div>Token Stored: {debugInfo.tokenStored ? '✅' : '❌'}</div>\n              {debugInfo.demoLogin && (\n                <div>\n                  Demo Login: {debugInfo.demoLogin.success ? '✅' : '❌'}\n                  {debugInfo.demoLogin.success && (\n                    <div className=\"ml-4\">\n                      <div>User ID: {debugInfo.demoLogin.userId}</div>\n                      <div>Email: {debugInfo.demoLogin.email}</div>\n                    </div>\n                  )}\n                  {!debugInfo.demoLogin.success && (\n                    <div className=\"ml-4 text-red-600\">\n                      Error: {debugInfo.demoLogin.error}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Credit Balance */}\n          <div className=\"p-4 border rounded\">\n            <h3 className=\"font-semibold mb-2\">Credit Balance</h3>\n            <div className=\"text-sm space-y-1\">\n              {debugInfo.creditBalance && (\n                <div>\n                  API Call: {debugInfo.creditBalance.success ? '✅' : '❌'}\n                  {debugInfo.creditBalance.success && (\n                    <div className=\"ml-4\">\n                      <div>Available: {debugInfo.creditBalance.data.available_credits}</div>\n                      <div>Total: {debugInfo.creditBalance.data.total_credits}</div>\n                      <div>Used: {debugInfo.creditBalance.data.used_credits}</div>\n                    </div>\n                  )}\n                  {!debugInfo.creditBalance.success && (\n                    <div className=\"ml-4 text-red-600\">\n                      Status: {debugInfo.creditBalance.status}<br/>\n                      Error: {debugInfo.creditBalance.error}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* API Connectivity */}\n          <div className=\"p-4 border rounded\">\n            <h3 className=\"font-semibold mb-2\">API Connectivity</h3>\n            <div className=\"text-sm space-y-1\">\n              {debugInfo.apiConnectivity && (\n                <div>\n                  Connection: {debugInfo.apiConnectivity.success ? '✅' : '❌'}\n                  {debugInfo.apiConnectivity.success && (\n                    <div className=\"ml-4\">\n                      Packages: {debugInfo.apiConnectivity.packagesCount}\n                    </div>\n                  )}\n                  {!debugInfo.apiConnectivity.success && (\n                    <div className=\"ml-4 text-red-600\">\n                      Error: {debugInfo.apiConnectivity.error}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Axios Configuration */}\n          <div className=\"p-4 border rounded\">\n            <h3 className=\"font-semibold mb-2\">Axios Config</h3>\n            <div className=\"text-sm space-y-1\">\n              {debugInfo.axiosConfig && (\n                <div>\n                  <div>Base URL: {debugInfo.axiosConfig.baseURL || 'Not set'}</div>\n                  <div>Timeout: {debugInfo.axiosConfig.timeout || 'Default'}</div>\n                  <div>Headers: {debugInfo.axiosConfig.headers.join(', ') || 'None'}</div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {debugInfo.generalError && (\n          <div className=\"p-4 border border-red-300 rounded bg-red-50\">\n            <h3 className=\"font-semibold text-red-800 mb-2\">General Error</h3>\n            <div className=\"text-sm text-red-600\">{debugInfo.generalError}</div>\n          </div>\n        )}\n\n        <div className=\"mt-4 p-4 bg-gray-50 rounded\">\n          <h3 className=\"font-semibold mb-2\">Raw Debug Data</h3>\n          <pre className=\"text-xs overflow-auto max-h-40\">\n            {JSON.stringify(debugInfo, null, 2)}\n          </pre>\n        </div>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default CreditDebug;\n"],"names":["CreditDebug","debugInfo","setDebugInfo","useState","loading","setLoading","runDebugTests","results","token","secureLocalStorage","loginResponse","axiosInstance","error","_b","_a","balanceResponse","_d","_c","_e","healthResponse","_f","_h","_g","clearStorage","useEffect","jsxs","Card","jsx","CardHeader","CardTitle","CardContent","Button"],"mappings":"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"}