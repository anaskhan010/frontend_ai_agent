import{j as e,bG as Q,b4 as D,aX as $,bc as k,p as le,U as B,b3 as K,bA as ne,a7 as ce,a3 as X,bC as ie,a1 as oe,av as de,bD as me}from"./ui-D0JisYOU.js";import{r as d}from"./vendor-D6QveUxv.js";import{M as xe}from"./ModernTable-DZeqS6bN.js";import{H as he}from"./Header-BI7qh_w5.js";import{P as ue}from"./Page-CFUSkGoi.js";import{L as pe}from"./Loading-_we4eg7o.js";import{u as ge,C as je}from"./resolvers-BDyAs6MX.js";import{o as fe,c as be,a as I}from"./index.esm-2IctsHce.js";import{P as Ne,C as ve}from"./ChatSidebar-COBqBpeu.js";import{L as b,I as U,S as ye,p as we,q as Ce,r as Se,s as E,T as Pe,B as N,C as ke,D as Ae,e as Fe,f as Ie,i as Ee,v as C,x as Le}from"./index-pyURvRiW.js";import{S as De,a as $e,b as Me}from"./sheet-C6Uc2Urd.js";import{b as Re}from"./query-CXvbhbrr.js";import{d as Te}from"./router-jXXg-8rg.js";import{A as Z,a as J}from"./avatar-Tp1KNCi2.js";import{P as qe,a as ze,b as Ve}from"./popover-CocCID7T.js";import{R as G,a as H}from"./radio-group-ZMHA8-qJ.js";import{S as _e}from"./separator-BkbgfagG.js";import"./table-B2l8ctbL.js";import"./scroll-area-P-Szmez0.js";import"./index-DxmflXzI.js";import"./messagingService-C4uQRAdL.js";import"./phoneNumberService-Q-sxO4l1.js";import"./CreatePhoneNumberForm-H0MBU6Sg.js";import"./agentService-B70xpLTK.js";import"./CreditGuard-CN3clUk7.js";const Oe=be().shape({name:I().required("Name is required").min(2,"Name must be at least 2 characters"),email:I().required("Email is required").email("Email is invalid"),contactNumber:I().required("Contact Number is required").min(10,"Contact Number must be at least 10 digits"),description:I().optional().max(500,"Description cannot exceed 500 characters")});function We(){const h=d.useRef(null),{register:u,handleSubmit:o,control:p,formState:{errors:c,isSubmitting:g},reset:r}=ge({resolver:fe(Oe),defaultValues:{contactNumber:""}}),j=async i=>{try{console.log("Form Data:",i),r(),alert("Contact added successfully!")}catch(l){console.error("Error submitting form:",l),alert("Failed to add contact. Please try again.")}},m=()=>{var i;(i=h.current)==null||i.click()},w=i=>{var x;const l=(x=i.target.files)==null?void 0:x[0];l&&(console.log("Importing file:",l.name),i.target.value="")};return e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"text-xl font-semibold jakarta bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-1",children:"Add New Contact"}),e.jsx($e,{className:"text-muted-foreground mb-6",children:"Add a new contact to your directory for voice AI agents to reach out to."}),e.jsxs("form",{onSubmit:o(j),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Q,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Contact Information"})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"name",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Name",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(U,{id:"name",placeholder:"Enter contact name",className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...u("name")}),c.name&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.name.message})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"email",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(U,{id:"email",type:"email",placeholder:"Enter contact email",className:"w-full pl-10 border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...u("email")})]}),c.email&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.email.message})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"contactNumber",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Phone Number",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(je,{name:"contactNumber",control:p,render:({field:{onChange:i,value:l}})=>e.jsx(Ne,{country:"us",value:l,onChange:x=>i(`+${x}`),inputProps:{name:"contactNumber",required:!0,autoFocus:!1},containerStyle:{width:"100%"},inputStyle:{width:"100%",height:"40px",fontSize:"14px",border:"1px solid hsl(var(--border))",borderRadius:"6px",backgroundColor:"hsl(var(--card))",color:"hsl(var(--foreground))",paddingLeft:"48px"},buttonStyle:{border:"1px solid hsl(var(--border))",borderRight:"none",backgroundColor:"hsl(var(--card))",borderRadius:"6px 0 0 6px"},dropdownStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"6px",color:"hsl(var(--foreground))"},placeholder:"Enter phone number",enableSearch:!0,disableSearchIcon:!0})}),c.contactNumber&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.contactNumber.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx($,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Additional Information"})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"list",className:"text-sm font-medium text-foreground mb-1.5 block",children:"Contact List"}),e.jsxs(ye,{children:[e.jsx(we,{className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",children:e.jsx(Ce,{placeholder:"Select a contact list"})}),e.jsxs(Se,{children:[e.jsx(E,{value:"leads",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:"Sales Leads"})]})}),e.jsx(E,{value:"customers",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-2"}),e.jsx("span",{children:"Existing Customers"})]})}),e.jsx(E,{value:"prospects",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-3"}),e.jsx("span",{children:"Prospects"})]})}),e.jsx(E,{value:"partners",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-4"}),e.jsx("span",{children:"Partners"})]})})]})]})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"description",className:"text-sm font-medium text-foreground mb-1.5 block",children:"Notes"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Pe,{id:"description",placeholder:"Add any additional notes about this contact...",className:"w-full pl-10 min-h-[100px] border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...u("description")})]}),c.description&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.description.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(B,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Bulk Import"})]}),e.jsx("div",{className:"border-2 border-dashed border-border/50 rounded-lg p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(B,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("h3",{className:"text-sm font-medium mb-1",children:"Import Contacts"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Drag and drop a CSV or Excel file here or click to browse"}),e.jsx(N,{type:"button",variant:"outline",className:"text-xs border-border/50 hover:bg-muted/20",onClick:m,children:"Browse Files"}),e.jsx("input",{type:"file",id:"import",accept:".xlsx, .csv",ref:h,onChange:w,className:"hidden"})]})})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx(Me,{asChild:!0,children:e.jsx(N,{type:"button",variant:"outline",className:"border-border/50 text-foreground hover:bg-muted/20",children:"Cancel"})}),e.jsx(N,{type:"submit",className:"btn-gradient text-white",disabled:g,children:g?"Saving...":"Add Contact"})]})]})]})}const Be=({data:h,onItemClick:u,actions:o,getInitials:p,formatPhoneNumber:c,getListBadgeVariant:g})=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 mt-6",children:h.map(r=>{const j=p(r.email),m=["Active","Inactive","New"],w=["success","secondary","info"],i=String(r.id).charCodeAt(0)%3;return e.jsx(ke,{className:"overflow-hidden border border-gray-200 hover:border-gray-300 hover:shadow-md transition-all cursor-pointer",onClick:()=>u(r),children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Z,{className:"h-10 w-10 bg-gradient-to-br from-primary/20 to-primary/10",children:e.jsx(J,{className:"text-primary font-medium",children:j})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 line-clamp-1",children:r.email}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",String(r.id).substring(0,8)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",onClick:l=>{l.stopPropagation();const x=o.find(v=>v.label==="Send Message");x&&x.onClick(r)},children:e.jsx(K,{className:"h-4 w-4 text-gray-500"})}),e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",onClick:l=>{l.stopPropagation(),console.log("Share",r)},children:e.jsx(ne,{className:"h-4 w-4 text-gray-500"})}),e.jsxs(Ae,{children:[e.jsx(Fe,{asChild:!0,onClick:l=>l.stopPropagation(),children:e.jsx(N,{variant:"ghost",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",children:e.jsx(ce,{className:"h-4 w-4 text-gray-500"})})}),e.jsx(Ie,{align:"end",className:"w-[160px]",children:o.map((l,x)=>e.jsxs(Ee,{onClick:v=>{v.stopPropagation(),l.onClick(r)},className:"cursor-pointer",children:[e.jsx("span",{className:"mr-2 h-4 w-4 text-gray-500",children:l.icon}),e.jsx("span",{children:l.label})]},x))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:c(r.contact_number)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 line-clamp-1",children:r.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"List"}),r.list_name?e.jsxs(C,{variant:g(r.list_name),className:"capitalize",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),r.list_name]}):e.jsx("span",{className:"text-xs text-gray-500",children:"No list"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),e.jsx(C,{variant:w[i],className:"capitalize",children:m[i]})]})]})]})},r.id)})}),Ue=({onFilterChange:h})=>{const[u,o]=d.useState(!1),[p,c]=d.useState([]),[g,r]=d.useState(null),[j,m]=d.useState(null),w=[{id:"Active",label:"Active"},{id:"Inactive",label:"Inactive"},{id:"New",label:"New"}],i=[{id:"Sales Leads",label:"Sales Leads"},{id:"Existing Customers",label:"Existing Customers"},{id:"Prospects",label:"Prospects"},{id:"Partners",label:"Partners"}],l=()=>{const t={status:g,list:j},y=[];g&&y.push(`Status: ${g}`),j&&y.push(`List: ${j}`),c(y),h(t),o(!1)},x=()=>{r(null),m(null),c([]),h({})},v=t=>{const y=p.filter(A=>A!==t);c(y),t.startsWith("Status:")&&r(null),t.startsWith("List:")&&m(null),h({status:t.startsWith("Status:")?null:g,list:t.startsWith("List:")?null:j})};return e.jsxs("div",{className:"relative",children:[e.jsxs(qe,{open:u,onOpenChange:o,children:[e.jsx(ze,{asChild:!0,children:e.jsxs(N,{variant:"outline",size:"sm",className:`h-9 border-gray-200 text-gray-700 hover:bg-gray-50 ${p.length>0?"border-primary/50 bg-primary/5":""}`,children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Filters",p.length>0&&e.jsx("span",{className:"ml-1 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[10px] font-medium text-white",children:p.length})]})}),e.jsx(Ve,{className:"w-[280px] p-4",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Filter Contacts"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{className:"text-xs font-medium",children:"Status"}),e.jsx(G,{value:g||"",onValueChange:t=>r(t||null),children:w.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{value:t.id,id:`status-${t.id}`}),e.jsx(b,{htmlFor:`status-${t.id}`,className:"text-sm font-normal cursor-pointer",children:t.label})]},t.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{className:"text-xs font-medium",children:"Contact List"}),e.jsx(G,{value:j||"",onValueChange:t=>m(t||null),children:i.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{value:t.id,id:`list-${t.id}`}),e.jsx(b,{htmlFor:`list-${t.id}`,className:"text-sm font-normal cursor-pointer",children:t.label})]},t.id))})]}),e.jsx(_e,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:x,className:"text-xs h-8",children:"Reset"}),e.jsx(N,{size:"sm",onClick:l,className:"text-xs h-8 bg-primary",children:"Apply Filters"})]})]})})]}),p.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:p.map(t=>e.jsxs(C,{variant:"outline",className:"px-2 py-1 text-xs bg-primary/5 border-primary/20 text-primary flex items-center gap-1",children:[t,e.jsx("button",{className:"ml-1 text-primary hover:text-primary/80",onClick:()=>v(t),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},t))})]})},fs=()=>{const[h,u]=Te(),[o,p]=d.useState(h.get("search")||""),[c,g]=d.useState(o),[r,j]=d.useState(h.get("view")==="grid"?"grid":"list"),[m,w]=d.useState({}),[i,l]=d.useState(!1),[x,v]=d.useState(null),[t,y]=d.useState(!1),A=parseInt(h.get("page")||"1");d.useEffect(()=>{const s=setTimeout(()=>{g(o),u(a=>{const n=new URLSearchParams(a);return o?n.set("search",o):n.delete("search"),n})},500);return()=>clearTimeout(s)},[o,u]),d.useEffect(()=>{u(s=>{const a=new URLSearchParams(s);return r==="grid"?a.set("view","grid"):a.delete("view"),a})},[r,u]);const{data:Y,isLoading:M,error:R}=Re({queryKey:["getAllContacts",A,c],queryFn:()=>Le(A,c)});if(M)return e.jsx(pe,{});if(R)return console.error("Error fetching contacts",R),e.jsx("div",{children:"Error loading contacts"});const ee=s=>{p(s)},se=s=>{j(s)},te=s=>{w(s),l(Object.keys(s).some(a=>s[a]!==null))},ae=s=>{v(s),y(!0)},re=()=>{y(!1),v(null)},L=Y.contacts.map(s=>({id:s.contact_id,...s})).filter(s=>{const a=m.status?String(s.id).charCodeAt(0)%3===(m.status==="Active"?0:m.status==="Inactive"?1:2):!0,n=m.list?s.list_name===m.list:!0;return a&&n}),T=(s,a)=>{let n=s,f=a;if(s&&s.includes('"email"'))try{const S=s.match(/"email":\s*"([^"]+)"/),P=s.match(/"phoneNumber":\s*"([^"]+)"/);S&&(n=S[1]),P&&(f=P[1])}catch{const P=s.split(/[,\s]+/),O=P.find(F=>F.includes("@")),W=P.find(F=>/[\d\+\-\(\)]+/.test(F)&&!F.includes("@"));O&&(n=O.replace(/[^a-zA-Z0-9@.\-_]/g,"")),W&&(f=W.replace(/[^0-9\+\-\(\)\s]/g,""))}return{email:n,phone:f}},q=s=>s.split(",")[0].trim().split("@")[0].substring(0,2).toUpperCase(),z=s=>{if(!s)return"";const a=s.replace(/[^\d\+\(\)\-\s]/g,"");return a.startsWith("+")?a.replace(/(\+\d{1,3})(\d{3})(\d{3})(\d{4})/,"$1 $2 $3 $4"):a.replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3")},V=s=>{const a=["purple","info","success","warning","secondary"],n=s.split("").reduce((f,S)=>f+S.charCodeAt(0),0);return a[n%a.length]},_=[{label:"Send Message",icon:e.jsx(K,{className:"h-4 w-4"}),onClick:s=>ae(s)},{label:"Edit Contact",icon:e.jsx(de,{className:"h-4 w-4"}),onClick:s=>console.log("Editing",s)},{label:"Delete Contact",icon:e.jsx(me,{className:"h-4 w-4"}),onClick:s=>console.log("Deleting",s)}];return e.jsxs(ue,{children:[e.jsx(he,{title:"Contact Directory",buttonText:"Contact",filterByName:!0,filterWord:o,onFilterChange:ee,useSheet:!0,sheetContent:e.jsx(We,{}),viewMode:r,onViewModeChange:se,showViewToggle:!0,showFilters:!1}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 gap-3",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(C,{variant:"secondary",className:"px-3 py-1",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[L.length," Contacts"]})]})}),e.jsx(Ue,{onFilterChange:te})]}),i&&e.jsx("div",{className:"mb-4"}),r==="list"?e.jsx(xe,{data:L,isLoading:M,isSelectable:!0,showColumnSelection:!0,onRowClick:s=>console.log("Row clicked",s),columns:[{header:"Contact",accessor:"email",className:"min-w-[250px]",cell:(s,a)=>{const{email:n}=T(String(s),String(a.contact_number||"")),f=q(n);return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Z,{className:"h-9 w-9 bg-gradient-to-br from-primary/20 to-primary/10",children:e.jsx(J,{className:"text-primary font-medium",children:f})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[e.jsx(D,{className:"h-4 w-4 inline mr-2 text-gray-400"}),n]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",String(a.id).substring(0,8)]})]})]})},sortable:!0},{header:"Phone",accessor:"contact_number",className:"min-w-[180px]",cell:(s,a)=>{const{phone:n}=T(String(a.email||""),String(s));return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-700",children:n?z(n):"No phone"})]})}},{header:"List",accessor:"list_name",className:"min-w-[150px]",cell:s=>s?e.jsxs(C,{variant:V(String(s)),className:"capitalize",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),String(s)]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"No list"}),sortable:!0},{header:"Status",accessor:"id",className:"min-w-[120px]",cell:s=>{const a=["Active","Inactive","New"],n=["success","secondary","info"],f=String(s).charCodeAt(0)%3;return e.jsx("div",{className:"flex items-center justify-start",children:e.jsx(C,{variant:n[f],className:"capitalize",children:a[f]})})}}],actions:_,emptyState:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"h-16 w-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Q,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"No contacts found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Get started by adding your first contact"}),e.jsxs("button",{className:"bg-primary px-4 py-2 rounded-md text-white flex items-center justify-center mx-auto",onClick:()=>console.log("Add contact"),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Add Contact"]})]})}):e.jsx(Be,{data:L,onItemClick:s=>console.log("Grid item clicked",s),actions:_,getInitials:q,formatPhoneNumber:z,getListBadgeVariant:V}),e.jsx(ve,{isOpen:t,contact:x,onClose:re})]})};export{fs as default};
//# sourceMappingURL=Contacts-DcyayFT5.js.map
