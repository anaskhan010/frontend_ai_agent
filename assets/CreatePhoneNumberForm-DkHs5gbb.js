import{j as e,aw as b,a5 as h,aU as g}from"./ui-S570Xcny.js";import{r as j}from"./vendor-DG599jyl.js";import{u as U,b as R,c as D}from"./query-Cab5P5bd.js";import{C as M,b as q,c as K,d as O,a as V}from"./card-DMfGhRm1.js";import{B as I}from"./button-BSd9MMPp.js";import{I as d}from"./input-jxB46izN.js";import{L as l}from"./label-C1-UM1F-.js";import{S as N,a as v,b as w,c as y,d as C}from"./select-D0_OqHwT.js";import{u as B,a as $,t}from"./index-Dlzy9K_J.js";import{i as G,c as z}from"./phoneNumberService-B1wjBO9K.js";import{f as J}from"./agentService-BC3vXPZD.js";import{C as Q}from"./CreditGuard-3wMcOQxa.js";const oe=({onSuccess:p,onCancel:P})=>{const{user:o}=B(),{isSuperAdmin:A}=$(),[s,k]=j.useState({provider:"vapi",phoneNumber:"",name:"",assistantId:"",squadId:"",workflowId:"",fallbackDestination:"",serverUrl:"",serverUrlSecret:"",twilioAccountSid:"",twilioAuthToken:"",vonageApiKey:"",vonageApiSecret:"",telnyxApiKey:"",telnyxApiSecret:"",areaCode:"",twilioPhoneNumber:"",twilioLabel:"",smsEnabled:!0}),[i,S]=j.useState("free"),[Y,_]=j.useState(!1),F=U(),{data:f,isLoading:T}=R({queryKey:["assistants","complete",o==null?void 0:o.id],queryFn:()=>J(""),retry:(a,r)=>{var m;return[404,204,402].includes((m=r==null?void 0:r.response)==null?void 0:m.status)?!1:a<1},enabled:!!(o!=null&&o.id)}),x=(f==null?void 0:f.data)||[],u=D({mutationFn:a=>i==="import"?G(a):z(a),onSuccess:()=>{const a=i==="import"?"Twilio phone number imported successfully!":"Phone number created successfully!";t.success(a),F.invalidateQueries({queryKey:["phoneNumbers"]}),p==null||p()},onError:a=>{var c,m;const r=i==="import"?"Failed to import Twilio phone number":"Failed to create phone number";t.error(((m=(c=a.response)==null?void 0:c.data)==null?void 0:m.message)||r)}}),n=(a,r)=>{k(c=>({...c,[a]:r}))},L=()=>{if(!s.provider)return t.error("Please select a provider"),!1;if(s.provider==="vapi"&&i==="free"&&(!s.areaCode||s.areaCode.length!==3))return t.error("Please enter a valid 3-digit area code"),!1;if(i==="import"){if(!s.twilioPhoneNumber)return t.error("Please enter a Twilio phone number"),!1;if(!s.twilioAccountSid)return t.error("Please enter Twilio Account SID"),!1;if(!s.twilioAuthToken)return t.error("Please enter Twilio Auth Token"),!1;if(!s.twilioLabel)return t.error("Please enter a label for the phone number"),!1;if(!/^\+[1-9]\d{1,14}$/.test(s.twilioPhoneNumber))return t.error("Phone number must be in E.164 format (e.g., +14155551234)"),!1}if(s.provider!=="vapi"&&i!=="import"){if(!s.phoneNumber)return t.error("Please enter a phone number"),!1;if(!/^\+[1-9]\d{1,14}$/.test(s.phoneNumber))return t.error("Phone number must be in E.164 format (e.g., +1234567890)"),!1}if(!s.assistantId||s.assistantId==="unassigned")return t.error("Please select an assistant"),!1;if(s.serverUrl)try{new URL(s.serverUrl)}catch{return t.error("Server URL must be a valid URL"),!1}if(s.fallbackDestination)try{JSON.parse(s.fallbackDestination)}catch{return t.error("Fallback destination must be valid JSON"),!1}switch(s.provider){case"vapi":break;case"twilio":if(!s.twilioAccountSid||!s.twilioAuthToken)return t.error("Twilio Account SID and Auth Token are required"),!1;if(!s.twilioAccountSid.startsWith("AC"))return t.error("Twilio Account SID should start with 'AC'"),!1;if(s.twilioAccountSid.length!==34)return t.error("Twilio Account SID should be 34 characters long"),!1;break;case"vonage":if(!s.vonageApiKey||!s.vonageApiSecret)return t.error("Vonage API Key and Secret are required"),!1;break;case"telnyx":if(!s.telnyxApiKey)return t.error("Telnyx API Key is required"),!1;break}return!0},E=a=>{if(a.preventDefault(),!L())return;let r;i==="import"?r={twilioPhoneNumber:s.twilioPhoneNumber,twilioAccountSid:s.twilioAccountSid,twilioAuthToken:s.twilioAuthToken,twilioLabel:s.twilioLabel,assistantId:s.assistantId,smsEnabled:s.smsEnabled}:r={...s},u.mutate(r)};return e.jsx(Q,{requiredCredits:1,feature:"phone number creation",showUpgradeButton:!0,children:e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs(M,{children:[e.jsxs(q,{children:[e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600"}),"Create Phone Number"]}),e.jsx(O,{children:"Get a free AI CRUITMENT phone number."})]}),e.jsx(V,{className:"space-y-5",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"w-52 space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Phone Number Options"}),e.jsx("button",{type:"button",onClick:()=>S("free"),className:`w-full p-2.5 text-left rounded-md border text-xs transition-colors ${i==="free"?"border-[#12a594] bg-[#12a594] text-white":"border-gray-200 bg-white text-gray-700 hover:bg-gray-50"}`,children:"Phone Number (Voice Only)"}),e.jsx("button",{type:"button",onClick:()=>S("import"),className:`w-full p-2.5 text-left rounded-md border text-sm transition-colors ${i==="import"?"border-[#12a594] bg-white text-[#12a594] ring-1 ring-[#12a594]":"border-gray-200 bg-white text-[#12a594] hover:bg-gray-50"}`,children:"Import Twilio (SMS & Voice)"})]}),e.jsx("div",{className:"flex-1 space-y-4",children:i==="free"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Free Vapi Number"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"provider",className:"text-sm font-medium",children:"Provider *"}),e.jsxs(N,{value:s.provider,onValueChange:a=>n("provider",a),children:[e.jsx(v,{children:e.jsx(w,{placeholder:"Select a provider"})}),e.jsx(y,{children:e.jsx(C,{value:"vapi",className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"#12a594"}}),"AI CRUITMENT (Free US Number)"]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(l,{htmlFor:"areaCode",className:"flex items-center gap-2 text-sm font-medium",children:["Area Code *",e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full text-white font-medium",style:{backgroundColor:"#12a594"},children:"Free"})]}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(d,{id:"areaCode",type:"text",placeholder:"000",value:s.areaCode,onChange:a=>{const r=a.target.value.replace(/\D/g,"").slice(0,3);n("areaCode",r),n("phoneNumber",r)},className:"font-mono text-lg text-center border-2 focus:border-[#12a594] focus:ring-[#12a594]",style:{borderColor:s.areaCode?"#12a594":void 0},maxLength:3}),s.areaCode&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("svg",{className:"h-4 w-4",style:{color:"#12a594"},fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("p",{className:"text-xs mt-1",style:{color:"#12a594"},children:"Enter a 3-digit US area code (e.g., 415, 212, 310)"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",className:"text-sm font-medium",children:"Friendly Name"}),e.jsx(d,{id:"name",type:"text",placeholder:"My AI CRUITMENT Number",value:s.name,onChange:a=>n("name",a.target.value),className:"mt-1"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"assistantId",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(h,{className:"h-4 w-4"}),"Assistant *"]}),e.jsxs(N,{value:s.assistantId,onValueChange:a=>n("assistantId",a),children:[e.jsx(v,{children:e.jsx(w,{placeholder:"Select an assistant"})}),e.jsx(y,{children:T?e.jsxs("div",{className:"flex items-center justify-center p-2",children:[e.jsx(g,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading assistants..."})]}):x.length===0?e.jsx("div",{className:"flex items-center justify-center p-2 text-gray-500",children:"No assistants available"}):e.jsx(e.Fragment,{children:x.map(a=>e.jsx(C,{value:a.assistant_id||a.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-3 w-3"}),a.name]})},a.id))})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:A?"Super admin can see all assistants":"You can only see your own assistants"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#12a594]",children:[e.jsx(b,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"AI CRUITMENT Free Phone Number"})]}),e.jsx("div",{className:"border border-[#12a594] rounded-lg p-4 bg-[#fafefd]",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"h-4 w-4 text-[#12a594]",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-[#12a594]",children:"No credentials required!"}),e.jsx("div",{className:"text-sm text-gray-700",children:"AI CRUITMENT provides free US phone numbers instantly. Just enter your desired area code and we'll assign you a random number in that area."}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[e.jsx("div",{children:"• Instant activation (2-3 minutes)"}),e.jsx("div",{children:"• US numbers only"})]})]})]})})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Import Twilio"}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twilioPhoneNumber",className:"text-sm font-medium",children:"Twilio Phone Number"}),e.jsxs("div",{className:"flex mt-1",children:[e.jsx("div",{className:"flex items-center px-3 border border-r-0 border-gray-300 bg-gray-50 rounded-l-md",children:e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"🇺🇸"})}),e.jsx(d,{id:"twilioPhoneNumber",type:"tel",placeholder:"+1415689........",value:s.twilioPhoneNumber,onChange:a=>n("twilioPhoneNumber",a.target.value),className:"rounded-l-none font-mono"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twilioAccountSid",className:"text-sm font-medium",children:"Twilio Account SID"}),e.jsx(d,{id:"twilioAccountSid",type:"text",placeholder:"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",value:s.twilioAccountSid,onChange:a=>n("twilioAccountSid",a.target.value),className:"font-mono text-sm mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twilioAuthToken",className:"text-sm font-medium",children:"Twilio Auth Token"}),e.jsx(d,{id:"twilioAuthToken",type:"password",placeholder:"Your Twilio Auth Token",value:s.twilioAuthToken,onChange:a=>n("twilioAuthToken",a.target.value),className:"font-mono text-sm mt-1"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twilioLabel",className:"text-sm font-medium",children:"Label"}),e.jsx(d,{id:"twilioLabel",type:"text",placeholder:"Label for Phone Number",value:s.twilioLabel,onChange:a=>n("twilioLabel",a.target.value),className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"assistantId",className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(h,{className:"h-4 w-4"}),"Assistant *"]}),e.jsxs(N,{value:s.assistantId,onValueChange:a=>n("assistantId",a),children:[e.jsx(v,{children:e.jsx(w,{placeholder:"Select an assistant"})}),e.jsx(y,{children:T?e.jsxs("div",{className:"flex items-center justify-center p-2",children:[e.jsx(g,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading assistants..."})]}):x.length===0?e.jsx("div",{className:"flex items-center justify-center p-2 text-gray-500",children:"No assistants available"}):e.jsx(e.Fragment,{children:x.map(a=>e.jsx(C,{value:a.assistant_id||a.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-3 w-3"}),a.name]})},a.id))})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:A?"Super admin can see all assistants":"You can only see your own assistants"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"SMS Enabled"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Enable SMS messaging for this phone number"})]}),e.jsx("button",{type:"button",onClick:()=>n("smsEnabled",!s.smsEnabled),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors ${s.smsEnabled?"bg-[#12a594]":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${s.smsEnabled?"translate-x-5":"translate-x-1"}`})})]})]})})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(I,{type:"button",variant:"outline",onClick:P,disabled:u.isPending,children:"Cancel"}),e.jsx(I,{type:"submit",disabled:u.isPending,className:"min-w-[140px]",style:i==="free"?{backgroundColor:"#12a594",borderColor:"#12a594",color:"white"}:{backgroundColor:"#12a594",borderColor:"#12a594",color:"white"},children:u.isPending?e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"h-4 w-4 mr-2 animate-spin"}),i==="import"?"Importing from Twilio...":"Getting Free Number..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),i==="import"?"Import from Twilio":"Get Free Number"]})})]})]})})};export{oe as C};
//# sourceMappingURL=CreatePhoneNumberForm-DkHs5gbb.js.map
