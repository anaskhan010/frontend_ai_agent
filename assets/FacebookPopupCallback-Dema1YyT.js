import{j as e}from"./ui-DHRUPyaA.js";import{r as g}from"./vendor-DG599jyl.js";import{c as j}from"./router-BavLd_S0.js";const N=()=>{const[o]=j(),[c,s]=g.useState("loading"),[a,n]=g.useState("Processing Facebook authentication...");return g.useEffect(()=>{(async()=>{var w,p,u,h;try{console.log("üöÄ FacebookPopupCallback component loaded!"),console.log("üîç Current URL:",window.location.href),console.log("üîç Search params:",window.location.search),console.log("üîç Hash:",window.location.hash),document.title="Facebook OAuth Callback - Processing...";const r=o.get("success"),l=o.get("name"),i=o.get("email"),x=o.get("id"),t=o.get("error");if(console.log("üîç Facebook popup callback parameters:",{success:r,name:l,email:i,id:x,error:t}),console.log("üîç All search params:",Object.fromEntries(o.entries())),r==="true"&&(l||i))if(s("success"),n("Facebook Lead Ads connected successfully!"),console.log("üéâ Facebook OAuth success in popup, notifying parent window"),console.log("üîç Checking parent window...",{hasOpener:!!window.opener,openerClosed:(w=window.opener)==null?void 0:w.closed,origin:window.location.origin}),window.opener&&!window.opener.closed){console.log("üì§ Sending Facebook success message to parent window");const b={type:"facebook_oauth_success",data:{isConnected:!0,facebookUser:{name:decodeURIComponent(l||"Facebook User"),email:decodeURIComponent(i||""),id:decodeURIComponent(x||"facebook_user")}}};console.log("üì§ Message being sent:",b);try{const d=[window.location.origin,"http://localhost:5173","http://localhost:5174","https://ai.research-hero.com","*"];for(const m of d)try{window.opener.postMessage(b,m),console.log(`‚úÖ Message sent successfully to parent window with origin: ${m}`)}catch(f){console.log(`‚ö†Ô∏è Failed to send message with origin ${m}:`,f)}}catch(d){console.error("‚ùå Error sending message to parent:",d)}setTimeout(()=>{console.log("üîí Closing Facebook popup window"),window.close()},1500)}else console.log("‚ö†Ô∏è No parent window found, closing popup"),console.log("üîç Window opener details:",{opener:window.opener,openerClosed:(p=window.opener)==null?void 0:p.closed,openerOrigin:(h=(u=window.opener)==null?void 0:u.location)==null?void 0:h.origin}),setTimeout(()=>{window.close()},2e3);else t?(s("error"),n(`Authentication failed: ${decodeURIComponent(t)}`),window.opener&&!window.opener.closed?(window.opener.postMessage({type:"facebook_oauth_error",message:decodeURIComponent(t)},window.location.origin),setTimeout(()=>{window.close()},3e3)):setTimeout(()=>{window.close()},3e3)):(s("error"),n("Invalid callback parameters"),setTimeout(()=>{window.close()},3e3))}catch{s("error"),n("An unexpected error occurred"),setTimeout(()=>{window.close()},3e3)}})()},[o]),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:[c==="loading"&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{role:"img","aria-label":"Facebook",children:"üìò"})}),e.jsx("div",{className:"text-lg font-semibold text-blue-900",children:"Connecting Facebook..."}),e.jsx("div",{className:"text-sm text-gray-500",children:a})]}),c==="success"&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{role:"img","aria-label":"Success",children:"‚úÖ"})}),e.jsx("div",{className:"text-lg font-semibold text-green-900",children:"Successfully Connected!"}),e.jsx("div",{className:"text-sm text-green-700",children:a}),e.jsx("div",{className:"text-xs text-gray-500",children:"This window will close automatically..."})]}),c==="error"&&e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx("span",{role:"img","aria-label":"Error",children:"‚ùå"})}),e.jsx("div",{className:"text-lg font-semibold text-red-900",children:"Connection Failed"}),e.jsx("div",{className:"text-sm text-red-700",children:a}),e.jsx("div",{className:"text-xs text-gray-500",children:"This window will close automatically..."})]})]})})};export{N as default};
//# sourceMappingURL=FacebookPopupCallback-Dema1YyT.js.map
