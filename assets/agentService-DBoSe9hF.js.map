{"version":3,"file":"agentService-DBoSe9hF.js","sources":["../../src/api/services/agents/agentService.ts"],"sourcesContent":["import axiosInstance from \"@/api/axios/axiosInstance\";\r\nimport { toast } from \"sonner\";\r\nimport { VapiAssistant } from \"@/types/vapi\";\r\n\r\n// Types\r\nexport interface AssistantConfig {\r\n  name: string;\r\n  firstMessage: string;\r\n  transcriber: {\r\n    provider: string;\r\n    model: string;\r\n  };\r\n  model: {\r\n    provider: string;\r\n    model: string;\r\n    temperature?: number;\r\n  };\r\n  voice: {\r\n    provider: string;\r\n    voiceId: string;\r\n  };\r\n  systemMessage?: string;\r\n  functions?: any[];\r\n  endCallMessage?: string;\r\n  endCallPhrases?: string[];\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\nexport interface Assistant {\r\n  id: string;\r\n  assistant_id?: string;\r\n  name: string;\r\n  firstMessage: string;\r\n  transcriber: any;\r\n  model: any;\r\n  voice: any;\r\n  systemMessage?: string;\r\n  functions?: any[];\r\n  endCallMessage?: string;\r\n  endCallPhrases?: string[];\r\n  metadata?: Record<string, any>;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n// Get all assistants with pagination\r\nexport async function fetchAllAgents(page: number, search: string) {\r\n  try {\r\n    const res = await axiosInstance.get(\"/api/assistant/get_all_assistants\", {\r\n      params: { page, search },\r\n    });\r\n    return res.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching agents:\", error);\r\n    toast.error(\"Failed to fetch agents\");\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Get all assistants without pagination (fetch all pages)\r\nexport async function fetchAllAgentsComplete(search: string = \"\") {\r\n  try {\r\n    let allAssistants: Assistant[] = [];\r\n    let currentPage = 1;\r\n    let totalPages = 1;\r\n\r\n    do {\r\n      const res = await axiosInstance.get(\"/api/assistant/get_all_assistants\", {\r\n        params: { page: currentPage, search, limit: 50 }, // Increase limit for efficiency\r\n      });\r\n\r\n      const { data, totalPages: total } = res.data;\r\n      allAssistants = [...allAssistants, ...data];\r\n      totalPages = total;\r\n      currentPage++;\r\n    } while (currentPage <= totalPages);\r\n\r\n    return { data: allAssistants, total: allAssistants.length };\r\n  } catch (error) {\r\n    console.error(\"Error fetching all agents:\", error);\r\n    toast.error(\"Failed to fetch all agents\");\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Get all assistants from VAPI directly\r\nexport async function fetchAllAgentsFromVapi() {\r\n  try {\r\n    const res = await axiosInstance.get(\"/api/assistant/list-all-assistants-from-vapi\");\r\n    return res.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching agents from VAPI:\", error);\r\n    toast.error(\"Failed to fetch agents from VAPI\");\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Get assistants that exist in both local DB and VAPI (fully synced)\r\nexport async function fetchSyncedAgents(page: number = 1, search: string = \"\") {\r\n  try {\r\n    const res = await axiosInstance.get(\"/api/assistant/get-synced-assistants\", {\r\n      params: { page, search, limit: 50 },\r\n    });\r\n    return res.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching synced agents:\", error);\r\n    toast.error(\"Failed to fetch synced agents\");\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Get all synced assistants without pagination (fetch all pages)\r\nexport async function fetchAllSyncedAgents(search: string = \"\") {\r\n  try {\r\n    let allAssistants: Assistant[] = [];\r\n    let currentPage = 1;\r\n    let totalPages = 1;\r\n\r\n    do {\r\n      const res = await axiosInstance.get(\"/api/assistant/get-synced-assistants\", {\r\n        params: { page: currentPage, search, limit: 50 },\r\n      });\r\n\r\n      const { data, totalPages: total } = res.data;\r\n      allAssistants = [...allAssistants, ...data];\r\n      totalPages = total;\r\n      currentPage++;\r\n    } while (currentPage <= totalPages);\r\n\r\n    return { data: allAssistants, total: allAssistants.length };\r\n  } catch (error) {\r\n    console.error(\"Error fetching all synced agents:\", error);\r\n    toast.error(\"Failed to fetch all synced agents\");\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Get assistant by ID\r\nexport async function getAssistantById(id: string) {\r\n  try {\r\n    const res = await axiosInstance.get(`/api/assistant/get-assistants/${id}`);\r\n    return res.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching assistant:\", error);\r\n    toast.error(\"Failed to fetch assistant\");\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Get complete assistant details from VAPI directly\r\nexport async function getVapiAssistantById(id: string) {\r\n  try {\r\n    const res = await axiosInstance.get(`/api/assistant/get-assistants/${id}`);\r\n    return res.data;\r\n  } catch (error) {\r\n    console.error(\"Error fetching VAPI assistant:\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Create new assistant\r\nexport async function createAssistant(data: VapiAssistant) {\r\n  try {\r\n    const res = await axiosInstance.post(\"/api/assistant/create_assistant\", data);\r\n    toast.success(\"Assistant created successfully\");\r\n    return res.data;\r\n  } catch (error: any) {\r\n    console.error(\"Error creating assistant:\", error);\r\n    const message = error.response?.data?.message || \"Failed to create assistant\";\r\n    toast.error(message);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Update assistant\r\nexport async function updateAssistant(id: string, data: Partial<VapiAssistant>) {\r\n  try {\r\n    const res = await axiosInstance.put(`/api/assistant/update-assistant/${id}`, data);\r\n    return res.data;\r\n  } catch (error: any) {\r\n    console.error(\"Error updating assistant:\", error);\r\n    const message = error.response?.data?.message || \"Failed to update assistant\";\r\n    toast.error(message);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// Delete assistant\r\nexport async function deleteAssistant(id: string) {\r\n  try {\r\n    console.log('üóëÔ∏è Deleting assistant with ID:', id);\r\n    const res = await axiosInstance.delete(`/api/assistant/delete-assistant/${id}`);\r\n    toast.success(\"Assistant deleted successfully\");\r\n    return res.data;\r\n  } catch (error: any) {\r\n    console.error(\"Error deleting assistant:\", error);\r\n    const message = error.response?.data?.message || \"Failed to delete assistant\";\r\n    toast.error(message);\r\n    throw error;\r\n  }\r\n}\r\n"],"names":["fetchAllAgents","page","search","axiosInstance","error","toast","fetchAllAgentsComplete","allAssistants","currentPage","totalPages","res","data","total","fetchAllAgentsFromVapi","fetchAllSyncedAgents","getAssistantById","id","getVapiAssistantById","createAssistant","message","_b","_a","updateAssistant","deleteAssistant"],"mappings":"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"}