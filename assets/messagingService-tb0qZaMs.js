import{d as g,t as c}from"./index-C95eVPAi.js";async function u(t){var s,a,o,e,n;try{console.log("üì± Sending SMS to contact:",t);const r=await g.post(`/api/contact-messages/contacts/${t.contactId}/messages`,{content:t.message,fromPhoneNumber:t.fromPhoneNumber});if(r.data.success)return c.success("Message sent successfully"),{success:!0,messageId:(s=r.data.data)==null?void 0:s.messageId,twilioSid:(a=r.data.data)==null?void 0:a.twilioSid,status:(o=r.data.data)==null?void 0:o.status};throw new Error(r.data.message||"Failed to send message")}catch(r){console.error("Error sending SMS:",r);const i=((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.message)||r.message||"Failed to send message";return c.error(i),{success:!1,error:i}}}async function m(t,s=1,a=50){var o,e;try{const n=await g.get(`/api/contact-messages/contacts/${t}/messages`,{params:{page:s,limit:a}});return{success:!0,messages:n.data.messages||[],totalCount:n.data.totalCount||0,page:n.data.page||1,totalPages:n.data.totalPages||1}}catch(n){console.error("Error fetching contact messages:",n);const r=((e=(o=n.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to fetch messages";return c.error(r),{success:!1,messages:[],totalCount:0,page:1,totalPages:1}}}async function d(t,s){var a;try{console.log(`üîç Checking new incoming messages for contact ${t}, after message ${s}`);const o={};s&&(o.lastMessageId=s);const e=await g.get(`/api/contact-messages/contacts/${t}/new-messages`,{params:o});return{success:!0,messages:e.data.data||[],hasNewMessages:e.data.hasNewMessages||!1,totalCount:((a=e.data.data)==null?void 0:a.length)||0,page:1,totalPages:1}}catch(o){return console.error("Error checking new incoming messages:",o),{success:!1,messages:[],hasNewMessages:!1,totalCount:0,page:1,totalPages:1}}}async function f(t=1,s=20){var a,o;try{const e=await g.get("/api/contact-messages/conversations",{params:{page:t,limit:s}});return{success:!0,conversations:e.data.conversations||[],totalCount:e.data.totalCount||0,page:e.data.page||1,totalPages:e.data.totalPages||1}}catch(e){console.error("Error fetching conversations:",e);const n=((o=(a=e.response)==null?void 0:a.data)==null?void 0:o.message)||"Failed to fetch conversations";return c.error(n),{success:!1,conversations:[],totalCount:0,page:1,totalPages:1}}}function h(t){const s=t.replace(/[^\d+]/g,"");return s.startsWith("+")?s:s.length===10?`+1${s}`:s.length===11&&s.startsWith("1")?`+${s}`:s.startsWith("+")?s:`+${s}`}function p(t){const s=t.replace(/[^\d]/g,"");if(s.length===10)return`(${s.slice(0,3)}) ${s.slice(3,6)}-${s.slice(6)}`;if(s.length===11&&s.startsWith("1")){const a=s.slice(1);return`+1 (${a.slice(0,3)}) ${a.slice(3,6)}-${a.slice(6)}`}return t}export{m as a,h as b,d as c,p as f,f as g,u as s};
//# sourceMappingURL=messagingService-tb0qZaMs.js.map
