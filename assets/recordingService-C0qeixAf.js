import{j as e,bX as _,bW as $,d as H,Q as J,bC as Y,cg as Z,ch as ee,cd as re,ay as se}from"./ui-CZ40mCLE.js";import{r as h}from"./vendor-DG599jyl.js";import{B as w,w as I,D as ae,j as te,k as ne,l as U,a as p,t as d}from"./index-DJRsvhPR.js";import{S as O}from"./slider-6rFcEnhq.js";const le=({src:a,title:c="Audio Recording",duration:t="00:00",className:r,onPlay:s,onPause:i,onDownload:l,onShare:C,showControls:y=!0,autoPlay:B=!1,compact:V=!1})=>{const n=h.useRef(null),[j,f]=h.useState(!1),[v,N]=h.useState(0),[u,D]=h.useState(0),[R,z]=h.useState(1),[k,S]=h.useState(!1),[b,T]=h.useState(!1),E=o=>{const m=Math.floor(o/60),g=Math.floor(o%60);return`${m.toString().padStart(2,"0")}:${g.toString().padStart(2,"0")}`},A=async()=>{if(n.current)try{j?(n.current.pause(),f(!1),i==null||i()):(T(!0),await n.current.play(),f(!0),s==null||s())}catch(o){console.error("Error playing audio:",o),f(!1)}finally{T(!1)}},M=()=>{n.current&&N(n.current.currentTime)},P=o=>{console.error("Audio playback error:",o);const g=o.target.error;if(T(!1),f(!1),a&&!a.includes("/api/recordings/")&&!a.includes("/stream")){let x="Failed to load audio";if(g)switch(g.code){case g.MEDIA_ERR_ABORTED:x="Audio playback was aborted";break;case g.MEDIA_ERR_NETWORK:x="Network error while loading audio";break;case g.MEDIA_ERR_DECODE:x="Audio format not supported";break;case g.MEDIA_ERR_SRC_NOT_SUPPORTED:x="Audio source not supported or not found";break;default:x="Unknown error loading audio"}console.warn(x)}},L=()=>{n.current&&D(n.current.duration)},W=o=>{if(n.current){const m=o[0]/100*u;n.current.currentTime=m,N(m)}},X=o=>{const m=o[0]/100;z(m),n.current&&(n.current.volume=m),S(m===0)},K=()=>{n.current&&(k?(n.current.volume=R,S(!1)):(n.current.volume=0,S(!0)))},Q=()=>{n.current&&(n.current.currentTime=Math.min(n.current.currentTime+10,u))},q=()=>{n.current&&(n.current.currentTime=Math.max(n.current.currentTime-10,0))},F=()=>{f(!1),N(0)};h.useEffect(()=>{const o=n.current;if(o)return o.addEventListener("timeupdate",M),o.addEventListener("loadedmetadata",L),o.addEventListener("ended",F),()=>{o.removeEventListener("timeupdate",M),o.removeEventListener("loadedmetadata",L),o.removeEventListener("ended",F)}},[]);const G=u>0?v/u*100:0;return V?e.jsxs("div",{className:I("flex items-center space-x-2",r),children:[e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-primary/10",onClick:A,disabled:!a||b,children:b?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"}):j?e.jsx(_,{className:"h-4 w-4 text-primary"}):e.jsx($,{className:"h-4 w-4 text-primary"})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[E(v)," / ",u>0?E(u):t]}),a&&e.jsx("audio",{ref:n,src:a,preload:"metadata"})]}):e.jsxs("div",{className:I("bg-card border rounded-lg p-4 space-y-4",r),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-foreground truncate",children:c}),y&&e.jsxs(ae,{children:[e.jsx(te,{asChild:!0,children:e.jsx(w,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(H,{className:"h-4 w-4"})})}),e.jsxs(ne,{align:"end",children:[e.jsxs(U,{onClick:l,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Download"]}),e.jsxs(U,{onClick:C,children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Share"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{value:[G],onValueChange:W,max:100,step:.1,className:"w-full",disabled:!a||u===0}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:E(v)}),e.jsx("span",{children:u>0?E(u):t})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:q,disabled:!a||!j,children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx(w,{variant:"ghost",size:"lg",onClick:A,disabled:!a||b,className:"h-10 w-10 rounded-full bg-primary/10 hover:bg-primary/20",children:b?e.jsx("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-primary border-t-transparent"}):j?e.jsx(_,{className:"h-5 w-5 text-primary"}):e.jsx($,{className:"h-5 w-5 text-primary"})}),e.jsx(w,{variant:"ghost",size:"sm",onClick:Q,disabled:!a||!j,children:e.jsx(ee,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:K,disabled:!a,children:k||R===0?e.jsx(re,{className:"h-4 w-4"}):e.jsx(se,{className:"h-4 w-4"})}),e.jsx(O,{value:[k?0:R*100],onValueChange:X,max:100,step:1,className:"w-20",disabled:!a})]})]}),a&&e.jsx("audio",{ref:n,src:a,preload:"metadata",autoPlay:B,onTimeUpdate:M,onLoadedMetadata:()=>{var o;return D(((o=n.current)==null?void 0:o.duration)||0)},onEnded:()=>f(!1),onError:P}),!a&&e.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:[e.jsx("p",{className:"text-sm",children:"No audio source available"}),e.jsx("p",{className:"text-xs",children:"Upload or select a recording to play"})]})]})};async function ue(a=1,c=10,t={}){var r,s;try{const i=new URLSearchParams({page:a.toString(),limit:c.toString(),...Object.fromEntries(Object.entries(t).filter(([C,y])=>y!==void 0&&y!==""))});return(await p.get(`/api/recordings?${i.toString()}`)).data.data}catch(i){console.error("Error fetching recordings:",i);const l=((s=(r=i.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to fetch recordings";throw d.error(l),i}}async function me(a){var c,t;try{return(await p.get(`/api/recordings/${a}`)).data.data}catch(r){console.error("Error fetching recording:",r);const s=((t=(c=r.response)==null?void 0:c.data)==null?void 0:t.message)||"Failed to fetch recording";throw d.error(s),r}}async function ge(a){var c,t;try{await p.delete(`/api/recordings/${a}`),d.success("Recording deleted successfully")}catch(r){console.error("Error deleting recording:",r);const s=((t=(c=r.response)==null?void 0:c.data)==null?void 0:t.message)||"Failed to delete recording";throw d.error(s),r}}async function he(a,c){var t,r;try{const s=await p.get(`/api/recordings/${a}/download`,{responseType:"blob"}),i=window.URL.createObjectURL(new Blob([s.data])),l=document.createElement("a");return l.href=i,l.setAttribute("download",c||`recording-${a}.mp3`),document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(i),d.success("Recording downloaded successfully"),s.data}catch(s){console.error("Error downloading recording:",s);const i=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to download recording";throw d.error(i),s}}async function pe(a){var c,t;try{return(await p.get(`/api/recordings/${a}/transcript`)).data.data}catch(r){console.error("Error fetching transcript:",r);const s=((t=(c=r.response)==null?void 0:c.data)==null?void 0:t.message)||"Failed to fetch transcript";throw d.error(s),r}}async function fe(a,c){var t,r;try{const s=await p.patch(`/api/recordings/${a}/transcript`,{transcript:c});return d.success("Transcript updated successfully"),s.data.data}catch(s){console.error("Error updating transcript:",s);const i=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to update transcript";throw d.error(i),s}}async function xe(a){var c,t;try{return(await p.get(`/api/recordings/${a}/analytics`)).data.data}catch(r){console.error("Error fetching recording analytics:",r);const s=((t=(c=r.response)==null?void 0:c.data)==null?void 0:t.message)||"Failed to fetch analytics";throw d.error(s),r}}async function we(a,c){var t,r;try{const s=await p.post(`/api/recordings/${a}/share`,c);return d.success("Recording shared successfully"),s.data.data}catch(s){console.error("Error sharing recording:",s);const i=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to share recording";throw d.error(i),s}}export{le as A,he as a,me as b,xe as c,ge as d,pe as e,ue as g,we as s,fe as u};
//# sourceMappingURL=recordingService-C0qeixAf.js.map
