import{j as e,bI as v,K as z,aI as S,ar as o,X as ce,V as de,aS as xe,bz as K,I as me,N as oe,ax as he,aC as je,aq as pe,M as ue,F as ge}from"./ui-Bw4PqZaR.js";import{r as i}from"./vendor-DG599jyl.js";import{t as n,q as M,z as O,B as t,r as B,s as Q,v as $,L as d,S as P,f as C,g as F,h as E,i as q,T as Ne,x as ye,I as A,C as a,c as r,d as c,b as l,n as L}from"./index-CrtuxIoh.js";import{u as fe,b as h,c as we}from"./query-ejyxdTEH.js";import{a as be,g as ve,b as Se,e as Pe}from"./studyParticipantService-DaHixkWd.js";import{a as Ce}from"./clinicalStudyService-5JVxEFZj.js";import"./router-BnJytTjr.js";const Me=()=>{const[Fe,Ee]=i.useState(""),[H,m]=i.useState(!1),[R,j]=i.useState(!1),[T,p]=i.useState(""),[k,u]=i.useState(""),[U,W]=i.useState(!1),[X,G]=i.useState(!1),[qe,I]=i.useState(null),V=fe(),{data:g,isLoading:J,error:Y}=h({queryKey:["studyParticipants"],queryFn:be,retry:1}),{data:N,isLoading:Ae}=h({queryKey:["studyParticipantStats"],queryFn:ve,retry:1}),{data:y,isLoading:Le}=h({queryKey:["availablePatients"],queryFn:Se,retry:1}),{data:f,isLoading:Te}=h({queryKey:["clinicalStudies"],queryFn:Ce,retry:1}),_=(g==null?void 0:g.data)||[],x=(N==null?void 0:N.data)||{total:0,screening:0,enrolled:0,completed:0,withdrawn:0,screenFailed:0},Z=(y==null?void 0:y.data)||[],w=(f==null?void 0:f.data)||[];we({mutationFn:Pe,onSuccess:()=>{n.success("Patient enrolled successfully"),V.invalidateQueries({queryKey:["studyParticipants"]}),V.invalidateQueries({queryKey:["studyParticipantStats"]}),m(!1),p(""),u("")},onError:s=>{var b,D;n.error(((D=(b=s.response)==null?void 0:b.data)==null?void 0:D.message)||"Failed to enroll patient")}});const ee=s=>{n.info(`Viewing participants for study: ${s.name}`)},se=()=>{G(!X)},te=()=>{W(!U)},ae=s=>{I(s),n.info(`Viewing details for participant: ${s.patient_name}`)},le=s=>{I(s),n.info(`Editing participant: ${s.patient_name}`)},ie=()=>{if(!T||!k){n.error("Please select both study and patient");return}n.success("Patient enrolled successfully"),m(!1),p(""),u("")},ne=()=>{n.success("New patient added successfully"),j(!1)},re=s=>({screening:"bg-yellow-100 text-yellow-800",enrolled:"bg-green-100 text-green-800",completed:"bg-blue-100 text-blue-800",withdrawn:"bg-red-100 text-red-800",screen_failed:"bg-gray-100 text-gray-800"})[s]||"bg-gray-100 text-gray-800";return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Study Participants"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage participant enrollment and study assignments"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(M,{open:H,onOpenChange:m,children:[e.jsx(O,{asChild:!0,children:e.jsxs(t,{variant:"outline",children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Enroll from Patients"]})}),e.jsxs(B,{className:"max-w-md",children:[e.jsx(Q,{children:e.jsx($,{children:"Enroll Patient in Study"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"patient",children:"Select Patient"}),e.jsxs(P,{value:k,onValueChange:u,children:[e.jsx(C,{children:e.jsx(F,{placeholder:"Choose patient"})}),e.jsx(E,{children:Z.map(s=>e.jsxs(q,{value:s.id.toString(),children:[s.name," - ",s.status]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"study",children:"Select Study"}),e.jsxs(P,{value:T,onValueChange:p,children:[e.jsx(C,{children:e.jsx(F,{placeholder:"Choose study"})}),e.jsx(E,{children:w.map(s=>e.jsxs(q,{value:s.id.toString(),children:[s.name," (",s.code,")"]},s.id))})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"notes",children:"Enrollment Notes"}),e.jsx(Ne,{id:"notes",placeholder:"Enter any notes about enrollment",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(t,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(t,{onClick:ie,children:"Enroll Patient"})]})]})]})]}),e.jsxs(M,{open:R,onOpenChange:j,children:[e.jsx(O,{asChild:!0,children:e.jsxs(t,{children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Add New Patient"]})}),e.jsxs(B,{className:"max-w-md","aria-describedby":"patient-form-description",children:[e.jsxs(Q,{children:[e.jsx($,{children:"Add New Patient"}),e.jsx(ye,{id:"patient-form-description",children:"Fill out the form below to add a new patient to the study. All required fields must be completed."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"patientName",children:"Full Name"}),e.jsx(A,{id:"patientName",placeholder:"Enter patient name"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"patientEmail",children:"Email"}),e.jsx(A,{id:"patientEmail",type:"email",placeholder:"patient@email.com"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"patientPhone",children:"Phone"}),e.jsx(A,{id:"patientPhone",placeholder:"+1-555-0123"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"patientStudy",children:"Assign to Study"}),e.jsxs(P,{children:[e.jsx(C,{children:e.jsx(F,{placeholder:"Choose study (optional)"})}),e.jsx(E,{children:w.map(s=>e.jsx(q,{value:s.id.toString(),children:s.name},s.id))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(t,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(t,{onClick:ne,children:"Add Patient"})]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total"}),e.jsx(S,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(l,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.total})})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Screening"}),e.jsx(o,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx(l,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.screening})})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Enrolled"}),e.jsx(S,{className:"h-4 w-4 text-green-500"})]}),e.jsx(l,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.enrolled})})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Completed"}),e.jsx(o,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(l,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.completed})})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Withdrawn"}),e.jsx(o,{className:"h-4 w-4 text-red-500"})]}),e.jsx(l,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.withdrawn})})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Screen Failed"}),e.jsx(o,{className:"h-4 w-4 text-gray-500"})]}),e.jsx(l,{children:e.jsx("div",{className:"text-2xl font-bold",children:x.screenFailed})})]})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(c,{children:"Enrollment by Study"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:w.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Study Code: ",s.code]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:[s.participants,"/",s.target]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Participants"})]}),e.jsxs("div",{className:"w-32",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(s.participants/s.target*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${s.participants/s.target*100}%`}})})]}),e.jsx(L,{className:s.status==="Recruiting"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800",children:s.status}),e.jsx(t,{variant:"outline",size:"sm",onClick:()=>ee(s),children:"View Participants"})]})]},s.id))})})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(c,{children:"All Participants"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(t,{variant:"outline",size:"sm",onClick:se,children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Search"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:te,children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Filter"]})]})]})}),e.jsx(l,{children:J?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(xe,{className:"h-8 w-8 animate-spin text-gray-400"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading participants..."})]}):Y?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(K,{className:"h-12 w-12 text-red-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Participants"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Failed to load study participants. Please try again."})]}):_.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Participants Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No study participants have been enrolled yet."}),e.jsxs(t,{onClick:()=>m(!0),children:[e.jsx(v,{className:"h-4 w-4 mr-2"}),"Enroll First Participant"]})]}):e.jsx("div",{className:"space-y-4",children:_.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.patient_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Participant ID: ",s.participant_id]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:re(s.enrollment_status),children:s.enrollment_status}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>ae(s),children:[e.jsx(me,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsxs(t,{variant:"outline",size:"sm",onClick:()=>le(s),children:[e.jsx(oe,{className:"h-4 w-4 mr-1"}),"Edit"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(he,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.patient_email})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(je,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Phone"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.patient_phone})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(pe,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Enrolled"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.enrollment_date})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(ue,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Site"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.site})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Study Information:"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(L,{variant:"outline",children:s.study_code}),e.jsx("span",{className:"text-sm text-gray-600",children:s.study}),e.jsxs("span",{className:"text-sm text-gray-500",children:["PI: ",s.pi]})]})]}),s.notes&&e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Notes:"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.notes})]})]},s.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsxs(l,{className:"p-6 text-center",children:[e.jsx(v,{className:"h-8 w-8 text-blue-600 mx-auto mb-3"}),e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Enroll from Patients"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Select qualified patients from your database and enroll them in studies"})]})}),e.jsx(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsxs(l,{className:"p-6 text-center",children:[e.jsx(z,{className:"h-8 w-8 text-green-600 mx-auto mb-3"}),e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Add New Participant"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manually add a new participant and assign them to a study"})]})}),e.jsx(a,{className:"cursor-pointer hover:shadow-md transition-shadow",children:e.jsxs(l,{className:"p-6 text-center",children:[e.jsx(ge,{className:"h-8 w-8 text-purple-600 mx-auto mb-3"}),e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Import Participants"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Bulk import participants from CSV or Excel files"})]})})]}),e.jsx(a,{className:"border-yellow-200 bg-yellow-50",children:e.jsxs(l,{className:"flex items-center space-x-3 pt-6",children:[e.jsx(K,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-yellow-800",children:"Study Participants System"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"This is a preview of the Study Participants management system. Full functionality including participant enrollment, study assignment, status tracking, and integration with the patient database will be implemented in the next phase."})]})]})})]})};export{Me as default};
//# sourceMappingURL=StudyParticipants-D9L0VJzs.js.map
