{"version":3,"file":"GmailPopupCallback-uG7GJyHf.js","sources":["../../src/pages/auth/GmailPopupCallback.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { CheckCircle, AlertCircle, Loader2, Mail } from 'lucide-react';\nimport { toast } from 'sonner';\n\nconst GmailPopupCallback: React.FC = () => {\n  const [searchParams] = useSearchParams();\n  const [status, setStatus] = useState<'loading' | 'success' | 'error'>('loading');\n  const [message, setMessage] = useState('Processing Gmail authentication...');\n\n  useEffect(() => {\n    const handleCallback = async () => {\n      try {\n        const success = searchParams.get('success');\n        const email = searchParams.get('email');\n        const error = searchParams.get('error');\n\n        if (success === 'true' && email) {\n          setStatus('success');\n          setMessage('Gmail account connected successfully!');\n\n          console.log('🎉 Gmail OAuth success in popup, notifying parent window');\n\n          // Notify parent window of success\n          if (window.opener && !window.opener.closed) {\n            console.log('📤 Sending success message to parent window');\n            window.opener.postMessage({\n              type: 'GMAIL_AUTH_SUCCESS',\n              data: {\n                email: decodeURIComponent(email),\n                isConnected: true\n              }\n            }, window.location.origin);\n\n            // Close popup after a short delay to allow parent to process\n            setTimeout(() => {\n              console.log('🔒 Closing popup window');\n              window.close();\n            }, 1500);\n          } else {\n            console.log('⚠️ No parent window found, closing popup');\n            // If no opener, try to close anyway\n            setTimeout(() => {\n              window.close();\n            }, 2000);\n          }\n        } else if (error) {\n          setStatus('error');\n          setMessage(`Authentication failed: ${decodeURIComponent(error)}`);\n          \n          // Notify parent window of error\n          if (window.opener && !window.opener.closed) {\n            window.opener.postMessage({\n              type: 'GMAIL_AUTH_ERROR',\n              message: decodeURIComponent(error)\n            }, window.location.origin);\n            \n            // Close popup after a short delay\n            setTimeout(() => {\n              window.close();\n            }, 3000);\n          } else {\n            // If no opener, try to close anyway\n            setTimeout(() => {\n              window.close();\n            }, 3000);\n          }\n        } else {\n          setStatus('error');\n          setMessage('Invalid callback parameters');\n          \n          // Close popup after error\n          setTimeout(() => {\n            window.close();\n          }, 3000);\n        }\n      } catch (error) {\n        console.error('Error handling Gmail popup callback:', error);\n        setStatus('error');\n        setMessage('An unexpected error occurred');\n        \n        // Close popup after error\n        setTimeout(() => {\n          window.close();\n        }, 3000);\n      }\n    };\n\n    handleCallback();\n  }, [searchParams]);\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full bg-white rounded-lg shadow-lg p-6\">\n        {status === 'loading' && (\n          <div className=\"text-center space-y-4\">\n            <div className=\"flex justify-center\">\n              <div className=\"relative\">\n                <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center\">\n                  <Mail className=\"h-8 w-8 text-blue-600\" />\n                </div>\n                <div className=\"absolute -top-1 -right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center\">\n                  <Loader2 className=\"h-3 w-3 text-white animate-spin\" />\n                </div>\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">\n                Processing Authentication\n              </h3>\n              <p className=\"text-sm text-gray-600\">\n                {message}\n              </p>\n            </div>\n          </div>\n        )}\n\n        {status === 'success' && (\n          <div className=\"text-center space-y-4\">\n            <div className=\"flex justify-center\">\n              <CheckCircle className=\"h-16 w-16 text-green-600\" />\n            </div>\n            <div className=\"space-y-2\">\n              <h3 className=\"text-lg font-semibold text-green-900\">\n                Successfully Connected!\n              </h3>\n              <p className=\"text-sm text-green-700\">\n                {message}\n              </p>\n              <p className=\"text-xs text-gray-500\">\n                This window will close automatically...\n              </p>\n            </div>\n          </div>\n        )}\n\n        {status === 'error' && (\n          <div className=\"text-center space-y-4\">\n            <div className=\"flex justify-center\">\n              <AlertCircle className=\"h-16 w-16 text-red-600\" />\n            </div>\n            <div className=\"space-y-2\">\n              <h3 className=\"text-lg font-semibold text-red-900\">\n                Connection Failed\n              </h3>\n              <p className=\"text-sm text-red-700\">\n                {message}\n              </p>\n              <p className=\"text-xs text-gray-500\">\n                This window will close automatically...\n              </p>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default GmailPopupCallback;\n"],"names":["GmailPopupCallback","searchParams","useSearchParams","status","setStatus","useState","message","setMessage","useEffect","success","email","error","jsxs","jsx","Mail","Loader2","CheckCircle","AlertCircle"],"mappings":"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"}