import{j as e,b5 as K,as as $,aw as M,aj as T,aB as k,F as ce,U as G,ar as Z,a$ as ie,b as le,b1 as ne,D as oe,H as me,b2 as de}from"./ui-S570Xcny.js";import{r as o}from"./vendor-DG599jyl.js";import{M as xe}from"./ModernTable-CXVr2xJv.js";import{H as he}from"./Header-BSPv7FNt.js";import{P as ue}from"./Page-BJWqKr2O.js";import{L as pe}from"./Loading-DqfgU-VE.js";import{u as je}from"./resolvers-BzctgYTE.js";import{o as ge,c as fe,a as I}from"./index.esm-C7RSptL2.js";import{B as b}from"./button-BSd9MMPp.js";import{I as D}from"./input-jxB46izN.js";import{L as N}from"./label-C1-UM1F-.js";import{T as Ne}from"./textarea-Cw4zrZDH.js";import{S as be,a as ve,b as ye}from"./sheet-C7DsuPAk.js";import{S as we,a as Ce,b as Se,c as Pe,d as E}from"./select-D0_OqHwT.js";import{b as ke}from"./query-Cab5P5bd.js";import{g as Fe}from"./contactService-DhoIrjN3.js";import{c as Ae}from"./router-BavLd_S0.js";import{B as C}from"./badge-ij7fArnn.js";import{A as J,a as X}from"./avatar-Cwu0Oo_-.js";import{C as Ie}from"./card-DMfGhRm1.js";import{D as Ee,a as Le,b as De,e as $e}from"./dropdown-menu-Bxst4dXB.js";import{P as Me,a as Te,b as Re}from"./popover-51UZHq0a.js";import{R as H,a as Q}from"./radio-group-DT_qJUyQ.js";import{S as ze}from"./separator-Wr5jI2gW.js";import{C as Ve}from"./ChatSidebar-DrEG2QfA.js";import"./table-Beiyegzh.js";import"./scroll-area-C-pzVjaj.js";import"./index-BHBJ6RT-.js";import"./index-CWMUKvWL.js";import"./index-HDeFwIcs.js";import"./index-Dlzy9K_J.js";import"./dialog-Cc2g-8Kh.js";import"./messagingService-BXpzguzD.js";import"./phoneNumberService-B1wjBO9K.js";import"./CreatePhoneNumberForm-DkHs5gbb.js";import"./agentService-BC3vXPZD.js";import"./CreditGuard-3wMcOQxa.js";const qe=fe().shape({name:I().required("Name is required").min(2,"Name must be at least 2 characters"),email:I().required("Email is required").email("Email is invalid"),contactNumber:I().required("Contact Number is required").matches(/^\+?[1-9]\d{1,14}$/,"Contact Number must include country code and be valid"),description:I().optional().max(500,"Description cannot exceed 500 characters")});function Be(){const h=o.useRef(null),{register:m,handleSubmit:n,formState:{errors:i,isSubmitting:u},reset:p}=je({resolver:ge(qe)}),r=async x=>{try{console.log("Form Data:",x),p(),alert("Contact added successfully!")}catch(g){console.error("Error submitting form:",g),alert("Failed to add contact. Please try again.")}},j=()=>{var x;(x=h.current)==null||x.click()},d=x=>{var l;const g=(l=x.target.files)==null?void 0:l[0];g&&(console.log("Importing file:",g.name),x.target.value="")};return e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"text-xl font-semibold jakarta bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-1",children:"Add New Contact"}),e.jsx(ve,{className:"text-muted-foreground mb-6",children:"Add a new contact to your directory for voice AI agents to reach out to."}),e.jsxs("form",{onSubmit:n(r),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(K,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Contact Information"})]}),e.jsxs("div",{children:[e.jsxs(N,{htmlFor:"name",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Name",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"name",placeholder:"Enter contact name",className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...m("name")}),i.name&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.name.message})]}),e.jsxs("div",{children:[e.jsxs(N,{htmlFor:"email",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{id:"email",type:"email",placeholder:"Enter contact email",className:"w-full pl-10 border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...m("email")})]}),i.email&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.email.message})]}),e.jsxs("div",{children:[e.jsxs(N,{htmlFor:"contactNumber",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Contact Number",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{id:"contactNumber",type:"tel",placeholder:"Enter contact number with country code (e.g., +1234567890)",className:"w-full pl-10 border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...m("contactNumber")})]}),i.contactNumber&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.contactNumber.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(T,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Additional Information"})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"list",className:"text-sm font-medium text-foreground mb-1.5 block",children:"Contact List"}),e.jsxs(we,{children:[e.jsx(Ce,{className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",children:e.jsx(Se,{placeholder:"Select a contact list"})}),e.jsxs(Pe,{children:[e.jsx(E,{value:"leads",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:"Sales Leads"})]})}),e.jsx(E,{value:"customers",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-2"}),e.jsx("span",{children:"Existing Customers"})]})}),e.jsx(E,{value:"prospects",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-3"}),e.jsx("span",{children:"Prospects"})]})}),e.jsx(E,{value:"partners",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-4"}),e.jsx("span",{children:"Partners"})]})})]})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"description",className:"text-sm font-medium text-foreground mb-1.5 block",children:"Notes"}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(Ne,{id:"description",placeholder:"Add any additional notes about this contact...",className:"w-full pl-10 min-h-[100px] border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...m("description")})]}),i.description&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.description.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(G,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Bulk Import"})]}),e.jsx("div",{className:"border-2 border-dashed border-border/50 rounded-lg p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(G,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("h3",{className:"text-sm font-medium mb-1",children:"Import Contacts"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Drag and drop a CSV or Excel file here or click to browse"}),e.jsx(b,{type:"button",variant:"outline",className:"text-xs border-border/50 hover:bg-muted/20",onClick:j,children:"Browse Files"}),e.jsx("input",{type:"file",id:"import",accept:".xlsx, .csv",ref:h,onChange:d,className:"hidden"})]})})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx(ye,{asChild:!0,children:e.jsx(b,{type:"button",variant:"outline",className:"border-border/50 text-foreground hover:bg-muted/20",children:"Cancel"})}),e.jsx(b,{type:"submit",className:"btn-gradient text-white",disabled:u,children:u?"Saving...":"Add Contact"})]})]})]})}const _e=({data:h,onItemClick:m,actions:n,getInitials:i,formatPhoneNumber:u,getListBadgeVariant:p})=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 mt-6",children:h.map(r=>{const j=i(r.email),d=["Active","Inactive","New"],x=["success","secondary","info"],g=String(r.id).charCodeAt(0)%3;return e.jsx(Ie,{className:"overflow-hidden border border-gray-200 hover:border-gray-300 hover:shadow-md transition-all cursor-pointer",onClick:()=>m(r),children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"h-10 w-10 bg-gradient-to-br from-primary/20 to-primary/10",children:e.jsx(X,{className:"text-primary font-medium",children:j})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 line-clamp-1",children:r.email}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",String(r.id).substring(0,8)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",onClick:l=>{l.stopPropagation();const v=n.find(y=>y.label==="Send Message");v&&v.onClick(r)},children:e.jsx(Z,{className:"h-4 w-4 text-gray-500"})}),e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",onClick:l=>{l.stopPropagation(),console.log("Share",r)},children:e.jsx(ie,{className:"h-4 w-4 text-gray-500"})}),e.jsxs(Ee,{children:[e.jsx(Le,{asChild:!0,onClick:l=>l.stopPropagation(),children:e.jsx(b,{variant:"ghost",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",children:e.jsx(le,{className:"h-4 w-4 text-gray-500"})})}),e.jsx(De,{align:"end",className:"w-[160px]",children:n.map((l,v)=>e.jsxs($e,{onClick:y=>{y.stopPropagation(),l.onClick(r)},className:"cursor-pointer",children:[e.jsx("span",{className:"mr-2 h-4 w-4 text-gray-500",children:l.icon}),e.jsx("span",{children:l.label})]},v))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:u(r.contact_number)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 line-clamp-1",children:r.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"List"}),r.list_name?e.jsxs(C,{variant:p(r.list_name),className:"capitalize",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),r.list_name]}):e.jsx("span",{className:"text-xs text-gray-500",children:"No list"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),e.jsx(C,{variant:x[g],className:"capitalize",children:d[g]})]})]})]})},r.id)})}),Oe=({onFilterChange:h})=>{const[m,n]=o.useState(!1),[i,u]=o.useState([]),[p,r]=o.useState(null),[j,d]=o.useState(null),x=[{id:"Active",label:"Active"},{id:"Inactive",label:"Inactive"},{id:"New",label:"New"}],g=[{id:"Sales Leads",label:"Sales Leads"},{id:"Existing Customers",label:"Existing Customers"},{id:"Prospects",label:"Prospects"},{id:"Partners",label:"Partners"}],l=()=>{const t={status:p,list:j},w=[];p&&w.push(`Status: ${p}`),j&&w.push(`List: ${j}`),u(w),h(t),n(!1)},v=()=>{r(null),d(null),u([]),h({})},y=t=>{const w=i.filter(F=>F!==t);u(w),t.startsWith("Status:")&&r(null),t.startsWith("List:")&&d(null),h({status:t.startsWith("Status:")?null:p,list:t.startsWith("List:")?null:j})};return e.jsxs("div",{className:"relative",children:[e.jsxs(Me,{open:m,onOpenChange:n,children:[e.jsx(Te,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"sm",className:`h-9 border-gray-200 text-gray-700 hover:bg-gray-50 ${i.length>0?"border-primary/50 bg-primary/5":""}`,children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Filters",i.length>0&&e.jsx("span",{className:"ml-1 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[10px] font-medium text-white",children:i.length})]})}),e.jsx(Re,{className:"w-[280px] p-4",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Filter Contacts"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{className:"text-xs font-medium",children:"Status"}),e.jsx(H,{value:p||"",onValueChange:t=>r(t||null),children:x.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{value:t.id,id:`status-${t.id}`}),e.jsx(N,{htmlFor:`status-${t.id}`,className:"text-sm font-normal cursor-pointer",children:t.label})]},t.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{className:"text-xs font-medium",children:"Contact List"}),e.jsx(H,{value:j||"",onValueChange:t=>d(t||null),children:g.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{value:t.id,id:`list-${t.id}`}),e.jsx(N,{htmlFor:`list-${t.id}`,className:"text-sm font-normal cursor-pointer",children:t.label})]},t.id))})]}),e.jsx(ze,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:v,className:"text-xs h-8",children:"Reset"}),e.jsx(b,{size:"sm",onClick:l,className:"text-xs h-8 bg-primary",children:"Apply Filters"})]})]})})]}),i.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map(t=>e.jsxs(C,{variant:"outline",className:"px-2 py-1 text-xs bg-primary/5 border-primary/20 text-primary flex items-center gap-1",children:[t,e.jsx("button",{className:"ml-1 text-primary hover:text-primary/80",onClick:()=>y(t),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},t))})]})},Fs=()=>{const[h,m]=Ae(),[n,i]=o.useState(h.get("search")||""),[u,p]=o.useState(n),[r,j]=o.useState(h.get("view")==="grid"?"grid":"list"),[d,x]=o.useState({}),[g,l]=o.useState(!1),[v,y]=o.useState(null),[t,w]=o.useState(!1),F=parseInt(h.get("page")||"1");o.useEffect(()=>{const s=setTimeout(()=>{p(n),m(a=>{const c=new URLSearchParams(a);return n?c.set("search",n):c.delete("search"),c})},500);return()=>clearTimeout(s)},[n,m]),o.useEffect(()=>{m(s=>{const a=new URLSearchParams(s);return r==="grid"?a.set("view","grid"):a.delete("view"),a})},[r,m]);const{data:Y,isLoading:R,error:z}=ke({queryKey:["getAllContacts",F,u],queryFn:()=>Fe(F,u)});if(R)return e.jsx(pe,{});if(z)return console.error("Error fetching contacts",z),e.jsx("div",{children:"Error loading contacts"});const ee=s=>{i(s)},se=s=>{j(s)},te=s=>{x(s),l(Object.keys(s).some(a=>s[a]!==null))},ae=s=>{y(s),w(!0)},re=()=>{w(!1),y(null)},L=Y.contacts.map(s=>({id:s.contact_id,...s})).filter(s=>{const a=d.status?String(s.id).charCodeAt(0)%3===(d.status==="Active"?0:d.status==="Inactive"?1:2):!0,c=d.list?s.list_name===d.list:!0;return a&&c}),V=(s,a)=>{let c=s,f=a;if(s&&s.includes('"email"'))try{const S=s.match(/"email":\s*"([^"]+)"/),P=s.match(/"phoneNumber":\s*"([^"]+)"/);S&&(c=S[1]),P&&(f=P[1])}catch{const P=s.split(/[,\s]+/),W=P.find(A=>A.includes("@")),U=P.find(A=>/[\d\+\-\(\)]+/.test(A)&&!A.includes("@"));W&&(c=W.replace(/[^a-zA-Z0-9@.\-_]/g,"")),U&&(f=U.replace(/[^0-9\+\-\(\)\s]/g,""))}return{email:c,phone:f}},q=s=>s.split(",")[0].trim().split("@")[0].substring(0,2).toUpperCase(),B=s=>{if(!s)return"";const a=s.replace(/[^\d\+\(\)\-\s]/g,"");return a.startsWith("+")?a.replace(/(\+\d{1,3})(\d{3})(\d{3})(\d{4})/,"$1 $2 $3 $4"):a.replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3")},_=s=>{const a=["purple","info","success","warning","secondary"],c=s.split("").reduce((f,S)=>f+S.charCodeAt(0),0);return a[c%a.length]},O=[{label:"Send Message",icon:e.jsx(Z,{className:"h-4 w-4"}),onClick:s=>ae(s)},{label:"Edit Contact",icon:e.jsx(me,{className:"h-4 w-4"}),onClick:s=>console.log("Editing",s)},{label:"Delete Contact",icon:e.jsx(de,{className:"h-4 w-4"}),onClick:s=>console.log("Deleting",s)}];return e.jsxs(ue,{children:[e.jsx(he,{title:"Contact Directory",buttonText:"Contact",filterByName:!0,filterWord:n,onFilterChange:ee,useSheet:!0,sheetContent:e.jsx(Be,{}),viewMode:r,onViewModeChange:se,showViewToggle:!0,showFilters:!1}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 gap-3",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(C,{variant:"secondary",className:"px-3 py-1",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[L.length," Contacts"]})]})}),e.jsx(Oe,{onFilterChange:te})]}),g&&e.jsx("div",{className:"mb-4"}),r==="list"?e.jsx(xe,{data:L,isLoading:R,isSelectable:!0,showColumnSelection:!0,onRowClick:s=>console.log("Row clicked",s),columns:[{header:"Contact",accessor:"email",className:"min-w-[250px]",cell:(s,a)=>{const{email:c}=V(String(s),String(a.contact_number||"")),f=q(c);return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"h-9 w-9 bg-gradient-to-br from-primary/20 to-primary/10",children:e.jsx(X,{className:"text-primary font-medium",children:f})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[e.jsx($,{className:"h-4 w-4 inline mr-2 text-gray-400"}),c]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",String(a.id).substring(0,8)]})]})]})},sortable:!0},{header:"Phone",accessor:"contact_number",className:"min-w-[180px]",cell:(s,a)=>{const{phone:c}=V(String(a.email||""),String(s));return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-700",children:c?B(c):"No phone"})]})}},{header:"List",accessor:"list_name",className:"min-w-[150px]",cell:s=>s?e.jsxs(C,{variant:_(String(s)),className:"capitalize",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),String(s)]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"No list"}),sortable:!0},{header:"Status",accessor:"id",className:"min-w-[120px]",cell:s=>{const a=["Active","Inactive","New"],c=["success","secondary","info"],f=String(s).charCodeAt(0)%3;return e.jsx("div",{className:"flex items-center justify-start",children:e.jsx(C,{variant:c[f],className:"capitalize",children:a[f]})})}}],actions:O,emptyState:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"h-16 w-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(K,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"No contacts found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Get started by adding your first contact"}),e.jsxs("button",{className:"bg-primary px-4 py-2 rounded-md text-white flex items-center justify-center mx-auto",onClick:()=>console.log("Add contact"),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Add Contact"]})]})}):e.jsx(_e,{data:L,onItemClick:s=>console.log("Grid item clicked",s),actions:O,getInitials:q,formatPhoneNumber:B,getListBadgeVariant:_}),e.jsx(Ve,{isOpen:t,contact:v,onClose:re})]})};export{Fs as default};
//# sourceMappingURL=Contacts-B_Lc6IE2.js.map
