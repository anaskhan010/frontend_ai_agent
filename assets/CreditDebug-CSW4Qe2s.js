import{j as e}from"./ui-CNbESIMS.js";import{r as d}from"./vendor-DG599jyl.js";import{B as f}from"./button-BpHONB4D.js";import{C,b as y,c as k,a as B}from"./card-pTI7iGfo.js";import{e as c,d as i}from"./index-m2-1zBbl.js";import"./router-BavLd_S0.js";import"./query-DFkYe0MV.js";const S=()=>{const[s,n]=d.useState({}),[o,l]=d.useState(!1),m=async()=>{var x,u,h,g,j,v,p,b;l(!0);const r={};try{const t=c.getItem("token");r.hasToken=!!t,r.tokenPreview=t?t.substring(0,20)+"...":"No token";try{const a=await i.post("/api/auth/demo-login",{});r.demoLogin={success:!0,userId:a.data.data.user.id,email:a.data.data.user.email},c.setItem("token",a.data.data.token),r.tokenStored=!0}catch(a){r.demoLogin={success:!1,error:((u=(x=a.response)==null?void 0:x.data)==null?void 0:u.message)||a.message}}try{const a=await i.get("/api/credits/balance");r.creditBalance={success:!0,data:a.data.data}}catch(a){r.creditBalance={success:!1,error:((g=(h=a.response)==null?void 0:h.data)==null?void 0:g.message)||a.message,status:(j=a.response)==null?void 0:j.status}}try{const a=await i.get("/api/credits/packages");r.apiConnectivity={success:!0,packagesCount:((v=a.data.data)==null?void 0:v.length)||0}}catch(a){r.apiConnectivity={success:!1,error:((b=(p=a.response)==null?void 0:p.data)==null?void 0:b.message)||a.message}}r.axiosConfig={baseURL:i.defaults.baseURL,timeout:i.defaults.timeout,headers:Object.keys(i.defaults.headers.common||{})}}catch(t){r.generalError=t.message}n(r),l(!1)},N=()=>{c.clear(),n({}),window.location.reload()};return d.useEffect(()=>{m()},[]),e.jsxs(C,{className:"w-full max-w-4xl mx-auto",children:[e.jsx(y,{children:e.jsx(k,{children:"Credit System Debug"})}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{onClick:m,disabled:o,children:o?"Running Tests...":"Run Debug Tests"}),e.jsx(f,{onClick:N,variant:"outline",children:"Clear Storage & Reload"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Authentication"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:["Has Token: ",s.hasToken?"✅":"❌"]}),e.jsxs("div",{children:["Token: ",s.tokenPreview]}),e.jsxs("div",{children:["Token Stored: ",s.tokenStored?"✅":"❌"]}),s.demoLogin&&e.jsxs("div",{children:["Demo Login: ",s.demoLogin.success?"✅":"❌",s.demoLogin.success&&e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{children:["User ID: ",s.demoLogin.userId]}),e.jsxs("div",{children:["Email: ",s.demoLogin.email]})]}),!s.demoLogin.success&&e.jsxs("div",{className:"ml-4 text-red-600",children:["Error: ",s.demoLogin.error]})]})]})]}),e.jsxs("div",{className:"p-4 border rounded",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Credit Balance"}),e.jsx("div",{className:"text-sm space-y-1",children:s.creditBalance&&e.jsxs("div",{children:["API Call: ",s.creditBalance.success?"✅":"❌",s.creditBalance.success&&e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{children:["Available: ",s.creditBalance.data.available_credits]}),e.jsxs("div",{children:["Total: ",s.creditBalance.data.total_credits]}),e.jsxs("div",{children:["Used: ",s.creditBalance.data.used_credits]})]}),!s.creditBalance.success&&e.jsxs("div",{className:"ml-4 text-red-600",children:["Status: ",s.creditBalance.status,e.jsx("br",{}),"Error: ",s.creditBalance.error]})]})})]}),e.jsxs("div",{className:"p-4 border rounded",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"API Connectivity"}),e.jsx("div",{className:"text-sm space-y-1",children:s.apiConnectivity&&e.jsxs("div",{children:["Connection: ",s.apiConnectivity.success?"✅":"❌",s.apiConnectivity.success&&e.jsxs("div",{className:"ml-4",children:["Packages: ",s.apiConnectivity.packagesCount]}),!s.apiConnectivity.success&&e.jsxs("div",{className:"ml-4 text-red-600",children:["Error: ",s.apiConnectivity.error]})]})})]}),e.jsxs("div",{className:"p-4 border rounded",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Axios Config"}),e.jsx("div",{className:"text-sm space-y-1",children:s.axiosConfig&&e.jsxs("div",{children:[e.jsxs("div",{children:["Base URL: ",s.axiosConfig.baseURL||"Not set"]}),e.jsxs("div",{children:["Timeout: ",s.axiosConfig.timeout||"Default"]}),e.jsxs("div",{children:["Headers: ",s.axiosConfig.headers.join(", ")||"None"]})]})})]})]}),s.generalError&&e.jsxs("div",{className:"p-4 border border-red-300 rounded bg-red-50",children:[e.jsx("h3",{className:"font-semibold text-red-800 mb-2",children:"General Error"}),e.jsx("div",{className:"text-sm text-red-600",children:s.generalError})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Raw Debug Data"}),e.jsx("pre",{className:"text-xs overflow-auto max-h-40",children:JSON.stringify(s,null,2)})]})]})]})};export{S as default};
//# sourceMappingURL=CreditDebug-CSW4Qe2s.js.map
