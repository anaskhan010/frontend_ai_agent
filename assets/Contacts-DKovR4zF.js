import{j as e,b4 as H,ar as M,av as $,aj as T,aA as k,F as Y,U,b5 as Q,a_ as ee,b as se,b0 as te,D as ae,H as re,b1 as ce}from"./ui-DHRUPyaA.js";import{r as h}from"./vendor-DG599jyl.js";import{M as ie}from"./ModernTable-kdGXiXLb.js";import{H as le}from"./Header-CjRwaabm.js";import{P as ne}from"./Page-DlVj60Rh.js";import{L as oe}from"./Loading-C1jVdMEL.js";import{u as me}from"./resolvers-BzctgYTE.js";import{o as de,c as xe,a as A}from"./index.esm-C7RSptL2.js";import{B as b}from"./button-D7rqocXn.js";import{I as D}from"./input-XSLov9pl.js";import{L as N}from"./label-CrKKAiqk.js";import{T as he}from"./textarea-_NvWYALn.js";import{S as ue,a as pe,b as ge}from"./sheet-BN9AFl4I.js";import{S as je,a as fe,b as Ne,c as be,d as I}from"./select-fj8F7bwK.js";import{b as ve}from"./query-C4fL1Hv3.js";import{g as ye}from"./contactService-Bragvwuw.js";import{c as we}from"./router-BavLd_S0.js";import{B as w}from"./badge-CqQHrhpt.js";import{A as K,a as Z}from"./avatar-BGZIpprs.js";import{C as Ce}from"./card-DNPHHQQ5.js";import{D as Se,a as Pe,b as ke,e as Fe}from"./dropdown-menu-BDAlliZC.js";import{P as Ae,a as Ie,b as Ee}from"./popover-CrB97PS7.js";import{R as G,a as O}from"./radio-group-DaclXhxZ.js";import{S as Le}from"./separator-B_ZqfU6K.js";import"./table-DhtUMdwT.js";import"./scroll-area-D8Yh2lEB.js";import"./index-gFMHSLmD.js";import"./index-CQ23FXLP.js";import"./index-HDeFwIcs.js";import"./index-kojKzVbx.js";const De=xe().shape({name:A().required("Name is required").min(2,"Name must be at least 2 characters"),email:A().required("Email is required").email("Email is invalid"),contactNumber:A().required("Contact Number is required").matches(/^\+?[1-9]\d{1,14}$/,"Contact Number must include country code and be valid"),description:A().optional().max(500,"Description cannot exceed 500 characters")});function Me(){const x=h.useRef(null),{register:n,handleSubmit:o,formState:{errors:i,isSubmitting:u},reset:p}=me({resolver:de(De)}),r=async d=>{try{console.log("Form Data:",d),p(),alert("Contact added successfully!")}catch(j){console.error("Error submitting form:",j),alert("Failed to add contact. Please try again.")}},g=()=>{var d;(d=x.current)==null||d.click()},m=d=>{var l;const j=(l=d.target.files)==null?void 0:l[0];j&&(console.log("Importing file:",j.name),d.target.value="")};return e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"text-xl font-semibold jakarta bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-1",children:"Add New Contact"}),e.jsx(pe,{className:"text-muted-foreground mb-6",children:"Add a new contact to your directory for voice AI agents to reach out to."}),e.jsxs("form",{onSubmit:o(r),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(H,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Contact Information"})]}),e.jsxs("div",{children:[e.jsxs(N,{htmlFor:"name",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Name",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(D,{id:"name",placeholder:"Enter contact name",className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...n("name")}),i.name&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.name.message})]}),e.jsxs("div",{children:[e.jsxs(N,{htmlFor:"email",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Email",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{id:"email",type:"email",placeholder:"Enter contact email",className:"w-full pl-10 border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...n("email")})]}),i.email&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.email.message})]}),e.jsxs("div",{children:[e.jsxs(N,{htmlFor:"contactNumber",className:"text-sm font-medium text-foreground mb-1.5 block",children:["Contact Number",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{id:"contactNumber",type:"tel",placeholder:"Enter contact number with country code (e.g., +1234567890)",className:"w-full pl-10 border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...n("contactNumber")})]}),i.contactNumber&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.contactNumber.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(T,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Additional Information"})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"list",className:"text-sm font-medium text-foreground mb-1.5 block",children:"Contact List"}),e.jsxs(je,{children:[e.jsx(fe,{className:"w-full border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",children:e.jsx(Ne,{placeholder:"Select a contact list"})}),e.jsxs(be,{children:[e.jsx(I,{value:"leads",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx("span",{children:"Sales Leads"})]})}),e.jsx(I,{value:"customers",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-2"}),e.jsx("span",{children:"Existing Customers"})]})}),e.jsx(I,{value:"prospects",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-3"}),e.jsx("span",{children:"Prospects"})]})}),e.jsx(I,{value:"partners",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-chart-4"}),e.jsx("span",{children:"Partners"})]})})]})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"description",className:"text-sm font-medium text-foreground mb-1.5 block",children:"Notes"}),e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(he,{id:"description",placeholder:"Add any additional notes about this contact...",className:"w-full pl-10 min-h-[100px] border-border/50 bg-card focus:border-primary/50 focus:ring-primary/20",...n("description")})]}),i.description&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:i.description.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(U,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-sm font-medium",children:"Bulk Import"})]}),e.jsx("div",{className:"border-2 border-dashed border-border/50 rounded-lg p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(U,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("h3",{className:"text-sm font-medium mb-1",children:"Import Contacts"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Drag and drop a CSV or Excel file here or click to browse"}),e.jsx(b,{type:"button",variant:"outline",className:"text-xs border-border/50 hover:bg-muted/20",onClick:g,children:"Browse Files"}),e.jsx("input",{type:"file",id:"import",accept:".xlsx, .csv",ref:x,onChange:m,className:"hidden"})]})})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx(ge,{asChild:!0,children:e.jsx(b,{type:"button",variant:"outline",className:"border-border/50 text-foreground hover:bg-muted/20",children:"Cancel"})}),e.jsx(b,{type:"submit",className:"btn-gradient text-white",disabled:u,children:u?"Saving...":"Add Contact"})]})]})]})}const $e=({data:x,onItemClick:n,actions:o,getInitials:i,formatPhoneNumber:u,getListBadgeVariant:p})=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 mt-6",children:x.map(r=>{const g=i(r.email),m=["Active","Inactive","New"],d=["success","secondary","info"],j=String(r.id).charCodeAt(0)%3;return e.jsx(Ce,{className:"overflow-hidden border border-gray-200 hover:border-gray-300 hover:shadow-md transition-all cursor-pointer",onClick:()=>n(r),children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{className:"h-10 w-10 bg-gradient-to-br from-primary/20 to-primary/10",children:e.jsx(Z,{className:"text-primary font-medium",children:g})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 line-clamp-1",children:r.email}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",String(r.id).substring(0,8)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",onClick:l=>{l.stopPropagation(),console.log("Message",r)},children:e.jsx(Q,{className:"h-4 w-4 text-gray-500"})}),e.jsx(b,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",onClick:l=>{l.stopPropagation(),console.log("Share",r)},children:e.jsx(ee,{className:"h-4 w-4 text-gray-500"})}),e.jsxs(Se,{children:[e.jsx(Pe,{asChild:!0,onClick:l=>l.stopPropagation(),children:e.jsx(b,{variant:"ghost",className:"h-8 w-8 p-0 rounded-full hover:bg-gray-100",children:e.jsx(se,{className:"h-4 w-4 text-gray-500"})})}),e.jsx(ke,{align:"end",className:"w-[160px]",children:o.map((l,y)=>e.jsxs(Fe,{onClick:C=>{C.stopPropagation(),l.onClick(r)},className:"cursor-pointer",children:[e.jsx("span",{className:"mr-2 h-4 w-4 text-gray-500",children:l.icon}),e.jsx("span",{children:l.label})]},y))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:u(r.contact_number)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700 line-clamp-1",children:r.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"List"}),r.list_name?e.jsxs(w,{variant:p(r.list_name),className:"capitalize",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),r.list_name]}):e.jsx("span",{className:"text-xs text-gray-500",children:"No list"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Status"}),e.jsx(w,{variant:d[j],className:"capitalize",children:m[j]})]})]})]})},r.id)})}),Te=({onFilterChange:x})=>{const[n,o]=h.useState(!1),[i,u]=h.useState([]),[p,r]=h.useState(null),[g,m]=h.useState(null),d=[{id:"Active",label:"Active"},{id:"Inactive",label:"Inactive"},{id:"New",label:"New"}],j=[{id:"Sales Leads",label:"Sales Leads"},{id:"Existing Customers",label:"Existing Customers"},{id:"Prospects",label:"Prospects"},{id:"Partners",label:"Partners"}],l=()=>{const t={status:p,list:g},v=[];p&&v.push(`Status: ${p}`),g&&v.push(`List: ${g}`),u(v),x(t),o(!1)},y=()=>{r(null),m(null),u([]),x({})},C=t=>{const v=i.filter(E=>E!==t);u(v),t.startsWith("Status:")&&r(null),t.startsWith("List:")&&m(null),x({status:t.startsWith("Status:")?null:p,list:t.startsWith("List:")?null:g})};return e.jsxs("div",{className:"relative",children:[e.jsxs(Ae,{open:n,onOpenChange:o,children:[e.jsx(Ie,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"sm",className:`h-9 border-gray-200 text-gray-700 hover:bg-gray-50 ${i.length>0?"border-primary/50 bg-primary/5":""}`,children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"Filters",i.length>0&&e.jsx("span",{className:"ml-1 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-[10px] font-medium text-white",children:i.length})]})}),e.jsx(Ee,{className:"w-[280px] p-4",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Filter Contacts"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{className:"text-xs font-medium",children:"Status"}),e.jsx(G,{value:p||"",onValueChange:t=>r(t||null),children:d.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{value:t.id,id:`status-${t.id}`}),e.jsx(N,{htmlFor:`status-${t.id}`,className:"text-sm font-normal cursor-pointer",children:t.label})]},t.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{className:"text-xs font-medium",children:"Contact List"}),e.jsx(G,{value:g||"",onValueChange:t=>m(t||null),children:j.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{value:t.id,id:`list-${t.id}`}),e.jsx(N,{htmlFor:`list-${t.id}`,className:"text-sm font-normal cursor-pointer",children:t.label})]},t.id))})]}),e.jsx(Le,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:y,className:"text-xs h-8",children:"Reset"}),e.jsx(b,{size:"sm",onClick:l,className:"text-xs h-8 bg-primary",children:"Apply Filters"})]})]})})]}),i.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.map(t=>e.jsxs(w,{variant:"outline",className:"px-2 py-1 text-xs bg-primary/5 border-primary/20 text-primary flex items-center gap-1",children:[t,e.jsx("button",{className:"ml-1 text-primary hover:text-primary/80",onClick:()=>C(t),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},t))})]})},us=()=>{const[x,n]=we(),[o,i]=h.useState(x.get("search")||""),[u,p]=h.useState(o),[r,g]=h.useState(x.get("view")==="grid"?"grid":"list"),[m,d]=h.useState({}),[j,l]=h.useState(!1),y=parseInt(x.get("page")||"1");h.useEffect(()=>{const s=setTimeout(()=>{p(o),n(a=>{const c=new URLSearchParams(a);return o?c.set("search",o):c.delete("search"),c})},500);return()=>clearTimeout(s)},[o,n]),h.useEffect(()=>{n(s=>{const a=new URLSearchParams(s);return r==="grid"?a.set("view","grid"):a.delete("view"),a})},[r,n]);const{data:C,isLoading:t,error:v}=ve({queryKey:["getAllContacts",y,u],queryFn:()=>ye(y,u)});if(t)return e.jsx(oe,{});if(v)return console.error("Error fetching contacts",v),e.jsx("div",{children:"Error loading contacts"});const E=s=>{i(s)},J=s=>{g(s)},X=s=>{d(s),l(Object.keys(s).some(a=>s[a]!==null))},L=C.contacts.map(s=>({id:s.contact_id,...s})).filter(s=>{const a=m.status?String(s.id).charCodeAt(0)%3===(m.status==="Active"?0:m.status==="Inactive"?1:2):!0,c=m.list?s.list_name===m.list:!0;return a&&c}),R=(s,a)=>{let c=s,f=a;if(s&&s.includes('"email"'))try{const S=s.match(/"email":\s*"([^"]+)"/),P=s.match(/"phoneNumber":\s*"([^"]+)"/);S&&(c=S[1]),P&&(f=P[1])}catch{const P=s.split(/[,\s]+/),B=P.find(F=>F.includes("@")),W=P.find(F=>/[\d\+\-\(\)]+/.test(F)&&!F.includes("@"));B&&(c=B.replace(/[^a-zA-Z0-9@.\-_]/g,"")),W&&(f=W.replace(/[^0-9\+\-\(\)\s]/g,""))}return{email:c,phone:f}},z=s=>s.split(",")[0].trim().split("@")[0].substring(0,2).toUpperCase(),V=s=>{if(!s)return"";const a=s.replace(/[^\d\+\(\)\-\s]/g,"");return a.startsWith("+")?a.replace(/(\+\d{1,3})(\d{3})(\d{3})(\d{4})/,"$1 $2 $3 $4"):a.replace(/(\d{3})(\d{3})(\d{4})/,"($1) $2-$3")},_=s=>{const a=["purple","info","success","warning","secondary"],c=s.split("").reduce((f,S)=>f+S.charCodeAt(0),0);return a[c%a.length]},q=[{label:"Send Message",icon:e.jsx(Q,{className:"h-4 w-4"}),onClick:s=>console.log("Messaging",s)},{label:"Edit Contact",icon:e.jsx(re,{className:"h-4 w-4"}),onClick:s=>console.log("Editing",s)},{label:"Delete Contact",icon:e.jsx(ce,{className:"h-4 w-4"}),onClick:s=>console.log("Deleting",s)}];return e.jsxs(ne,{children:[e.jsx(le,{title:"Contact Directory",buttonText:"Contact",filterByName:!0,filterWord:o,onFilterChange:E,useSheet:!0,sheetContent:e.jsx(Me,{}),viewMode:r,onViewModeChange:J,showViewToggle:!0,showFilters:!1}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 gap-3",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(w,{variant:"secondary",className:"px-3 py-1",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[L.length," Contacts"]})]})}),e.jsx(Te,{onFilterChange:X})]}),j&&e.jsx("div",{className:"mb-4"}),r==="list"?e.jsx(ie,{data:L,isLoading:t,isSelectable:!0,showColumnSelection:!0,onRowClick:s=>console.log("Row clicked",s),columns:[{header:"Contact",accessor:"email",className:"min-w-[250px]",cell:(s,a)=>{const{email:c}=R(String(s),String(a.contact_number||"")),f=z(c);return e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{className:"h-9 w-9 bg-gradient-to-br from-primary/20 to-primary/10",children:e.jsx(Z,{className:"text-primary font-medium",children:f})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-gray-900",children:[e.jsx(M,{className:"h-4 w-4 inline mr-2 text-gray-400"}),c]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",String(a.id).substring(0,8)]})]})]})},sortable:!0},{header:"Phone",accessor:"contact_number",className:"min-w-[180px]",cell:(s,a)=>{const{phone:c}=R(String(a.email||""),String(s));return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-700",children:c?V(c):"No phone"})]})}},{header:"List",accessor:"list_name",className:"min-w-[150px]",cell:s=>s?e.jsxs(w,{variant:_(String(s)),className:"capitalize",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),String(s)]}):e.jsx("span",{className:"text-gray-500 text-sm",children:"No list"}),sortable:!0},{header:"Status",accessor:"id",className:"min-w-[120px]",cell:s=>{const a=["Active","Inactive","New"],c=["success","secondary","info"],f=String(s).charCodeAt(0)%3;return e.jsx("div",{className:"flex items-center justify-start",children:e.jsx(w,{variant:c[f],className:"capitalize",children:a[f]})})}}],actions:q,emptyState:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"h-16 w-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(H,{className:"h-8 w-8 text-primary"})}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"No contacts found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Get started by adding your first contact"}),e.jsxs("button",{className:"bg-primary px-4 py-2 rounded-md text-white flex items-center justify-center mx-auto",onClick:()=>console.log("Add contact"),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Add Contact"]})]})}):e.jsx($e,{data:L,onItemClick:s=>console.log("Grid item clicked",s),actions:q,getInitials:z,formatPhoneNumber:V,getListBadgeVariant:_})]})};export{us as default};
//# sourceMappingURL=Contacts-DKovR4zF.js.map
