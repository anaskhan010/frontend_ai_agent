{"version":3,"file":"EmailManagement-BbKQydZL.js","sources":["../../src/EmailManagement/EmailManagement.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport axiosInstance from \"@/api/axios/axiosInstance\";\n\nconst EmailManagement = () => {\n  const [emailTypes, setEmailTypes] = useState([]);\n  const [frequencies, setFrequencies] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [rules, setRules] = useState([]);\n\n  const [selectedEmailType, setSelectedEmailType] = useState(null);\n  const [selectedUser, setSelectedUser] = useState(\"\");\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const [selectedType, setSelectedType] = useState(null);\n\n  const [phases, setPhases] = useState([]);\n  const [conditions, setConditions] = useState([]);\n\n  const [selectedPhases, setSelectedPhases] = useState([]);\n  const [selectedConditions, setSelectedConditions] = useState([]);\n\n  const [editingRule, setEditingRule] = useState(null);\n\n  const [form, setForm] = useState({\n    rule_name: \"\",\n    location_text: \"\",\n    condition_text: \"\",\n    frequency_code: \"\",\n  });\n\n  useEffect(() => {\n    axiosInstance\n      .get(\"/api/email-management/email-types\")\n      .then((r) => setEmailTypes(r.data.data));\n\n    axiosInstance\n      .get(\"/api/email-management/frequencies\")\n      .then((r) => setFrequencies(r.data.data));\n\n    axiosInstance\n      .get(\"/api/email-management/users\")\n      .then((r) => setUsers(r.data.data));\n\n    axiosInstance\n      .get(\"/api/email-management/study-phases\")\n      .then((r) => setPhases(r.data.data));\n\n    axiosInstance\n      .get(\"/api/email-management/study-conditions\")\n      .then((r) => setConditions(r.data.data));\n  }, []);\n\n  const openStudyDrawer = (type) => {\n    if (type.code !== \"STUDY\") return;\n    setSelectedEmailType(type);\n    setDrawerOpen(true);\n  };\n\n  const fetchRules = (userId) => {\n    axiosInstance\n      .get(`/api/email-management/rules/${userId}`)\n      .then((r) => setRules(r.data.data));\n  };\n\n  const saveRule = async () => {\n    if (!selectedUser) {\n      alert(\"Please select a user first\");\n      return;\n    }\n\n    if (editingRule) {\n      // ✅ UPDATE\n      await axiosInstance.put(`/api/email-management/rules/${editingRule.id}`, {\n        location_text: form.location_text || null,\n        phase: selectedPhases,\n        condition_text: selectedConditions,\n        frequency_code: form.frequency_code,\n        timezone: \"America/Chicago\",\n        schedule_day_of_week: form.schedule_day_of_week,\n        schedule_day_of_month: form.schedule_day_of_month,\n        schedule_time: form.schedule_time,\n        is_enabled: 1,\n      });\n    } else {\n      // ✅ CREATE\n      await axiosInstance.post(\"/api/email-management/rules\", {\n        email_type_code: \"STUDY\",\n        target_user_id: selectedUser,\n        ...form,\n      });\n    }\n\n    // ✅ RESET STATE\n    setEditingRule(null);\n    setForm({\n      location_text: \"\",\n      condition_text: \"\",\n      frequency_code: \"\",\n    });\n    setSelectedPhases([]);\n    setSelectedConditions([]);\n\n    fetchRules(selectedUser);\n  };\n\n  const deleteRule = async (id) => {\n    if (!confirm(\"Are you sure you want to delete this rule?\")) return;\n\n    await axiosInstance.delete(`/api/email-management/rules/${id}`);\n    fetchRules(selectedUser);\n  };\n\n  const parseJSON = (val) => {\n    try {\n      return val ? JSON.parse(val) : [];\n    } catch {\n      return [];\n    }\n  };\n\n  const formatFrequency = (r) => {\n    if (r.frequency_code === \"DAILY\") return \"Daily\";\n    if (r.frequency_code === \"WEEKLY\")\n      return `Weekly (Day ${r.schedule_day_of_week})`;\n    if (r.frequency_code === \"MONTHLY\")\n      return `Monthly (Day ${r.schedule_day_of_month})`;\n    return r.frequency_code;\n  };\n\n  const getOrdinal = (n) => {\n    if (n > 3 && n < 21) return \"th\";\n    switch (n % 10) {\n      case 1:\n        return \"st\";\n      case 2:\n        return \"nd\";\n      case 3:\n        return \"rd\";\n      default:\n        return \"th\";\n    }\n  };\n\n  useEffect(() => {\n    const close = () => setOpen(false);\n    document.addEventListener(\"click\", close);\n    return () => document.removeEventListener(\"click\", close);\n  }, []);\n\n  const SearchableMultiSelect = ({\n    label,\n    options = [],\n    value = [],\n    onChange,\n    placeholder = \"Select...\",\n  }) => {\n    const [open, setOpen] = useState(false);\n    const [search, setSearch] = useState(\"\");\n    const containerRef = useRef(null);\n\n    // ✅ Toggle selection\n    const toggleOption = (item) => {\n      if (value.includes(item)) {\n        onChange(value.filter((v) => v !== item));\n      } else {\n        onChange([...value, item]);\n      }\n    };\n\n    // ✅ Filter options\n    const filteredOptions = options.filter((opt) =>\n      opt.toLowerCase().includes(search.toLowerCase())\n    );\n\n    // ✅ Close dropdown ONLY on outside click\n    useEffect(() => {\n      const handleOutsideClick = (e) => {\n        if (containerRef.current && !containerRef.current.contains(e.target)) {\n          setOpen(false);\n        }\n      };\n\n      document.addEventListener(\"mousedown\", handleOutsideClick);\n      return () =>\n        document.removeEventListener(\"mousedown\", handleOutsideClick);\n    }, []);\n\n    return (\n      <div ref={containerRef} className=\"relative mb-6\">\n        <label className=\"block text-sm font-semibold mb-1 text-white\">{label}</label>\n\n        {/* INPUT */}\n        <div\n          className=\"border border-white/20 rounded-md p-3 flex justify-between items-center cursor-pointer bg-white/5\"\n          onClick={() => setOpen(true)}\n        >\n          <span className=\"text-sm text-white/60\">\n            {value.length ? `${value.length} selected` : placeholder}\n          </span>\n          <span className=\"text-white/40\">▾</span>\n        </div>\n\n        {/* DROPDOWN */}\n        {open && (\n          <div className=\"absolute z-50 w-full bg-[#0e1340] border border-white/10 rounded-lg shadow-lg mt-2\">\n            {/* SEARCH */}\n            <div className=\"p-2 border-b border-white/10\">\n              <input\n                type=\"text\"\n                className=\"w-full bg-white/5 border border-white/20 rounded p-2 text-sm text-white placeholder:text-white/40\"\n                placeholder=\"Search...\"\n                value={search}\n                onChange={(e) => setSearch(e.target.value)}\n              />\n            </div>\n\n            {/* OPTIONS */}\n            <div className=\"max-h-60 overflow-y-auto p-2\">\n              {filteredOptions.length === 0 && (\n                <p className=\"text-xs text-white/40 p-2\">No results found</p>\n              )}\n\n              {filteredOptions.map((opt) => (\n                <div\n                  key={opt}\n                  className=\"flex items-center gap-2 p-2 rounded hover:bg-white/5 cursor-pointer text-white\"\n                  onClick={() => toggleOption(opt)}\n                >\n                  <input\n                    type=\"checkbox\"\n                    checked={value.includes(opt)}\n                    readOnly\n                    className=\"bg-white/5 border-white/30\"\n                  />\n                  <span className=\"text-sm\">{opt}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* SELECTED TAGS */}\n        {value.length > 0 && (\n          <div className=\"flex flex-wrap gap-2 mt-2\">\n            {value.map((v) => (\n              <span\n                key={v}\n                className=\"bg-indigo-500/20 border border-indigo-500/30 text-indigo-300 rounded-full px-3 py-1 text-xs flex items-center gap-2\"\n              >\n                {v}\n                <button\n                  className=\"text-indigo-300 hover:text-white\"\n                  onClick={() => toggleOption(v)}\n                >\n                  ×\n                </button>\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen app-shell-bg p-6\">\n      {/* Neon glow layer */}\n      <div className=\"pointer-events-none fixed inset-0 z-0\">\n        <div className=\"absolute left-1/4 top-0 h-[500px] w-[500px] rounded-full bg-indigo-600/20 blur-[120px]\" />\n        <div className=\"absolute right-1/4 bottom-0 h-[400px] w-[400px] rounded-full bg-purple-600/20 blur-[100px]\" />\n      </div>\n\n      <div className=\"relative z-10 bg-[#0b0f2e]/90 backdrop-blur-sm rounded-lg border border-white/10 p-6\">\n        <h2 className=\"text-2xl font-bold mb-4 text-white\">Email Management</h2>\n\n        {/* EMAIL TYPES TABLE */}\n        <table className=\"w-full border border-white/10 mb-6 rounded-lg overflow-hidden\">\n          <thead>\n            <tr className=\"border-b border-white/10 bg-white/5\">\n              <th className=\"p-3 text-left text-white/70\">Email Type</th>\n              <th className=\"p-3 text-left text-white/70\">Description</th>\n              <th className=\"p-3 text-left text-white/70\">Status</th>\n            </tr>\n          </thead>\n          <tbody>\n            {emailTypes.map((t) => (\n              <tr\n                key={t.id}\n                className=\"border-b border-white/5 cursor-pointer hover:bg-white/5 text-white\"\n                onClick={() => openStudyDrawer(t)}\n              >\n                <td className=\"p-3\">{t.name}</td>\n                <td className=\"p-3 text-white/70\">{t.description}</td>\n                <td className=\"p-3\">\n                  <span className={t.is_active ? \"text-green-400\" : \"text-red-400\"}>\n                    {t.is_active ? \"Enabled\" : \"Disabled\"}\n                  </span>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {/* SIDEBAR */}\n      {drawerOpen && (\n        <div className=\"fixed inset-0 bg-black/80 z-[60]\" onClick={() => setDrawerOpen(false)}>\n          <div\n            className=\"absolute right-0 top-0 h-full w-[1200px] bg-[#0b0f2e] border-l border-white/10 p-6 overflow-auto shadow-2xl\"\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div className=\"flex justify-between mb-4\">\n              <h3 className=\"font-bold text-white\">{selectedType?.name}</h3>\n              <button\n                onClick={() => setDrawerOpen(false)}\n                className=\"text-white/70 hover:text-white px-3 py-1 border border-white/20 rounded hover:bg-white/10\"\n              >\n                Close\n              </button>\n            </div>\n\n            <select\n              className=\"w-full bg-white/5 border border-white/20 text-white p-2 mb-4 rounded\"\n              onChange={(e) => {\n                const userId = e.target.value;\n                setSelectedUser(userId);\n                setRules([]); // ✅ CLEAR old rules\n                fetchRules(userId); // ✅ CORRECT function\n              }}\n            >\n              <option className=\"bg-[#0e1340] text-white\">Select user</option>\n              {users.map((u) => (\n                <option key={u.id} value={u.id} className=\"bg-[#0e1340] text-white\">\n                  {u.name}\n                </option>\n              ))}\n            </select>\n\n\n\n            <SearchableMultiSelect\n              label=\"ClinicalTrials.gov Study Phase\"\n              options={phases}\n              value={selectedPhases}\n              placeholder=\"Select study phase(s)\"\n              onChange={(vals) => {\n                setSelectedPhases(vals);\n                setForm((prev) => ({ ...prev, phase: vals }));\n              }}\n            />\n\n            <SearchableMultiSelect\n              label=\"ClinicalTrials.gov Condition\"\n              options={conditions}\n              value={selectedConditions}\n              placeholder=\"Select condition(s)\"\n              onChange={(vals) => {\n                setSelectedConditions(vals);\n                setForm((prev) => ({ ...prev, condition_text: vals }));\n              }}\n            />\n\n\n\n            <select\n              className=\"w-full bg-white/5 border border-white/20 text-white p-2 mb-4 rounded\"\n              onChange={(e) =>\n                setForm({ ...form, frequency_code: e.target.value })\n              }\n            >\n              <option className=\"bg-[#0e1340] text-white\">Select frequency</option>\n              {frequencies.map((f) => (\n                <option key={f.code} value={f.code} className=\"bg-[#0e1340] text-white\">\n                  {f.label}\n                </option>\n              ))}\n            </select>\n\n            {[\"DAILY\", \"WEEKLY\", \"MONTHLY\"].includes(form.frequency_code) && (\n              <input\n                type=\"time\"\n                className=\"w-full bg-white/5 border border-white/20 text-white p-2 mb-4 rounded\"\n                onChange={(e) =>\n                  setForm({ ...form, schedule_time: e.target.value })\n                }\n              />\n            )}\n\n            {form.frequency_code === \"WEEKLY\" && (\n              <select\n                className=\"w-full bg-white/5 border border-white/20 text-white p-2 mb-4 rounded\"\n                onChange={(e) =>\n                  setForm({ ...form, schedule_day_of_week: e.target.value })\n                }\n              >\n                <option value=\"\" className=\"bg-[#0e1340] text-white\">Select weekday</option>\n                <option value=\"1\" className=\"bg-[#0e1340] text-white\">Monday</option>\n                <option value=\"2\" className=\"bg-[#0e1340] text-white\">Tuesday</option>\n                <option value=\"3\" className=\"bg-[#0e1340] text-white\">Wednesday</option>\n                <option value=\"4\" className=\"bg-[#0e1340] text-white\">Thursday</option>\n                <option value=\"5\" className=\"bg-[#0e1340] text-white\">Friday</option>\n              </select>\n            )}\n\n            {form.frequency_code === \"MONTHLY\" && (\n              <div className=\"mb-4\">\n                <label className=\"text-sm text-white/50 block mb-1\">\n                  Select day of month\n                </label>\n\n                <input\n                  type=\"date\"\n                  className=\"w-full bg-white/5 border border-white/20 text-white p-2 rounded\"\n                  onChange={(e) => {\n                    if (!e.target.value) return;\n\n                    const selectedDate = new Date(e.target.value);\n                    const dayOfMonth = selectedDate.getDate(); // ✅ ONLY DAY\n\n                    setForm({\n                      ...form,\n                      schedule_day_of_month: dayOfMonth,\n                    });\n                  }}\n                />\n\n                {form.schedule_day_of_month && (\n                  <p className=\"text-xs text-white/50 mt-1\">\n                    Email will be sent on the{\" \"}\n                    <b className=\"text-white\">{form.schedule_day_of_month}</b>\n                    {getOrdinal(form.schedule_day_of_month)} of every month\n                  </p>\n                )}\n              </div>\n            )}\n\n            <button\n              className=\"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-2 rounded mb-2\"\n              onClick={saveRule}\n            >\n              {editingRule ? \"Update Rule\" : \"Save Rule\"}\n            </button>\n\n            {editingRule && (\n              <button\n                className=\"w-full mt-2 border border-white/20 text-white p-2 rounded hover:bg-white/10\"\n                onClick={() => {\n                  setEditingRule(null);\n                  setForm({\n                    location_text: \"\",\n                    condition_text: \"\",\n                    frequency_code: \"\",\n                  });\n                  setSelectedPhases([]);\n                  setSelectedConditions([]);\n                }}\n              >\n                Cancel Edit\n              </button>\n            )}\n\n            {/* RULES TABLE */}\n\n            <div className=\"mt-4\">\n              {selectedUser &&\n                rules.length > 0 &&\n                rules.map((r) => {\n                  const phases = parseJSON(r.phase);\n                  const conditions = parseJSON(r.condition_text);\n\n                  return (\n                    <div\n                      key={r.id}\n                      className=\"border border-white/10 rounded-lg p-4 mb-4 bg-white/5\"\n                    >\n\n                      {/* HEADER */}\n                      <div className=\"flex justify-between items-start mb-2\">\n\n\n\n                         {/* User Name */}\n                      <div>\n                        <h4 className=\"font-semibold text-lg text-white\">User</h4>\n                        <p className=\"text-sm text-white/50\">\n                          {users.find((u) => u.id === r.target_user_id)?.name}\n                        </p>\n                      </div>\n\n\n                        <div>\n                          <h4 className=\"font-semibold text-lg text-white\">\n                            {r.rule_name}\n                          </h4>\n                          <p className=\"text-sm text-white/50\">\n                            {formatFrequency(r)}\n                          </p>\n                        </div>\n\n                        <div className=\"flex gap-2\">\n                          <button\n                            className=\"px-3 py-1 text-sm border border-white/20 text-white rounded hover:bg-white/10\"\n                            onClick={() => {\n                              setEditingRule(r);\n\n                              setForm({\n                                rule_name: r.rule_name,\n                                location_text: r.location_text || \"\",\n                                frequency_code: r.frequency_code,\n                                schedule_day_of_week: r.schedule_day_of_week,\n                                schedule_day_of_month: r.schedule_day_of_month,\n                                schedule_time: r.schedule_time,\n                                phase: parseJSON(r.phase),\n                                condition_text: parseJSON(r.condition_text),\n                              });\n\n                              setSelectedPhases(parseJSON(r.phase));\n                              setSelectedConditions(\n                                parseJSON(r.condition_text)\n                              );\n                            }}\n                          >\n                            Edit\n                          </button>\n\n                          <button\n                            className=\"px-3 py-1 text-sm border border-red-500/30 text-red-400 rounded hover:bg-red-500/10\"\n                            onClick={() => deleteRule(r.id)}\n                          >\n                            Delete\n                          </button>\n                        </div>\n                      </div>\n\n                      {/* PHASES */}\n                      {phases.length > 0 && (\n                        <div className=\"mb-2\">\n                          <p className=\"text-sm font-medium mb-1 text-white\">\n                            Study Phases\n                          </p>\n                          <div className=\"flex flex-wrap gap-2\">\n                            {phases.map((p) => (\n                              <span\n                                key={p}\n                                className=\"bg-indigo-500/20 text-indigo-300 border border-indigo-500/30 px-2 py-1 rounded text-xs\"\n                              >\n                                {p}\n                              </span>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n\n                      {/* CONDITIONS */}\n                      {conditions.length > 0 && (\n                        <div className=\"mb-2\">\n                          <p className=\"text-sm font-medium mb-1 text-white\">Conditions</p>\n                          <div className=\"flex flex-wrap gap-2\">\n                            {conditions.map((c) => (\n                              <span\n                                key={c}\n                                className=\"bg-green-500/20 text-green-300 border border-green-500/30 px-2 py-1 rounded text-xs\"\n                              >\n                                {c}\n                              </span>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n\n                      {/* STATUS */}\n                      <div className=\"mt-2 text-sm text-white/50\">\n                        Status:{\" \"}\n                        <span\n                          className={\n                            r.is_enabled\n                              ? \"text-green-400 font-medium\"\n                              : \"text-red-400\"\n                          }\n                        >\n                          {r.is_enabled ? \"Enabled\" : \"Disabled\"}\n                        </span>\n                      </div>\n                    </div>\n                  );\n                })}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EmailManagement;\n"],"names":["EmailManagement","emailTypes","setEmailTypes","useState","frequencies","setFrequencies","users","setUsers","rules","setRules","selectedEmailType","setSelectedEmailType","selectedUser","setSelectedUser","drawerOpen","setDrawerOpen","selectedType","setSelectedType","phases","setPhases","conditions","setConditions","selectedPhases","setSelectedPhases","selectedConditions","setSelectedConditions","editingRule","setEditingRule","form","setForm","useEffect","axiosInstance","r","openStudyDrawer","type","fetchRules","userId","saveRule","deleteRule","id","parseJSON","val","formatFrequency","getOrdinal","n","close","SearchableMultiSelect","label","options","value","onChange","placeholder","open","setOpen","search","setSearch","containerRef","useRef","toggleOption","item","v","filteredOptions","opt","handleOutsideClick","e","jsxs","jsx","t","u","vals","prev","f","dayOfMonth","_a","p","c"],"mappings":"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"}