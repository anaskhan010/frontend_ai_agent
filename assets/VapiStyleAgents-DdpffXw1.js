var wc=Object.defineProperty;var Sc=(s,e,t)=>e in s?wc(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var X=(s,e,t)=>Sc(s,typeof e!="symbol"?e+"":e,t);import{j as r,aS as Ot,c6 as jc,T as Jn,bo as ma,ay as Ss,aB as is,Y as js,aw as Xs,G as vo,C as kc,ab as Cc,aG as yo,bV as Ec,bX as Nc,bY as Tc,aC as Zs,bW as Ac,a9 as ft,ba as Mc,bv as bo,am as Oc,K as _o,X as xo,V as Ic,k as Pc,m as Lc,c7 as pa,c8 as Dc,I as Rc,N as fa,aQ as ga}from"./ui-B8VyAbFl.js";import{r as K,g as Fc,d as va,a as Vc,b as qc}from"./vendor-DG599jyl.js";import{a as en,u as Uc,c as jn}from"./query-CWB_8EHL.js";import{u as Bc,a as $c,b as Jc,c as Gc,d as zc,g as Yc,e as Wc,h as Hc,i as Kc,j as Qc}from"./agentService-CYr8QiHt.js";import{p as Tt,B as Se,Q as wr,R as Sr,U as Ye,V as We,C as Ae,d as Pe,e as Le,b as Me,g as be,h as _e,i as xe,j as we,k as ue,I as ye,T as ht,s as Zt,v as es,w as ts,x as ss,y as Xc,L as W,q as kt,t as ee,u as Zc}from"./index-BQqu6sK2.js";import{A as tn,a as sn}from"./avatar-BxhnxVoh.js";import{T as eu,a as tu,b as As,c as Ms,d as su,e as Kt}from"./table-BnB8sdck.js";import{g as nu,a as ru,u as au}from"./defaultAssistantTemplateService-DyjYG75j.js";import{S as iu}from"./slider-Ddln0wr9.js";import{a as Os}from"./client-Cq3cWhXQ.js";import{g as ya,a as ba,b as _a,T as xa,V as wa,M as Sa,c as ja,d as ka,e as Ca}from"./vapiProviders-ChvPBQcq.js";import{u as ou}from"./router-BnJytTjr.js";const Ea=({agent:s,details:e,isLoading:t,onUpdateField:n,onUpdateSystemMessage:a,onDelete:i,onPublishToggle:l,isPublished:c,isSaving:d,onTalkToAssistant:m,MODEL_PROVIDERS:g,VOICE_PROVIDERS:_,TRANSCRIBER_PROVIDERS:M,getProviderModels:E,getProviderVoices:k,getTranscriberModels:b,normalizeProviderValue:x,getInitials:p})=>{var T,L,j,O,D,Y,te,re,C,G,S,V,z,Ee,$e;return t?r.jsxs("div",{className:"flex flex-col items-center justify-center py-20 min-h-[400px]",children:[r.jsx(Ot,{className:"h-10 w-10 animate-spin text-indigo-500 mb-4"}),r.jsx("p",{className:"text-white/60",children:"Fetching Vapi agent details..."})]}):r.jsxs("div",{className:"flex flex-col h-full bg-[#0b0f2e]",children:[r.jsxs("div",{className:"p-6 border-b border-white/10 flex items-center justify-between sticky top-0 bg-[#0b0f2e] z-10",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(tn,{className:"h-16 w-16 ring-2 ring-indigo-500/20",children:r.jsx(sn,{className:"text-white bg-gradient-to-br from-indigo-500/30 to-purple-500/30 text-xl font-bold",children:p(s.name)})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:s.name}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(Tt,{variant:"secondary",className:"bg-green-500/20 text-green-400 border border-green-500/30",children:"Active"}),r.jsxs("span",{className:"text-sm text-white/50 font-mono",children:["ID: ",String(s.id).substring(0,12),"..."]}),d&&r.jsxs("div",{className:"flex items-center text-xs text-blue-400",children:[r.jsx(Ot,{className:"h-3 w-3 mr-1 animate-spin"}),"Auto-saving..."]})]})]})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs(Se,{size:"sm",onClick:m,className:"bg-gradient-to-r from-teal-500 to-cyan-600 hover:from-teal-600 hover:to-cyan-700 text-white shadow-lg",children:[r.jsx(jc,{className:"h-4 w-4 mr-2"}),"Talk"]}),r.jsx(Se,{variant:c?"default":"outline",size:"sm",onClick:()=>l(s),className:c?"bg-green-600 hover:bg-green-700 text-white":"text-white bg-transparent hover:bg-white/10 border-white/20",children:c?"Published":"Publish"}),r.jsx(Se,{variant:"outline",size:"sm",onClick:()=>i(s),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10 border-red-400/30",children:r.jsx(Jn,{className:"h-4 w-4"})})]})]}),r.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:r.jsxs(wr,{defaultValue:"model",className:"w-full",children:[r.jsxs(Sr,{className:"flex flex-wrap items-center gap-2 mb-8 bg-transparent p-0 h-auto",children:[r.jsxs(Ye,{value:"model",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[r.jsx(ma,{className:"h-4 w-4 mr-2"}),"Model"]}),r.jsxs(Ye,{value:"voice",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[r.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Voice"]}),r.jsxs(Ye,{value:"transcriber",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[r.jsx(is,{className:"h-4 w-4 mr-2"}),"Transcriber"]}),r.jsxs(Ye,{value:"advanced",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag z-0",children:[r.jsx(js,{className:"h-4 w-4 mr-2"}),"Advanced"]})]}),r.jsxs(We,{value:"model",className:"space-y-6",children:[r.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"flex items-center text-white gap-2",children:[r.jsx(ma,{className:"h-5 w-5 text-indigo-400"}),"Model Configuration"]})}),r.jsxs(Me,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Provider"}),r.jsxs(be,{value:x(((T=e==null?void 0:e.model)==null?void 0:T.provider)||"","model"),onValueChange:y=>n("model.provider",y),children:[r.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:r.jsx(xe,{placeholder:((L=e==null?void 0:e.model)==null?void 0:L.provider)||"Select provider"})}),r.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:g.map(y=>r.jsx(ue,{value:y.id,children:r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("span",{children:y.name})})},y.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Model"}),r.jsxs(be,{value:((j=e==null?void 0:e.model)==null?void 0:j.model)||"",onValueChange:y=>n("model.model",y),children:[r.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:r.jsx(xe,{placeholder:((O=e==null?void 0:e.model)==null?void 0:O.model)||"Select model"})}),r.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:E(((D=e==null?void 0:e.model)==null?void 0:D.provider)||"openai").map(y=>r.jsx(ue,{value:y.id,children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-medium text-white",children:y.name}),r.jsx("span",{className:"text-xs text-white/50",children:y.id})]})},y.id))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Temperature"}),r.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",type:"number",min:"0",max:"1",step:"0.1",value:((Y=e==null?void 0:e.model)==null?void 0:Y.temperature)||.7,onChange:y=>n("model.temperature",parseFloat(y.target.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Max Tokens"}),r.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",type:"number",value:((te=e==null?void 0:e.model)==null?void 0:te.maxTokens)||1e3,onChange:y=>n("model.maxTokens",parseInt(y.target.value))})]})]})]})]}),r.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"flex items-center text-white gap-2",children:[r.jsx(Xs,{className:"h-5 w-5 text-indigo-400"}),"System Prompt"]})}),r.jsx(Me,{children:r.jsx(ht,{className:"bg-white/5 border-white/10 text-white min-h-[300px]",value:((G=(C=(re=e==null?void 0:e.model)==null?void 0:re.messages)==null?void 0:C[0])==null?void 0:G.content)||(e==null?void 0:e.systemMessage)||"",onChange:y=>a(y.target.value),placeholder:"You are a helpful assistant..."})})]})]}),r.jsx(We,{value:"voice",className:"space-y-6",children:r.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"flex items-center text-white gap-2",children:[r.jsx(Ss,{className:"h-5 w-5 text-indigo-400"}),"Voice Configuration"]})}),r.jsx(Me,{className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Voice Provider"}),r.jsxs(be,{value:x(((S=e==null?void 0:e.voice)==null?void 0:S.provider)||"","voice"),onValueChange:y=>n("voice.provider",y),children:[r.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:r.jsx(xe,{})}),r.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:_.map(y=>r.jsx(ue,{value:y.id,children:y.name},y.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Voice ID"}),r.jsxs(be,{value:((V=e==null?void 0:e.voice)==null?void 0:V.voiceId)||"",onValueChange:y=>n("voice.voiceId",y),children:[r.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:r.jsx(xe,{placeholder:"Select voice..."})}),r.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:k(((z=e==null?void 0:e.voice)==null?void 0:z.provider)||"11labs").map(y=>r.jsx(ue,{value:y.id,children:y.name},y.id))})]})]})]})})]})}),r.jsx(We,{value:"transcriber",className:"space-y-6",children:r.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"flex items-center text-white gap-2",children:[r.jsx(is,{className:"h-5 w-5 text-indigo-400"}),"Transcriber"]})}),r.jsx(Me,{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"STT Provider"}),r.jsxs(be,{value:((Ee=e==null?void 0:e.transcriber)==null?void 0:Ee.provider)||"deepgram",onValueChange:y=>n("transcriber.provider",y),children:[r.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:r.jsx(xe,{})}),r.jsx(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:M.map(y=>r.jsx(ue,{value:y.id,children:y.name},y.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Language"}),r.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",value:(($e=e==null?void 0:e.transcriber)==null?void 0:$e.language)||"en",onChange:y=>n("transcriber.language",y.target.value)})]})]})})]})}),r.jsx(We,{value:"advanced",className:"space-y-6",children:r.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[r.jsx(Pe,{children:r.jsx(Le,{children:"Call Settings"})}),r.jsx(Me,{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Max Duration (sec)"}),r.jsx(ye,{type:"number",className:"bg-white/5 border-white/10 text-white mt-1",value:(e==null?void 0:e.maxDurationSeconds)||600,onChange:y=>n("maxDurationSeconds",parseInt(y.target.value))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium text-white/70",children:"Background Sound"}),r.jsxs(be,{value:(e==null?void 0:e.backgroundSound)||"off",onValueChange:y=>n("backgroundSound",y),children:[r.jsx(_e,{className:"mt-1 bg-white/5 border-white/10 text-white",children:r.jsx(xe,{})}),r.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[r.jsx(ue,{value:"off",children:"Off"}),r.jsx(ue,{value:"office",children:"Office"}),r.jsx(ue,{value:"cafe",children:"Cafe"})]})]})]})]})})]})})]})})]})},lu=({agent:s,details:e,isLoading:t,onEdit:n,getInitials:a})=>{var c,d,m,g,_,M,E,k,b;const i=e&&typeof e=="object"&&"data"in e?e.data:e||{},l=(i==null?void 0:i.llm)||((c=i==null?void 0:i.response_engine)==null?void 0:c.llm_details)||((d=i==null?void 0:i.response_engine)==null?void 0:d.llm)||null;return t?r.jsxs("div",{className:"flex flex-col items-center justify-center py-20 min-h-[400px]",children:[r.jsx(Ot,{className:"h-10 w-10 animate-spin text-orange-500 mb-4"}),r.jsx("p",{className:"text-white/60",children:"Fetching Retell agent details..."})]}):r.jsxs("div",{className:"flex flex-col h-full bg-[#0b0f2e]",children:[r.jsxs("div",{className:"p-8 border-b border-white/10 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsx(tn,{className:"h-20 w-20 ring-4 ring-orange-500/20",children:r.jsx(sn,{className:"text-white bg-gradient-to-br from-orange-500/30 to-red-500/30 text-2xl font-bold",children:a(s.name||(i==null?void 0:i.agent_name)||s.name)})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:(i==null?void 0:i.agent_name)||s.name}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Tt,{variant:"outline",className:"border-orange-500/30 text-orange-400 bg-orange-500/5 px-3 py-1",children:"Retell AI Agent"}),r.jsx("span",{className:"text-sm text-white/40 font-mono",children:(i==null?void 0:i.agent_id)||s.agent_id||s.id})]})]})]}),r.jsxs(Se,{onClick:n,className:"bg-orange-600 hover:bg-orange-700 text-white px-6",children:[r.jsx(js,{className:"h-4 w-4 mr-2"}),"Edit Agent"]})]}),r.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[r.jsxs(Ae,{className:"neo-card bg-white/5 border-white/10",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[r.jsx(js,{className:"h-6 w-6"}),"Core Configuration"]})}),r.jsxs(Me,{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice ID"}),r.jsx("p",{className:"text-white font-medium",children:(i==null?void 0:i.voice_id)||"Not set"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Model"}),r.jsx("p",{className:"text-white font-medium",children:((m=i==null?void 0:i.response_engine)==null?void 0:m.llm_id)||((g=i==null?void 0:i.response_engine)==null?void 0:g.llm)||"Retell LLM"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Language"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(vo,{className:"h-4 w-4 text-white/40"}),r.jsx("p",{className:"text-white",children:((i==null?void 0:i.language)||"en-US").toUpperCase()})]})]})]})]}),r.jsxs(Ae,{className:"neo-card bg-white/5 border-white/10",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[r.jsx(is,{className:"h-6 w-6"}),"Speech & Interaction"]})}),r.jsxs(Me,{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Sensitivity"}),r.jsx("p",{className:"text-white",children:(i==null?void 0:i.interruption_sensitivity)||"Default"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Denoising"}),r.jsx("p",{className:"text-white",children:i!=null&&i.opt_out_sensitive_data_storage?"Enabled":"Disabled"})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Ambient Sound"}),r.jsx("p",{className:"text-white capitalize",children:(i==null?void 0:i.ambient_sound)||"None"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Emotion"}),r.jsx("p",{className:"text-white",children:(i==null?void 0:i.voice_emotion)||"—"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Model"}),r.jsx("p",{className:"text-white",children:(i==null?void 0:i.voice_model)||"—"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Temp"}),r.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.voice_temperature)<"u"?String(i.voice_temperature):"—"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Speed"}),r.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.voice_speed)<"u"?String(i.voice_speed):"—"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Volume"}),r.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.volume)<"u"?String(i.volume):"—"})]})]})]})]}),r.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[r.jsx(Xs,{className:"h-6 w-6"}),"Agent Instructions"]})}),r.jsx(Me,{children:r.jsx("div",{className:"bg-black/20 p-6 rounded-xl border border-white/5 text-white/80 leading-relaxed whitespace-pre-wrap min-h-[150px]",children:l?r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase",children:"General Prompt"}),r.jsx("div",{className:"text-white mt-1",children:l.general_prompt||l.instructions||"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase",children:"Begin Message"}),r.jsx("div",{className:"text-white mt-1",children:l.begin_message||"—"})]})]}):r.jsx("div",{className:"text-white/60",children:((_=i==null?void 0:i.response_engine)==null?void 0:_.instructions)||(i==null?void 0:i.instructions)||"No instructions provided."})})})]}),l&&r.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[r.jsx(kc,{className:"h-5 w-5"}),"LLM Details"]})}),r.jsx(Me,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"LLM ID"}),r.jsx("div",{className:"text-white mt-1",children:l.llm_id||l.llmId||"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Model"}),r.jsx("div",{className:"text-white mt-1",children:l.model||l.llm_model||"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Temperature"}),r.jsx("div",{className:"text-white mt-1",children:typeof l.model_temperature<"u"?String(l.model_temperature):"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Start Speaker"}),r.jsx("div",{className:"text-white mt-1",children:l.start_speaker||"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"KB Config"}),r.jsx("div",{className:"text-white mt-1",children:l.kb_config?`top_k: ${l.kb_config.top_k}, filter_score: ${l.kb_config.filter_score}`:"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Published"}),r.jsx("div",{className:"text-white mt-1",children:l.is_published?"Yes":"No"})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Last Modified"}),r.jsx("div",{className:"text-white mt-1",children:l.last_modification_timestamp?new Date(l.last_modification_timestamp).toLocaleString():l.lastModified?new Date(l.lastModified).toLocaleString():"—"})]})]})})]}),r.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[r.jsx(Cc,{className:"h-5 w-5"}),"Telephony & Call Flow"]})}),r.jsx(Me,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Webhook URL"}),r.jsx("div",{className:"text-white mt-1",children:(i==null?void 0:i.webhook_url)||"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Webhook Timeout"}),r.jsx("div",{className:"text-white mt-1",children:i!=null&&i.webhook_timeout_ms?`${i.webhook_timeout_ms} ms`:"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"IVR Action"}),r.jsx("div",{className:"text-white mt-1",children:((E=(M=i==null?void 0:i.ivr_option)==null?void 0:M.action)==null?void 0:E.type)||"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Action"}),r.jsx("div",{className:"text-white mt-1",children:((b=(k=i==null?void 0:i.voicemail_option)==null?void 0:k.action)==null?void 0:b.type)||"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Message"}),r.jsx("div",{className:"text-white mt-1",children:(i==null?void 0:i.voicemail_message)||"—"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Timeout"}),r.jsx("div",{className:"text-white mt-1",children:i!=null&&i.voicemail_detection_timeout_ms?`${i.voicemail_detection_timeout_ms} ms`:"—"})]})]})})]}),r.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[r.jsx(yo,{className:"h-5 w-5"}),"Post-call Analysis"]})}),r.jsx(Me,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Model"}),r.jsx("div",{className:"text-white",children:(i==null?void 0:i.post_call_analysis_model)||"—"}),r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold mt-2",children:"Analysis Prompts"}),r.jsx("div",{className:"text-white whitespace-pre-wrap mt-1",children:(i==null?void 0:i.analysis_summary_prompt)||"—"}),r.jsx("div",{className:"text-xs text-white/40 uppercase font-bold mt-2",children:"Analysis Data Schema"}),r.jsx("div",{className:"mt-1",children:Array.isArray(i==null?void 0:i.post_call_analysis_data)&&i.post_call_analysis_data.length>0?i.post_call_analysis_data.map((x,p)=>r.jsxs("div",{className:"text-white/90 mb-2",children:[r.jsxs("div",{className:"font-medium",children:[x.name," ",r.jsxs("span",{className:"text-white/60",children:["(",x.type,")"]})]}),r.jsx("div",{className:"text-white/70 text-sm",children:x.description}),Array.isArray(x.examples)&&r.jsxs("div",{className:"text-white/60 text-sm mt-1",children:["Examples: ",x.examples.join(", ")]})]},p)):r.jsx("div",{className:"text-white/60",children:"No post-call data configured."})})]})})]})]})})]})},cu=({isOpen:s,onClose:e,onSuccess:t,agentId:n,initialData:a})=>{var _,M,E,k,b,x,p,T,L,j;const[i,l]=K.useState(!1),[c,d]=K.useState(null);K.useEffect(()=>{var O,D,Y;a&&s&&d({agent_name:a.agent_name||a.name,voice_id:a.voice_id,response_engine:{type:"retell-llm",llm_id:(O=a.response_engine)==null?void 0:O.llm_id,instructions:(D=a.response_engine)==null?void 0:D.instructions},language:m(a),ambient_sound:a.ambient_sound||"none",interruption_sensitivity:a.interruption_sensitivity||.8,llm:a.llm||((Y=a.response_engine)==null?void 0:Y.llm_details)||null})},[a,s]);function m(O){return O.language||O.lang||"en-US"}const g=async O=>{var D,Y,te;O.preventDefault(),l(!0);try{const re={agent_name:c.agent_name,voice_id:c.voice_id,language:c.language,ambient_sound:c.ambient_sound,interruption_sensitivity:c.interruption_sensitivity};if(await Bc(n,re),c.llm&&((D=c.response_engine)!=null&&D.llm_id)){const C=String(c.response_engine.llm_id),G={model:c.llm.model,model_temperature:c.llm.model_temperature,general_prompt:c.llm.general_prompt,begin_message:c.llm.begin_message,start_speaker:c.llm.start_speaker,kb_config:c.llm.kb_config,is_published:typeof c.llm.is_published<"u"?c.llm.is_published:void 0};await $c(C,G)}ee.success("Retell agent updated successfully"),t(),e()}catch(re){console.error("Error updating Retell agent:",re),ee.error(((te=(Y=re.response)==null?void 0:Y.data)==null?void 0:te.message)||"Failed to update Retell agent")}finally{l(!1)}};return c?r.jsx(Zt,{open:s,onOpenChange:e,children:r.jsxs(es,{className:"sm:max-w-[700px] bg-[#0b0f2e] border-white/10 text-white max-h-[90vh] overflow-y-auto neon-fire-scroll",children:[r.jsxs(ts,{children:[r.jsxs(ss,{className:"text-2xl font-bold flex items-center gap-2",children:[r.jsx(js,{className:"h-6 w-6 text-orange-500"}),"Update Retell Agent"]}),r.jsxs(Xc,{className:"text-white/60",children:["Modify configuration for agent: ",c.agent_name]})]}),r.jsxs("form",{onSubmit:g,className:"space-y-6 py-4",children:[r.jsxs(wr,{defaultValue:"general",className:"w-full",children:[r.jsxs(Sr,{className:"bg-white/5 border border-white/10 p-1 w-full grid grid-cols-3",children:[r.jsx(Ye,{value:"general",className:"data-[state=active]:bg-orange-600",children:"General"}),r.jsx(Ye,{value:"voice",className:"data-[state=active]:bg-orange-600",children:"Voice"}),r.jsx(Ye,{value:"llm",className:"data-[state=active]:bg-orange-600",children:"LLM & Prompt"})]}),r.jsxs(We,{value:"general",className:"space-y-4 pt-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{htmlFor:"name",children:"Agent Name"}),r.jsx(ye,{id:"name",value:c.agent_name,onChange:O=>d({...c,agent_name:O.target.value}),className:"bg-white/5 border-white/10 text-white"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{children:"Language"}),r.jsxs(be,{value:c.language,onValueChange:O=>d({...c,language:O}),children:[r.jsx(_e,{className:"bg-white/5 border-white/10",children:r.jsx(xe,{})}),r.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[r.jsx(ue,{value:"en-US",children:"English (US)"}),r.jsx(ue,{value:"en-GB",children:"English (UK)"}),r.jsx(ue,{value:"es-ES",children:"Spanish"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{children:"Ambient Sound"}),r.jsxs(be,{value:c.ambient_sound,onValueChange:O=>d({...c,ambient_sound:O}),children:[r.jsx(_e,{className:"bg-white/5 border-white/10",children:r.jsx(xe,{})}),r.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[r.jsx(ue,{value:"none",children:"None"}),r.jsx(ue,{value:"coffee-shop",children:"Coffee Shop"}),r.jsx(ue,{value:"office",children:"Office"})]})]})]})]})]}),r.jsxs(We,{value:"voice",className:"space-y-4 pt-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{htmlFor:"voiceId",children:"Voice ID"}),r.jsx(ye,{id:"voiceId",value:c.voice_id,onChange:O=>d({...c,voice_id:O.target.value}),className:"bg-white/5 border-white/10 text-white font-mono",placeholder:"e.g. 11labs-Adrian"}),r.jsx("p",{className:"text-[10px] text-white/40",children:"Enter a valid Retell Voice ID or ElevenLabs Voice ID"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{children:"Interruption Sensitivity (0.0 - 1.0)"}),r.jsx(ye,{type:"number",step:"0.1",min:"0",max:"1",value:c.interruption_sensitivity,onChange:O=>d({...c,interruption_sensitivity:parseFloat(O.target.value)}),className:"bg-white/5 border-white/10"})]})]}),r.jsxs(We,{value:"llm",className:"space-y-4 pt-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{children:"Instructions (System Prompt)"}),r.jsx(ht,{value:c.response_engine.instructions||((_=c.llm)==null?void 0:_.general_prompt)||"",onChange:O=>d({...c,response_engine:{...c.response_engine,instructions:O.target.value},llm:{...c.llm,general_prompt:O.target.value}}),className:"bg-white/5 border-white/10 text-white min-h-[120px]",placeholder:"You are an AI assistant..."})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{children:"Begin Message"}),r.jsx(ye,{value:((M=c.llm)==null?void 0:M.begin_message)||"",onChange:O=>d({...c,llm:{...c.llm,begin_message:O.target.value}}),className:"bg-white/5 border-white/10 text-white"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{children:"Model"}),r.jsx(ye,{value:((E=c.llm)==null?void 0:E.model)||"",onChange:O=>d({...c,llm:{...c.llm,model:O.target.value}}),className:"bg-white/5 border-white/10 text-white"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{children:"Temperature"}),r.jsx(ye,{type:"number",step:"0.1",min:"0",max:"2",value:typeof((k=c.llm)==null?void 0:k.model_temperature)<"u"?String(c.llm.model_temperature):"",onChange:O=>d({...c,llm:{...c.llm,model_temperature:parseFloat(O.target.value)}}),className:"bg-white/5 border-white/10"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{children:"Start Speaker"}),r.jsxs(be,{value:((b=c.llm)==null?void 0:b.start_speaker)||"agent",onValueChange:O=>d({...c,llm:{...c.llm,start_speaker:O}}),children:[r.jsx(_e,{className:"bg-white/5 border-white/10",children:r.jsx(xe,{})}),r.jsxs(we,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[r.jsx(ue,{value:"agent",children:"Agent"}),r.jsx(ue,{value:"user",children:"User"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(W,{children:"KB Top K"}),r.jsx(ye,{type:"number",value:((p=(x=c.llm)==null?void 0:x.kb_config)==null?void 0:p.top_k)||"",onChange:O=>{var D;return d({...c,llm:{...c.llm,kb_config:{...((D=c.llm)==null?void 0:D.kb_config)||{},top_k:parseInt(O.target.value||"0")}}})},className:"bg-white/5 border-white/10"})]}),r.jsxs("div",{children:[r.jsx(W,{children:"KB Filter Score"}),r.jsx(ye,{type:"number",step:"0.01",value:((L=(T=c.llm)==null?void 0:T.kb_config)==null?void 0:L.filter_score)||"",onChange:O=>{var D;return d({...c,llm:{...c.llm,kb_config:{...((D=c.llm)==null?void 0:D.kb_config)||{},filter_score:parseFloat(O.target.value||"0")}}})},className:"bg-white/5 border-white/10"})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(W,{children:"Published"}),r.jsx(kt,{checked:!!((j=c.llm)!=null&&j.is_published),onCheckedChange:O=>d({...c,llm:{...c.llm,is_published:O}})})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-white/10",children:[r.jsx(Se,{type:"button",variant:"ghost",onClick:e,disabled:i,children:"Cancel"}),r.jsx(Se,{type:"submit",className:"bg-orange-600 hover:bg-orange-700",disabled:i,children:i?r.jsx(Ot,{className:"mr-2 h-4 w-4 animate-spin"}):"Save Changes"})]})]})]})}):null};var wo={};function Na(s,e){if(s==null)return{};var t,n,a=function(l,c){if(l==null)return{};var d={};for(var m in l)if({}.hasOwnProperty.call(l,m)){if(c.indexOf(m)!==-1)continue;d[m]=l[m]}return d}(s,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(n=0;n<i.length;n++)t=i[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(s,t)&&(a[t]=s[t])}return a}function Ke(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function de(s){return de=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(s)}function So(s){var e=function(t,n){if(de(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var i=a.call(t,n||"default");if(de(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}(s,"string");return de(e)=="symbol"?e:e+""}function Ta(s,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,So(n.key),n)}}function Qe(s,e,t){return e&&Ta(s.prototype,e),t&&Ta(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function pn(s,e){if(e&&(de(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(s)}function at(s){return at=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},at(s)}function ks(s,e){return ks=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},ks(s,e)}function fn(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&ks(s,e)}function ut(s,e,t){return(e=So(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Aa(s,e,t,n,a,i,l){try{var c=s[i](l),d=c.value}catch(m){return void t(m)}c.done?e(d):Promise.resolve(d).then(n,a)}function H(s){return function(){var e=this,t=arguments;return new Promise(function(n,a){var i=s.apply(e,t);function l(d){Aa(i,n,a,l,c,"next",d)}function c(d){Aa(i,n,a,l,c,"throw",d)}l(void 0)})}}function Ma(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=Array(e);t<e;t++)n[t]=s[t];return n}function Re(s,e){return function(t){if(Array.isArray(t))return t}(s)||function(t,n){var a=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(a!=null){var i,l,c,d,m=[],g=!0,_=!1;try{if(c=(a=a.call(t)).next,n===0){if(Object(a)!==a)return;g=!1}else for(;!(g=(i=c.call(a)).done)&&(m.push(i.value),m.length!==n);g=!0);}catch(M){_=!0,l=M}finally{try{if(!g&&a.return!=null&&(d=a.return(),Object(d)!==d))return}finally{if(_)throw l}}return m}}(s,e)||function(t,n){if(t){if(typeof t=="string")return Ma(t,n);var a={}.toString.call(t).slice(8,-1);return a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set"?Array.from(t):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ma(t,n):void 0}}(s,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function uu(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Oa,Is={exports:{}},Gn=function(){if(Oa)return Is.exports;Oa=1;var s,e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(b,x,p){return Function.prototype.apply.call(b,x,p)};s=e&&typeof e.ownKeys=="function"?e.ownKeys:Object.getOwnPropertySymbols?function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:function(b){return Object.getOwnPropertyNames(b)};var n=Number.isNaN||function(b){return b!=b};function a(){a.init.call(this)}Is.exports=a,Is.exports.once=function(b,x){return new Promise(function(p,T){function L(O){b.removeListener(x,j),T(O)}function j(){typeof b.removeListener=="function"&&b.removeListener("error",L),p([].slice.call(arguments))}k(b,x,j,{once:!0}),x!=="error"&&function(O,D,Y){typeof O.on=="function"&&k(O,"error",D,Y)}(b,L,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var i=10;function l(b){if(typeof b!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof b)}function c(b){return b._maxListeners===void 0?a.defaultMaxListeners:b._maxListeners}function d(b,x,p,T){var L,j,O,D;if(l(p),(j=b._events)===void 0?(j=b._events=Object.create(null),b._eventsCount=0):(j.newListener!==void 0&&(b.emit("newListener",x,p.listener?p.listener:p),j=b._events),O=j[x]),O===void 0)O=j[x]=p,++b._eventsCount;else if(typeof O=="function"?O=j[x]=T?[p,O]:[O,p]:T?O.unshift(p):O.push(p),(L=c(b))>0&&O.length>L&&!O.warned){O.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(x)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=b,Y.type=x,Y.count=O.length,D=Y,console&&console.warn&&console.warn(D)}return b}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(b,x,p){var T={fired:!1,wrapFn:void 0,target:b,type:x,listener:p},L=m.bind(T);return L.listener=p,T.wrapFn=L,L}function _(b,x,p){var T=b._events;if(T===void 0)return[];var L=T[x];return L===void 0?[]:typeof L=="function"?p?[L.listener||L]:[L]:p?function(j){for(var O=new Array(j.length),D=0;D<O.length;++D)O[D]=j[D].listener||j[D];return O}(L):E(L,L.length)}function M(b){var x=this._events;if(x!==void 0){var p=x[b];if(typeof p=="function")return 1;if(p!==void 0)return p.length}return 0}function E(b,x){for(var p=new Array(x),T=0;T<x;++T)p[T]=b[T];return p}function k(b,x,p,T){if(typeof b.on=="function")T.once?b.once(x,p):b.on(x,p);else{if(typeof b.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof b);b.addEventListener(x,function L(j){T.once&&b.removeEventListener(x,L),p(j)})}}return Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(b){if(typeof b!="number"||b<0||n(b))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+b+".");i=b}}),a.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(b){if(typeof b!="number"||b<0||n(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(b){for(var x=[],p=1;p<arguments.length;p++)x.push(arguments[p]);var T=b==="error",L=this._events;if(L!==void 0)T=T&&L.error===void 0;else if(!T)return!1;if(T){var j;if(x.length>0&&(j=x[0]),j instanceof Error)throw j;var O=new Error("Unhandled error."+(j?" ("+j.message+")":""));throw O.context=j,O}var D=L[b];if(D===void 0)return!1;if(typeof D=="function")t(D,this,x);else{var Y=D.length,te=E(D,Y);for(p=0;p<Y;++p)t(te[p],this,x)}return!0},a.prototype.addListener=function(b,x){return d(this,b,x,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(b,x){return d(this,b,x,!0)},a.prototype.once=function(b,x){return l(x),this.on(b,g(this,b,x)),this},a.prototype.prependOnceListener=function(b,x){return l(x),this.prependListener(b,g(this,b,x)),this},a.prototype.removeListener=function(b,x){var p,T,L,j,O;if(l(x),(T=this._events)===void 0)return this;if((p=T[b])===void 0)return this;if(p===x||p.listener===x)--this._eventsCount==0?this._events=Object.create(null):(delete T[b],T.removeListener&&this.emit("removeListener",b,p.listener||x));else if(typeof p!="function"){for(L=-1,j=p.length-1;j>=0;j--)if(p[j]===x||p[j].listener===x){O=p[j].listener,L=j;break}if(L<0)return this;L===0?p.shift():function(D,Y){for(;Y+1<D.length;Y++)D[Y]=D[Y+1];D.pop()}(p,L),p.length===1&&(T[b]=p[0]),T.removeListener!==void 0&&this.emit("removeListener",b,O||x)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(b){var x,p,T;if((p=this._events)===void 0)return this;if(p.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):p[b]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete p[b]),this;if(arguments.length===0){var L,j=Object.keys(p);for(T=0;T<j.length;++T)(L=j[T])!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(x=p[b])=="function")this.removeListener(b,x);else if(x!==void 0)for(T=x.length-1;T>=0;T--)this.removeListener(b,x[T]);return this},a.prototype.listeners=function(b){return _(this,b,!0)},a.prototype.rawListeners=function(b){return _(this,b,!1)},a.listenerCount=function(b,x){return typeof b.listenerCount=="function"?b.listenerCount(x):M.call(b,x)},a.prototype.listenerCount=M,a.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]},Is.exports}(),Ps=uu(Gn),Ia=Object.prototype.hasOwnProperty;function Pa(s,e,t){for(t of s.keys())if(Ve(t,e))return t}function Ve(s,e){var t,n,a;if(s===e)return!0;if(s&&e&&(t=s.constructor)===e.constructor){if(t===Date)return s.getTime()===e.getTime();if(t===RegExp)return s.toString()===e.toString();if(t===Array){if((n=s.length)===e.length)for(;n--&&Ve(s[n],e[n]););return n===-1}if(t===Set){if(s.size!==e.size)return!1;for(n of s)if((a=n)&&typeof a=="object"&&!(a=Pa(e,a))||!e.has(a))return!1;return!0}if(t===Map){if(s.size!==e.size)return!1;for(n of s)if((a=n[0])&&typeof a=="object"&&!(a=Pa(e,a))||!Ve(n[1],e.get(a)))return!1;return!0}if(t===ArrayBuffer)s=new Uint8Array(s),e=new Uint8Array(e);else if(t===DataView){if((n=s.byteLength)===e.byteLength)for(;n--&&s.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(s)){if((n=s.byteLength)===e.byteLength)for(;n--&&s[n]===e[n];);return n===-1}if(!t||typeof s=="object"){for(t in n=0,s)if(Ia.call(s,t)&&++n&&!Ia.call(e,t)||!(t in e)||!Ve(s[t],e[t]))return!1;return Object.keys(e).length===n}}return s!=s&&e!=e}const du={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},jo={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},Te={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Fe={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Ct={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class A{static getFirstMatch(e,t){const n=t.match(e);return n&&n.length>0&&n[1]||""}static getSecondMatch(e,t){const n=t.match(e);return n&&n.length>1&&n[2]||""}static matchAndReturnConst(e,t,n){if(e.test(t))return n}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const t=e.split(".").splice(0,2).map(n=>parseInt(n,10)||0);if(t.push(0),t[0]===10)switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const t=e.split(".").splice(0,2).map(n=>parseInt(n,10)||0);if(t.push(0),!(t[0]===1&&t[1]<5))return t[0]===1&&t[1]<6?"Cupcake":t[0]===1&&t[1]>=6?"Donut":t[0]===2&&t[1]<2?"Eclair":t[0]===2&&t[1]===2?"Froyo":t[0]===2&&t[1]>2?"Gingerbread":t[0]===3?"Honeycomb":t[0]===4&&t[1]<1?"Ice Cream Sandwich":t[0]===4&&t[1]<4?"Jelly Bean":t[0]===4&&t[1]>=4?"KitKat":t[0]===5?"Lollipop":t[0]===6?"Marshmallow":t[0]===7?"Nougat":t[0]===8?"Oreo":t[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,n=!1){const a=A.getVersionPrecision(e),i=A.getVersionPrecision(t);let l=Math.max(a,i),c=0;const d=A.map([e,t],m=>{const g=l-A.getVersionPrecision(m),_=m+new Array(g+1).join(".0");return A.map(_.split("."),M=>new Array(20-M.length).join("0")+M).reverse()});for(n&&(c=l-Math.min(a,i)),l-=1;l>=c;){if(d[0][l]>d[1][l])return 1;if(d[0][l]===d[1][l]){if(l===c)return 0;l-=1}else if(d[0][l]<d[1][l])return-1}}static map(e,t){const n=[];let a;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(a=0;a<e.length;a+=1)n.push(t(e[a]));return n}static find(e,t){let n,a;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,a=e.length;n<a;n+=1){const i=e[n];if(t(i,n))return i}}static assign(e,...t){const n=e;let a,i;if(Object.assign)return Object.assign(e,...t);for(a=0,i=t.length;a<i;a+=1){const l=t[a];typeof l=="object"&&l!==null&&Object.keys(l).forEach(c=>{n[c]=l[c]})}return e}static getBrowserAlias(e){return du[e]}static getBrowserTypeByAlias(e){return jo[e]||""}}const fe=/version\/(\d+(\.?_?\d+)+)/i,hu=[{test:[/googlebot/i],describe(s){const e={name:"Googlebot"},t=A.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/opera/i],describe(s){const e={name:"Opera"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/opr\/|opios/i],describe(s){const e={name:"Opera"},t=A.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/SamsungBrowser/i],describe(s){const e={name:"Samsung Internet for Android"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/Whale/i],describe(s){const e={name:"NAVER Whale Browser"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/MZBrowser/i],describe(s){const e={name:"MZ Browser"},t=A.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/focus/i],describe(s){const e={name:"Focus"},t=A.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/swing/i],describe(s){const e={name:"Swing"},t=A.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/coast/i],describe(s){const e={name:"Opera Coast"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(s){const e={name:"Opera Touch"},t=A.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/yabrowser/i],describe(s){const e={name:"Yandex Browser"},t=A.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/ucbrowser/i],describe(s){const e={name:"UC Browser"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/Maxthon|mxios/i],describe(s){const e={name:"Maxthon"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/epiphany/i],describe(s){const e={name:"Epiphany"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/puffin/i],describe(s){const e={name:"Puffin"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/sleipnir/i],describe(s){const e={name:"Sleipnir"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/k-meleon/i],describe(s){const e={name:"K-Meleon"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/micromessenger/i],describe(s){const e={name:"WeChat"},t=A.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/qqbrowser/i],describe(s){const e={name:/qqbrowserlite/i.test(s)?"QQ Browser Lite":"QQ Browser"},t=A.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/msie|trident/i],describe(s){const e={name:"Internet Explorer"},t=A.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/\sedg\//i],describe(s){const e={name:"Microsoft Edge"},t=A.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/edg([ea]|ios)/i],describe(s){const e={name:"Microsoft Edge"},t=A.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/vivaldi/i],describe(s){const e={name:"Vivaldi"},t=A.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/seamonkey/i],describe(s){const e={name:"SeaMonkey"},t=A.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/sailfish/i],describe(s){const e={name:"Sailfish"},t=A.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,s);return t&&(e.version=t),e}},{test:[/silk/i],describe(s){const e={name:"Amazon Silk"},t=A.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/phantom/i],describe(s){const e={name:"PhantomJS"},t=A.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/slimerjs/i],describe(s){const e={name:"SlimerJS"},t=A.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(s){const e={name:"BlackBerry"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/(web|hpw)[o0]s/i],describe(s){const e={name:"WebOS Browser"},t=A.getFirstMatch(fe,s)||A.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/bada/i],describe(s){const e={name:"Bada"},t=A.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/tizen/i],describe(s){const e={name:"Tizen"},t=A.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/qupzilla/i],describe(s){const e={name:"QupZilla"},t=A.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/firefox|iceweasel|fxios/i],describe(s){const e={name:"Firefox"},t=A.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/electron/i],describe(s){const e={name:"Electron"},t=A.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/MiuiBrowser/i],describe(s){const e={name:"Miui"},t=A.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/chromium/i],describe(s){const e={name:"Chromium"},t=A.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,s)||A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/chrome|crios|crmo/i],describe(s){const e={name:"Chrome"},t=A.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/GSA/i],describe(s){const e={name:"Google Search"},t=A.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test(s){const e=!s.test(/like android/i),t=s.test(/android/i);return e&&t},describe(s){const e={name:"Android Browser"},t=A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/playstation 4/i],describe(s){const e={name:"PlayStation 4"},t=A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/safari|applewebkit/i],describe(s){const e={name:"Safari"},t=A.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/.*/i],describe(s){const e=s.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:A.getFirstMatch(e,s),version:A.getSecondMatch(e,s)}}}];var mu=[{test:[/Roku\/DVP/],describe(s){const e=A.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,s);return{name:Fe.Roku,version:e}}},{test:[/windows phone/i],describe(s){const e=A.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,s);return{name:Fe.WindowsPhone,version:e}}},{test:[/windows /i],describe(s){const e=A.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,s),t=A.getWindowsVersionName(e);return{name:Fe.Windows,version:e,versionName:t}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(s){const e={name:Fe.iOS},t=A.getSecondMatch(/(Version\/)(\d[\d.]+)/,s);return t&&(e.version=t),e}},{test:[/macintosh/i],describe(s){const e=A.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,s).replace(/[_\s]/g,"."),t=A.getMacOSVersionName(e),n={name:Fe.MacOS,version:e};return t&&(n.versionName=t),n}},{test:[/(ipod|iphone|ipad)/i],describe(s){const e=A.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,s).replace(/[_\s]/g,".");return{name:Fe.iOS,version:e}}},{test(s){const e=!s.test(/like android/i),t=s.test(/android/i);return e&&t},describe(s){const e=A.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,s),t=A.getAndroidVersionName(e),n={name:Fe.Android,version:e};return t&&(n.versionName=t),n}},{test:[/(web|hpw)[o0]s/i],describe(s){const e=A.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,s),t={name:Fe.WebOS};return e&&e.length&&(t.version=e),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(s){const e=A.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,s)||A.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,s)||A.getFirstMatch(/\bbb(\d+)/i,s);return{name:Fe.BlackBerry,version:e}}},{test:[/bada/i],describe(s){const e=A.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,s);return{name:Fe.Bada,version:e}}},{test:[/tizen/i],describe(s){const e=A.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,s);return{name:Fe.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:Fe.Linux})},{test:[/CrOS/],describe:()=>({name:Fe.ChromeOS})},{test:[/PlayStation 4/],describe(s){const e=A.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,s);return{name:Fe.PlayStation4,version:e}}}],pu=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(s){const e=A.getFirstMatch(/(can-l01)/i,s)&&"Nova",t={type:Te.mobile,vendor:"Huawei"};return e&&(t.model=e),t}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:Te.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:Te.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:Te.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:Te.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:Te.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:Te.tablet})},{test(s){const e=s.test(/ipod|iphone/i),t=s.test(/like (ipod|iphone)/i);return e&&!t},describe(s){const e=A.getFirstMatch(/(ipod|iphone)/i,s);return{type:Te.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:Te.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:Te.mobile})},{test:s=>s.getBrowserName(!0)==="blackberry",describe:()=>({type:Te.mobile,vendor:"BlackBerry"})},{test:s=>s.getBrowserName(!0)==="bada",describe:()=>({type:Te.mobile})},{test:s=>s.getBrowserName()==="windows phone",describe:()=>({type:Te.mobile,vendor:"Microsoft"})},{test(s){const e=Number(String(s.getOSVersion()).split(".")[0]);return s.getOSName(!0)==="android"&&e>=3},describe:()=>({type:Te.tablet})},{test:s=>s.getOSName(!0)==="android",describe:()=>({type:Te.mobile})},{test:s=>s.getOSName(!0)==="macos",describe:()=>({type:Te.desktop,vendor:"Apple"})},{test:s=>s.getOSName(!0)==="windows",describe:()=>({type:Te.desktop})},{test:s=>s.getOSName(!0)==="linux",describe:()=>({type:Te.desktop})},{test:s=>s.getOSName(!0)==="playstation 4",describe:()=>({type:Te.tv})},{test:s=>s.getOSName(!0)==="roku",describe:()=>({type:Te.tv})}],fu=[{test:s=>s.getBrowserName(!0)==="microsoft edge",describe(s){if(/\sedg\//i.test(s))return{name:Ct.Blink};const e=A.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,s);return{name:Ct.EdgeHTML,version:e}}},{test:[/trident/i],describe(s){const e={name:Ct.Trident},t=A.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:s=>s.test(/presto/i),describe(s){const e={name:Ct.Presto},t=A.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test(s){const e=s.test(/gecko/i),t=s.test(/like gecko/i);return e&&!t},describe(s){const e={name:Ct.Gecko},t=A.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:Ct.Blink})},{test:[/(apple)?webkit/i],describe(s){const e={name:Ct.WebKit},t=A.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}}];class La{constructor(e,t=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},t!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=A.find(hu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=A.find(mu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};const e=A.find(pu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=A.find(fu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return A.assign({},this.parsedResult)}satisfies(e){const t={};let n=0;const a={};let i=0;if(Object.keys(e).forEach(l=>{const c=e[l];typeof c=="string"?(a[l]=c,i+=1):typeof c=="object"&&(t[l]=c,n+=1)}),n>0){const l=Object.keys(t),c=A.find(l,m=>this.isOS(m));if(c){const m=this.satisfies(t[c]);if(m!==void 0)return m}const d=A.find(l,m=>this.isPlatform(m));if(d){const m=this.satisfies(t[d]);if(m!==void 0)return m}}if(i>0){const l=Object.keys(a),c=A.find(l,d=>this.isBrowser(d,!0));if(c!==void 0)return this.compareVersion(a[c])}}isBrowser(e,t=!1){const n=this.getBrowserName().toLowerCase();let a=e.toLowerCase();const i=A.getBrowserTypeByAlias(a);return t&&i&&(a=i.toLowerCase()),a===n}compareVersion(e){let t=[0],n=e,a=!1;const i=this.getBrowserVersion();if(typeof i=="string")return e[0]===">"||e[0]==="<"?(n=e.substr(1),e[1]==="="?(a=!0,n=e.substr(2)):t=[],e[0]===">"?t.push(1):t.push(-1)):e[0]==="="?n=e.substr(1):e[0]==="~"&&(a=!0,n=e.substr(1)),t.indexOf(A.compareVersions(i,n,a))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,t=!1){return this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(t=>this.is(t))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class gu{static getParser(e,t=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new La(e,t)}static parse(e){return new La(e).getResult()}static get BROWSER_MAP(){return jo}static get ENGINE_MAP(){return Ct}static get OS_MAP(){return Fe}static get PLATFORMS_MAP(){return Te}}function gn(){return Date.now()+Math.random().toString()}function ps(){throw new Error("Method must be implemented in subclass")}function ko(s,e){return e!=null&&e.proxyUrl?e.proxyUrl+(e.proxyUrl.slice(-1)==="/"?"":"/")+s.substring(8):s}function nn(s){return s!=null&&s.callObjectBundleUrlOverride?s.callObjectBundleUrlOverride:ko("https://c.daily.co/call-machine/versioned/".concat("0.80.0","/static/call-machine-object-bundle.js"),s)}function rn(s){try{new URL(s)}catch{return!1}return!0}const ve=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Ut="8.55.0",me=globalThis;function an(s,e,t){const n=me,a=n.__SENTRY__=n.__SENTRY__||{},i=a[Ut]=a[Ut]||{};return i[s]||(i[s]=e())}const Wt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,zn=["debug","info","warn","error","log","assert","trace"],on={};function Es(s){if(!("console"in me))return s();const e=me.console,t={},n=Object.keys(on);n.forEach(a=>{const i=on[a];t[a]=e[a],e[a]=i});try{return s()}finally{n.forEach(a=>{e[a]=t[a]})}}const Q=an("logger",function(){let s=!1;const e={enable:()=>{s=!0},disable:()=>{s=!1},isEnabled:()=>s};return Wt?zn.forEach(t=>{e[t]=(...n)=>{s&&Es(()=>{me.console[t](`Sentry Logger [${t}]:`,...n)})}}):zn.forEach(t=>{e[t]=()=>{}}),e}),qt="?",Da=/\(error: (.*)\)/,Ra=/captureMessage|captureException/;function Ls(s){return s[s.length-1]||{}}const Fa="<anonymous>";function It(s){try{return s&&typeof s=="function"&&s.name||Fa}catch{return Fa}}function Va(s){const e=s.exception;if(e){const t=[];try{return e.values.forEach(n=>{n.stacktrace.frames&&t.push(...n.stacktrace.frames)}),t}catch{return}}}const zs={},qa={};function Bt(s,e){zs[s]=zs[s]||[],zs[s].push(e)}function $t(s,e){if(!qa[s]){qa[s]=!0;try{e()}catch(t){Wt&&Q.error(`Error while instrumenting ${s}`,t)}}}function rt(s,e){const t=s&&zs[s];if(t)for(const n of t)try{n(e)}catch(a){Wt&&Q.error(`Error while triggering instrumentation handler.
Type: ${s}
Name: ${It(n)}
Error:`,a)}}let kn=null;function vu(){kn=me.onerror,me.onerror=function(s,e,t,n,a){return rt("error",{column:n,error:a,line:t,msg:s,url:e}),!!kn&&kn.apply(this,arguments)},me.onerror.__SENTRY_INSTRUMENTED__=!0}let Cn=null;function yu(){Cn=me.onunhandledrejection,me.onunhandledrejection=function(s){return rt("unhandledrejection",s),!Cn||Cn.apply(this,arguments)},me.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function vn(){return jr(me),me}function jr(s){const e=s.__SENTRY__=s.__SENTRY__||{};return e.version=e.version||Ut,e[Ut]=e[Ut]||{}}const Co=Object.prototype.toString;function kr(s){switch(Co.call(s)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Jt(s,Error)}}function hs(s,e){return Co.call(s)===`[object ${e}]`}function Eo(s){return hs(s,"ErrorEvent")}function Ua(s){return hs(s,"DOMError")}function gt(s){return hs(s,"String")}function Cr(s){return typeof s=="object"&&s!==null&&"__sentry_template_string__"in s&&"__sentry_template_values__"in s}function Yn(s){return s===null||Cr(s)||typeof s!="object"&&typeof s!="function"}function os(s){return hs(s,"Object")}function yn(s){return typeof Event<"u"&&Jt(s,Event)}function bn(s){return!!(s&&s.then&&typeof s.then=="function")}function Jt(s,e){try{return s instanceof e}catch{return!1}}function No(s){return!(typeof s!="object"||s===null||!s.__isVue&&!s._isVue)}const Er=me;function To(s,e={}){if(!s)return"<unknown>";try{let t=s;const n=5,a=[];let i=0,l=0;const c=" > ",d=c.length;let m;const g=Array.isArray(e)?e:e.keyAttrs,_=!Array.isArray(e)&&e.maxStringLength||80;for(;t&&i++<n&&(m=bu(t,g),!(m==="html"||i>1&&l+a.length*d+m.length>=_));)a.push(m),l+=m.length,t=t.parentNode;return a.reverse().join(c)}catch{return"<unknown>"}}function bu(s,e){const t=s,n=[];if(!t||!t.tagName)return"";if(Er.HTMLElement&&t instanceof HTMLElement&&t.dataset){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}n.push(t.tagName.toLowerCase());const a=e&&e.length?e.filter(l=>t.getAttribute(l)).map(l=>[l,t.getAttribute(l)]):null;if(a&&a.length)a.forEach(l=>{n.push(`[${l[0]}="${l[1]}"]`)});else{t.id&&n.push(`#${t.id}`);const l=t.className;if(l&&gt(l)){const c=l.split(/\s+/);for(const d of c)n.push(`.${d}`)}}const i=["aria-label","type","name","title","alt"];for(const l of i){const c=t.getAttribute(l);c&&n.push(`[${l}="${c}"]`)}return n.join("")}function ns(s,e=0){return typeof s!="string"||e===0||s.length<=e?s:`${s.slice(0,e)}...`}function Ba(s,e){if(!Array.isArray(s))return"";const t=[];for(let n=0;n<s.length;n++){const a=s[n];try{No(a)?t.push("[VueViewModel]"):t.push(String(a))}catch{t.push("[value cannot be serialized]")}}return t.join(e)}function _u(s,e,t=!1){return!!gt(s)&&(hs(e,"RegExp")?e.test(s):!!gt(e)&&(t?s===e:s.includes(e)))}function Ds(s,e=[],t=!1){return e.some(n=>_u(s,n,t))}function He(s,e,t){if(!(e in s))return;const n=s[e],a=t(n);typeof a=="function"&&Ao(a,n);try{s[e]=a}catch{Wt&&Q.log(`Failed to replace method "${e}" in object`,s)}}function Gt(s,e,t){try{Object.defineProperty(s,e,{value:t,writable:!0,configurable:!0})}catch{Wt&&Q.log(`Failed to add non-enumerable property "${e}" to object`,s)}}function Ao(s,e){try{const t=e.prototype||{};s.prototype=e.prototype=t,Gt(s,"__sentry_original__",e)}catch{}}function Nr(s){return s.__sentry_original__}function Mo(s){if(kr(s))return{message:s.message,name:s.name,stack:s.stack,...Ja(s)};if(yn(s)){const e={type:s.type,target:$a(s.target),currentTarget:$a(s.currentTarget),...Ja(s)};return typeof CustomEvent<"u"&&Jt(s,CustomEvent)&&(e.detail=s.detail),e}return s}function $a(s){try{return e=s,typeof Element<"u"&&Jt(e,Element)?To(s):Object.prototype.toString.call(s)}catch{return"<unknown>"}var e}function Ja(s){if(typeof s=="object"&&s!==null){const e={};for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t]);return e}return{}}function Ze(s){return Wn(s,new Map)}function Wn(s,e){if(function(t){if(!os(t))return!1;try{const n=Object.getPrototypeOf(t).constructor.name;return!n||n==="Object"}catch{return!0}}(s)){const t=e.get(s);if(t!==void 0)return t;const n={};e.set(s,n);for(const a of Object.getOwnPropertyNames(s))s[a]!==void 0&&(n[a]=Wn(s[a],e));return n}if(Array.isArray(s)){const t=e.get(s);if(t!==void 0)return t;const n=[];return e.set(s,n),s.forEach(a=>{n.push(Wn(a,e))}),n}return s}function Ns(){return Date.now()/1e3}const yt=function(){const{performance:s}=me;if(!s||!s.now)return Ns;const e=Date.now()-s.now(),t=s.timeOrigin==null?e:s.timeOrigin;return()=>(t+s.now())/1e3}();function et(){const s=me,e=s.crypto||s.msCrypto;let t=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(t=()=>{const n=new Uint8Array(1);return e.getRandomValues(n),n[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,n=>(n^(15&t())>>n/4).toString(16))}function Oo(s){return s.exception&&s.exception.values?s.exception.values[0]:void 0}function Nt(s){const{message:e,event_id:t}=s;if(e)return e;const n=Oo(s);return n?n.type&&n.value?`${n.type}: ${n.value}`:n.type||n.value||t||"<unknown>":t||"<unknown>"}function Hn(s,e,t){const n=s.exception=s.exception||{},a=n.values=n.values||[],i=a[0]=a[0]||{};i.value||(i.value=e||""),i.type||(i.type="Error")}function ls(s,e){const t=Oo(s);if(!t)return;const n=t.mechanism;if(t.mechanism={type:"generic",handled:!0,...n,...e},e&&"data"in e){const a={...n&&n.data,...e.data};t.mechanism.data=a}}function Ga(s){if(function(e){try{return e.__sentry_captured__}catch{}}(s))return!0;try{Gt(s,"__sentry_captured__",!0)}catch{}return!1}var mt;function zt(s){return new Xe(e=>{e(s)})}function ln(s){return new Xe((e,t)=>{t(s)})}(()=>{const{performance:s}=me;!s||!s.now||(s.now(),s.timing&&s.timing.navigationStart)})(),function(s){s[s.PENDING=0]="PENDING",s[s.RESOLVED=1]="RESOLVED",s[s.REJECTED=2]="REJECTED"}(mt||(mt={}));class Xe{constructor(e){Xe.prototype.__init.call(this),Xe.prototype.__init2.call(this),Xe.prototype.__init3.call(this),Xe.prototype.__init4.call(this),this._state=mt.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(t){this._reject(t)}}then(e,t){return new Xe((n,a)=>{this._handlers.push([!1,i=>{if(e)try{n(e(i))}catch(l){a(l)}else n(i)},i=>{if(t)try{n(t(i))}catch(l){a(l)}else a(i)}]),this._executeHandlers()})}catch(e){return this.then(t=>t,e)}finally(e){return new Xe((t,n)=>{let a,i;return this.then(l=>{i=!1,a=l,e&&e()},l=>{i=!0,a=l,e&&e()}).then(()=>{i?n(a):t(a)})})}__init(){this._resolve=e=>{this._setResult(mt.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(mt.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===mt.PENDING&&(bn(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===mt.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(t=>{t[0]||(this._state===mt.RESOLVED&&t[1](this._value),this._state===mt.REJECTED&&t[2](this._value),t[0]=!0)})}}}function xu(s){const e=yt(),t={sid:et(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(n){return Ze({sid:`${n.sid}`,init:n.init,started:new Date(1e3*n.started).toISOString(),timestamp:new Date(1e3*n.timestamp).toISOString(),status:n.status,errors:n.errors,did:typeof n.did=="number"||typeof n.did=="string"?`${n.did}`:void 0,duration:n.duration,abnormal_mechanism:n.abnormal_mechanism,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}})}(t)};return s&&cs(t,s),t}function cs(s,e={}){if(e.user&&(!s.ipAddress&&e.user.ip_address&&(s.ipAddress=e.user.ip_address),s.did||e.did||(s.did=e.user.id||e.user.email||e.user.username)),s.timestamp=e.timestamp||yt(),e.abnormal_mechanism&&(s.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(s.ignoreDuration=e.ignoreDuration),e.sid&&(s.sid=e.sid.length===32?e.sid:et()),e.init!==void 0&&(s.init=e.init),!s.did&&e.did&&(s.did=`${e.did}`),typeof e.started=="number"&&(s.started=e.started),s.ignoreDuration)s.duration=void 0;else if(typeof e.duration=="number")s.duration=e.duration;else{const t=s.timestamp-s.started;s.duration=t>=0?t:0}e.release&&(s.release=e.release),e.environment&&(s.environment=e.environment),!s.ipAddress&&e.ipAddress&&(s.ipAddress=e.ipAddress),!s.userAgent&&e.userAgent&&(s.userAgent=e.userAgent),typeof e.errors=="number"&&(s.errors=e.errors),e.status&&(s.status=e.status)}function za(){return et()}function Kn(){return et().substring(16)}function _n(s,e,t=2){if(!e||typeof e!="object"||t<=0)return e;if(s&&e&&Object.keys(e).length===0)return s;const n={...s};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=_n(n[a],e[a],t-1));return n}const Qn="_sentrySpan";function Ya(s,e){e?Gt(s,Qn,e):delete s[Qn]}function Wa(s){return s[Qn]}class Tr{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:za(),spanId:Kn()}}clone(){const e=new Tr;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Ya(e,Wa(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&cs(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return t===null?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t=typeof e=="function"?e(this):e,[n,a]=t instanceof Pt?[t.getScopeData(),t.getRequestSession()]:os(t)?[e,e.requestSession]:[],{tags:i,extra:l,user:c,contexts:d,level:m,fingerprint:g=[],propagationContext:_}=n||{};return this._tags={...this._tags,...i},this._extra={...this._extra,...l},this._contexts={...this._contexts,...d},c&&Object.keys(c).length&&(this._user=c),m&&(this._level=m),g.length&&(this._fingerprint=g),_&&(this._propagationContext=_),a&&(this._requestSession=a),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Ya(this,void 0),this._attachments=[],this.setPropagationContext({traceId:za()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const n=typeof t=="number"?t:100;if(n<=0)return this;const a={timestamp:Ns(),...e};return this._breadcrumbs.push(a),this._breadcrumbs.length>n&&(this._breadcrumbs=this._breadcrumbs.slice(-n),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Wa(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=_n(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:Kn(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,t){const n=t&&t.event_id?t.event_id:et();if(!this._client)return Q.warn("No client configured on scope - will not capture exception!"),n;const a=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:a,...t,event_id:n},this),n}captureMessage(e,t,n){const a=n&&n.event_id?n.event_id:et();if(!this._client)return Q.warn("No client configured on scope - will not capture message!"),a;const i=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:i,...n,event_id:a},this),a}captureEvent(e,t){const n=t&&t.event_id?t.event_id:et();return this._client?(this._client.captureEvent(e,{...t,event_id:n},this),n):(Q.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const Pt=Tr;class wu{constructor(e,t){let n,a;n=e||new Pt,a=t||new Pt,this._stack=[{scope:n}],this._isolationScope=a}withScope(e){const t=this._pushScope();let n;try{n=e(t)}catch(a){throw this._popScope(),a}return bn(n)?n.then(a=>(this._popScope(),a),a=>{throw this._popScope(),a}):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function us(){const s=jr(vn());return s.stack=s.stack||new wu(an("defaultCurrentScope",()=>new Pt),an("defaultIsolationScope",()=>new Pt))}function Su(s){return us().withScope(s)}function ju(s,e){const t=us();return t.withScope(()=>(t.getStackTop().scope=s,e(s)))}function Ha(s){return us().withScope(()=>s(us().getIsolationScope()))}function Ar(s){const e=jr(s);return e.acs?e.acs:{withIsolationScope:Ha,withScope:Su,withSetScope:ju,withSetIsolationScope:(t,n)=>Ha(n),getCurrentScope:()=>us().getScope(),getIsolationScope:()=>us().getIsolationScope()}}function Ht(){return Ar(vn()).getCurrentScope()}function Ts(){return Ar(vn()).getIsolationScope()}function De(){return Ht().getClient()}function ku(s){const e=s.getPropagationContext(),{traceId:t,spanId:n,parentSpanId:a}=e;return Ze({trace_id:t,span_id:n,parent_span_id:a})}function Cu(s){const e=s._sentryMetrics;if(!e)return;const t={};for(const[,[n,a]]of e)(t[n]||(t[n]=[])).push(Ze(a));return t}const Eu=/^sentry-/;function Nu(s){const e=function(n){if(!(!n||!gt(n)&&!Array.isArray(n)))return Array.isArray(n)?n.reduce((a,i)=>{const l=Ka(i);return Object.entries(l).forEach(([c,d])=>{a[c]=d}),a},{}):Ka(n)}(s);if(!e)return;const t=Object.entries(e).reduce((n,[a,i])=>(a.match(Eu)&&(n[a.slice(7)]=i),n),{});return Object.keys(t).length>0?t:void 0}function Ka(s){return s.split(",").map(e=>e.split("=").map(t=>decodeURIComponent(t.trim()))).reduce((e,[t,n])=>(t&&n&&(e[t]=n),e),{})}let Qa=!1;function Tu(s){const{spanId:e,traceId:t,isRemote:n}=s.spanContext();return Ze({parent_span_id:n?e:Mr(s).parent_span_id,span_id:n?Kn():e,trace_id:t})}function Xa(s){return typeof s=="number"?Za(s):Array.isArray(s)?s[0]+s[1]/1e9:s instanceof Date?Za(s.getTime()):yt()}function Za(s){return s>9999999999?s/1e3:s}function Mr(s){if(function(e){return typeof e.getSpanJSON=="function"}(s))return s.getSpanJSON();try{const{spanId:e,traceId:t}=s.spanContext();if(function(n){const a=n;return!!(a.attributes&&a.startTime&&a.name&&a.endTime&&a.status)}(s)){const{attributes:n,startTime:a,name:i,endTime:l,parentSpanId:c,status:d}=s;return Ze({span_id:e,trace_id:t,data:n,description:i,parent_span_id:c,start_timestamp:Xa(a),timestamp:Xa(l)||void 0,status:Au(d),op:n["sentry.op"],origin:n["sentry.origin"],_metrics_summary:Cu(s)})}return{span_id:e,trace_id:t}}catch{return{}}}function Au(s){if(s&&s.code!==0)return s.code===1?"ok":s.message||"unknown_error"}function Io(s){return s._sentryRootSpan||s}function Mu(){Qa||(Es(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")}),Qa=!0)}const Or="production";function Po(s,e){const t=e.getOptions(),{publicKey:n}=e.getDsn()||{},a=Ze({environment:t.environment||Or,release:t.release,public_key:n,trace_id:s});return e.emit("createDsc",a),a}function Ou(s){const e=De();if(!e)return{};const t=Io(s),n=t._frozenDsc;if(n)return n;const a=t.spanContext().traceState,i=a&&a.get("sentry.dsc"),l=i&&Nu(i);if(l)return l;const c=Po(s.spanContext().traceId,e),d=Mr(t),m=d.data||{},g=m["sentry.sample_rate"];g!=null&&(c.sample_rate=`${g}`);const _=m["sentry.source"],M=d.description;return _!=="url"&&M&&(c.transaction=M),function(E){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const k=De(),b=k&&k.getOptions();return!!b&&(b.enableTracing||"tracesSampleRate"in b||"tracesSampler"in b)}()&&(c.sampled=String(function(E){const{traceFlags:k}=E.spanContext();return k===1}(t))),e.emit("createDsc",c,t),c}const Iu=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function cn(s,e=!1){const{host:t,path:n,pass:a,port:i,projectId:l,protocol:c,publicKey:d}=s;return`${c}://${d}${e&&a?`:${a}`:""}@${t}${i?`:${i}`:""}/${n&&`${n}/`}${l}`}function ei(s){return{protocol:s.protocol,publicKey:s.publicKey||"",pass:s.pass||"",host:s.host,port:s.port||"",path:s.path||"",projectId:s.projectId}}function Pu(s){const e=typeof s=="string"?function(t){const n=Iu.exec(t);if(!n)return void Es(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});const[a,i,l="",c="",d="",m=""]=n.slice(1);let g="",_=m;const M=_.split("/");if(M.length>1&&(g=M.slice(0,-1).join("/"),_=M.pop()),_){const E=_.match(/^\d+/);E&&(_=E[0])}return ei({host:c,pass:l,path:g,projectId:_,port:d,protocol:a,publicKey:i})}(s):ei(s);if(e&&function(t){if(!Wt)return!0;const{port:n,projectId:a,protocol:i}=t;return!(["protocol","publicKey","host","projectId"].find(l=>!t[l]&&(Q.error(`Invalid Sentry Dsn: ${l} missing`),!0))||(a.match(/^\d+$/)?function(l){return l==="http"||l==="https"}(i)?n&&isNaN(parseInt(n,10))&&(Q.error(`Invalid Sentry Dsn: Invalid port ${n}`),1):(Q.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),1):(Q.error(`Invalid Sentry Dsn: Invalid projectId ${a}`),1)))}(e))return e}function pt(s,e=100,t=1/0){try{return Xn("",s,e,t)}catch(n){return{ERROR:`**non-serializable** (${n})`}}}function Lo(s,e=3,t=102400){const n=pt(s,e);return a=n,function(i){return~-encodeURI(i).split(/%..|./).length}(JSON.stringify(a))>t?Lo(s,e-1,t):n;var a}function Xn(s,e,t=1/0,n=1/0,a=function(){const i=typeof WeakSet=="function",l=i?new WeakSet:[];return[function(c){if(i)return!!l.has(c)||(l.add(c),!1);for(let d=0;d<l.length;d++)if(l[d]===c)return!0;return l.push(c),!1},function(c){if(i)l.delete(c);else for(let d=0;d<l.length;d++)if(l[d]===c){l.splice(d,1);break}}]}()){const[i,l]=a;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const c=function(E,k){try{if(E==="domain"&&k&&typeof k=="object"&&k._events)return"[Domain]";if(E==="domainEmitter")return"[DomainEmitter]";if(typeof globalThis<"u"&&k===globalThis)return"[Global]";if(typeof window<"u"&&k===window)return"[Window]";if(typeof document<"u"&&k===document)return"[Document]";if(No(k))return"[VueViewModel]";if(os(b=k)&&"nativeEvent"in b&&"preventDefault"in b&&"stopPropagation"in b)return"[SyntheticEvent]";if(typeof k=="number"&&!Number.isFinite(k))return`[${k}]`;if(typeof k=="function")return`[Function: ${It(k)}]`;if(typeof k=="symbol")return`[${String(k)}]`;if(typeof k=="bigint")return`[BigInt: ${String(k)}]`;const x=function(p){const T=Object.getPrototypeOf(p);return T?T.constructor.name:"null prototype"}(k);return/^HTML(\w*)Element$/.test(x)?`[HTMLElement: ${x}]`:`[object ${x}]`}catch(x){return`**non-serializable** (${x})`}var b}(s,e);if(!c.startsWith("[object "))return c;if(e.__sentry_skip_normalization__)return e;const d=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:t;if(d===0)return c.replace("object ","");if(i(e))return"[Circular ~]";const m=e;if(m&&typeof m.toJSON=="function")try{return Xn("",m.toJSON(),d-1,n,a)}catch{}const g=Array.isArray(e)?[]:{};let _=0;const M=Mo(e);for(const E in M){if(!Object.prototype.hasOwnProperty.call(M,E))continue;if(_>=n){g[E]="[MaxProperties ~]";break}const k=M[E];g[E]=Xn(E,k,d-1,n,a),_++}return l(e),g}function Cs(s,e=[]){return[s,e]}function Lu(s,e){const[t,n]=s;return[t,[...n,e]]}function ti(s,e){const t=s[1];for(const n of t)if(e(n,n[0].type))return!0;return!1}function Zn(s){return me.__SENTRY__&&me.__SENTRY__.encodePolyfill?me.__SENTRY__.encodePolyfill(s):new TextEncoder().encode(s)}function Du(s){const[e,t]=s;let n=JSON.stringify(e);function a(i){typeof n=="string"?n=typeof i=="string"?n+i:[Zn(n),i]:n.push(typeof i=="string"?Zn(i):i)}for(const i of t){const[l,c]=i;if(a(`
${JSON.stringify(l)}
`),typeof c=="string"||c instanceof Uint8Array)a(c);else{let d;try{d=JSON.stringify(c)}catch{d=JSON.stringify(pt(c))}a(d)}}return typeof n=="string"?n:function(i){const l=i.reduce((m,g)=>m+g.length,0),c=new Uint8Array(l);let d=0;for(const m of i)c.set(m,d),d+=m.length;return c}(n)}function Ru(s){const e=typeof s.data=="string"?Zn(s.data):s.data;return[Ze({type:"attachment",length:e.length,filename:s.filename,content_type:s.contentType,attachment_type:s.attachmentType}),e]}const Fu={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function si(s){return Fu[s]}function Do(s){if(!s||!s.sdk)return;const{name:e,version:t}=s.sdk;return{name:e,version:t}}function Vu(s,e,t,n){const a=Do(t),i=s.type&&s.type!=="replay_event"?s.type:"event";(function(c,d){d&&(c.sdk=c.sdk||{},c.sdk.name=c.sdk.name||d.name,c.sdk.version=c.sdk.version||d.version,c.sdk.integrations=[...c.sdk.integrations||[],...d.integrations||[]],c.sdk.packages=[...c.sdk.packages||[],...d.packages||[]])})(s,t&&t.sdk);const l=function(c,d,m,g){const _=c.sdkProcessingMetadata&&c.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:c.event_id,sent_at:new Date().toISOString(),...d&&{sdk:d},...!!m&&g&&{dsn:cn(g)},..._&&{trace:Ze({..._})}}}(s,a,n,e);return delete s.sdkProcessingMetadata,Cs(l,[[{type:i},s]])}function er(s,e,t,n=0){return new Xe((a,i)=>{const l=s[n];if(e===null||typeof l!="function")a(e);else{const c=l({...e},t);ve&&l.id&&c===null&&Q.log(`Event processor "${l.id}" dropped event`),bn(c)?c.then(d=>er(s,d,t,n+1).then(a)).then(null,i):er(s,c,t,n+1).then(a).then(null,i)}})}let Rs,ni,En;function qu(s,e){const{fingerprint:t,span:n,breadcrumbs:a,sdkProcessingMetadata:i}=e;(function(l,c){const{extra:d,tags:m,user:g,contexts:_,level:M,transactionName:E}=c,k=Ze(d);k&&Object.keys(k).length&&(l.extra={...k,...l.extra});const b=Ze(m);b&&Object.keys(b).length&&(l.tags={...b,...l.tags});const x=Ze(g);x&&Object.keys(x).length&&(l.user={...x,...l.user});const p=Ze(_);p&&Object.keys(p).length&&(l.contexts={...p,...l.contexts}),M&&(l.level=M),E&&l.type!=="transaction"&&(l.transaction=E)})(s,e),n&&function(l,c){l.contexts={trace:Tu(c),...l.contexts},l.sdkProcessingMetadata={dynamicSamplingContext:Ou(c),...l.sdkProcessingMetadata};const d=Io(c),m=Mr(d).description;m&&!l.transaction&&l.type==="transaction"&&(l.transaction=m)}(s,n),function(l,c){l.fingerprint=l.fingerprint?Array.isArray(l.fingerprint)?l.fingerprint:[l.fingerprint]:[],c&&(l.fingerprint=l.fingerprint.concat(c)),l.fingerprint&&!l.fingerprint.length&&delete l.fingerprint}(s,t),function(l,c){const d=[...l.breadcrumbs||[],...c];l.breadcrumbs=d.length?d:void 0}(s,a),function(l,c){l.sdkProcessingMetadata={...l.sdkProcessingMetadata,...c}}(s,i)}function ri(s,e){const{extra:t,tags:n,user:a,contexts:i,level:l,sdkProcessingMetadata:c,breadcrumbs:d,fingerprint:m,eventProcessors:g,attachments:_,propagationContext:M,transactionName:E,span:k}=e;Fs(s,"extra",t),Fs(s,"tags",n),Fs(s,"user",a),Fs(s,"contexts",i),s.sdkProcessingMetadata=_n(s.sdkProcessingMetadata,c,2),l&&(s.level=l),E&&(s.transactionName=E),k&&(s.span=k),d.length&&(s.breadcrumbs=[...s.breadcrumbs,...d]),m.length&&(s.fingerprint=[...s.fingerprint,...m]),g.length&&(s.eventProcessors=[...s.eventProcessors,...g]),_.length&&(s.attachments=[...s.attachments,..._]),s.propagationContext={...s.propagationContext,...M}}function Fs(s,e,t){s[e]=_n(s[e],t,1)}function Uu(s,e,t,n,a,i){const{normalizeDepth:l=3,normalizeMaxBreadth:c=1e3}=s,d={...e,event_id:e.event_id||t.event_id||et(),timestamp:e.timestamp||Ns()},m=t.integrations||s.integrations.map(k=>k.name);(function(k,b){const{environment:x,release:p,dist:T,maxValueLength:L=250}=b;k.environment=k.environment||x||Or,!k.release&&p&&(k.release=p),!k.dist&&T&&(k.dist=T),k.message&&(k.message=ns(k.message,L));const j=k.exception&&k.exception.values&&k.exception.values[0];j&&j.value&&(j.value=ns(j.value,L));const O=k.request;O&&O.url&&(O.url=ns(O.url,L))})(d,s),function(k,b){b.length>0&&(k.sdk=k.sdk||{},k.sdk.integrations=[...k.sdk.integrations||[],...b])}(d,m),a&&a.emit("applyFrameMetadata",e),e.type===void 0&&function(k,b){const x=function(p){const T=me._sentryDebugIds;if(!T)return{};const L=Object.keys(T);return En&&L.length===ni||(ni=L.length,En=L.reduce((j,O)=>{Rs||(Rs={});const D=Rs[O];if(D)j[D[0]]=D[1];else{const Y=p(O);for(let te=Y.length-1;te>=0;te--){const re=Y[te],C=re&&re.filename,G=T[O];if(C&&G){j[C]=G,Rs[O]=[C,G];break}}}return j},{})),En}(b);try{k.exception.values.forEach(p=>{p.stacktrace.frames.forEach(T=>{x&&T.filename&&(T.debug_id=x[T.filename])})})}catch{}}(d,s.stackParser);const g=function(k,b){if(!b)return k;const x=k?k.clone():new Pt;return x.update(b),x}(n,t.captureContext);t.mechanism&&ls(d,t.mechanism);const _=a?a.getEventProcessors():[],M=an("globalScope",()=>new Pt).getScopeData();i&&ri(M,i.getScopeData()),g&&ri(M,g.getScopeData());const E=[...t.attachments||[],...M.attachments];return E.length&&(t.attachments=E),qu(d,M),er([..._,...M.eventProcessors],d,t).then(k=>(k&&function(b){const x={};try{b.exception.values.forEach(T=>{T.stacktrace.frames.forEach(L=>{L.debug_id&&(L.abs_path?x[L.abs_path]=L.debug_id:L.filename&&(x[L.filename]=L.debug_id),delete L.debug_id)})})}catch{}if(Object.keys(x).length===0)return;b.debug_meta=b.debug_meta||{},b.debug_meta.images=b.debug_meta.images||[];const p=b.debug_meta.images;Object.entries(x).forEach(([T,L])=>{p.push({type:"sourcemap",code_file:T,debug_id:L})})}(k),typeof l=="number"&&l>0?function(b,x,p){if(!b)return null;const T={...b,...b.breadcrumbs&&{breadcrumbs:b.breadcrumbs.map(L=>({...L,...L.data&&{data:pt(L.data,x,p)}}))},...b.user&&{user:pt(b.user,x,p)},...b.contexts&&{contexts:pt(b.contexts,x,p)},...b.extra&&{extra:pt(b.extra,x,p)}};return b.contexts&&b.contexts.trace&&T.contexts&&(T.contexts.trace=b.contexts.trace,b.contexts.trace.data&&(T.contexts.trace.data=pt(b.contexts.trace.data,x,p))),b.spans&&(T.spans=b.spans.map(L=>({...L,...L.data&&{data:pt(L.data,x,p)}}))),b.contexts&&b.contexts.flags&&T.contexts&&(T.contexts.flags=pt(b.contexts.flags,3,p)),T}(k,l,c):k))}function ai(s,e){return Ht().captureEvent(s,e)}function ii(s){const e=De(),t=Ts(),n=Ht(),{release:a,environment:i=Or}=e&&e.getOptions()||{},{userAgent:l}=me.navigator||{},c=xu({release:a,environment:i,user:n.getUser()||t.getUser(),...l&&{userAgent:l},...s}),d=t.getSession();return d&&d.status==="ok"&&cs(d,{status:"exited"}),Ro(),t.setSession(c),n.setSession(c),c}function Ro(){const s=Ts(),e=Ht(),t=e.getSession()||s.getSession();t&&function(n,a){let i={};n.status==="ok"&&(i={status:"exited"}),cs(n,i)}(t),Fo(),s.setSession(),e.setSession()}function Fo(){const s=Ts(),e=Ht(),t=De(),n=e.getSession()||s.getSession();n&&t&&t.captureSession(n)}function oi(s=!1){s?Ro():Fo()}function Bu(s,e,t){return e||`${function(n){return`${function(a){const i=a.protocol?`${a.protocol}:`:"",l=a.port?`:${a.port}`:"";return`${i}//${a.host}${l}${a.path?`/${a.path}`:""}/api/`}(n)}${n.projectId}/envelope/`}(s)}?${function(n,a){const i={sentry_version:"7"};return n.publicKey&&(i.sentry_key=n.publicKey),a&&(i.sentry_client=`${a.name}/${a.version}`),new URLSearchParams(i).toString()}(s,t)}`}const li=[];function ci(s,e){for(const t of e)t&&t.afterAllSetup&&t.afterAllSetup(s)}function ui(s,e,t){if(t[e.name])ve&&Q.log(`Integration skipped because it was already installed: ${e.name}`);else{if(t[e.name]=e,li.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),li.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(s),typeof e.preprocessEvent=="function"){const n=e.preprocessEvent.bind(e);s.on("preprocessEvent",(a,i)=>n(a,i,s))}if(typeof e.processEvent=="function"){const n=e.processEvent.bind(e),a=Object.assign((i,l)=>n(i,l,s),{id:e.name});s.addEventProcessor(a)}ve&&Q.log(`Integration installed: ${e.name}`)}}class nt extends Error{constructor(e,t="warn"){super(e),this.message=e,this.logLevel=t}}const di="Not capturing exception because it's already been captured.";class $u{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Pu(e.dsn):ve&&Q.warn("No DSN provided, client will not send events."),this._dsn){const n=Bu(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}const t=["enableTracing","tracesSampleRate","tracesSampler"].find(n=>n in e&&e[n]==null);t&&Es(()=>{console.warn(`[Sentry] Deprecation warning: \`${t}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)})}captureException(e,t,n){const a=et();if(Ga(e))return ve&&Q.log(di),a;const i={event_id:a,...t};return this._process(this.eventFromException(e,i).then(l=>this._captureEvent(l,i,n))),i.event_id}captureMessage(e,t,n,a){const i={event_id:et(),...n},l=Cr(e)?e:String(e),c=Yn(e)?this.eventFromMessage(l,t,i):this.eventFromException(e,i);return this._process(c.then(d=>this._captureEvent(d,i,a))),i.event_id}captureEvent(e,t,n){const a=et();if(t&&t.originalException&&Ga(t.originalException))return ve&&Q.log(di),a;const i={event_id:a,...t},l=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,i,l||n)),i.event_id}captureSession(e){typeof e.release!="string"?ve&&Q.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),cs(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then(n=>t.flush(e).then(a=>n&&a))):zt(!0)}close(e){return this.flush(e).then(t=>(this.getOptions().enabled=!1,this.emit("close"),t))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];ui(this,e,this._integrations),t||ci(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=Vu(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of t.attachments||[])n=Lu(n,Ru(i));const a=this.sendEnvelope(n);a&&a.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){const t=function(n,a,i,l){const c=Do(i);return Cs({sent_at:new Date().toISOString(),...c&&{sdk:c},...!!l&&a&&{dsn:cn(a)}},["aggregates"in n?[{type:"sessions"},n]:[{type:"session"},n.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){const a=typeof n=="number"?n:1,i=`${e}:${t}`;ve&&Q.log(`Recording outcome: "${i}"${a>1?` (${a} times)`:""}`),this._outcomes[i]=(this._outcomes[i]||0)+a}}on(e,t){const n=this._hooks[e]=this._hooks[e]||[];return n.push(t),()=>{const a=n.indexOf(t);a>-1&&n.splice(a,1)}}emit(e,...t){const n=this._hooks[e];n&&n.forEach(a=>a(...t))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,t=>(ve&&Q.error("Error while sending envelope:",t),t)):(ve&&Q.error("Transport disabled"),zt({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(t,n){const a={};return n.forEach(i=>{i&&ui(t,i,a)}),a}(this,e),ci(this,e)}_updateSessionFromEvent(e,t){let n=t.level==="fatal",a=!1;const i=t.exception&&t.exception.values;if(i){a=!0;for(const c of i){const d=c.mechanism;if(d&&d.handled===!1){n=!0;break}}}const l=e.status==="ok";(l&&e.errors===0||l&&n)&&(cs(e,{...n&&{status:"crashed"},errors:e.errors||Number(a||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Xe(t=>{let n=0;const a=setInterval(()=>{this._numProcessing==0?(clearInterval(a),t(!0)):(n+=1,e&&n>=e&&(clearInterval(a),t(!1)))},1)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,t,n=Ht(),a=Ts()){const i=this.getOptions(),l=Object.keys(this._integrations);return!t.integrations&&l.length>0&&(t.integrations=l),this.emit("preprocessEvent",e,t),e.type||a.setLastEventId(e.event_id||t.event_id),Uu(i,e,t,n,this,a).then(c=>{if(c===null)return c;c.contexts={trace:ku(n),...c.contexts};const d=function(m,g){const _=g.getPropagationContext();return _.dsc||Po(_.traceId,m)}(this,n);return c.sdkProcessingMetadata={dynamicSamplingContext:d,...c.sdkProcessingMetadata},c})}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then(a=>a.event_id,a=>{ve&&(a instanceof nt&&a.logLevel==="log"?Q.log(a.message):Q.warn(a))})}_processEvent(e,t,n){const a=this.getOptions(),{sampleRate:i}=a,l=mi(e),c=hi(e),d=e.type||"error",m=`before send for type \`${d}\``,g=i===void 0?void 0:function(E){if(typeof E=="boolean")return Number(E);const k=typeof E=="string"?parseFloat(E):E;if(!(typeof k!="number"||isNaN(k)||k<0||k>1))return k;ve&&Q.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(E)} of type ${JSON.stringify(typeof E)}.`)}(i);if(c&&typeof g=="number"&&Math.random()>g)return this.recordDroppedEvent("sample_rate","error",e),ln(new nt(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));const _=d==="replay_event"?"replay":d,M=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,M).then(E=>{if(E===null)throw this.recordDroppedEvent("event_processor",_,e),new nt("An event processor returned `null`, will not send event.","log");if(t.data&&t.data.__sentry__===!0)return E;const k=function(b,x,p,T){const{beforeSend:L,beforeSendTransaction:j,beforeSendSpan:O}=x;if(hi(p)&&L)return L(p,T);if(mi(p)){if(p.spans&&O){const D=[];for(const Y of p.spans){const te=O(Y);te?D.push(te):(Mu(),b.recordDroppedEvent("before_send","span"))}p.spans=D}if(j){if(p.spans){const D=p.spans.length;p.sdkProcessingMetadata={...p.sdkProcessingMetadata,spanCountBeforeProcessing:D}}return j(p,T)}}return p}(this,a,E,t);return function(b,x){const p=`${x} must return \`null\` or a valid event.`;if(bn(b))return b.then(T=>{if(!os(T)&&T!==null)throw new nt(p);return T},T=>{throw new nt(`${x} rejected with ${T}`)});if(!os(b)&&b!==null)throw new nt(p);return b}(k,m)}).then(E=>{if(E===null){if(this.recordDroppedEvent("before_send",_,e),l){const x=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",x)}throw new nt(`${m} returned \`null\`, will not send event.`,"log")}const k=n&&n.getSession();if(!l&&k&&this._updateSessionFromEvent(k,E),l){const x=(E.sdkProcessingMetadata&&E.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(E.spans?E.spans.length:0);x>0&&this.recordDroppedEvent("before_send","span",x)}const b=E.transaction_info;if(l&&b&&E.transaction!==e.transaction){const x="custom";E.transaction_info={...b,source:x}}return this.sendEvent(E,t),E}).then(null,E=>{throw E instanceof nt?E:(this.captureException(E,{data:{__sentry__:!0},originalException:E}),new nt(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${E}`))})}_process(e){this._numProcessing++,e.then(t=>(this._numProcessing--,t),t=>(this._numProcessing--,t))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([t,n])=>{const[a,i]=t.split(":");return{reason:a,category:i,quantity:n}})}_flushOutcomes(){ve&&Q.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0)return void(ve&&Q.log("No outcomes to send"));if(!this._dsn)return void(ve&&Q.log("No dsn provided, will not send outcomes"));ve&&Q.log("Sending outcomes:",e);const t=(n=e,Cs((a=this._options.tunnel&&cn(this._dsn))?{dsn:a}:{},[[{type:"client_report"},{timestamp:Ns(),discarded_events:n}]]));var n,a;this.sendEnvelope(t)}}function hi(s){return s.type===void 0}function mi(s){return s.type==="transaction"}function Ju(s){const e=[];function t(n){return e.splice(e.indexOf(n),1)[0]||Promise.resolve(void 0)}return{$:e,add:function(n){if(!(s===void 0||e.length<s))return ln(new nt("Not adding Promise because buffer limit was reached."));const a=n();return e.indexOf(a)===-1&&e.push(a),a.then(()=>t(a)).then(null,()=>t(a).then(null,()=>{})),a},drain:function(n){return new Xe((a,i)=>{let l=e.length;if(!l)return a(!0);const c=setTimeout(()=>{n&&n>0&&a(!1)},n);e.forEach(d=>{zt(d).then(()=>{--l||(clearTimeout(c),a(!0))},i)})})}}}function Gu(s,{statusCode:e,headers:t},n=Date.now()){const a={...s},i=t&&t["x-sentry-rate-limits"],l=t&&t["retry-after"];if(i)for(const c of i.trim().split(",")){const[d,m,,,g]=c.split(":",5),_=parseInt(d,10),M=1e3*(isNaN(_)?60:_);if(m)for(const E of m.split(";"))E==="metric_bucket"&&g&&!g.split(";").includes("custom")||(a[E]=n+M);else a.all=n+M}else l?a.all=n+function(c,d=Date.now()){const m=parseInt(`${c}`,10);if(!isNaN(m))return 1e3*m;const g=Date.parse(`${c}`);return isNaN(g)?6e4:g-d}(l,n):e===429&&(a.all=n+6e4);return a}function zu(s,e,t=Ju(s.bufferSize||64)){let n={};return{send:function(a){const i=[];if(ti(a,(d,m)=>{const g=si(m);if(function(_,M,E=Date.now()){return function(k,b){return k[b]||k.all||0}(_,M)>E}(n,g)){const _=pi(d,m);s.recordDroppedEvent("ratelimit_backoff",g,_)}else i.push(d)}),i.length===0)return zt({});const l=Cs(a[0],i),c=d=>{ti(l,(m,g)=>{const _=pi(m,g);s.recordDroppedEvent(d,si(g),_)})};return t.add(()=>e({body:Du(l)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&ve&&Q.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),n=Gu(n,d),d),d=>{throw c("network_error"),d})).then(d=>d,d=>{if(d instanceof nt)return ve&&Q.error("Skipped sending event because buffer is full."),c("queue_overflow"),zt({});throw d})},flush:a=>t.drain(a)}}function pi(s,e){if(e==="event"||e==="transaction")return Array.isArray(s)?s[1]:void 0}const Yu=100;function Rt(s,e){const t=De(),n=Ts();if(!t)return;const{beforeBreadcrumb:a=null,maxBreadcrumbs:i=Yu}=t.getOptions();if(i<=0)return;const l={timestamp:Ns(),...s},c=a?Es(()=>a(l,e)):l;c!==null&&(t.emit&&t.emit("beforeAddBreadcrumb",c,e),n.addBreadcrumb(c,i))}let fi;const gi=new WeakMap,Wu=()=>({name:"FunctionToString",setupOnce(){fi=Function.prototype.toString;try{Function.prototype.toString=function(...s){const e=Nr(this),t=gi.has(De())&&e!==void 0?e:this;return fi.apply(t,s)}}catch{}},setup(s){gi.set(s,!0)}}),Hu=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],Ku=(s={})=>({name:"InboundFilters",processEvent(e,t,n){const a=n.getOptions(),i=function(l={},c={}){return{allowUrls:[...l.allowUrls||[],...c.allowUrls||[]],denyUrls:[...l.denyUrls||[],...c.denyUrls||[]],ignoreErrors:[...l.ignoreErrors||[],...c.ignoreErrors||[],...l.disableErrorDefaults?[]:Hu],ignoreTransactions:[...l.ignoreTransactions||[],...c.ignoreTransactions||[]],ignoreInternal:l.ignoreInternal===void 0||l.ignoreInternal}}(s,a);return function(l,c){return c.ignoreInternal&&function(d){try{return d.exception.values[0].type==="SentryError"}catch{}return!1}(l)?(ve&&Q.warn(`Event dropped due to being internal Sentry Error.
Event: ${Nt(l)}`),!0):function(d,m){return d.type||!m||!m.length?!1:function(g){const _=[];g.message&&_.push(g.message);let M;try{M=g.exception.values[g.exception.values.length-1]}catch{}return M&&M.value&&(_.push(M.value),M.type&&_.push(`${M.type}: ${M.value}`)),_}(d).some(g=>Ds(g,m))}(l,c.ignoreErrors)?(ve&&Q.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Nt(l)}`),!0):function(d){return d.type||!d.exception||!d.exception.values||d.exception.values.length===0?!1:!d.message&&!d.exception.values.some(m=>m.stacktrace||m.type&&m.type!=="Error"||m.value)}(l)?(ve&&Q.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Nt(l)}`),!0):function(d,m){if(d.type!=="transaction"||!m||!m.length)return!1;const g=d.transaction;return!!g&&Ds(g,m)}(l,c.ignoreTransactions)?(ve&&Q.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Nt(l)}`),!0):function(d,m){if(!m||!m.length)return!1;const g=Vs(d);return!!g&&Ds(g,m)}(l,c.denyUrls)?(ve&&Q.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Nt(l)}.
Url: ${Vs(l)}`),!0):function(d,m){if(!m||!m.length)return!0;const g=Vs(d);return!g||Ds(g,m)}(l,c.allowUrls)?!1:(ve&&Q.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Nt(l)}.
Url: ${Vs(l)}`),!0)}(e,i)?null:e}});function Vs(s){try{let e;try{e=s.exception.values[0].stacktrace.frames}catch{}return e?function(t=[]){for(let n=t.length-1;n>=0;n--){const a=t[n];if(a&&a.filename!=="<anonymous>"&&a.filename!=="[native code]")return a.filename||null}return null}(e):null}catch{return ve&&Q.error(`Cannot extract url for event ${Nt(s)}`),null}}function Qu(s,e,t=250,n,a,i,l){if(!(i.exception&&i.exception.values&&l&&Jt(l.originalException,Error)))return;const c=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;var d,m;c&&(i.exception.values=(d=tr(s,e,a,l.originalException,n,i.exception.values,c,0),m=t,d.map(g=>(g.value&&(g.value=ns(g.value,m)),g))))}function tr(s,e,t,n,a,i,l,c){if(i.length>=t+1)return i;let d=[...i];if(Jt(n[a],Error)){vi(l,c);const m=s(e,n[a]),g=d.length;yi(m,a,g,c),d=tr(s,e,t,n[a],a,[m,...d],m,g)}return Array.isArray(n.errors)&&n.errors.forEach((m,g)=>{if(Jt(m,Error)){vi(l,c);const _=s(e,m),M=d.length;yi(_,`errors[${g}]`,M,c),d=tr(s,e,t,m,a,[_,...d],_,M)}}),d}function vi(s,e){s.mechanism=s.mechanism||{type:"generic",handled:!0},s.mechanism={...s.mechanism,...s.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function yi(s,e,t,n){s.mechanism=s.mechanism||{type:"generic",handled:!0},s.mechanism={...s.mechanism,type:"chained",source:e,exception_id:t,parent_id:n}}function Nn(s){if(!s)return{};const e=s.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const t=e[6]||"",n=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:t,hash:n,relative:e[5]+t+n}}function Xu(){"console"in me&&zn.forEach(function(s){s in me.console&&He(me.console,s,function(e){return on[s]=e,function(...t){rt("console",{args:t,level:s});const n=on[s];n&&n.apply(me.console,t)}})})}function Zu(s){return s==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(s)?s:"log"}const ed=()=>{let s;return{name:"Dedupe",processEvent(e){if(e.type)return e;try{if(function(t,n){return n?!!(function(a,i){const l=a.message,c=i.message;return!(!l&&!c||l&&!c||!l&&c||l!==c||!_i(a,i)||!bi(a,i))}(t,n)||function(a,i){const l=xi(i),c=xi(a);return!(!l||!c||l.type!==c.type||l.value!==c.value||!_i(a,i)||!bi(a,i))}(t,n)):!1}(e,s))return ve&&Q.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return s=e}}};function bi(s,e){let t=Va(s),n=Va(e);if(!t&&!n)return!0;if(t&&!n||!t&&n||n.length!==t.length)return!1;for(let a=0;a<n.length;a++){const i=n[a],l=t[a];if(i.filename!==l.filename||i.lineno!==l.lineno||i.colno!==l.colno||i.function!==l.function)return!1}return!0}function _i(s,e){let t=s.fingerprint,n=e.fingerprint;if(!t&&!n)return!0;if(t&&!n||!t&&n)return!1;try{return t.join("")===n.join("")}catch{return!1}}function xi(s){return s.exception&&s.exception.values&&s.exception.values[0]}function wi(s){return s===void 0?void 0:s>=400&&s<500?"warning":s>=500?"error":void 0}const Tn=me;function sr(s){return s&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(s.toString())}function td(){if(typeof EdgeRuntime=="string")return!0;if(!function(){if(!("fetch"in Tn))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}())return!1;if(sr(Tn.fetch))return!0;let s=!1;const e=Tn.document;if(e&&typeof e.createElement=="function")try{const t=e.createElement("iframe");t.hidden=!0,e.head.appendChild(t),t.contentWindow&&t.contentWindow.fetch&&(s=sr(t.contentWindow.fetch)),e.head.removeChild(t)}catch(t){Wt&&Q.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return s}function sd(s,e){const t="fetch";Bt(t,s),$t(t,()=>function(n,a=!1){a&&!td()||He(me,"fetch",function(i){return function(...l){const c=new Error,{method:d,url:m}=function(_){if(_.length===0)return{method:"GET",url:""};if(_.length===2){const[E,k]=_;return{url:Si(E),method:nr(k,"method")?String(k.method).toUpperCase():"GET"}}const M=_[0];return{url:Si(M),method:nr(M,"method")?String(M.method).toUpperCase():"GET"}}(l),g={args:l,fetchData:{method:d,url:m},startTimestamp:1e3*yt(),virtualError:c};return n||rt("fetch",{...g}),i.apply(me,l).then(async _=>(n?n(_):rt("fetch",{...g,endTimestamp:1e3*yt(),response:_}),_),_=>{throw rt("fetch",{...g,endTimestamp:1e3*yt(),error:_}),kr(_)&&_.stack===void 0&&(_.stack=c.stack,Gt(_,"framesToPop",1)),_})}})}(void 0,e))}function nr(s,e){return!!s&&typeof s=="object"&&!!s[e]}function Si(s){return typeof s=="string"?s:s?nr(s,"url")?s.url:s.toString?s.toString():"":""}const qs=me,Oe=me;let rr=0;function ji(){return rr>0}function ds(s,e={}){if(!function(n){return typeof n=="function"}(s))return s;try{const n=s.__sentry_wrapped__;if(n)return typeof n=="function"?n:s;if(Nr(s))return s}catch{return s}const t=function(...n){try{const a=n.map(i=>ds(i,e));return s.apply(this,a)}catch(a){throw rr++,setTimeout(()=>{rr--}),function(...i){const l=Ar(vn());if(i.length===2){const[c,d]=i;return c?l.withSetScope(c,d):l.withScope(d)}l.withScope(i[0])}(i=>{var l;i.addEventProcessor(c=>(e.mechanism&&(Hn(c,void 0),ls(c,e.mechanism)),c.extra={...c.extra,arguments:n},c)),l=a,Ht().captureException(l,void 0)}),a}};try{for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}catch{}Ao(t,s),Gt(s,"__sentry_wrapped__",t);try{Object.getOwnPropertyDescriptor(t,"name").configurable&&Object.defineProperty(t,"name",{get:()=>s.name})}catch{}return t}const xn=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function Ir(s,e){const t=Pr(s,e),n={type:ad(e),value:id(e)};return t.length&&(n.stacktrace={frames:t}),n.type===void 0&&n.value===""&&(n.value="Unrecoverable error caught"),n}function nd(s,e,t,n){const a=De(),i=a&&a.getOptions().normalizeDepth,l=function(m){for(const g in m)if(Object.prototype.hasOwnProperty.call(m,g)){const _=m[g];if(_ instanceof Error)return _}}(e),c={__serialized__:Lo(e,i)};if(l)return{exception:{values:[Ir(s,l)]},extra:c};const d={exception:{values:[{type:yn(e)?e.constructor.name:n?"UnhandledRejection":"Error",value:od(e,{isUnhandledRejection:n})}]},extra:c};if(t){const m=Pr(s,t);m.length&&(d.exception.values[0].stacktrace={frames:m})}return d}function An(s,e){return{exception:{values:[Ir(s,e)]}}}function Pr(s,e){const t=e.stacktrace||e.stack||"",n=function(i){return i&&rd.test(i.message)?1:0}(e),a=function(i){return typeof i.framesToPop=="number"?i.framesToPop:0}(e);try{return s(t,n,a)}catch{}return[]}const rd=/Minified React error #\d+;/i;function Vo(s){return typeof WebAssembly<"u"&&WebAssembly.Exception!==void 0&&s instanceof WebAssembly.Exception}function ad(s){const e=s&&s.name;return!e&&Vo(s)?s.message&&Array.isArray(s.message)&&s.message.length==2?s.message[0]:"WebAssembly.Exception":e}function id(s){const e=s&&s.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:Vo(s)&&Array.isArray(s.message)&&s.message.length==2?s.message[1]:e:"No error message"}function ar(s,e,t,n,a){let i;if(Eo(e)&&e.error)return An(s,e.error);if(Ua(e)||hs(e,"DOMException")){const l=e;if("stack"in e)i=An(s,e);else{const c=l.name||(Ua(l)?"DOMError":"DOMException"),d=l.message?`${c}: ${l.message}`:c;i=ir(s,d,t,n),Hn(i,d)}return"code"in l&&(i.tags={...i.tags,"DOMException.code":`${l.code}`}),i}return kr(e)?An(s,e):os(e)||yn(e)?(i=nd(s,e,t,a),ls(i,{synthetic:!0}),i):(i=ir(s,e,t,n),Hn(i,`${e}`),ls(i,{synthetic:!0}),i)}function ir(s,e,t,n){const a={};if(n&&t){const i=Pr(s,t);i.length&&(a.exception={values:[{value:e,stacktrace:{frames:i}}]}),ls(a,{synthetic:!0})}if(Cr(e)){const{__sentry_template_string__:i,__sentry_template_values__:l}=e;return a.logentry={message:i,params:l},a}return a.message=e,a}function od(s,{isUnhandledRejection:e}){const t=function(a,i=40){const l=Object.keys(Mo(a));l.sort();const c=l[0];if(!c)return"[object has no keys]";if(c.length>=i)return ns(c,i);for(let d=l.length;d>0;d--){const m=l.slice(0,d).join(", ");if(!(m.length>i))return d===l.length?m:ns(m,i)}return""}(s),n=e?"promise rejection":"exception";return Eo(s)?`Event \`ErrorEvent\` captured as ${n} with message \`${s.message}\``:yn(s)?`Event \`${function(a){try{const i=Object.getPrototypeOf(a);return i?i.constructor.name:void 0}catch{}}(s)}\` (type=${s.type}) captured as ${n}`:`Object captured as ${n} with keys: ${t}`}class ld extends $u{constructor(e){const t={parentSpanIsAlwaysRootSpan:!0,...e};(function(n,a,i=[a],l="npm"){const c=n._metadata||{};c.sdk||(c.sdk={name:`sentry.javascript.${a}`,packages:i.map(d=>({name:`${l}:@sentry/${d}`,version:Ut})),version:Ut}),n._metadata=c})(t,"browser",["browser"],Oe.SENTRY_SDK_SOURCE||"npm"),super(t),t.sendClientReports&&Oe.document&&Oe.document.addEventListener("visibilitychange",()=>{Oe.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,t){return function(n,a,i,l){const c=ar(n,a,i&&i.syntheticException||void 0,l);return ls(c),c.level="error",i&&i.event_id&&(c.event_id=i.event_id),zt(c)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",n){return function(a,i,l="info",c,d){const m=ir(a,i,c&&c.syntheticException||void 0,d);return m.level=l,c&&c.event_id&&(m.event_id=c.event_id),zt(m)}(this._options.stackParser,e,t,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(xn&&Q.warn("SDK not enabled, will not capture user feedback."));const t=function(n,{metadata:a,tunnel:i,dsn:l}){const c={event_id:n.event_id,sent_at:new Date().toISOString(),...a&&a.sdk&&{sdk:{name:a.sdk.name,version:a.sdk.version}},...!!i&&!!l&&{dsn:cn(l)}};return Cs(c,[function(m){return[{type:"user_report"},m]}(n)])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(t)}_prepareEvent(e,t,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,n)}}const cd=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,qe=me;let ki,Mn,On,Us;function ud(){if(!qe.document)return;const s=rt.bind(null,"dom"),e=Ci(s,!0);qe.document.addEventListener("click",e,!1),qe.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(t=>{const n=qe[t],a=n&&n.prototype;a&&a.hasOwnProperty&&a.hasOwnProperty("addEventListener")&&(He(a,"addEventListener",function(i){return function(l,c,d){if(l==="click"||l=="keypress")try{const m=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},g=m[l]=m[l]||{refCount:0};if(!g.handler){const _=Ci(s);g.handler=_,i.call(this,l,_,d)}g.refCount++}catch{}return i.call(this,l,c,d)}}),He(a,"removeEventListener",function(i){return function(l,c,d){if(l==="click"||l=="keypress")try{const m=this.__sentry_instrumentation_handlers__||{},g=m[l];g&&(g.refCount--,g.refCount<=0&&(i.call(this,l,g.handler,d),g.handler=void 0,delete m[l]),Object.keys(m).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return i.call(this,l,c,d)}}))})}function Ci(s,e=!1){return t=>{if(!t||t._sentryCaptured)return;const n=function(i){try{return i.target}catch{return null}}(t);if(function(i,l){return i==="keypress"&&(!l||!l.tagName||l.tagName!=="INPUT"&&l.tagName!=="TEXTAREA"&&!l.isContentEditable)}(t.type,n))return;Gt(t,"_sentryCaptured",!0),n&&!n._sentryId&&Gt(n,"_sentryId",et());const a=t.type==="keypress"?"input":t.type;(function(i){if(i.type!==Mn)return!1;try{if(!i.target||i.target._sentryId!==On)return!1}catch{}return!0})(t)||(s({event:t,name:a,global:e}),Mn=t.type,On=n?n._sentryId:void 0),clearTimeout(ki),ki=qe.setTimeout(()=>{On=void 0,Mn=void 0},1e3)}}function qo(s){const e="history";Bt(e,s),$t(e,dd)}function dd(){if(!function(){const t=qs.chrome,n=t&&t.app&&t.app.runtime,a="history"in qs&&!!qs.history.pushState&&!!qs.history.replaceState;return!n&&a}())return;const s=qe.onpopstate;function e(t){return function(...n){const a=n.length>2?n[2]:void 0;if(a){const i=Us,l=String(a);Us=l,rt("history",{from:i,to:l})}return t.apply(this,n)}}qe.onpopstate=function(...t){const n=qe.location.href,a=Us;if(Us=n,rt("history",{from:a,to:n}),s)try{return s.apply(this,t)}catch{}},He(qe.history,"pushState",e),He(qe.history,"replaceState",e)}const Ys={};function Ei(s){Ys[s]=void 0}const vs="__sentry_xhr_v3__";function hd(){if(!qe.XMLHttpRequest)return;const s=XMLHttpRequest.prototype;s.open=new Proxy(s.open,{apply(e,t,n){const a=new Error,i=1e3*yt(),l=gt(n[0])?n[0].toUpperCase():void 0,c=function(m){if(gt(m))return m;try{return m.toString()}catch{}}(n[1]);if(!l||!c)return e.apply(t,n);t[vs]={method:l,url:c,request_headers:{}},l==="POST"&&c.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const d=()=>{const m=t[vs];if(m&&t.readyState===4){try{m.status_code=t.status}catch{}rt("xhr",{endTimestamp:1e3*yt(),startTimestamp:i,xhr:t,virtualError:a})}};return"onreadystatechange"in t&&typeof t.onreadystatechange=="function"?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply:(m,g,_)=>(d(),m.apply(g,_))}):t.addEventListener("readystatechange",d),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(m,g,_){const[M,E]=_,k=g[vs];return k&&gt(M)&&gt(E)&&(k.request_headers[M.toLowerCase()]=E),m.apply(g,_)}}),e.apply(t,n)}}),s.send=new Proxy(s.send,{apply(e,t,n){const a=t[vs];return a?(n[0]!==void 0&&(a.body=n[0]),rt("xhr",{startTimestamp:1e3*yt(),xhr:t}),e.apply(t,n)):e.apply(t,n)}})}function md(s,e=function(t){const n=Ys[t];if(n)return n;let a=qe[t];if(sr(a))return Ys[t]=a.bind(qe);const i=qe.document;if(i&&typeof i.createElement=="function")try{const l=i.createElement("iframe");l.hidden=!0,i.head.appendChild(l);const c=l.contentWindow;c&&c[t]&&(a=c[t]),i.head.removeChild(l)}catch(l){cd&&Q.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,l)}return a&&(Ys[t]=a.bind(qe))}("fetch")){let t=0,n=0;return zu(s,function(a){const i=a.body.length;t+=i,n++;const l={body:a.body,method:"POST",referrerPolicy:"origin",headers:s.headers,keepalive:t<=6e4&&n<15,...s.fetchOptions};if(!e)return Ei("fetch"),ln("No fetch implementation available");try{return e(s.url,l).then(c=>(t-=i,n--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return Ei("fetch"),t-=i,n--,ln(c)}})}function In(s,e,t,n){const a={filename:s,function:e==="<anonymous>"?qt:e,in_app:!0};return t!==void 0&&(a.lineno=t),n!==void 0&&(a.colno=n),a}const pd=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,fd=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,gd=/\((\S*)(?::(\d+))(?::(\d+))\)/,vd=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,yd=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,bd=function(...s){const e=s.sort((t,n)=>t[0]-n[0]).map(t=>t[1]);return(t,n=0,a=0)=>{const i=[],l=t.split(`
`);for(let c=n;c<l.length;c++){const d=l[c];if(d.length>1024)continue;const m=Da.test(d)?d.replace(Da,"$1"):d;if(!m.match(/\S*Error: /)){for(const g of e){const _=g(m);if(_){i.push(_);break}}if(i.length>=50+a)break}}return function(c){if(!c.length)return[];const d=Array.from(c);return/sentryWrapped/.test(Ls(d).function||"")&&d.pop(),d.reverse(),Ra.test(Ls(d).function||"")&&(d.pop(),Ra.test(Ls(d).function||"")&&d.pop()),d.slice(0,50).map(m=>({...m,filename:m.filename||Ls(d).filename,function:m.function||qt}))}(i.slice(a))}}([30,s=>{const e=pd.exec(s);if(e){const[,n,a,i]=e;return In(n,qt,+a,+i)}const t=fd.exec(s);if(t){if(t[2]&&t[2].indexOf("eval")===0){const i=gd.exec(t[2]);i&&(t[2]=i[1],t[3]=i[2],t[4]=i[3])}const[n,a]=Ni(t[1]||qt,t[2]);return In(a,n,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],[50,s=>{const e=vd.exec(s);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const a=yd.exec(e[3]);a&&(e[1]=e[1]||"eval",e[3]=a[1],e[4]=a[2],e[5]="")}let t=e[3],n=e[1]||qt;return[n,t]=Ni(n,t),In(t,n,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]),Ni=(s,e)=>{const t=s.indexOf("safari-extension")!==-1,n=s.indexOf("safari-web-extension")!==-1;return t||n?[s.indexOf("@")!==-1?s.split("@")[0]:qt,t?`safari-extension:${e}`:`safari-web-extension:${e}`]:[s,e]},Ti=1024,_d=(s={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...s};return{name:"Breadcrumbs",setup(t){var n;e.console&&function(a){const i="console";Bt(i,a),$t(i,Xu)}(function(a){return function(i){if(De()!==a)return;const l={category:"console",data:{arguments:i.args,logger:"console"},level:Zu(i.level),message:Ba(i.args," ")};if(i.level==="assert"){if(i.args[0]!==!1)return;l.message=`Assertion failed: ${Ba(i.args.slice(1)," ")||"console.assert"}`,l.data.arguments=i.args.slice(1)}Rt(l,{input:i.args,level:i.level})}}(t)),e.dom&&(n=function(a,i){return function(l){if(De()!==a)return;let c,d,m=typeof i=="object"?i.serializeAttribute:void 0,g=typeof i=="object"&&typeof i.maxStringLength=="number"?i.maxStringLength:void 0;g&&g>Ti&&(xn&&Q.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${g} was configured. Sentry will use 1024 instead.`),g=Ti),typeof m=="string"&&(m=[m]);try{const M=l.event,E=function(k){return!!k&&!!k.target}(M)?M.target:M;c=To(E,{keyAttrs:m,maxStringLength:g}),d=function(k){if(!Er.HTMLElement)return null;let b=k;for(let x=0;x<5;x++){if(!b)return null;if(b instanceof HTMLElement){if(b.dataset.sentryComponent)return b.dataset.sentryComponent;if(b.dataset.sentryElement)return b.dataset.sentryElement}b=b.parentNode}return null}(E)}catch{c="<unknown>"}if(c.length===0)return;const _={category:`ui.${l.name}`,message:c};d&&(_.data={"ui.component_name":d}),Rt(_,{event:l.event,name:l.name,global:l.global})}}(t,e.dom),Bt("dom",n),$t("dom",ud)),e.xhr&&function(a){Bt("xhr",a),$t("xhr",hd)}(function(a){return function(i){if(De()!==a)return;const{startTimestamp:l,endTimestamp:c}=i,d=i.xhr[vs];if(!l||!c||!d)return;const{method:m,url:g,status_code:_,body:M}=d,E={method:m,url:g,status_code:_},k={xhr:i.xhr,input:M,startTimestamp:l,endTimestamp:c};Rt({category:"xhr",data:E,type:"http",level:wi(_)},k)}}(t)),e.fetch&&sd(function(a){return function(i){if(De()!==a)return;const{startTimestamp:l,endTimestamp:c}=i;if(c&&(!i.fetchData.url.match(/sentry_key/)||i.fetchData.method!=="POST"))if(i.error)Rt({category:"fetch",data:i.fetchData,level:"error",type:"http"},{data:i.error,input:i.args,startTimestamp:l,endTimestamp:c});else{const d=i.response,m={...i.fetchData,status_code:d&&d.status},g={input:i.args,response:d,startTimestamp:l,endTimestamp:c};Rt({category:"fetch",data:m,type:"http",level:wi(m.status_code)},g)}}}(t)),e.history&&qo(function(a){return function(i){if(De()!==a)return;let l=i.from,c=i.to;const d=Nn(Oe.location.href);let m=l?Nn(l):void 0;const g=Nn(c);m&&m.path||(m=d),d.protocol===g.protocol&&d.host===g.host&&(c=g.relative),d.protocol===m.protocol&&d.host===m.host&&(l=m.relative),Rt({category:"navigation",data:{from:l,to:c}})}}(t)),e.sentry&&t.on("beforeSendEvent",function(a){return function(i){De()===a&&Rt({category:"sentry."+(i.type==="transaction"?"transaction":"event"),event_id:i.event_id,level:i.level,message:Nt(i)},{event:i})}}(t))}}},xd=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],wd=(s={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...s};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&He(Oe,"setTimeout",Ai),e.setInterval&&He(Oe,"setInterval",Ai),e.requestAnimationFrame&&He(Oe,"requestAnimationFrame",Sd),e.XMLHttpRequest&&"XMLHttpRequest"in Oe&&He(XMLHttpRequest.prototype,"send",jd);const t=e.eventTarget;t&&(Array.isArray(t)?t:xd).forEach(kd)}}};function Ai(s){return function(...e){const t=e[0];return e[0]=ds(t,{mechanism:{data:{function:It(s)},handled:!1,type:"instrument"}}),s.apply(this,e)}}function Sd(s){return function(e){return s.apply(this,[ds(e,{mechanism:{data:{function:"requestAnimationFrame",handler:It(s)},handled:!1,type:"instrument"}})])}}function jd(s){return function(...e){const t=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(n=>{n in t&&typeof t[n]=="function"&&He(t,n,function(a){const i={mechanism:{data:{function:n,handler:It(a)},handled:!1,type:"instrument"}},l=Nr(a);return l&&(i.mechanism.data.handler=It(l)),ds(a,i)})}),s.apply(this,e)}}function kd(s){const e=Oe[s],t=e&&e.prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(He(t,"addEventListener",function(n){return function(a,i,l){try{typeof i.handleEvent=="function"&&(i.handleEvent=ds(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:It(i),target:s},handled:!1,type:"instrument"}}))}catch{}return n.apply(this,[a,ds(i,{mechanism:{data:{function:"addEventListener",handler:It(i),target:s},handled:!1,type:"instrument"}}),l])}}),He(t,"removeEventListener",function(n){return function(a,i,l){try{const c=i.__sentry_wrapped__;c&&n.call(this,a,c,l)}catch{}return n.call(this,a,i,l)}}))}const Cd=()=>({name:"BrowserSession",setupOnce(){Oe.document!==void 0?(ii({ignoreDuration:!0}),oi(),qo(({from:s,to:e})=>{s!==void 0&&s!==e&&(ii({ignoreDuration:!0}),oi())})):xn&&Q.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),Ed=(s={})=>{const e={onerror:!0,onunhandledrejection:!0,...s};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(t){e.onerror&&(function(n){(function(a){const i="error";Bt(i,a),$t(i,vu)})(a=>{const{stackParser:i,attachStacktrace:l}=Oi();if(De()!==n||ji())return;const{msg:c,url:d,line:m,column:g,error:_}=a,M=function(E,k,b,x){const p=E.exception=E.exception||{},T=p.values=p.values||[],L=T[0]=T[0]||{},j=L.stacktrace=L.stacktrace||{},O=j.frames=j.frames||[],D=x,Y=b,te=gt(k)&&k.length>0?k:function(){try{return Er.document.location.href}catch{return""}}();return O.length===0&&O.push({colno:D,filename:te,function:qt,in_app:!0,lineno:Y}),E}(ar(i,_||c,void 0,l,!1),d,m,g);M.level="error",ai(M,{originalException:_,mechanism:{handled:!1,type:"onerror"}})})}(t),Mi("onerror")),e.onunhandledrejection&&(function(n){(function(a){const i="unhandledrejection";Bt(i,a),$t(i,yu)})(a=>{const{stackParser:i,attachStacktrace:l}=Oi();if(De()!==n||ji())return;const c=function(m){if(Yn(m))return m;try{if("reason"in m)return m.reason;if("detail"in m&&"reason"in m.detail)return m.detail.reason}catch{}return m}(a),d=Yn(c)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(c)}`}]}}:ar(i,c,void 0,l,!0);d.level="error",ai(d,{originalException:c,mechanism:{handled:!1,type:"onunhandledrejection"}})})}(t),Mi("onunhandledrejection"))}}};function Mi(s){xn&&Q.log(`Global Handler attached: ${s}`)}function Oi(){const s=De();return s&&s.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Nd=()=>({name:"HttpContext",preprocessEvent(s){if(!Oe.navigator&&!Oe.location&&!Oe.document)return;const e=s.request&&s.request.url||Oe.location&&Oe.location.href,{referrer:t}=Oe.document||{},{userAgent:n}=Oe.navigator||{},a={...s.request&&s.request.headers,...t&&{Referer:t},...n&&{"User-Agent":n}},i={...s.request,...e&&{url:e},headers:a};s.request=i}}),Td=(s={})=>{const e=s.limit||5,t=s.key||"cause";return{name:"LinkedErrors",preprocessEvent(n,a,i){const l=i.getOptions();Qu(Ir,l.stackParser,l.maxValueLength,t,e,n,a)}}};var or="new",Ii="loading",Pi="loaded",un="joining-meeting",At="joined-meeting",Et="left-meeting",dt="error",Ad="blocked",Md="off",Od="sendable",Id="loading",Pd="interrupted",Uo="playable",Ws="unknown",Bo="full",Ld="lobby",Dd="none",$o="base",Rd="*",Fd="ejected",Vd="nbf-room",qd="nbf-token",Ud="exp-room",Bd="exp-token",lr="no-room",$d="meeting-full",Jo="end-of-life",Jd="not-allowed",Go="connection-error",Gd="cam-in-use",zd="mic-in-use",Yd="cam-mic-in-use",Wd="permissions",Hd="undefined-mediadevices",Kd="not-found",Qd="constraints",Xd="unknown",zo="iframe-ready-for-launch-config",Yo="iframe-launch-config",Wo="theme-updated",Ho="loading",Ko="load-attempt-failed",cr="loaded",Qo="started-camera",Xo="camera-error",Zo="joining-meeting",el="joined-meeting",tl="left-meeting",sl="participant-joined",nl="participant-updated",rl="participant-left",al="participant-counts-updated",il="access-state-updated",ol="meeting-session-summary-updated",ll="meeting-session-state-updated",Zd="meeting-session-data-error",cl="waiting-participant-added",ul="waiting-participant-updated",dl="waiting-participant-removed",hl="track-started",ml="track-stopped",pl="transcription-started",fl="transcription-stopped",gl="transcription-error",ur="recording-started",dr="recording-stopped",vl="recording-stats",yl="recording-error",bl="recording-upload-completed",_l="recording-data",xl="app-message",wl="transcription-message",Sl="remote-media-player-started",jl="remote-media-player-updated",kl="remote-media-player-stopped",Cl="local-screen-share-started",El="local-screen-share-stopped",Nl="local-screen-share-canceled",Tl="active-speaker-change",Al="active-speaker-mode-change",Ml="network-quality-change",Ol="network-connection",Il="cpu-load-change",Pl="face-counts-updated",ys="fullscreen",bs="exited-fullscreen",Ll="live-streaming-started",Dl="live-streaming-updated",Rl="live-streaming-stopped",Fl="live-streaming-error",Vl="lang-updated",ql="receive-settings-updated",hr="input-settings-updated",mr="nonfatal-error",pr="error",Pn=4096,Li=102400,Ln="iframe-call-message",Di="local-screen-start",Ri="daily-method-update-live-streaming-endpoints",Bs="transmit-log",vt="daily-custom-track",Hs={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},Ul={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},fr={PLAY:"play",PAUSE:"pause"},Dn=["jpg","png","jpeg"],eh="add-endpoints",th="remove-endpoints",Fi="sip-call-transfer";function tt(){return!le()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function le(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function Bl(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function sh(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&(function(s,e){if(!s||!e)return!0;switch(s){case"Chrome":return e.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(e.major===13&&e.minor===0&&e.point===0);case"Firefox":return e.major>=67}return!0}(Yt(),dn())||le())}function Vi(){if(le()||!document)return!1;var s=document.createElement("iframe");return!!s.requestFullscreen||!!s.webkitRequestFullscreen}var gr="none",nh="software",rh="hardware",ah=function(){try{var s,e=document.createElement("canvas"),t=!1;(s=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(t=!0,s=e.getContext("webgl2"));var n=s!=null;return e.remove(),n?t?nh:rh:gr}catch{return gr}}();function $l(){var s=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!le()&&ah!==gr&&(s?function(){return Ui()?!1:["Chrome","Firefox"].includes(Yt())}():function(){if(Ui())return!1;var e=Yt();if(e==="Safari"){var t=Dr();if(t.major<15||t.major===15&&t.minor<4)return!1}return e==="Chrome"?Lr().major>=77:e==="Firefox"?Rr().major>=97:["Chrome","Firefox","Safari"].includes(e)}())}function Jl(){if(le()||Gl()||typeof AudioWorkletNode>"u")return!1;switch(Yt()){case"Chrome":case"Firefox":return!0;case"Safari":var s=dn();return s.major>17||s.major===17&&s.minor>=4}return!1}function qi(){return Bl()&&!function(){var s,e=Yt();if(!tt())return!0;switch(e){case"Chrome":return(s=Lr()).major&&s.major>0&&s.major<75;case"Firefox":return(s=Rr()).major<91;case"Safari":return(s=Dr()).major<13||s.major===13&&s.minor<1;default:return!0}}()}function Gl(){return tt().match(/Linux; Android/)}function Ui(){var s,e=tt(),t=e.match(/Mac/)&&(!le()&&typeof window<"u"&&(s=window)!==null&&s!==void 0&&(s=s.navigator)!==null&&s!==void 0&&s.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(e.match(/Mobi/)||e.match(/Android/)||t)||!!tt().match(/DailyAnd\//)||void 0}function Yt(){if(typeof window<"u"){var s=tt();return zl()?"Safari":s.indexOf("Edge")>-1?"Edge":s.match(/Chrome\//)?"Chrome":s.indexOf("Safari")>-1||Yl()?"Safari":s.indexOf("Firefox")>-1?"Firefox":s.indexOf("MSIE")>-1||s.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function dn(){switch(Yt()){case"Chrome":return Lr();case"Safari":return Dr();case"Firefox":return Rr();case"Edge":return function(){var s=0,e=0;if(typeof window<"u"){var t=tt().match(/Edge\/(\d+).(\d+)/);if(t)try{s=parseInt(t[1]),e=parseInt(t[2])}catch{}}return{major:s,minor:e}}()}}function Lr(){var s=0,e=0,t=0,n=0,a=!1;if(typeof window<"u"){var i=tt(),l=i.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(l)try{s=parseInt(l[1]),e=parseInt(l[2]),t=parseInt(l[3]),n=parseInt(l[4]),a=i.indexOf("OPR/")>-1}catch{}}return{major:s,minor:e,build:t,patch:n,opera:a}}function zl(){return!!tt().match(/iPad|iPhone|iPod/i)&&Bl()}function Yl(){return tt().indexOf("AppleWebKit/605.1.15")>-1}function Dr(){var s=0,e=0,t=0;if(typeof window<"u"){var n=tt().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(n)try{s=parseInt(n[1]),e=parseInt(n[2]),t=parseInt(n[4])}catch{}else(zl()||Yl())&&(s=14,e=0,t=3)}return{major:s,minor:e,point:t}}function Rr(){var s=0,e=0;if(typeof window<"u"){var t=tt().match(/Firefox\/(\d+).(\d+)/);if(t)try{s=parseInt(t[1]),e=parseInt(t[2])}catch{}}return{major:s,minor:e}}var Wl=function(){return Qe(function s(){Ke(this,s)},[{key:"addListenerForMessagesFromCallMachine",value:function(s,e,t){ps()}},{key:"addListenerForMessagesFromDailyJs",value:function(s,e,t){ps()}},{key:"sendMessageToCallMachine",value:function(s,e,t,n){ps()}},{key:"sendMessageToDailyJs",value:function(s,e){ps()}},{key:"removeListener",value:function(s){ps()}}])}();function Bi(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,n)}return t}function Rn(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bi(Object(t),!0).forEach(function(n){ut(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Bi(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function Hl(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hl=function(){return!!s})()}var ih=function(){function s(){var e,t,n,a;return Ke(this,s),t=this,n=at(n=s),(e=pn(t,Hl()?Reflect.construct(n,[],at(t).constructor):n.apply(t,a)))._wrappedListeners={},e._messageCallbacks={},e}return fn(s,Wl),Qe(s,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,n){var a=this,i=function(l){if(l.data&&l.data.what==="iframe-call-message"&&(!l.data.callClientId||l.data.callClientId===t)&&(!l.data.from||l.data.from!=="module")){var c=Rn({},l.data);if(delete c.from,c.callbackStamp&&a._messageCallbacks[c.callbackStamp]){var d=c.callbackStamp;a._messageCallbacks[d].call(n,c),delete a._messageCallbacks[d]}delete c.what,delete c.callbackStamp,e.call(n,c)}};this._wrappedListeners[e]=i,window.addEventListener("message",i)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,n){var a=function(i){var l;if(!(!i.data||i.data.what!==Ln||!i.data.action||i.data.from&&i.data.from!=="module"||i.data.callClientId&&t&&i.data.callClientId!==t||i!=null&&(l=i.data)!==null&&l!==void 0&&l.callFrameId)){var c=i.data;e.call(n,c)}};this._wrappedListeners[e]=a,window.addEventListener("message",a)}},{key:"sendMessageToCallMachine",value:function(e,t,n,a){if(!n)throw new Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var i=Rn({},e);if(i.what=Ln,i.from="module",i.callClientId=n,t){var l=gn();this._messageCallbacks[l]=t,i.callbackStamp=l}var c=a?a.contentWindow:window,d=this._callMachineTargetOrigin(a);d&&c.postMessage(i,d)}},{key:"sendMessageToDailyJs",value:function(e,t){e.what=Ln,e.callClientId=t,e.from="embedded",window.postMessage(e,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,t,n){var a=Rn({},e);a.callClientId=n;var i=t?t.contentWindow:window,l=this._callMachineTargetOrigin(t);l&&i.postMessage(a,l)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,t){var n=function(a){if(a.data&&a.data.what==="iframe-call-message"&&(!a.data.callClientId||a.data.callClientId===t)&&(!a.data.from||a.data.from!=="module")){var i=a.data;e(i)}};return this._wrappedListeners[e]=n,window.addEventListener("message",n),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"_callMachineTargetOrigin",value:function(e){return e?e.src?new URL(e.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return window.location.protocol==="file:"?"*":window.location.origin}}])}();function $i(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,n)}return t}function Kl(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kl=function(){return!!s})()}var oh=function(){function s(){var e,t,n,a;return Ke(this,s),t=this,n=at(n=s),e=pn(t,Kl()?Reflect.construct(n,[],at(t).constructor):n.apply(t,a)),globalThis.callMachineToDailyJsEmitter=globalThis.callMachineToDailyJsEmitter||new Gn.EventEmitter,globalThis.dailyJsToCallMachineEmitter=globalThis.dailyJsToCallMachineEmitter||new Gn.EventEmitter,e._wrappedListeners={},e._messageCallbacks={},e}return fn(s,Wl),Qe(s,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,n){this._addListener(e,globalThis.callMachineToDailyJsEmitter,t,n,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,n){this._addListener(e,globalThis.dailyJsToCallMachineEmitter,t,n,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(e,t,n){this._sendMessage(e,globalThis.dailyJsToCallMachineEmitter,n,t,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(e,t){this._sendMessage(e,globalThis.callMachineToDailyJsEmitter,t,null,"sending message to daily-js")}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(globalThis.callMachineToDailyJsEmitter.removeListener("message",t),globalThis.dailyJsToCallMachineEmitter.removeListener("message",t),delete this._wrappedListeners[e])}},{key:"_addListener",value:function(e,t,n,a,i){var l=this,c=function(d){if(d.callClientId===n){if(d.callbackStamp&&l._messageCallbacks[d.callbackStamp]){var m=d.callbackStamp;l._messageCallbacks[m].call(a,d),delete l._messageCallbacks[m]}e.call(a,d)}};this._wrappedListeners[e]=c,t.addListener("message",c)}},{key:"_sendMessage",value:function(e,t,n,a,i){var l=function(d){for(var m=1;m<arguments.length;m++){var g=arguments[m]!=null?arguments[m]:{};m%2?$i(Object(g),!0).forEach(function(_){ut(d,_,g[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):$i(Object(g)).forEach(function(_){Object.defineProperty(d,_,Object.getOwnPropertyDescriptor(g,_))})}return d}({},e);if(l.callClientId=n,a){var c=gn();this._messageCallbacks[c]=a,l.callbackStamp=c}t.emit("message",l)}}])}(),vr="replace",yr="shallow-merge",Ji=[vr,yr],lh=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.data,n=e.mergeStrategy,a=n===void 0?vr:n;Ke(this,s),s._validateMergeStrategy(a),s._validateData(t,a),this.mergeStrategy=a,this.data=t}return Qe(s,[{key:"isNoOp",value:function(){return s.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,t){return Object.keys(e).length===0&&t===yr}},{key:"_validateMergeStrategy",value:function(e){if(!Ji.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(Ji,"]"))}},{key:"_validateData",value:function(e,t){if(!function(c){if(c==null||de(c)!=="object")return!1;var d=Object.getPrototypeOf(c);return d==null||d===Object.prototype}(e))throw Error("Meeting session data must be a plain (map-like) object");var n;try{if(n=JSON.stringify(e),t===vr){var a=JSON.parse(n);Ve(a,e)||console.warn("The meeting session data provided will be modified when serialized.",a,e)}else if(t===yr){for(var i in e)if(Object.hasOwnProperty.call(e,i)&&e[i]!==void 0){var l=JSON.parse(JSON.stringify(e[i]));Ve(e[i],l)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",l,e[i])}}}catch(c){throw Error("Meeting session data must be serializable to JSON: ".concat(c))}if(n.length>Li)throw Error("Meeting session data is too large (".concat(n.length," characters). Maximum size suppported is ").concat(Li,"."))}}])}();function Ql(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ql=function(){return!!s})()}function br(s){var e=typeof Map=="function"?new Map:void 0;return br=function(t){if(t===null||!function(a){try{return Function.toString.call(a).indexOf("[native code]")!==-1}catch{return typeof a=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(a,i,l){if(Ql())return Reflect.construct.apply(null,arguments);var c=[null];c.push.apply(c,i);var d=new(a.bind.apply(a,c));return l&&ks(d,l.prototype),d}(t,arguments,at(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ks(n,t)},br(s)}function Xl(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xl=function(){return!!s})()}function Gi(s){var e,t=(e=window._daily)===null||e===void 0?void 0:e.pendings;if(t){var n=t.indexOf(s);n!==-1&&t.splice(n,1)}}var ch=function(){return Qe(function s(e){Ke(this,s),this._currentLoad=null,this._callClientId=e},[{key:"load",value:function(){var s,e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;if(this.loaded)return window._daily.instances[this._callClientId].callMachine.reset(),void n(!0);s=this._callClientId,window._daily.pendings.push(s),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new uh(t,function(){n(!1)},function(i,l){l||Gi(e._callClientId),a(i,l)}),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),Gi(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}])}(),uh=function(){return Qe(function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;Ke(this,s),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=e,this._successCallback=t,this._failureCallback=n},[{key:"start",value:function(){var s=this;if(!this._currentAttempt){var e=function(t){s._currentAttempt.cancelled||(s._attemptsRemaining--,s._failureCallback(t,s._attemptsRemaining>0),s._attemptsRemaining<=0||setTimeout(function(){s._currentAttempt.cancelled||(s._currentAttempt=new zi(s._dailyConfig,s._successCallback,e),s._currentAttempt.start())},3e3))};this._currentAttempt=new zi(this._dailyConfig,this._successCallback,e),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}])}(),Fn=function(){function s(){return Ke(this,s),e=this,n=arguments,t=at(t=s),pn(e,Xl()?Reflect.construct(t,n||[],at(e).constructor):t.apply(e,n));var e,t,n}return fn(s,br(Error)),Qe(s)}(),hn=2e4,zi=function(){return Qe(function e(t,n,a){Ke(this,e),this._loadAttemptImpl=le()||!t.avoidEval?new dh(t,n,a):new hh(t,n,a)},[{key:"start",value:(s=H(function*(){return this._loadAttemptImpl.start()}),function(){return s.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]);var s}(),dh=function(){return Qe(function a(i,l,c){Ke(this,a),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=i,this._successCallback=l,this._failureCallback=c},[{key:"start",value:(n=H(function*(){var a=nn(this._dailyConfig);!(yield this._tryLoadFromIOSCache(a))&&this._loadFromNetwork(a)}),function(){return n.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(t=H(function*(a){if(!this._iosCache)return!1;try{var i=yield this._iosCache.get(a);return!!this.cancelled||!!i&&(i.code?(Function('"use strict";'+i.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=i.refetchHeaders,!1))}catch{return!1}}),function(a){return t.apply(this,arguments)})},{key:"_loadFromNetwork",value:(e=H(function*(a){var i=this;this._networkTimeout=setTimeout(function(){i._networkTimedOut=!0,i._failureCallback({msg:"Timed out (>".concat(hn," ms) when loading call object bundle ").concat(a),type:"timeout"})},hn);try{var l=this._refetchHeaders?{headers:this._refetchHeaders}:{},c=yield fetch(a,l);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new Fn;var d=yield this._getBundleCodeFromResponse(a,c);if(this.cancelled)throw new Fn;Function('"use strict";'+d)(),this._iosCache&&this._iosCache.set(a,d,c.headers),this.succeeded=!0,this._successCallback()}catch(m){if(clearTimeout(this._networkTimeout),m instanceof Fn||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(a,": ").concat(m),type:m.message})}}),function(a){return e.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(s=H(function*(a,i){if(i.ok)return yield i.text();if(this._iosCache&&i.status===304)return(yield this._iosCache.renew(a,i.headers)).code;throw new Error("Received ".concat(i.status," response"))}),function(a,i){return s.apply(this,arguments)})}]);var s,e,t,n}(),hh=function(){return Qe(function s(e,t,n){Ke(this,s),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=e,this._successCallback=t,this._failureCallback=n,this._attemptId=gn(),this._networkTimeout=null,this._scriptElement=null},[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var s=nn(this._dailyConfig);(typeof document>"u"?"undefined":de(document))==="object"?this._startLoading(s):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(s){var e=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){e._stopLoading(),e._failureCallback({msg:"Timed out (>".concat(hn," ms) when loading call object bundle ").concat(s),type:"timeout"})},hn);var t=document.getElementsByTagName("head")[0],n=document.createElement("script");this._scriptElement=n,n.onload=function(){e._stopLoading(),e.succeeded=!0,e._successCallback()},n.onerror=function(a){e._stopLoading(),e._failureCallback({msg:"Failed to load call object bundle ".concat(a.target.src),type:a.message})},n.src=s,t.appendChild(n)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}])}(),$s=function(s,e,t){return ph(s.local,e,t)===!0},mh=function(s,e,t){return s.local.streams&&s.local.streams[e]&&s.local.streams[e].stream&&s.local.streams[e].stream["get".concat(t==="video"?"Video":"Audio","Tracks")]()[0]},Xt=function(s,e,t,n){var a=fh(s,e,t,n);return a&&a.pendingTrack},ph=function(s,e,t){if(!s)return!1;var n=function(i){switch(i){case"avatar":return!0;case"staged":return i;default:return!!i}},a=s.public.subscribedTracks;return a&&a[e]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(t)===-1&&a[e].custom?[!0,"staged"].includes(a[e].custom)?n(a[e].custom):n(a[e].custom[t]):n(a[e][t]):!a||n(a.ALL)},fh=function(s,e,t,n){var a=Object.values(s.streams||{}).filter(function(i){return i.participantId===e&&i.type===t&&i.pendingTrack&&i.pendingTrack.kind===n}).sort(function(i,l){return new Date(l.starttime)-new Date(i.starttime)});return a&&a[0]},gh=function(s,e){var t=s.local.public.customTracks;if(t&&t[e])return t[e].track};function Yi(s,e){for(var t=e.getState(),n=0,a=["cam","screen"];n<a.length;n++)for(var i=a[n],l=0,c=["video","audio"];l<c.length;l++){var d=c[l],m=i==="cam"?d:"screen".concat(d.charAt(0).toUpperCase()+d.slice(1)),g=s.tracks[m];if(g){var _=s.local?mh(t,i,d):Xt(t,s.session_id,i,d);g.state==="playable"&&(g.track=_),g.persistentTrack=_}}}function Wi(s,e){try{var t=e.getState();for(var n in s.tracks)if(!vh(n)){var a=s.tracks[n].kind;if(a){var i=s.tracks[n];if(i){var l=s.local?gh(t,n):Xt(t,s.session_id,n,a);i.state==="playable"&&(s.tracks[n].track=l),i.persistentTrack=l}}else console.error("unknown type for custom track")}}catch(c){console.error(c)}}function vh(s){return["video","audio","screenVideo","screenAudio"].includes(s)}function Hi(s,e,t){var n=t.getState();if(s.local){if(s.audio)try{s.audioTrack=n.local.streams.cam.stream.getAudioTracks()[0],s.audioTrack||(s.audio=!1)}catch{}if(s.video)try{s.videoTrack=n.local.streams.cam.stream.getVideoTracks()[0],s.videoTrack||(s.video=!1)}catch{}if(s.screen)try{s.screenVideoTrack=n.local.streams.screen.stream.getVideoTracks()[0],s.screenAudioTrack=n.local.streams.screen.stream.getAudioTracks()[0],s.screenVideoTrack||s.screenAudioTrack||(s.screen=!1)}catch{}}else{var a=!0;try{var i=n.participants[s.session_id];i&&i.public&&i.public.rtcType&&i.public.rtcType.impl==="peer-to-peer"&&i.private&&!["connected","completed"].includes(i.private.peeringState)&&(a=!1)}catch(g){console.error(g)}if(!a)return s.audio=!1,s.audioTrack=!1,s.video=!1,s.videoTrack=!1,s.screen=!1,void(s.screenTrack=!1);try{if(n.streams,s.audio&&$s(n,s.session_id,"cam-audio")){var l=Xt(n,s.session_id,"cam","audio");l&&(e&&e.audioTrack&&e.audioTrack.id===l.id?s.audioTrack=l:l.muted||(s.audioTrack=l)),s.audioTrack||(s.audio=!1)}if(s.video&&$s(n,s.session_id,"cam-video")){var c=Xt(n,s.session_id,"cam","video");c&&(e&&e.videoTrack&&e.videoTrack.id===c.id?s.videoTrack=c:c.muted||(s.videoTrack=c)),s.videoTrack||(s.video=!1)}if(s.screen&&$s(n,s.session_id,"screen-audio")){var d=Xt(n,s.session_id,"screen","audio");d&&(e&&e.screenAudioTrack&&e.screenAudioTrack.id===d.id?s.screenAudioTrack=d:d.muted||(s.screenAudioTrack=d))}if(s.screen&&$s(n,s.session_id,"screen-video")){var m=Xt(n,s.session_id,"screen","video");m&&(e&&e.screenVideoTrack&&e.screenVideoTrack.id===m.id?s.screenVideoTrack=m:m.muted||(s.screenVideoTrack=m))}s.screenVideoTrack||s.screenAudioTrack||(s.screen=!1)}catch(g){console.error("unexpected error matching up tracks",g)}}}function yh(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return Ki(d,m);var g={}.toString.call(d).slice(8,-1);return g==="Object"&&d.constructor&&(g=d.constructor.name),g==="Map"||g==="Set"?Array.from(d):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?Ki(d,m):void 0}}(s))||e){t&&(s=t);var n=0,a=function(){};return{s:a,n:function(){return n>=s.length?{done:!0}:{done:!1,value:s[n++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function Ki(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=Array(e);t<e;t++)n[t]=s[t];return n}var lt=new Map,rs=null;function bh(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return Qi(d,m);var g={}.toString.call(d).slice(8,-1);return g==="Object"&&d.constructor&&(g=d.constructor.name),g==="Map"||g==="Set"?Array.from(d):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?Qi(d,m):void 0}}(s))||e){t&&(s=t);var n=0,a=function(){};return{s:a,n:function(){return n>=s.length?{done:!0}:{done:!1,value:s[n++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function Qi(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=Array(e);t<e;t++)n[t]=s[t];return n}var ct=new Map,xs=null;function _h(s){Zl()?function(e){lt.has(e)||(lt.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(t){lt.has(e)&&(lt.get(e).lastDevicesString=JSON.stringify(t),rs||(rs=function(){var n=H(function*(){var a,i=yield navigator.mediaDevices.enumerateDevices(),l=yh(lt.keys());try{for(l.s();!(a=l.n()).done;){var c=a.value,d=JSON.stringify(i);d!==lt.get(c).lastDevicesString&&(lt.get(c).lastDevicesString=d,c(i))}}catch(m){l.e(m)}finally{l.f()}});return function(){return n.apply(this,arguments)}}(),navigator.mediaDevices.addEventListener("devicechange",rs)))}).catch(function(){}))}(s):function(e){ct.has(e)||(ct.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(t){ct.has(e)&&(ct.get(e).lastDevicesString=JSON.stringify(t),xs||(xs=setInterval(H(function*(){var n,a=yield navigator.mediaDevices.enumerateDevices(),i=bh(ct.keys());try{for(i.s();!(n=i.n()).done;){var l=n.value,c=JSON.stringify(a);c!==ct.get(l).lastDevicesString&&(ct.get(l).lastDevicesString=c,l(a))}}catch(d){i.e(d)}finally{i.f()}}),3e3)))}))}(s)}function xh(s){Zl()?function(e){lt.has(e)&&(lt.delete(e),lt.size===0&&rs&&(navigator.mediaDevices.removeEventListener("devicechange",rs),rs=null))}(s):function(e){ct.has(e)&&(ct.delete(e),ct.size===0&&xs&&(clearInterval(xs),xs=null))}(s)}function Zl(){var s;return le()||((s=navigator.mediaDevices)===null||s===void 0?void 0:s.ondevicechange)!==void 0}var wh=new Set;function Sh(s,e){return s&&s.readyState==="live"&&!function(t,n){return t.muted&&!wh.has(t.id)}(s)}function Xi(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,n)}return t}function jt(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Xi(Object(t),!0).forEach(function(n){ut(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Xi(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}var _s=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),jh=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),ws=Object.values(_s),Zi=["v","a","sv","sa","cv","ca"];Object.freeze(ws.reduce(function(s,e,t){return s[e]=Zi[t],s},{})),Object.freeze(Zi.reduce(function(s,e,t){return s[e]=ws[t],s},{}));var kh=[_s.VIDEO,_s.AUDIO,_s.SCREEN_VIDEO,_s.SCREEN_AUDIO],eo=Object.values(jh),to=["p","s","t"];Object.freeze(eo.reduce(function(s,e,t){return s[e]=to[t],s},{})),Object.freeze(to.reduce(function(s,e,t){return s[e]=eo[t],s},{}));var ec=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.base,n=e.byUserId,a=e.byParticipantId;Ke(this,s),this.base=t,this.byUserId=n,this.byParticipantId=a}return Qe(s,[{key:"clone",value:function(){var e=new s;if(this.base instanceof Ie?e.base=this.base.clone():e.base=this.base,this.byUserId!==void 0)for(var t in e.byUserId={},this.byUserId){var n=this.byUserId[t];e.byUserId[t]=n instanceof Ie?n.clone():n}if(this.byParticipantId!==void 0)for(var a in e.byParticipantId={},this.byParticipantId){var i=this.byParticipantId[a];e.byParticipantId[a]=i instanceof Ie?i.clone():i}return e}},{key:"toJSONObject",value:function(){var e={};if(typeof this.base=="boolean"?e.base=this.base:this.base instanceof Ie&&(e.base=this.base.toJSONObject()),this.byUserId!==void 0)for(var t in e.byUserId={},this.byUserId){var n=this.byUserId[t];e.byUserId[t]=n instanceof Ie?n.toJSONObject():n}if(this.byParticipantId!==void 0)for(var a in e.byParticipantId={},this.byParticipantId){var i=this.byParticipantId[a];e.byParticipantId[a]=i instanceof Ie?i.toJSONObject():i}return e}},{key:"toMinifiedJSONObject",value:function(){var e={};if(this.base!==void 0&&(typeof this.base=="boolean"?e.b=this.base:e.b=this.base.toMinifiedJSONObject()),this.byUserId!==void 0)for(var t in e.u={},this.byUserId){var n=this.byUserId[t];e.u[t]=typeof n=="boolean"?n:n.toMinifiedJSONObject()}if(this.byParticipantId!==void 0)for(var a in e.p={},this.byParticipantId){var i=this.byParticipantId[a];e.p[a]=typeof i=="boolean"?i:i.toMinifiedJSONObject()}return e}},{key:"normalize",value:function(){return this.base instanceof Ie&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map(function(e){var t=Re(e,2),n=t[0],a=t[1];return[n,a instanceof Ie?a.normalize():a]}))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map(function(e){var t=Re(e,2),n=t[0],a=t[1];return[n,a instanceof Ie?a.normalize():a]}))),this}}],[{key:"fromJSONObject",value:function(e){var t,n,a;if(e.base!==void 0&&(t=typeof e.base=="boolean"?e.base:Ie.fromJSONObject(e.base)),e.byUserId!==void 0)for(var i in n={},e.byUserId){var l=e.byUserId[i];n[i]=typeof l=="boolean"?l:Ie.fromJSONObject(l)}if(e.byParticipantId!==void 0)for(var c in a={},e.byParticipantId){var d=e.byParticipantId[c];a[c]=typeof d=="boolean"?d:Ie.fromJSONObject(d)}return new s({base:t,byUserId:n,byParticipantId:a})}},{key:"fromMinifiedJSONObject",value:function(e){var t,n,a;if(e.b!==void 0&&(t=typeof e.b=="boolean"?e.b:Ie.fromMinifiedJSONObject(e.b)),e.u!==void 0)for(var i in n={},e.u){var l=e.u[i];n[i]=typeof l=="boolean"?l:Ie.fromMinifiedJSONObject(l)}if(e.p!==void 0)for(var c in a={},e.p){var d=e.p[c];a[c]=typeof d=="boolean"?d:Ie.fromMinifiedJSONObject(d)}return new s({base:t,byUserId:n,byParticipantId:a})}},{key:"validateJSONObject",value:function(e){if(de(e)!=="object")return[!1,"canReceive must be an object"];for(var t=["base","byUserId","byParticipantId"],n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];if(!t.includes(i))return[!1,"canReceive can only contain keys (".concat(t.join(", "),")")];if(i==="base"){var l=Re(Ie.validateJSONObject(e.base,!0),2),c=l[0],d=l[1];if(!c)return[!1,d]}else{if(de(e[i])!=="object")return[!1,"invalid (non-object) value for field '".concat(i,"' in canReceive")];for(var m=0,g=Object.values(e[i]);m<g.length;m++){var _=g[m],M=Re(Ie.validateJSONObject(_),2),E=M[0],k=M[1];if(!E)return[!1,k]}}}return[!0]}}])}(),Ie=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.video,n=e.audio,a=e.screenVideo,i=e.screenAudio,l=e.customVideo,c=e.customAudio;Ke(this,s),this.video=t,this.audio=n,this.screenVideo=a,this.screenAudio=i,this.customVideo=l,this.customAudio=c}return Qe(s,[{key:"clone",value:function(){var e=new s;return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=jt({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=jt({},this.customAudio)),e}},{key:"toJSONObject",value:function(){var e={};return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=jt({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=jt({},this.customAudio)),e}},{key:"toMinifiedJSONObject",value:function(){var e={};return this.video!==void 0&&(e.v=this.video),this.audio!==void 0&&(e.a=this.audio),this.screenVideo!==void 0&&(e.sv=this.screenVideo),this.screenAudio!==void 0&&(e.sa=this.screenAudio),this.customVideo!==void 0&&(e.cv=jt({},this.customVideo)),this.customAudio!==void 0&&(e.ca=jt({},this.customAudio)),e}},{key:"normalize",value:function(){function e(t,n){return t&&Object.keys(t).length===1&&t["*"]===n}return!(this.video!==!0||this.audio!==!0||this.screenVideo!==!0||this.screenAudio!==!0||!e(this.customVideo,!0)||!e(this.customAudio,!0))||(this.video!==!1||this.audio!==!1||this.screenVideo!==!1||this.screenAudio!==!1||!e(this.customVideo,!1)||!e(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(e){return new s({video:e,audio:e,screenVideo:e,screenAudio:e,customVideo:{"*":e},customAudio:{"*":e}})}},{key:"fromJSONObject",value:function(e){return new s({video:e.video,audio:e.audio,screenVideo:e.screenVideo,screenAudio:e.screenAudio,customVideo:e.customVideo!==void 0?jt({},e.customVideo):void 0,customAudio:e.customAudio!==void 0?jt({},e.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(e){return new s({video:e.v,audio:e.a,screenVideo:e.sv,screenAudio:e.sa,customVideo:e.cv,customAudio:e.ca})}},{key:"validateJSONObject",value:function(e,t){if(typeof e=="boolean")return[!0];if(de(e)!=="object")return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var n=Object.keys(e),a=0,i=n;a<i.length;a++){var l=i[a];if(!ws.includes(l))return[!1,"invalid media type '".concat(l,"' in canReceive")];if(kh.includes(l)){if(typeof e[l]!="boolean")return[!1,"invalid (non-boolean) value for media type '".concat(l,"' in canReceive")]}else{if(de(e[l])!=="object")return[!1,"invalid (non-object) value for media type '".concat(l,"' in canReceive")];for(var c=0,d=Object.values(e[l]);c<d.length;c++)if(typeof d[c]!="boolean")return[!1,"invalid (non-boolean) value for entry within '".concat(l,"' in canReceive")];if(t&&e[l]["*"]===void 0)return[!1,`canReceive "base" permission must specify "*" as an entry within '`.concat(l,"'")]}}return t&&n.length!==ws.length?[!1,'canReceive "base" permission must specify all media types: '.concat(ws.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])}(),Ch=["result"],Eh=["preserveIframe"];function so(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,n)}return t}function J(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?so(Object(t),!0).forEach(function(n){ut(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):so(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function tc(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tc=function(){return!!s})()}function no(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return ro(d,m);var g={}.toString.call(d).slice(8,-1);return g==="Object"&&d.constructor&&(g=d.constructor.name),g==="Map"||g==="Set"?Array.from(d):g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g)?ro(d,m):void 0}}(s))||e){t&&(s=t);var n=0,a=function(){};return{s:a,n:function(){return n>=s.length?{done:!0}:{done:!1,value:s[n++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function ro(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=Array(e);t<e;t++)n[t]=s[t];return n}var Ft={},ao="video",Nh="voice",io=le()?{data:{}}:{data:{},topology:"none"},oo={present:0,hidden:0},sc={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},Vn=Object.keys(sc),lo=["state","volume","simulcastEncodings"],co={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},mn={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},_r={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},Vt={customIntegrations:{validate:uc,help:lc()},customTrayButtons:{validate:cc,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(mn))},url:{validate:function(s){return typeof s=="string"},help:"url should be a string"},baseUrl:{validate:function(s){return typeof s=="string"},help:"baseUrl should be a string"},token:{validate:function(s){return typeof s=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(s,e){try{return e.validateDailyConfig(s),!0}catch(t){console.error("Failed to validate dailyConfig",t)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(s){return dc(s,co)},help:"reactNativeConfig should look like ".concat(JSON.stringify(co),", all fields optional")},lang:{validate:function(s){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(s)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(s){try{return nc(s),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(s,e){if(typeof s=="boolean")return e._preloadCache.allowLocalVideo=s,!0;var t;if(s instanceof MediaStreamTrack)e._sharedTracks.videoTrack=s,t={customTrack:vt};else{if(delete e._sharedTracks.videoTrack,typeof s!="string")return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;t={deviceId:s}}return e._updatePreloadCacheInputSettings({video:{settings:t}},!1),!0}},audioSource:{validate:function(s,e){if(typeof s=="boolean")return e._preloadCache.allowLocalAudio=s,!0;var t;if(s instanceof MediaStreamTrack)e._sharedTracks.audioTrack=s,t={customTrack:vt};else{if(delete e._sharedTracks.audioTrack,typeof s!="string")return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;t={deviceId:s}}return e._updatePreloadCacheInputSettings({audio:{settings:t}},!1),!0}},subscribeToTracksAutomatically:{validate:function(s,e){return e._preloadCache.subscribeToTracksAutomatically=s,!0}},theme:{validate:function(s){var e=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],t=function(n){for(var a=0,i=Object.keys(n);a<i.length;a++){var l=i[a];if(!e.includes(l))return console.error('unsupported color "'.concat(l,'". Valid colors: ').concat(e.join(", "))),!1;if(!n[l].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(l,' theme color should be provided in valid hex color format. Received: "').concat(n[l],'"')),!1}return!0};return de(s)==="object"&&("light"in s&&"dark"in s||"colors"in s)?"light"in s&&"dark"in s?"colors"in s.light?"colors"in s.dark?t(s.light.colors)&&t(s.dark.colors):(console.error('Dark theme is missing "colors" property.',s),!1):(console.error('Light theme is missing "colors" property.',s),!1):t(s.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',s),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(s){if("grid"in s){var e=s.grid;if("maxTilesPerPage"in e){if(!Number.isInteger(e.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(e.maxTilesPerPage,".")),!1;if(e.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in e){if(!Number.isInteger(e.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(e.minTilesPerPage,".")),!1;if(e.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in e&&e.minTilesPerPage>e.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(s){return rc(s,{allowAllParticipantsKey:!1})},help:oc({allowAllParticipantsKey:!1})},sendSettings:{validate:function(s,e){return!!function(t,n){try{return n.validateUpdateSendSettings(t),!0}catch(a){return console.error("Failed to validate send settings",a),!1}}(s,e)&&(e._preloadCache.sendSettings=s,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(s,e){var t;return!!ac(s)&&(e._inputSettings||(e._inputSettings={}),ic(s,(t=e.properties)===null||t===void 0?void 0:t.dailyConfig,e._sharedTracks),e._updatePreloadCacheInputSettings(s,!0),!0)},help:xr()},layout:{validate:function(s){return s==="custom-v1"||s==="browser"||s==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},Js={styles:{validate:function(s){for(var e in s)if(e!=="cam"&&e!=="screen")return!1;if(s.cam){for(var t in s.cam)if(t!=="div"&&t!=="video")return!1}if(s.screen){for(var n in s.screen)if(n!=="div"&&n!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(s,e){if(e._preloadCache.subscribeToTracksAutomatically)return!1;var t=[!0,!1,"staged"];if(t.includes(s)||!le()&&s==="avatar")return!0;var n=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],a=function(i){var l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var c in i)if(c==="custom"){if(!t.includes(i[c])&&!a(i[c],!0))return!1}else{var d=!l&&!n.includes(c),m=!t.includes(i[c]);if(d||m)return!1}return!0};return a(s)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(le()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(s){return s===!1},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(s){for(var e=0,t=Object.entries(s);e<t.length;e++){var n=Re(t[e],2),a=n[0],i=n[1];switch(a){case"hasPresence":if(typeof i!="boolean")return!1;break;case"canSend":if(i instanceof Set||i instanceof Array||Array.isArray(i)){var l,c=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],d=no(i);try{for(d.s();!(l=d.n()).done;){var m=l.value;if(!c.includes(m))return!1}}catch(p){d.e(p)}finally{d.f()}}else if(typeof i!="boolean")return!1;(i instanceof Array||Array.isArray(i))&&(s.canSend=new Set(i));break;case"canReceive":var g=Re(ec.validateJSONObject(i),2),_=g[0],M=g[1];if(!_)return console.error(M),!1;break;case"canAdmin":if(i instanceof Set||i instanceof Array||Array.isArray(i)){var E,k=["participants","streaming","transcription"],b=no(i);try{for(b.s();!(E=b.n()).done;){var x=E.value;if(!k.includes(x))return!1}}catch(p){b.e(p)}finally{b.f()}}else if(typeof i!="boolean")return!1;(i instanceof Array||Array.isArray(i))&&(s.canAdmin=new Set(i));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};Promise.any||(Promise.any=function(){var s=H(function*(e){return new Promise(function(t,n){var a=[];e.forEach(function(i){return Promise.resolve(i).then(function(l){t(l)}).catch(function(l){a.push(l),a.length===e.length&&n(a)})})})});return function(e){return s.apply(this,arguments)}}());var Th=function(){function s(o){var h,u,f,v,N,I,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Ke(this,s),f=this,v=at(v=s),ut(u=pn(f,tc()?Reflect.construct(v,[],at(f).constructor):v.apply(f,N)),"startListeningForDeviceChanges",function(){_h(u.handleDeviceChange)}),ut(u,"stopListeningForDeviceChanges",function(){xh(u.handleDeviceChange)}),ut(u,"handleDeviceChange",function(Z){Z=Z.map(function(ne){return JSON.parse(JSON.stringify(ne))}),u.emitDailyJSEvent({action:"available-devices-updated",availableDevices:Z})}),ut(u,"handleNativeAppStateChange",function(){var Z=H(function*(ne){if(ne==="destroyed")return console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),void(yield u.destroy());var Ge=ne==="active";u.disableReactNativeAutoDeviceManagement("video")||(Ge?u.camUnmutedBeforeLosingNativeActiveState&&u.setLocalVideo(!0):(u.camUnmutedBeforeLosingNativeActiveState=u.localVideo(),u.camUnmutedBeforeLosingNativeActiveState&&u.setLocalVideo(!1)))});return function(ne){return Z.apply(this,arguments)}}()),ut(u,"handleNativeAudioFocusChange",function(Z){u.disableReactNativeAutoDeviceManagement("audio")||(u._hasNativeAudioFocus=Z,u.toggleParticipantAudioBasedOnNativeAudioFocus(),u._hasNativeAudioFocus?u.micUnmutedBeforeLosingNativeAudioFocus&&u.setLocalAudio(!0):(u.micUnmutedBeforeLosingNativeAudioFocus=u.localAudio(),u.setLocalAudio(!1)))}),ut(u,"handleNativeSystemScreenCaptureStop",function(){u.stopScreenShare()}),u.strictMode=P.strictMode===void 0||P.strictMode,u.allowMultipleCallInstances=(h=P.allowMultipleCallInstances)!==null&&h!==void 0&&h,Object.keys(Ft).length&&(u._logDuplicateInstanceAttempt(),!u.allowMultipleCallInstances)){if(u.strictMode)throw new Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),u.callClientId=gn(),Ft[(I=u).callClientId]=I,window._daily.instances[u.callClientId]={},u._sharedTracks={},window._daily.instances[u.callClientId].tracks=u._sharedTracks,P.dailyJsVersion=s.version(),u._iframe=o,u._callObjectMode=P.layout==="none"&&!u._iframe,u._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},P.showLocalVideo!==void 0?u._callObjectMode?console.error("showLocalVideo is not available in call object mode"):u._showLocalVideo=!!P.showLocalVideo:u._showLocalVideo=!0,P.showParticipantsBar!==void 0?u._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):u._showParticipantsBar=!!P.showParticipantsBar:u._showParticipantsBar=!0,P.customIntegrations!==void 0?u._callObjectMode?console.error("customIntegrations is not available in call object mode"):u._customIntegrations=P.customIntegrations:u._customIntegrations={},P.customTrayButtons!==void 0?u._callObjectMode?console.error("customTrayButtons is not available in call object mode"):u._customTrayButtons=P.customTrayButtons:u._customTrayButtons={},P.activeSpeakerMode!==void 0?u._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):u._activeSpeakerMode=!!P.activeSpeakerMode:u._activeSpeakerMode=!1,P.receiveSettings?u._callObjectMode?u._receiveSettings=P.receiveSettings:console.error("receiveSettings is only available in call object mode"):u._receiveSettings={},u.validateProperties(P),u.properties=J({},P),u._inputSettings||(u._inputSettings={}),u._callObjectLoader=u._callObjectMode?new ch(u.callClientId):null,u._callState=or,u._isPreparingToJoin=!1,u._accessState={access:Ws},u._meetingSessionSummary={},u._finalSummaryOfPrevSession={},u._meetingSessionState=Bn(io,u._callObjectMode),u._nativeInCallAudioMode=ao,u._participants={},u._isScreenSharing=!1,u._participantCounts=oo,u._rmpPlayerState={},u._waitingParticipants={},u._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},u._activeSpeaker={},u._localAudioLevel=0,u._isLocalAudioLevelObserverRunning=!1,u._remoteParticipantsAudioLevel={},u._isRemoteParticipantsAudioLevelObserverRunning=!1,u._maxAppMessageSize=Pn,u._messageChannel=le()?new oh:new ih,u._iframe&&(u._iframe.requestFullscreen?u._iframe.addEventListener("fullscreenchange",function(){document.fullscreenElement===u._iframe?(u.emitDailyJSEvent({action:ys}),u.sendMessageToCallMachine({action:ys})):(u.emitDailyJSEvent({action:bs}),u.sendMessageToCallMachine({action:bs}))}):u._iframe.webkitRequestFullscreen&&u._iframe.addEventListener("webkitfullscreenchange",function(){document.webkitFullscreenElement===u._iframe?(u.emitDailyJSEvent({action:ys}),u.sendMessageToCallMachine({action:ys})):(u.emitDailyJSEvent({action:bs}),u.sendMessageToCallMachine({action:bs}))})),le()){var F=u.nativeUtils();F.addAudioFocusChangeListener&&F.removeAudioFocusChangeListener&&F.addAppStateChangeListener&&F.removeAppStateChangeListener&&F.addSystemScreenCaptureStopListener&&F.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),u._hasNativeAudioFocus=!0,F.addAudioFocusChangeListener(u.handleNativeAudioFocusChange),F.addAppStateChangeListener(u.handleNativeAppStateChange),F.addSystemScreenCaptureStopListener(u.handleNativeSystemScreenCaptureStop)}return u._callObjectMode&&u.startListeningForDeviceChanges(),u._messageChannel.addListenerForMessagesFromCallMachine(u.handleMessageFromCallMachine,u.callClientId,u),u}return fn(s,Ps),Qe(s,[{key:"destroy",value:(je=H(function*(){var o;try{yield this.leave()}catch{}var h=this._iframe;if(h){var u=h.parentElement;u&&u.removeChild(h)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),le()){var f=this.nativeUtils();f.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),f.removeAppStateChangeListener(this.handleNativeAppStateChange),f.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete Ft[this.callClientId],!((o=window)===null||o===void 0||(o=o._daily)===null||o===void 0)&&o.instances&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)}),function(){return je.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(o){var h=o.bodyClass,u=o.cssFile,f=o.cssText;return ae(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(u),bodyClass:h,cssText:f}),this}},{key:"iframe",value:function(){return ae(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return st(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return st(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(o,h){for(var u in h){if(!Js[u])throw new Error("unrecognized updateParticipant property ".concat(u));if(Js[u].validate&&!Js[u].validate(h[u],this,this._participants[o]))throw new Error(Js[u].help)}}},{key:"updateParticipant",value:function(o,h){return this._participants.local&&this._participants.local.session_id===o&&(o="local"),o&&h&&(this.validateParticipantProperties(o,h),this.sendMessageToCallMachine({action:"update-participant",id:o,properties:h})),this}},{key:"updateParticipants",value:function(o){var h=this._participants.local&&this._participants.local.session_id;for(var u in o)u===h&&(u="local"),u&&o[u]&&this.validateParticipantProperties(u,o[u]);return this.sendMessageToCallMachine({action:"update-participants",participants:o}),this}},{key:"updateWaitingParticipant",value:(B=H(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(st(this._callObjectMode,"updateWaitingParticipant()"),ge(this._callState,"updateWaitingParticipant()"),typeof h!="string"||de(u)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(f,v){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:h,updates:u},function(N){N.error&&v(N.error),N.id||v(new Error("unknown error in updateWaitingParticipant()")),f({id:N.id})})})}),function(){return B.apply(this,arguments)})},{key:"updateWaitingParticipants",value:(Ne=H(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(st(this._callObjectMode,"updateWaitingParticipants()"),ge(this._callState,"updateWaitingParticipants()"),de(h)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(u,f){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:h},function(v){v.error&&f(v.error),v.ids||f(new Error("unknown error in updateWaitingParticipants()")),u({ids:v.ids})})})}),function(){return Ne.apply(this,arguments)})},{key:"requestAccess",value:(Je=H(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=h.access,f=u===void 0?{level:Bo}:u,v=h.name,N=v===void 0?"":v;return st(this._callObjectMode,"requestAccess()"),ge(this._callState,"requestAccess()"),new Promise(function(I,P){o.sendMessageToCallMachine({action:"daily-method-request-access",access:f,name:N},function(F){F.error&&P(F.error),F.access||P(new Error("unknown error in requestAccess()")),I({access:F.access,granted:F.granted})})})}),function(){return Je.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"forceDiscardTrack"in h&&(le()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),h={}):o&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),h={})),this.sendMessageToCallMachine({action:"local-audio",state:o,options:h}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(o){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:o}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(o){return this.sendMessageToCallMachine({action:"local-video",state:o}),this}},{key:"_setAllowLocalAudio",value:function(o){if(this._preloadCache.allowLocalAudio=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:o}),this}},{key:"_setAllowLocalVideo",value:function(o){if(this._preloadCache.allowLocalVideo=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:o}),this}},{key:"getReceiveSettings",value:(Ue=H(function*(o){var h=this,u=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,f=u!==void 0&&u;if(st(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(de(o)){case"string":return new Promise(function(v){h.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:o,showInheritedValues:f},function(N){v(N.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}}),function(o){return Ue.apply(this,arguments)})},{key:"updateReceiveSettings",value:(y=H(function*(o){var h=this;if(st(this._callObjectMode,"updateReceiveSettings()"),!rc(o,{allowAllParticipantsKey:!0}))throw new Error(oc({allowAllParticipantsKey:!0}));return ge(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise(function(u){h.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:o},function(f){u({receiveSettings:f.receiveSettings})})})}),function(o){return y.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(o,h){if(o){var u={};if(o.audio){var f,v,N;o.audio.settings&&(!Object.keys(o.audio.settings).length&&h||(u.audio={settings:J({},o.audio.settings)})),h&&(f=u.audio)!==null&&f!==void 0&&(f=f.settings)!==null&&f!==void 0&&f.customTrack&&(u.audio.settings={customTrack:this._sharedTracks.audioTrack});var I=((v=o.audio.processor)===null||v===void 0?void 0:v.type)==="none"&&((N=o.audio.processor)===null||N===void 0?void 0:N._isDefaultWhenNone);if(o.audio.processor&&!I){var P=J({},o.audio.processor);delete P._isDefaultWhenNone,u.audio=J(J({},u.audio),{},{processor:P})}}if(o.video){var F,Z,ne;o.video.settings&&(!Object.keys(o.video.settings).length&&h||(u.video={settings:J({},o.video.settings)})),h&&(F=u.video)!==null&&F!==void 0&&(F=F.settings)!==null&&F!==void 0&&F.customTrack&&(u.video.settings={customTrack:this._sharedTracks.videoTrack});var Ge=((Z=o.video.processor)===null||Z===void 0?void 0:Z.type)==="none"&&((ne=o.video.processor)===null||ne===void 0?void 0:ne._isDefaultWhenNone);if(o.video.processor&&!Ge){var it=J({},o.video.processor);delete it._isDefaultWhenNone,u.video=J(J({},u.video),{},{processor:it})}}return u}}},{key:"getInputSettings",value:function(){var o=this;return ae(),new Promise(function(h){h(o._getInputSettings())})}},{key:"_getInputSettings",value:function(){var o,h,u,f,v,N,I={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(o=((u=this._inputSettings)===null||u===void 0?void 0:u.video)||I,h=((f=this._inputSettings)===null||f===void 0?void 0:f.audio)||I):(o=((v=this._preloadCache)===null||v===void 0||(v=v.inputSettings)===null||v===void 0?void 0:v.video)||I,h=((N=this._preloadCache)===null||N===void 0||(N=N.inputSettings)===null||N===void 0?void 0:N.audio)||I);var P={audio:h,video:o};return this._prepInputSettingsForSharing(P,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(o,h){var u=this._inputSettings||{},f={};if(o.video){var v,N,I;f.video={},o.video.settings?(f.video.settings={},h||o.video.settings.customTrack||(I=u.video)===null||I===void 0||!I.settings?f.video.settings=o.video.settings:f.video.settings=J(J({},u.video.settings),o.video.settings),Object.keys(f.video.settings).length||delete f.video.settings):(v=u.video)!==null&&v!==void 0&&v.settings&&(f.video.settings=u.video.settings),o.video.processor?f.video.processor=o.video.processor:(N=u.video)!==null&&N!==void 0&&N.processor&&(f.video.processor=u.video.processor)}else u.video&&(f.video=u.video);if(o.audio){var P,F,Z;f.audio={},o.audio.settings?(f.audio.settings={},h||o.audio.settings.customTrack||(Z=u.audio)===null||Z===void 0||!Z.settings?f.audio.settings=o.audio.settings:f.audio.settings=J(J({},u.audio.settings),o.audio.settings),Object.keys(f.audio.settings).length||delete f.audio.settings):(P=u.audio)!==null&&P!==void 0&&P.settings&&(f.audio.settings=u.audio.settings),o.audio.processor?f.audio.processor=o.audio.processor:(F=u.audio)!==null&&F!==void 0&&F.processor&&(f.audio.processor=u.audio.processor)}else u.audio&&(f.audio=u.audio);this._maybeUpdateInputSettings(f)}},{key:"_devicesFromInputSettings",value:function(o){var h,u,f=(o==null||(h=o.video)===null||h===void 0||(h=h.settings)===null||h===void 0?void 0:h.deviceId)||null,v=(o==null||(u=o.audio)===null||u===void 0||(u=u.settings)===null||u===void 0?void 0:u.deviceId)||null,N=this._preloadCache.outputDeviceId||null;return{camera:f?{deviceId:f}:{},mic:v?{deviceId:v}:{},speaker:N?{deviceId:N}:{}}}},{key:"updateInputSettings",value:($e=H(function*(o){var h=this;return ae(),ac(o)?o.video||o.audio?(ic(o,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(o,!0),this._getInputSettings()):new Promise(function(u,f){h.sendMessageToCallMachine({action:"update-input-settings",inputSettings:o},function(v){if(v.error)f(v.error);else{if(v.returnPreloadCache)return h._updatePreloadCacheInputSettings(o,!0),void u(h._getInputSettings());h._maybeUpdateInputSettings(v.inputSettings),u(h._prepInputSettingsForSharing(v.inputSettings,!0))}})})):this._getInputSettings():(console.error(xr()),Promise.reject(xr()))}),function(o){return $e.apply(this,arguments)})},{key:"setBandwidth",value:function(o){var h=o.kbs,u=o.trackConstraints;if(ae(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:h,trackConstraints:u}),this}},{key:"getDailyLang",value:function(){var o=this;if(ae(),this._callMachineInitialized)return new Promise(function(h){o.sendMessageToCallMachine({action:"get-daily-lang"},function(u){delete u.action,delete u.callbackStamp,h(u)})})}},{key:"setDailyLang",value:function(o){return ae(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:o}),this}},{key:"setProxyUrl",value:function(o){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:o}),this}},{key:"setIceConfig",value:function(o){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:o}),this}},{key:"meetingSessionSummary",value:function(){return[Et,dt].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(Ee=H(function*(){var o=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),ge(this._callState,"getMeetingSession()"),new Promise(function(h){o.sendMessageToCallMachine({action:"get-meeting-session"},function(u){delete u.action,delete u.callbackStamp,h(u)})})}),function(){return Ee.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return ge(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"replace";st(this._callObjectMode,"setMeetingSessionData()"),ge(this._callState,"setMeetingSessionData");try{(function(u,f){new lh({data:u,mergeStrategy:f})})(o,h)}catch(u){throw console.error(u),u}try{this.sendMessageToCallMachine({action:"set-session-data",data:o,mergeStrategy:h})}catch(u){throw new Error("Error setting meeting session data: ".concat(u))}}},{key:"setUserName",value:function(o,h){var u=this;return this.properties.userName=o,new Promise(function(f){u.sendMessageToCallMachine({action:"set-user-name",name:o??"",thisMeetingOnly:le()||!!h&&!!h.thisMeetingOnly},function(v){delete v.action,delete v.callbackStamp,f(v)})})}},{key:"setUserData",value:(z=H(function*(o){var h=this;try{nc(o)}catch(u){throw console.error(u),u}if(this.properties.userData=o,this._callMachineInitialized)return new Promise(function(u){try{h.sendMessageToCallMachine({action:"set-user-data",userData:o},function(f){delete f.action,delete f.callbackStamp,u(f)})}catch(f){throw new Error("Error setting user data: ".concat(f))}})}),function(o){return z.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(o){if(o&&(o<100||typeof o!="number"))throw new Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(o){var h=this;if(typeof AudioWorkletNode>"u"&&!le())throw new Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise(function(u,f){h.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:o},function(v){h._isLocalAudioLevelObserverRunning=!v.error,v.error?f({error:v.error}):u()})});this._preloadCache.localAudioLevelObserver={enabled:!0,interval:o}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(o){var h=this;if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise(function(u,f){h.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:o},function(v){h._isRemoteParticipantsAudioLevelObserverRunning=!v.error,v.error?f({error:v.error}):u()})});this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:o}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(V=H(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(st(this._callObjectMode,"startCamera()"),qn(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(h)}catch(u){return Promise.reject(u)}else{if(this._didPreAuth){if(h.url&&h.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(h.token&&h.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(h),this.properties=J(J({},this.properties),h)}return new Promise(function(u){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"start-camera",properties:Qt(o.properties,o.callClientId),preloadCache:Qt(o._preloadCache,o.callClientId)},function(f){u({camera:f.camera,mic:f.mic,speaker:f.speaker})})})}),function(){return V.apply(this,arguments)})},{key:"validateCustomTrack",value:function(o,h,u){if(u&&u.length>50)throw new Error("Custom track `trackName` must not be more than 50 characters");if(h&&h!=="music"&&h!=="speech"&&!(h instanceof Object))throw new Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(u&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(u))throw new Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(o instanceof MediaStreamTrack))throw new Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{track,mode,trackName};return ae(),ge(this._callState,"startCustomTrack()"),this.validateCustomTrack(h.track,h.mode,h.trackName),new Promise(function(u,f){o._sharedTracks.customTrack=h.track,h.track=vt,o.sendMessageToCallMachine({action:"start-custom-track",properties:h},function(v){v.error?f({error:v.error}):u(v.mediaTag)})})}},{key:"stopCustomTrack",value:function(o){var h=this;return ae(),ge(this._callState,"stopCustomTrack()"),new Promise(function(u){h.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:o},function(f){u(f.mediaTag)})})}},{key:"setCamera",value:function(o){var h=this;return fs(),Gs(this._callMachineInitialized,"setCamera()"),new Promise(function(u){h.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:o},function(f){u({device:f.device})})})}},{key:"setAudioDevice",value:(S=H(function*(o){return fs(),this.nativeUtils().setAudioDevice(o),{deviceId:yield this.nativeUtils().getAudioDevice()}}),function(o){return S.apply(this,arguments)})},{key:"cycleCamera",value:function(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(u){o.sendMessageToCallMachine({action:"cycle-camera",properties:h},function(f){u({device:f.device})})})}},{key:"cycleMic",value:function(){var o=this;return ae(),new Promise(function(h){o.sendMessageToCallMachine({action:"cycle-mic"},function(u){h({device:u.device})})})}},{key:"getCameraFacingMode",value:function(){var o=this;return fs(),new Promise(function(h){o.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(u){h(u.facingMode)})})}},{key:"setInputDevicesAsync",value:(G=H(function*(o){var h=this,u=o.audioDeviceId,f=o.videoDeviceId,v=o.audioSource,N=o.videoSource;if(ae(),v!==void 0&&(u=v),N!==void 0&&(f=N),typeof u=="boolean"&&(this._setAllowLocalAudio(u),u=void 0),typeof f=="boolean"&&(this._setAllowLocalVideo(f),f=void 0),!u&&!f)return yield this.getInputDevices();var I={};return u&&(u instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=u,u=vt,I.audio={settings:{customTrack:u}}):(delete this._sharedTracks.audioTrack,I.audio={settings:{deviceId:u}})),f&&(f instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=f,f=vt,I.video={settings:{customTrack:f}}):(delete this._sharedTracks.videoTrack,I.video={settings:{deviceId:f}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(I,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise(function(P){h.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:u,videoDeviceId:f},function(F){if(delete F.action,delete F.callbackStamp,F.returnPreloadCache)return h._updatePreloadCacheInputSettings(I,!1),void P(h._devicesFromInputSettings(h._inputSettings));P(F)})})}),function(o){return G.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(C=H(function*(o){var h=this,u=o.outputDeviceId;return ae(),u&&(this._preloadCache.outputDeviceId=u),this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(f){h.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:u},function(v){delete v.action,delete v.callbackStamp,v.returnPreloadCache?f(h._devicesFromInputSettings(h._inputSettings)):f(v)})})}),function(o){return C.apply(this,arguments)})},{key:"getInputDevices",value:(re=H(function*(){var o=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(h){o.sendMessageToCallMachine({action:"get-input-devices"},function(u){u.returnPreloadCache?h(o._devicesFromInputSettings(o._inputSettings)):h({camera:u.camera,mic:u.mic,speaker:u.speaker})})})}),function(){return re.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return fs(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(o){if(fs(),[ao,Nh].includes(o)){if(o!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=o,!this.disableReactNativeAutoDeviceManagement("audio")&&Ks(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",o)}},{key:"preAuth",value:(te=H(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(st(this._callObjectMode,"preAuth()"),qn(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(h)),!h.url)throw new Error("preAuth() requires at least a url to be provided");return this.validateProperties(h),this.properties=J(J({},this.properties),h),new Promise(function(u,f){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"daily-method-preauth",properties:Qt(o.properties,o.callClientId),preloadCache:Qt(o._preloadCache,o.callClientId)},function(v){return v.error?f(v.error):v.access?(o._didPreAuth=!0,void u({access:v.access})):f(new Error("unknown error in preAuth()"))})})}),function(){return te.apply(this,arguments)})},{key:"load",value:(Y=H(function*(o){var h=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");if(o&&(this.validateProperties(o),this.properties=J(J({},this.properties),o)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");return this._updateCallState(Ii),this.emitDailyJSEvent({action:Ho}),this._callObjectMode?new Promise(function(u,f){h._callObjectLoader.cancel();var v=Date.now();h._callObjectLoader.load(h.properties.dailyConfig,function(N){h._bundleLoadTime=N?"no-op":Date.now()-v,h._updateCallState(Pi),N&&h.emitDailyJSEvent({action:cr}),u()},function(N,I){if(h.emitDailyJSEvent({action:Ko}),!I){h._updateCallState(dt),h.resetMeetingDependentVars();var P={action:pr,errorMsg:N.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:N,bundleUrl:nn(h.properties.dailyConfig)}}};h._maybeSendToSentry(P),h.emitDailyJSEvent(P),f(N.msg)}})}):(this._iframe.src=ko(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise(function(u,f){h._loadedCallback=function(v){h._callState!==dt?(h._updateCallState(Pi),(h.properties.cssFile||h.properties.cssText)&&h.loadCss(h.properties),u()):f(v)}}))}}),function(o){return Y.apply(this,arguments)})},{key:"join",value:(D=H(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._testCallInProgress&&this.stopTestCallQuality();var u=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(h)}catch(f){return this.updateIsPreparingToJoin(!1),Promise.reject(f)}}else{if(u=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(h.url&&h.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(h.token&&h.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(h.url&&!this._callObjectMode&&h.url&&h.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(h.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(h),this.properties=J(J({},this.properties),h)}return h.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!h.showLocalVideo),h.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!h.showParticipantsBar),this._callState===At||this._callState===un?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(un,!1),this.emitDailyJSEvent({action:Zo}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:Qt(this.properties,this.callClientId),preloadCache:Qt(this._preloadCache,this.callClientId)}),new Promise(function(f,v){o._joinedCallback=function(N,I){if(o._callState!==dt){if(o._updateCallState(At),N)for(var P in N){if(o._callObjectMode){var F=o._callMachine().store;Yi(N[P],F),Wi(N[P],F),Hi(N[P],o._participants[P],F)}o._participants[P]=J({},N[P]),o.toggleParticipantAudioBasedOnNativeAudioFocus()}u&&o.loadCss(o.properties),f(N)}else v(I)}}))}),function(){return D.apply(this,arguments)})},{key:"leave",value:(O=H(function*(){var o=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise(function(h){o._callState===Et||o._callState===dt?h():o._callObjectLoader&&!o._callObjectLoader.loaded?(o._callObjectLoader.cancel(),o._updateCallState(Et),o.resetMeetingDependentVars(),o.emitDailyJSEvent({action:Et}),h()):(o._resolveLeave=h,o.sendMessageToCallMachine({action:"leave-meeting"}))})}),function(){return O.apply(this,arguments)})},{key:"startScreenShare",value:(j=H(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Gs(this._callMachineInitialized,"startScreenShare()"),h.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",h.screenVideoSendSettings),h.mediaStream&&(this._sharedTracks.screenMediaStream=h.mediaStream,h.mediaStream=vt),typeof DailyNativeUtils<"u"&&DailyNativeUtils.isIOS!==void 0&&DailyNativeUtils.isIOS){var u=this.nativeUtils();if(yield u.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:mr,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});u.setSystemScreenCaptureStartCallback(function(){u.setSystemScreenCaptureStartCallback(null),o.sendMessageToCallMachine({action:Di,captureOptions:h})}),u.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:Di,captureOptions:h})}),function(){return j.apply(this,arguments)})},{key:"stopScreenShare",value:function(){Gs(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=o.type;if(h&&h!=="cloud"&&h!=="raw-tracks"&&h!=="local")throw new Error("invalid type: ".concat(h,", allowed values 'cloud', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(J({action:"local-recording-start"},o))}},{key:"updateRecording",value:function(o){var h=o.layout,u=h===void 0?{preset:"default"}:h,f=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:u,instanceId:f})}},{key:"stopRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(J({action:"local-recording-stop"},o))}},{key:"startLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(J({action:"daily-method-start-live-streaming"},o))}},{key:"updateLiveStreaming",value:function(o){var h=o.layout,u=h===void 0?{preset:"default"}:h,f=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:u,instanceId:f})}},{key:"addLiveStreamingEndpoints",value:function(o){var h=o.endpoints,u=o.instanceId;this.sendMessageToCallMachine({action:Ri,endpointsOp:eh,endpoints:h,instanceId:u})}},{key:"removeLiveStreamingEndpoints",value:function(o){var h=o.endpoints,u=o.instanceId;this.sendMessageToCallMachine({action:Ri,endpointsOp:th,endpoints:h,instanceId:u})}},{key:"stopLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(J({action:"daily-method-stop-live-streaming"},o))}},{key:"validateDailyConfig",value:function(o){o.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(o.camSimulcastEncodings)),o.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),Gl()&&o.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,u=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(o){if(!(o instanceof Array||Array.isArray(o)))throw new Error("encodings must be an Array");if(!po(o.length,1,3))throw new Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var f=0;f<o.length;f++){var v=o[f];for(var N in this._validateEncodingLayerHasValidProperties(v),v)if(Vn.includes(N)){if(typeof v[N]!="number")throw new Error("".concat(N," must be a number"));if(h){var I=h[N],P=I.min,F=I.max;if(!po(v[N],P,F))throw new Error("".concat(N," value not in range. valid range: ").concat(P," to ").concat(F))}}else if(!["active","scalabilityMode"].includes(N))throw new Error("Invalid key ".concat(N,", valid keys are:")+Object.values(Vn));if(u&&!v.hasOwnProperty("maxBitrate"))throw new Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(L=H(function*(o){var h=this,u=o.url,f=o.settings,v=f===void 0?{state:fr.PLAY}:f;try{(function(N){if(typeof N!="string")throw new Error('url parameter must be "string" type')})(u),mo(v),function(N){for(var I in N)if(!lo.includes(I))throw new Error("Invalid key ".concat(I,", valid keys are: ").concat(lo));N.simulcastEncodings&&this.validateSimulcastEncodings(N.simulcastEncodings,sc,!0)}(v)}catch(N){throw console.error("invalid argument Error: ".concat(N)),console.error(`startRemoteMediaPlayer arguments must be of the form:
  { url: "playback url",
  settings?:
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),N}return new Promise(function(N,I){h.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:u,settings:v},function(P){P.error?I({error:P.error,errorMsg:P.errorMsg}):N({session_id:P.session_id,remoteMediaPlayerState:{state:P.state,settings:P.settings}})})})}),function(o){return L.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(T=H(function*(o){var h=this;if(typeof o!="string")throw new Error(" remotePlayerID must be of type string");return new Promise(function(u,f){h.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:o},function(v){v.error?f({error:v.error,errorMsg:v.errorMsg}):u()})})}),function(o){return T.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(p=H(function*(o){var h=this,u=o.session_id,f=o.settings;try{mo(f)}catch(v){throw console.error("invalid argument Error: ".concat(v)),console.error(`updateRemoteMediaPlayer arguments must be of the form:
  session_id: "participant session",
  { settings?: {state: "play"|"pause"} }`),v}return new Promise(function(v,N){h.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:u,settings:f},function(I){I.error?N({error:I.error,errorMsg:I.errorMsg}):v({session_id:I.session_id,remoteMediaPlayerState:{state:I.state,settings:I.settings}})})})}),function(o){return p.apply(this,arguments)})},{key:"startTranscription",value:function(o){ge(this._callState,"startTranscription()"),this.sendMessageToCallMachine(J({action:"daily-method-start-transcription"},o))}},{key:"updateTranscription",value:function(o){if(ge(this._callState,"updateTranscription()"),!o)throw new Error("updateTranscription Error: options is mandatory");if(de(o)!=="object")throw new Error("updateTranscription Error: options must be object type");if(o.participants&&!Array.isArray(o.participants))throw new Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(J({action:"daily-method-update-transcription"},o))}},{key:"stopTranscription",value:function(o){if(ge(this._callState,"stopTranscription()"),o&&de(o)!=="object")throw new Error("stopTranscription Error: options must be object type");if(o&&!o.instanceId)throw new Error('"instanceId" not provided');this.sendMessageToCallMachine(J({action:"daily-method-stop-transcription"},o))}},{key:"startDialOut",value:(x=H(function*(o){var h=this;ge(this._callState,"startDialOut()");var u=function(I){if(I){if(!Array.isArray(I))throw new Error("Error starting dial out: audio codec must be an array");if(I.length<=0)throw new Error("Error starting dial out: audio codec array specified but empty");I.forEach(function(P){if(typeof P!="string")throw new Error("Error starting dial out: audio codec must be a string");if(P!=="OPUS"&&P!=="PCMU"&&P!=="PCMA"&&P!=="G722")throw new Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")})}};if(!o.sipUri&&!o.phoneNumber)throw new Error("Error starting dial out: either a sip uri or phone number must be provided");if(o.sipUri&&o.phoneNumber)throw new Error("Error starting dial out: only one of sip uri or phone number must be provided");if(o.sipUri){if(typeof o.sipUri!="string")throw new Error("Error starting dial out: sipUri must be a string");if(!o.sipUri.startsWith("sip:"))throw new Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(o.video&&typeof o.video!="boolean")throw new Error("Error starting dial out: video must be a boolean value");(function(I){if(I&&(u(I.audio),I.video)){if(!Array.isArray(I.video))throw new Error("Error starting dial out: video codec must be an array");if(I.video.length<=0)throw new Error("Error starting dial out: video codec array specified but empty");I.video.forEach(function(P){if(typeof P!="string")throw new Error("Error starting dial out: video codec must be a string");if(P!=="H264"&&P!=="VP8")throw new Error("Error starting dial out: video codec must be H264 or VP8")})}})(o.codecs)}if(o.phoneNumber){if(typeof o.phoneNumber!="string")throw new Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(o.phoneNumber))throw new Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");o.codecs&&u(o.codecs.audio)}if(o.callerId){if(typeof o.callerId!="string")throw new Error("Error starting dial out: callerId must be a string");if(o.sipUri)throw new Error("Error starting dial out: callerId not allowed with sipUri")}if(o.displayName){if(typeof o.displayName!="string")throw new Error("Error starting dial out: displayName must be a string");if(o.displayName.length>=200)throw new Error("Error starting dial out: displayName length must be less than 200")}if(o.userId){if(typeof o.userId!="string")throw new Error("Error starting dial out: userId must be a string");if(o.userId.length>36)throw new Error("Error starting dial out: userId length must be less than or equal to 36")}if(o.permissions&&o.permissions.canReceive){var f=Re(ec.validateJSONObject(o.permissions.canReceive),2),v=f[0],N=f[1];if(!v)throw new Error(N)}return new Promise(function(I,P){h.sendMessageToCallMachine(J({action:"dialout-start"},o),function(F){F.error?P(F.error):I(F)})})}),function(o){return x.apply(this,arguments)})},{key:"stopDialOut",value:function(o){var h=this;return ge(this._callState,"stopDialOut()"),new Promise(function(u,f){h.sendMessageToCallMachine(J({action:"dialout-stop"},o),function(v){v.error?f(v.error):u(v)})})}},{key:"sipCallTransfer",value:(b=H(function*(o){var h=this;if(ge(this._callState,"sipCallTransfer()"),!o)throw new Error("sipCallTransfer() requires a sessionId and toEndPoint");return o.useSipRefer=!1,ho(o,"sipCallTransfer"),new Promise(function(u,f){h.sendMessageToCallMachine(J({action:Fi},o),function(v){v.error?f(v.error):u(v)})})}),function(o){return b.apply(this,arguments)})},{key:"sipRefer",value:(k=H(function*(o){var h=this;if(ge(this._callState,"sipRefer()"),!o)throw new Error("sessionId and toEndPoint are mandatory parameter");return o.useSipRefer=!0,ho(o,"sipRefer"),new Promise(function(u,f){h.sendMessageToCallMachine(J({action:Fi},o),function(v){v.error?f(v.error):u(v)})})}),function(o){return k.apply(this,arguments)})},{key:"sendDTMF",value:(E=H(function*(o){var h=this;return ge(this._callState,"sendDTMF()"),function(u){var f=u.sessionId,v=u.tones;if(!f||!v)throw new Error("sessionId and tones are mandatory parameter");if(typeof f!="string"||typeof v!="string")throw new Error("sessionId and tones should be of string type");if(v.length>20)throw new Error("tones string must be upto 20 characters");var N=/[^0-9A-D*#]/g,I=v.match(N);if(I&&I[0])throw new Error("".concat(I[0]," is not valid DTMF tone"))}(o),new Promise(function(u,f){h.sendMessageToCallMachine(J({action:"send-dtmf"},o),function(v){v.error?f(v.error):u(v)})})}),function(o){return E.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var o=this;return this._callState!==At?Promise.resolve(J({stats:{latest:{}}},this._network)):new Promise(function(h){o.sendMessageToCallMachine({action:"get-calc-stats"},function(u){h(J(J({},o._network),{},{stats:u.stats}))})})}},{key:"testWebsocketConnectivity",value:(M=H(function*(){var o=this;if(Un(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(h){return Promise.reject(h)}return new Promise(function(h,u){o.sendMessageToCallMachine({action:"test-websocket-connectivity"},function(f){f.error?u(f.error):h(f.results)})})}),function(){return M.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(o){return o?o instanceof MediaStreamTrack?!!Sh(o)||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(_=H(function*(){var o=this;ae(),st(this._callObjectMode,"testCallQuality()"),Gs(this._callMachineInitialized,"testCallQuality()",null,!0),qn(this._callState,this._isPreparingToJoin,"testCallQuality()");var h=this._testCallAlreadyInProgress,u=function(v){h||(o._testCallInProgress=v)};if(u(!0),this.needsLoad())try{var f=this._callState;yield this.load(),this._callState=f}catch(v){return u(!1),Promise.reject(v)}return new Promise(function(v){o.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:o.properties.dailyJsVersion},function(N){var I=N.results,P=I.result,F=Na(I,Ch);if(P==="failed"){var Z,ne=J({},F);(Z=F.error)!==null&&Z!==void 0&&Z.details?(F.error.details=JSON.parse(F.error.details),ne.error=J(J({},ne.error),{},{details:J({},ne.error.details)}),ne.error.details.duringTest="testCallQuality"):(ne.error=ne.error?J({},ne.error):{},ne.error.details={duringTest:"testCallQuality"}),o._maybeSendToSentry(ne)}u(!1),v(J({result:P},F))})})}),function(){return _.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(g=H(function*(o){var h;le()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),h=yield this.testPeerToPeerCallQuality(o)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),h=yield this.testCallQuality());var u={result:h.result,secondsElapsed:h.secondsElapsed};return h.data&&(u.data={maxRTT:h.data.maxRoundTripTime,packetLoss:h.data.avgRecvPacketLoss}),u}),function(o){return g.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(m=H(function*(o){var h=this;if(Un(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(v){return Promise.reject(v)}var u=o.videoTrack,f=o.duration;if(!this._validateVideoTrackForNetworkTests(u))throw new Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=u,new Promise(function(v,N){h.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:f},function(I){I.error?N(I.error):v(I.results)})})}),function(o){return m.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){le()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(d=H(function*(o){var h=this;if(Un(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(u){return Promise.reject(u)}if(!this._validateVideoTrackForNetworkTests(o))throw new Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=o,new Promise(function(u,f){h.sendMessageToCallMachine({action:"test-network-connectivity"},function(v){v.error?f(v.error):u(v.results)})})}),function(o){return d.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var o=this;return new Promise(function(h){o._callState===At?o.sendMessageToCallMachine({action:"get-cpu-load-stats"},function(u){h(u.cpuStats)}):h({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})})}},{key:"_validateEncodingLayerHasValidProperties",value:function(o){var h;if(!(((h=Object.keys(o))===null||h===void 0?void 0:h.length)>0))throw new Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(Vn))}},{key:"_validateVideoSendSettings",value:function(o,h){var u=o==="screenVideo"?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],f="Video send settings should be either an object or one of the supported presets: ".concat(u.join());if(typeof h=="string"){if(!u.includes(h))throw new Error(f)}else{if(de(h)!=="object")throw new Error(f);if(!h.maxQuality&&!h.encodings&&h.allowAdaptiveLayers===void 0)throw new Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(h.maxQuality&&["low","medium","high"].indexOf(h.maxQuality)===-1)throw new Error("maxQuality must be either low, medium or high");if(h.encodings){var v=!1;switch(Object.keys(h.encodings).length){case 1:v=!h.encodings.low;break;case 2:v=!h.encodings.low||!h.encodings.medium;break;case 3:v=!h.encodings.low||!h.encodings.medium||!h.encodings.high;break;default:v=!0}if(v)throw new Error("Encodings must be defined as: low, low and medium, or low, medium and high.");h.encodings.low&&this._validateEncodingLayerHasValidProperties(h.encodings.low),h.encodings.medium&&this._validateEncodingLayerHasValidProperties(h.encodings.medium),h.encodings.high&&this._validateEncodingLayerHasValidProperties(h.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(o){var h=this;if(!o||Object.keys(o).length===0)throw new Error("Send settings must contain at least information for one track!");Object.entries(o).forEach(function(u){var f=Re(u,2),v=f[0],N=f[1];h._validateVideoSendSettings(v,N)})}},{key:"updateSendSettings",value:function(o){var h=this;return this.validateUpdateSendSettings(o),this.needsLoad()?(this._preloadCache.sendSettings=o,{sendSettings:this._preloadCache.sendSettings}):new Promise(function(u,f){h.sendMessageToCallMachine({action:"update-send-settings",sendSettings:o},function(v){v.error?f(v.error):u(v.sendSettings)})})}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return ae(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(o){return ae(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:o}),this}},{key:"activeSpeakerMode",value:function(){return ae(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(o){return ge(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=o,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:o}),this}},{key:"enumerateDevices",value:(c=H(function*(){var o=this;if(this._callObjectMode){var h=yield navigator.mediaDevices.enumerateDevices();return Yt()==="Firefox"&&dn().major>115&&dn().major<123&&(h=h.filter(function(u){return u.kind!=="audiooutput"})),{devices:h.map(function(u){var f=JSON.parse(JSON.stringify(u));if(!le()&&u.kind==="videoinput"&&u.getCapabilities){var v,N=u.getCapabilities();f.facing=(N==null||(v=N.facingMode)===null||v===void 0?void 0:v.length)>=1?N.facingMode[0]:void 0}return f})}}return new Promise(function(u){o.sendMessageToCallMachine({action:"enumerate-devices"},function(f){u({devices:f.devices})})})}),function(){return c.apply(this,arguments)})},{key:"sendAppMessage",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(ge(this._callState,"sendAppMessage()"),JSON.stringify(o).length>this._maxAppMessageSize)throw new Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:o,to:h}),this}},{key:"addFakeParticipant",value:function(o){return ae(),ge(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(J({action:"add-fake-participant"},o)),this}},{key:"setShowNamesMode",value:function(o){return ze(this._callObjectMode,"setShowNamesMode()"),ae(),o&&o!=="always"&&o!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:o}),this)}},{key:"setShowLocalVideo",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return ze(this._callObjectMode,"setShowLocalVideo()"),ae(),ge(this._callState,"setShowLocalVideo()"),typeof o!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:o}),this._showLocalVideo=o,this)}},{key:"showLocalVideo",value:function(){return ze(this._callObjectMode,"showLocalVideo()"),ae(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return ze(this._callObjectMode,"setShowParticipantsBar()"),ae(),ge(this._callState,"setShowParticipantsBar()"),typeof o!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:o}),this._showParticipantsBar=o,this)}},{key:"showParticipantsBar",value:function(){return ze(this._callObjectMode,"showParticipantsBar()"),ae(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return ae(),ze(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(o){return ae(),ze(this._callObjectMode,"setCustomIntegrations()"),ge(this._callState,"setCustomIntegrations()"),uc(o)?(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:o}),this._customIntegrations=o,this):this}},{key:"startCustomIntegrations",value:function(o){var h=this;if(ae(),ze(this._callObjectMode,"startCustomIntegrations()"),ge(this._callState,"startCustomIntegrations()"),Array.isArray(o)&&o.some(function(v){return typeof v!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("startCustomIntegrations() only accepts string | string[]"),this;var u=typeof o=="string"?[o]:o,f=u.filter(function(v){return!(v in h._customIntegrations)});return f.length?(console.error(`Can't find custom integration(s): "`.concat(f.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"start-custom-integrations",ids:u}),this)}},{key:"stopCustomIntegrations",value:function(o){var h=this;if(ae(),ze(this._callObjectMode,"stopCustomIntegrations()"),ge(this._callState,"stopCustomIntegrations()"),Array.isArray(o)&&o.some(function(v){return typeof v!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var u=typeof o=="string"?[o]:o,f=u.filter(function(v){return!(v in h._customIntegrations)});return f.length?(console.error(`Can't find custom integration(s): "`.concat(f.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:u}),this)}},{key:"customTrayButtons",value:function(){return ze(this._callObjectMode,"customTrayButtons()"),ae(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(o){return ze(this._callObjectMode,"updateCustomTrayButtons()"),ae(),ge(this._callState,"updateCustomTrayButtons()"),cc(o)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:o}),this._customTrayButtons=o,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(mn))),this)}},{key:"theme",value:function(){return ze(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(o){var h=this;return ze(this._callObjectMode,"setTheme()"),new Promise(function(u,f){try{h.validateProperties({theme:o}),h.properties.theme=J({},o),h.sendMessageToCallMachine({action:"set-theme",theme:h.properties.theme});try{h.emitDailyJSEvent({action:Wo,theme:h.properties.theme})}catch(v){console.log("could not emit 'theme-updated'",v)}u(h.properties.theme)}catch(v){f(v)}})}},{key:"requestFullscreen",value:(l=H(function*(){if(ae(),this._iframe&&!document.fullscreenElement&&Vi())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(o){console.log("could not make video call fullscreen",o)}}),function(){return l.apply(this,arguments)})},{key:"exitFullscreen",value:function(){ae(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(i=H(function*(){var o=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise(function(h){o.sendMessageToCallMachine({action:"get-sidebar-view"},function(u){h(u.view)})})}),function(){return i.apply(this,arguments)})},{key:"setSidebarView",value:function(o){return this._callObjectMode?(console.error("setSidebarView is not available in callObject mode"),this):(this.sendMessageToCallMachine({action:"set-sidebar-view",view:o}),this)}},{key:"room",value:(a=H(function*(){var o=this,h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,u=h===void 0||h;return this._accessState.access===Ws||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(f){o.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:u},function(v){delete v.action,delete v.callbackStamp,f(v)})})}),function(){return a.apply(this,arguments)})},{key:"geo",value:(n=H(function*(){try{var o=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield o.json()).geo}}catch(h){return console.error("geo lookup failed",h),{current:""}}}),function(){return n.apply(this,arguments)})},{key:"setNetworkTopology",value:(t=H(function*(o){var h=this;return ae(),ge(this._callState,"setNetworkTopology()"),new Promise(function(u,f){h.sendMessageToCallMachine({action:"set-network-topology",opts:o},function(v){v.error?f({error:v.error}):u({workerId:v.workerId})})})}),function(o){return t.apply(this,arguments)})},{key:"getNetworkTopology",value:(e=H(function*(){var o=this;return new Promise(function(h,u){o.needsLoad()&&h({topology:"none"}),o.sendMessageToCallMachine({action:"get-network-topology"},function(f){f.error?u({error:f.error}):h({topology:f.topology})})})}),function(){return e.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(o){if(ae(),typeof o!="number"&&o!==!0&&o!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(o));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:o})}},{key:"on",value:function(o,h){return Ps.prototype.on.call(this,o,h)}},{key:"once",value:function(o,h){return Ps.prototype.once.call(this,o,h)}},{key:"off",value:function(o,h){return Ps.prototype.off.call(this,o,h)}},{key:"validateProperties",value:function(o){var h,u;if(o!=null&&(h=o.dailyConfig)!==null&&h!==void 0&&h.userMediaAudioConstraints){var f,v;le()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var N=o.inputSettings||{};N.audio=((f=o.inputSettings)===null||f===void 0?void 0:f.audio)||{},N.audio.settings=((v=o.inputSettings)===null||v===void 0||(v=v.audio)===null||v===void 0?void 0:v.settings)||{},N.audio.settings=J(J({},N.audio.settings),o.dailyConfig.userMediaAudioConstraints),o.inputSettings=N,delete o.dailyConfig.userMediaAudioConstraints}if(o!=null&&(u=o.dailyConfig)!==null&&u!==void 0&&u.userMediaVideoConstraints){var I,P;le()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var F=o.inputSettings||{};F.video=((I=o.inputSettings)===null||I===void 0?void 0:I.video)||{},F.video.settings=((P=o.inputSettings)===null||P===void 0||(P=P.video)===null||P===void 0?void 0:P.settings)||{},F.video.settings=J(J({},F.video.settings),o.dailyConfig.userMediaVideoConstraints),o.inputSettings=F,delete o.dailyConfig.userMediaVideoConstraints}for(var Z in o){if(!Vt[Z])throw new Error("unrecognized property '".concat(Z,"'"));if(Vt[Z].validate&&!Vt[Z].validate(o[Z],this))throw new Error("property '".concat(Z,"': ").concat(Vt[Z].help))}}},{key:"assembleMeetingUrl",value:function(){var o,h,u=J(J({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:(o=this.properties.dailyConfig)!==null&&o!==void 0&&o.proxyUrl?encodeURIComponent((h=this.properties.dailyConfig)===null||h===void 0?void 0:h.proxyUrl):void 0}),f=u.url.match(/\?/)?"&":"?";return u.url+f+Object.keys(Vt).filter(function(v){return Vt[v].queryString&&u[v]!==void 0}).map(function(v){return"".concat(Vt[v].queryString,"=").concat(u[v])}).join("&")}},{key:"needsLoad",value:function(){return[or,Ii,Et,dt].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(o,h){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(o,h,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(o){this._messageChannel.forwardPackagedMessageToCallMachine(o,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(o){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(o,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(o){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(o)}},{key:"handleMessageFromCallMachine",value:function(o){switch(o.action){case zo:this.sendMessageToCallMachine(J({action:Yo},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var h={action:Bs,level:"log",code:1011,stats:{event:"bundle load",time:this._bundleLoadTime==="no-op"?0:this._bundleLoadTime,preLoaded:this._bundleLoadTime==="no-op",url:nn(this.properties.dailyConfig)}};this.sendMessageToCallMachine(h),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case cr:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(o);break;case el:var u,f=J({},o);delete f.internal,this._maxAppMessageSize=((u=o.internal)===null||u===void 0?void 0:u._maxAppMessageSize)||Pn,this._joinedCallback&&(this._joinedCallback(o.participants),this._joinedCallback=null),this.emitDailyJSEvent(f);break;case sl:case nl:if(this._callState===Et)return;if(o.participant&&o.participant.session_id){var v=o.participant.local?"local":o.participant.session_id;if(this._callObjectMode){var N=this._callMachine().store;Yi(o.participant,N),Wi(o.participant,N),Hi(o.participant,this._participants[v],N)}try{this.maybeParticipantTracksStopped(this._participants[v],o.participant),this.maybeParticipantTracksStarted(this._participants[v],o.participant),this.maybeEventRecordingStopped(this._participants[v],o.participant),this.maybeEventRecordingStarted(this._participants[v],o.participant)}catch($){console.error("track events error",$)}this.compareEqualForParticipantUpdateEvent(o.participant,this._participants[v])||(this._participants[v]=J({},o.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(o))}break;case rl:if(o.participant&&o.participant.session_id){var I=this._participants[o.participant.session_id];I&&this.maybeParticipantTracksStopped(I,null),delete this._participants[o.participant.session_id],this.emitDailyJSEvent(o)}break;case al:Ve(this._participantCounts,o.participantCounts)||(this._participantCounts=o.participantCounts,this.emitDailyJSEvent(o));break;case il:var P={access:o.access};o.awaitingAccess&&(P.awaitingAccess=o.awaitingAccess),Ve(this._accessState,P)||(this._accessState=P,this.emitDailyJSEvent(o));break;case ol:if(o.meetingSession){this._meetingSessionSummary=o.meetingSession,this.emitDailyJSEvent(o);var F=J(J({},o),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(F)}break;case pr:var Z;this._iframe&&!o.preserveIframe&&(this._iframe.src=""),this._updateCallState(dt),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(o.errorMsg),this._loadedCallback=null),o.preserveIframe;var ne=Na(o,Eh);ne!=null&&(Z=ne.error)!==null&&Z!==void 0&&Z.details&&(ne.error.details=JSON.parse(ne.error.details)),this._maybeSendToSentry(o),this._joinedCallback&&(this._joinedCallback(null,ne),this._joinedCallback=null),this.emitDailyJSEvent(ne);break;case tl:this._callState!==dt&&this._updateCallState(Et),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(o);break;case"selected-devices-updated":o.devices&&this.emitDailyJSEvent(o);break;case Ml:var Ge=o.state,it=o.threshold,bt=o.quality,ke=Ge.state,Be=Ge.reasons;ke===this._network.networkState&&Ve(Be,this._network.networkStateReasons)&&it===this._network.threshold&&bt===this._network.quality||(this._network.networkState=ke,this._network.networkStateReasons=Be,this._network.quality=bt,this._network.threshold=it,o.networkState=ke,Be.length&&(o.networkStateReasons=Be),delete o.state,this.emitDailyJSEvent(o));break;case Il:o&&o.cpuLoadState&&this.emitDailyJSEvent(o);break;case Pl:o&&o.faceCounts!==void 0&&this.emitDailyJSEvent(o);break;case Tl:var ot=o.activeSpeaker;this._activeSpeaker.peerId!==ot.peerId&&(this._activeSpeaker.peerId=ot.peerId,this.emitDailyJSEvent({action:o.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var _t=o.show;this._showLocalVideo=_t,this.emitDailyJSEvent({action:o.action,show:_t});break;case Al:var Lt=o.enabled;this._activeSpeakerMode!==Lt&&(this._activeSpeakerMode=Lt,this.emitDailyJSEvent({action:o.action,enabled:this._activeSpeakerMode}));break;case cl:case ul:case dl:this._waitingParticipants=o.allWaitingParticipants,this.emitDailyJSEvent({action:o.action,participant:o.participant});break;case ql:Ve(this._receiveSettings,o.receiveSettings)||(this._receiveSettings=o.receiveSettings,this.emitDailyJSEvent({action:o.action,receiveSettings:o.receiveSettings}));break;case hr:this._maybeUpdateInputSettings(o.inputSettings);break;case"send-settings-updated":Ve(this._sendSettings,o.sendSettings)||(this._sendSettings=o.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:o.action,sendSettings:o.sendSettings}));break;case"local-audio-level":this._localAudioLevel=o.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=o.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case Sl:var xt=o.session_id;this._rmpPlayerState[xt]=o.playerState,this.emitDailyJSEvent(o);break;case kl:delete this._rmpPlayerState[o.session_id],this.emitDailyJSEvent(o);break;case jl:var w=o.session_id,R=this._rmpPlayerState[w];R&&this.compareEqualForRMPUpdateEvent(R,o.remoteMediaPlayerState)||(this._rmpPlayerState[w]=o.remoteMediaPlayerState,this.emitDailyJSEvent(o));break;case"custom-button-click":case"sidebar-view-changed":this.emitDailyJSEvent(o);break;case ll:var se=this._meetingSessionState.topology!==(o.meetingSessionState&&o.meetingSessionState.topology);this._meetingSessionState=Bn(o.meetingSessionState,this._callObjectMode),(this._callObjectMode||se)&&this.emitDailyJSEvent(o);break;case Cl:this._isScreenSharing=!0,this.emitDailyJSEvent(o);break;case El:case Nl:this._isScreenSharing=!1,this.emitDailyJSEvent(o);break;case ur:case dr:case vl:case yl:case bl:case pl:case fl:case gl:case Qo:case Xo:case xl:case wl:case"test-completed":case Ol:case _l:case Ll:case Dl:case Rl:case Fl:case mr:case Vl:case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(o);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(o,h){var u="record";o&&(h.local||h[u]!==!1||o[u]===h[u]||this.emitDailyJSEvent({action:dr}))}},{key:"maybeEventRecordingStarted",value:function(o,h){var u="record";o&&(h.local||h[u]!==!0||o[u]===h[u]||this.emitDailyJSEvent({action:ur}))}},{key:"_trackStatePlayable",value:function(o){return!(!o||o.state!==Uo)}},{key:"_trackChanged",value:function(o,h){return(o==null?void 0:o.id)!==(h==null?void 0:h.id)}},{key:"maybeEventTrackStopped",value:function(o,h,u){var f,v,N=(f=h==null?void 0:h.tracks[o])!==null&&f!==void 0?f:null,I=(v=u==null?void 0:u.tracks[o])!==null&&v!==void 0?v:null,P=N==null?void 0:N.track;if(P){var F=this._trackStatePlayable(N),Z=this._trackStatePlayable(I),ne=this._trackChanged(P,I==null?void 0:I.track);F&&(Z&&!ne||this.emitDailyJSEvent({action:ml,track:P,participant:u??h,type:o}))}}},{key:"maybeEventTrackStarted",value:function(o,h,u){var f,v,N=(f=h==null?void 0:h.tracks[o])!==null&&f!==void 0?f:null,I=(v=u==null?void 0:u.tracks[o])!==null&&v!==void 0?v:null,P=I==null?void 0:I.track;if(P){var F=this._trackStatePlayable(N),Z=this._trackStatePlayable(I),ne=this._trackChanged(N==null?void 0:N.track,P);Z&&(F&&!ne||this.emitDailyJSEvent({action:hl,track:P,participant:u,type:o}))}}},{key:"maybeParticipantTracksStopped",value:function(o,h){if(o)for(var u in o.tracks)this.maybeEventTrackStopped(u,o,h)}},{key:"maybeParticipantTracksStarted",value:function(o,h){if(h)for(var u in h.tracks)this.maybeEventTrackStarted(u,o,h)}},{key:"compareEqualForRMPUpdateEvent",value:function(o,h){var u,f;return o.state===h.state&&((u=o.settings)===null||u===void 0?void 0:u.volume)===((f=h.settings)===null||f===void 0?void 0:f.volume)}},{key:"emitDailyJSEvent",value:function(o){try{o.callClientId=this.callClientId,this.emit(o.action,o)}catch(h){console.log("could not emit",o,h)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(o,h){return!!Ve(o,h)&&(!o.videoTrack||!h.videoTrack||o.videoTrack.id===h.videoTrack.id&&o.videoTrack.muted===h.videoTrack.muted&&o.videoTrack.enabled===h.videoTrack.enabled)&&(!o.audioTrack||!h.audioTrack||o.audioTrack.id===h.audioTrack.id&&o.audioTrack.muted===h.audioTrack.muted&&o.audioTrack.enabled===h.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return le()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(o){this._updateCallState(this._callState,o)}},{key:"_updateCallState",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(o!==this._callState||h!==this._isPreparingToJoin){var u=this._callState,f=this._isPreparingToJoin;this._callState=o,this._isPreparingToJoin=h;var v=this._callState===At;this.updateShowAndroidOngoingMeetingNotification(v);var N=Ks(u,f),I=Ks(this._callState,this._isPreparingToJoin);N!==I&&(this.updateKeepDeviceAwake(I),this.updateDeviceAudioMode(I),this.updateNoOpRecordingEnsuringBackgroundContinuity(I))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=oo,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:Ws},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=Bn(io,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=Pn,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(o){le()&&this.nativeUtils().setKeepDeviceAwake(o,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(o){if(le()&&!this.disableReactNativeAutoDeviceManagement("audio")){var h=o?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(h)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(o){if(le()&&this.nativeUtils().setShowOngoingMeetingNotification){var h,u,f,v;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var N=this.properties.reactNativeConfig.androidInCallNotification;h=N.title,u=N.subtitle,f=N.iconName,v=N.disableForCustomOverride}v&&(o=!1),this.nativeUtils().setShowOngoingMeetingNotification(o,h,u,f,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(o){le()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(o)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var o;if(le()){var h=(o=this._callMachine())===null||o===void 0||(o=o.store)===null||o===void 0?void 0:o.getState();for(var u in h==null?void 0:h.streams){var f=h.streams[u];f&&f.pendingTrack&&f.pendingTrack.kind==="audio"&&(f.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(o){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[o]}},{key:"absoluteUrl",value:function(o){if(o!==void 0){var h=document.createElement("a");return h.href=o,h.href}}},{key:"sayHello",value:function(){var o="hello, world.";return console.log(o),o}},{key:"_logUseAfterDestroy",value:function(){var o=Object.values(Ft)[0];if(this.needsLoad())if(o&&!o.needsLoad()){var h={action:Bs,level:"error",code:this.strictMode?9995:9997};o.sendMessageToCallMachine(h)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var u={action:Bs,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(u,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var o=0,h=Object.values(Ft);o<h.length;o++){var u=h[o];u._callMachineInitialized?(u.sendMessageToCallMachine({action:Bs,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),u._delayDuplicateInstanceLog=!1):u._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(o){var h,u,f,v;if(!((h=o.error)!==null&&h!==void 0&&h.type&&(![Go,Jo,lr].includes(o.error.type)||o.error.type===lr&&o.error.msg.includes("deleted")))){var N=(u=this.properties)!==null&&u!==void 0&&u.url?new URL(this.properties.url):void 0,I="production";N&&N.host.includes(".staging.daily")&&(I="staging");var P,F,Z,ne,Ge,it=function(xt){const w=[Ku(),Wu(),wd(),_d(),Ed(),Td(),ed(),Nd()];return xt.autoSessionTracking!==!1&&w.push(Cd()),w}({}).filter(function(xt){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(xt.name)}),bt=new ld({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:md,stackParser:bd,integrations:it,environment:I}),ke=new Pt;if(ke.setClient(bt),bt.init(),this.session_id&&ke.setExtra("sessionId",this.session_id),this.properties){var Be=J({},this.properties);Be.userName=Be.userName?"[Filtered]":void 0,Be.userData=Be.userData?"[Filtered]":void 0,Be.token=Be.token?"[Filtered]":void 0,ke.setExtra("properties",Be)}if(N){var ot=N.searchParams.get("domain");if(!ot){var _t=N.host.match(/(.*?)\./);ot=_t&&_t[1]||""}ot&&ke.setTag("domain",ot)}o.error&&(ke.setTag("fatalErrorType",o.error.type),ke.setExtra("errorDetails",o.error.details),!((P=o.error.details)===null||P===void 0)&&P.uri&&ke.setTag("serverAddress",o.error.details.uri),!((F=o.error.details)===null||F===void 0)&&F.workerGroup&&ke.setTag("workerGroup",o.error.details.workerGroup),!((Z=o.error.details)===null||Z===void 0)&&Z.geoGroup&&ke.setTag("geoGroup",o.error.details.geoGroup),!((ne=o.error.details)===null||ne===void 0)&&ne.on&&ke.setTag("connectionAttempt",o.error.details.on),(Ge=o.error.details)!==null&&Ge!==void 0&&Ge.bundleUrl&&(ke.setTag("bundleUrl",o.error.details.bundleUrl),ke.setTag("bundleError",o.error.details.sourceError.type))),ke.setTags({callMode:this._callObjectMode?le()?"reactNative":(f=this.properties)!==null&&f!==void 0&&(f=f.dailyConfig)!==null&&f!==void 0&&(f=f.callMode)!==null&&f!==void 0&&f.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:s.version()});var Lt=((v=o.error)===null||v===void 0?void 0:v.msg)||o.errorMsg;ke.captureException(new Error(Lt))}}},{key:"_callMachine",value:function(){var o;return(o=window._daily)===null||o===void 0||(o=o.instances)===null||o===void 0||(o=o[this.callClientId])===null||o===void 0?void 0:o.callMachine}},{key:"_maybeUpdateInputSettings",value:function(o){if(!Ve(this._inputSettings,o)){var h=this._getInputSettings();this._inputSettings=o;var u=this._getInputSettings();Ve(h,u)||this.emitDailyJSEvent({action:hr,inputSettings:u})}}}],[{key:"supportedBrowser",value:function(){if(le())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var o=gu.getParser(tt());return{supported:!!qi(),mobile:o.getPlatformType()==="mobile",name:o.getBrowserName(),version:o.getBrowserVersion(),supportsFullscreen:!!Vi(),supportsScreenShare:!!sh(),supportsSfu:!!qi(),supportsVideoProcessing:$l(),supportsAudioProcessing:Jl()}}},{key:"version",value:function(){return"0.80.0"}},{key:"createCallObject",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return o.layout="none",new s(null,o)}},{key:"wrap",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ae(),!o||!o.contentWindow||typeof o.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return h.layout||(h.customLayout?h.layout="custom-v1":h.layout="browser"),new s(o,h)}},{key:"createFrame",value:function(o,h){var u,f;ae(),o&&h?(u=o,f=h):o&&o.append?(u=o,f={}):(u=document.body,f=o||{});var v=f.iframeStyle;v||(v=u===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var N=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?N.allow="microphone, camera":N.allow="microphone; camera; autoplay; display-capture; screen-wake-lock",N.style.visibility="hidden",u.appendChild(N),N.style.visibility=null,Object.keys(v).forEach(function(I){return N.style[I]=v[I]}),f.layout||(f.customLayout?f.layout="custom-v1":f.layout="browser");try{return new s(N,f)}catch(I){throw u.removeChild(N),I}}},{key:"createTransparentFrame",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ae();var h=document.createElement("iframe");return h.allow="microphone; camera; autoplay",h.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(h),o.layout||(o.layout="custom-v1"),s.wrap(h,o)}},{key:"getCallInstance",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return o?Ft[o]:Object.values(Ft)[0]}}]);var e,t,n,a,i,l,c,d,m,g,_,M,E,k,b,x,p,T,L,j,O,D,Y,te,re,C,G,S,V,z,Ee,$e,y,Ue,Je,Ne,B,je}();function Qt(s,e){var t={};for(var n in s)if(s[n]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",n),t[n]=vt;else if(n==="dailyConfig"){if(s[n].modifyLocalSdpHook){var a=window._daily.instances[e].customCallbacks||{};a.modifyLocalSdpHook=s[n].modifyLocalSdpHook,window._daily.instances[e].customCallbacks=a,delete s[n].modifyLocalSdpHook}if(s[n].modifyRemoteSdpHook){var i=window._daily.instances[e].customCallbacks||{};i.modifyRemoteSdpHook=s[n].modifyRemoteSdpHook,window._daily.instances[e].customCallbacks=i,delete s[n].modifyRemoteSdpHook}t[n]=s[n]}else t[n]=s[n];return t}function ge(s){var e=arguments.length>2?arguments[2]:void 0;if(s!==At){var t="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," only supported after join.");throw e&&(t+=" ".concat(e)),console.error(t),new Error(t)}}function Ks(s,e){return[un,At].includes(s)||e}function qn(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"This daily-js method",n=arguments.length>3?arguments[3]:void 0;if(Ks(s,e)){var a="".concat(t," not supported after joining a meeting.");throw n&&(a+=" ".concat(n)),console.error(a),new Error(a)}}function Gs(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method",t=arguments.length>2?arguments[2]:void 0;if(!s){var n="".concat(e,arguments.length>3&&arguments[3]!==void 0&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw t&&(n+=" ".concat(t)),console.error(n),new Error(n)}}function Un(s){if(s){var e="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(e),new Error(e)}}function st(s){if(!s){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(e),new Error(e)}}function ze(s){if(s){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(e),new Error(e)}}function ae(){if(le())throw new Error("This daily-js method is not currently supported in React Native")}function fs(){if(!le())throw new Error("This daily-js method is only supported in React Native")}function nc(s){if(s===void 0)return!0;var e;if(typeof s=="string")e=s;else try{e=JSON.stringify(s),Ve(JSON.parse(e),s)||console.warn("The userData provided will be modified when serialized.")}catch(t){throw Error("userData must be serializable to JSON: ".concat(t))}if(e.length>4096)throw Error("userData is too large (".concat(e.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function rc(s,e){for(var t=e.allowAllParticipantsKey,n=function(_){var M=["local"];return t||M.push("*"),_&&!M.includes(_)},a=function(_){return!!(_.layer===void 0||Number.isInteger(_.layer)&&_.layer>=0||_.layer==="inherit")},i=function(_){return!!_&&!(_.video&&!a(_.video))&&!(_.screenVideo&&!a(_.screenVideo))},l=0,c=Object.entries(s);l<c.length;l++){var d=Re(c[l],2),m=d[0],g=d[1];if(!n(m)||!i(g))return!1}return!0}function ac(s){if(de(s)!=="object")return!1;for(var e=0,t=Object.entries(s);e<t.length;e++){var n=Re(t[e],2),a=n[0],i=n[1];switch(a){case"video":if(de(i)!=="object")return!1;for(var l=0,c=Object.entries(i);l<c.length;l++){var d=Re(c[l],2),m=d[0],g=d[1];switch(m){case"processor":if(!Mh(g))return!1;break;case"settings":if(!uo(g))return!1;break;default:return!1}}break;case"audio":if(de(i)!=="object")return!1;for(var _=0,M=Object.entries(i);_<M.length;_++){var E=Re(M[_],2),k=E[0],b=E[1];switch(k){case"processor":if(!Ah(b))return!1;break;case"settings":if(!uo(b))return!1;break;default:return!1}}break;default:return!1}}return!0}function ic(s,e,t){var n,a=[];s.video&&s.video.processor&&($l((n=e==null?void 0:e.useLegacyVideoProcessor)!==null&&n!==void 0&&n)||(s.video.settings?delete s.video.processor:delete s.video,a.push("video"))),s.audio&&s.audio.processor&&(Jl()||(s.audio.settings?delete s.audio.processor:delete s.audio,a.push("audio"))),a.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(a.join(", "))),s.audio&&s.audio.settings&&(s.audio.settings.customTrack?(t.audioTrack=s.audio.settings.customTrack,s.audio.settings={customTrack:vt}):delete t.audioTrack),s.video&&s.video.settings&&(s.video.settings.customTrack?(t.videoTrack=s.video.settings.customTrack,s.video.settings={customTrack:vt}):delete t.videoTrack)}function Ah(s){if(le())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type"];return!!s&&de(s)==="object"&&(Object.keys(s).filter(function(t){return!e.includes(t)}).forEach(function(t){console.warn("invalid key inputSettings -> audio -> processor : ".concat(t)),delete s[t]}),!!function(t){return typeof t!="string"?!1:Object.values(Ul).includes(t)?!0:(console.error("inputSettings audio processor type invalid"),!1)}(s.type))}function Mh(s){if(le())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type","config"];return!s||de(s)!=="object"||!function(t){return typeof t!="string"?!1:Object.values(Hs).includes(t)?!0:(console.error("inputSettings video processor type invalid"),!1)}(s.type)||s.config&&(de(s.config)!=="object"||!function(t,n){var a=Object.keys(n);if(a.length===0)return!0;var i="invalid object in inputSettings -> video -> processor -> config";switch(t){case Hs.BGBLUR:return a.length>1||a[0]!=="strength"?(console.error(i),!1):!(typeof n.strength!="number"||n.strength<=0||n.strength>1||isNaN(n.strength))||(console.error("".concat(i,"; expected: {0 < strength <= 1}, got: ").concat(n.strength)),!1);case Hs.BGIMAGE:return!(n.source!==void 0&&!function(l){if(l.source==="default")return l.type="default",!0;if(l.source instanceof ArrayBuffer)return!0;if(rn(l.source))return l.type="url",!!function(m){var g=new URL(m),_=g.pathname;if(g.protocol==="data:")try{var M=_.substring(_.indexOf(":")+1,_.indexOf(";")).split("/")[1];return Dn.includes(M)}catch(k){return console.error("failed to deduce blob content type",k),!1}var E=_.split(".").at(-1).toLowerCase().trim();return Dn.includes(E)}(l.source)||(console.error("invalid image type; supported types: [".concat(Dn.join(", "),"]")),!1);return c=l.source,d=Number(c),isNaN(d)||!Number.isInteger(d)||d<=0||d>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(l.type="daily-preselect",!0);var c,d}(n));default:return!0}}(s.type,s.config))?!1:(Object.keys(s).filter(function(t){return!e.includes(t)}).forEach(function(t){console.warn("invalid key inputSettings -> video -> processor : ".concat(t)),delete s[t]}),!0)}function uo(s){return de(s)==="object"&&(!s.customTrack||s.customTrack instanceof MediaStreamTrack)}function xr(){var s=Object.values(Hs).join(" | "),e=Object.values(Ul).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(s," ], config?: {} } }, audio?: { processor: {type: [ ").concat(e," ] } } }")}function oc(s){var e=s.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat($o).concat(e?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function lc(){return"customIntegrations should be an object of type ".concat(JSON.stringify(_r),".")}function cc(s){if(s&&de(s)!=="object"||Array.isArray(s))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(mn),".")),!1;if(s)for(var e=0,t=Object.entries(s);e<t.length;e++)for(var n=Re(t[e],1)[0],a=0,i=Object.entries(s[n]);a<i.length;a++){var l=Re(i[a],2),c=l[0],d=l[1],m=mn.id[c];if(!m)return console.error("customTrayButton does not support key ".concat(c)),!1;switch(c){case"iconPath":case"iconPathDarkMode":if(!rn(d))return console.error("customTrayButton ".concat(c," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(d))return console.error("customTrayButton ".concat(c," should be ").concat(m,". Got: ").concat(d)),!1;break;default:if(de(d)!==m)return console.error("customTrayButton ".concat(c," should be a ").concat(m,".")),!1}}return!0}function uc(s){if(!s||s&&de(s)!=="object"||Array.isArray(s))return console.error(lc()),!1;for(var e=function(_){return"".concat(_," should be ").concat(_r.id[_])},t=function(_,M){return console.error("customIntegration ".concat(_,": ").concat(M))},n=0,a=Object.entries(s);n<a.length;n++){var i=Re(a[n],1)[0];if(!("label"in s[i]))return t(i,"label is required"),!1;if(!("location"in s[i]))return t(i,"location is required"),!1;if(!("src"in s[i])&&!("srcdoc"in s[i]))return t(i,"src or srcdoc is required"),!1;for(var l=0,c=Object.entries(s[i]);l<c.length;l++){var d=Re(c[l],2),m=d[0],g=d[1];switch(m){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if(typeof g!="string")return t(i,e(m)),!1;break;case"iconURL":if(!rn(g))return t(i,"".concat(m," should be a url")),!1;break;case"src":if("srcdoc"in s[i])return t(i,"cannot have both src and srcdoc"),!1;if(!rn(g))return t(i,'src "'.concat(g,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in s[i])return t(i,"cannot have both src and srcdoc"),!1;if(typeof g!="string")return t(i,e(m)),!1;break;case"location":if(!["main","sidebar"].includes(g))return t(i,e(m)),!1;break;case"controlledBy":if(g!=="*"&&g!=="owners"&&(!Array.isArray(g)||g.some(function(_){return typeof _!="string"})))return t(i,e(m)),!1;break;case"shared":if((!Array.isArray(g)||g.some(function(_){return typeof _!="string"}))&&g!=="owners"&&typeof g!="boolean")return t(i,e(m)),!1;break;default:if(!_r.id[m])return console.error("customIntegration does not support key ".concat(m)),!1}}}return!0}function dc(s,e){if(e===void 0)return!1;switch(de(e)){case"string":return de(s)===e;case"object":if(de(s)!=="object")return!1;for(var t in s)if(!dc(s[t],e[t]))return!1;return!0;default:return!1}}function ho(s,e){var t=s.sessionId,n=s.toEndPoint,a=s.callerId,i=s.useSipRefer;if(!t||!n)throw new Error("".concat(e,"() requires a sessionId and toEndPoint"));if(typeof t!="string"||typeof n!="string")throw new Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(i&&!n.startsWith("sip:"))throw new Error('"toEndPoint" must be a "sip" address');if(!n.startsWith("sip:")&&!n.startsWith("+"))throw new Error("toEndPoint: ".concat(n,' must starts with either "sip:" or "+"'));if(a&&typeof a!="string")throw new Error("callerId must be of type string");if(a&&!n.startsWith("+"))throw new Error("callerId is only valid when transferring to a PSTN number")}function mo(s){if(de(s)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(s.state&&!Object.values(fr).includes(s.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(fr));if(s.volume){if(typeof s.volume!="number")throw new Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(s.volume<0||s.volume>2)throw new Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function po(s,e,t){return!(typeof s!="number"||s<e||s>t)}function Bn(s,e){return s&&!e&&delete s.data,s}const Oh=Object.freeze(Object.defineProperty({__proto__:null,DAILY_ACCESS_LEVEL_FULL:Bo,DAILY_ACCESS_LEVEL_LOBBY:Ld,DAILY_ACCESS_LEVEL_NONE:Dd,DAILY_ACCESS_UNKNOWN:Ws,DAILY_CAMERA_ERROR_CAM_AND_MIC_IN_USE:Yd,DAILY_CAMERA_ERROR_CAM_IN_USE:Gd,DAILY_CAMERA_ERROR_CONSTRAINTS:Qd,DAILY_CAMERA_ERROR_MIC_IN_USE:zd,DAILY_CAMERA_ERROR_NOT_FOUND:Kd,DAILY_CAMERA_ERROR_PERMISSIONS:Wd,DAILY_CAMERA_ERROR_UNDEF_MEDIADEVICES:Hd,DAILY_CAMERA_ERROR_UNKNOWN:Xd,DAILY_EVENT_ACCESS_STATE_UPDATED:il,DAILY_EVENT_ACTIVE_SPEAKER_CHANGE:Tl,DAILY_EVENT_ACTIVE_SPEAKER_MODE_CHANGE:Al,DAILY_EVENT_APP_MSG:xl,DAILY_EVENT_CAMERA_ERROR:Xo,DAILY_EVENT_CPU_LOAD_CHANGE:Il,DAILY_EVENT_ERROR:pr,DAILY_EVENT_EXIT_FULLSCREEN:bs,DAILY_EVENT_FACE_COUNTS_UPDATED:Pl,DAILY_EVENT_FULLSCREEN:ys,DAILY_EVENT_IFRAME_LAUNCH_CONFIG:Yo,DAILY_EVENT_IFRAME_READY_FOR_LAUNCH_CONFIG:zo,DAILY_EVENT_INPUT_SETTINGS_UPDATED:hr,DAILY_EVENT_JOINED_MEETING:el,DAILY_EVENT_JOINING_MEETING:Zo,DAILY_EVENT_LANG_UPDATED:Vl,DAILY_EVENT_LEFT_MEETING:tl,DAILY_EVENT_LIVE_STREAMING_ERROR:Fl,DAILY_EVENT_LIVE_STREAMING_STARTED:Ll,DAILY_EVENT_LIVE_STREAMING_STOPPED:Rl,DAILY_EVENT_LIVE_STREAMING_UPDATED:Dl,DAILY_EVENT_LOADED:cr,DAILY_EVENT_LOADING:Ho,DAILY_EVENT_LOAD_ATTEMPT_FAILED:Ko,DAILY_EVENT_LOCAL_SCREEN_SHARE_CANCELED:Nl,DAILY_EVENT_LOCAL_SCREEN_SHARE_STARTED:Cl,DAILY_EVENT_LOCAL_SCREEN_SHARE_STOPPED:El,DAILY_EVENT_MEETING_SESSION_DATA_ERROR:Zd,DAILY_EVENT_MEETING_SESSION_STATE_UPDATED:ll,DAILY_EVENT_MEETING_SESSION_SUMMARY_UPDATED:ol,DAILY_EVENT_NETWORK_CONNECTION:Ol,DAILY_EVENT_NETWORK_QUALITY_CHANGE:Ml,DAILY_EVENT_NONFATAL_ERROR:mr,DAILY_EVENT_PARTICIPANT_COUNTS_UPDATED:al,DAILY_EVENT_PARTICIPANT_JOINED:sl,DAILY_EVENT_PARTICIPANT_LEFT:rl,DAILY_EVENT_PARTICIPANT_UPDATED:nl,DAILY_EVENT_RECEIVE_SETTINGS_UPDATED:ql,DAILY_EVENT_RECORDING_DATA:_l,DAILY_EVENT_RECORDING_ERROR:yl,DAILY_EVENT_RECORDING_STARTED:ur,DAILY_EVENT_RECORDING_STATS:vl,DAILY_EVENT_RECORDING_STOPPED:dr,DAILY_EVENT_RECORDING_UPLOAD_COMPLETED:bl,DAILY_EVENT_REMOTE_MEDIA_PLAYER_STARTED:Sl,DAILY_EVENT_REMOTE_MEDIA_PLAYER_STOPPED:kl,DAILY_EVENT_REMOTE_MEDIA_PLAYER_UPDATED:jl,DAILY_EVENT_STARTED_CAMERA:Qo,DAILY_EVENT_THEME_UPDATED:Wo,DAILY_EVENT_TRACK_STARTED:hl,DAILY_EVENT_TRACK_STOPPED:ml,DAILY_EVENT_TRANSCRIPTION_ERROR:gl,DAILY_EVENT_TRANSCRIPTION_MSG:wl,DAILY_EVENT_TRANSCRIPTION_STARTED:pl,DAILY_EVENT_TRANSCRIPTION_STOPPED:fl,DAILY_EVENT_WAITING_PARTICIPANT_ADDED:cl,DAILY_EVENT_WAITING_PARTICIPANT_REMOVED:dl,DAILY_EVENT_WAITING_PARTICIPANT_UPDATED:ul,DAILY_FATAL_ERROR_CONNECTION:Go,DAILY_FATAL_ERROR_EJECTED:Fd,DAILY_FATAL_ERROR_EOL:Jo,DAILY_FATAL_ERROR_EXP_ROOM:Ud,DAILY_FATAL_ERROR_EXP_TOKEN:Bd,DAILY_FATAL_ERROR_MEETING_FULL:$d,DAILY_FATAL_ERROR_NBF_ROOM:Vd,DAILY_FATAL_ERROR_NBF_TOKEN:qd,DAILY_FATAL_ERROR_NOT_ALLOWED:Jd,DAILY_FATAL_ERROR_NO_ROOM:lr,DAILY_RECEIVE_SETTINGS_ALL_PARTICIPANTS_KEY:Rd,DAILY_RECEIVE_SETTINGS_BASE_KEY:$o,DAILY_STATE_ERROR:dt,DAILY_STATE_JOINED:At,DAILY_STATE_JOINING:un,DAILY_STATE_LEFT:Et,DAILY_STATE_NEW:or,DAILY_TRACK_STATE_BLOCKED:Ad,DAILY_TRACK_STATE_INTERRUPTED:Pd,DAILY_TRACK_STATE_LOADING:Id,DAILY_TRACK_STATE_OFF:Md,DAILY_TRACK_STATE_PLAYABLE:Uo,DAILY_TRACK_STATE_SENDABLE:Od,default:Th},Symbol.toStringTag,{value:"Module"})),Ih=Fc(Oh);var Fr={exports:{}},as=typeof Reflect=="object"?Reflect:null,fo=as&&typeof as.apply=="function"?as.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Qs;as&&typeof as.ownKeys=="function"?Qs=as.ownKeys:Object.getOwnPropertySymbols?Qs=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Qs=function(e){return Object.getOwnPropertyNames(e)};function Ph(s){console&&console.warn&&console.warn(s)}var hc=Number.isNaN||function(e){return e!==e};function pe(){pe.init.call(this)}Fr.exports=pe;Fr.exports.once=Fh;pe.EventEmitter=pe;pe.prototype._events=void 0;pe.prototype._eventsCount=0;pe.prototype._maxListeners=void 0;var go=10;function wn(s){if(typeof s!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}Object.defineProperty(pe,"defaultMaxListeners",{enumerable:!0,get:function(){return go},set:function(s){if(typeof s!="number"||s<0||hc(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");go=s}});pe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};pe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||hc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function mc(s){return s._maxListeners===void 0?pe.defaultMaxListeners:s._maxListeners}pe.prototype.getMaxListeners=function(){return mc(this)};pe.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var a=e==="error",i=this._events;if(i!==void 0)a=a&&i.error===void 0;else if(!a)return!1;if(a){var l;if(t.length>0&&(l=t[0]),l instanceof Error)throw l;var c=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw c.context=l,c}var d=i[e];if(d===void 0)return!1;if(typeof d=="function")fo(d,this,t);else for(var m=d.length,g=yc(d,m),n=0;n<m;++n)fo(g[n],this,t);return!0};function pc(s,e,t,n){var a,i,l;if(wn(t),i=s._events,i===void 0?(i=s._events=Object.create(null),s._eventsCount=0):(i.newListener!==void 0&&(s.emit("newListener",e,t.listener?t.listener:t),i=s._events),l=i[e]),l===void 0)l=i[e]=t,++s._eventsCount;else if(typeof l=="function"?l=i[e]=n?[t,l]:[l,t]:n?l.unshift(t):l.push(t),a=mc(s),a>0&&l.length>a&&!l.warned){l.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=s,c.type=e,c.count=l.length,Ph(c)}return s}pe.prototype.addListener=function(e,t){return pc(this,e,t,!1)};pe.prototype.on=pe.prototype.addListener;pe.prototype.prependListener=function(e,t){return pc(this,e,t,!0)};function Lh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function fc(s,e,t){var n={fired:!1,wrapFn:void 0,target:s,type:e,listener:t},a=Lh.bind(n);return a.listener=t,n.wrapFn=a,a}pe.prototype.once=function(e,t){return wn(t),this.on(e,fc(this,e,t)),this};pe.prototype.prependOnceListener=function(e,t){return wn(t),this.prependListener(e,fc(this,e,t)),this};pe.prototype.removeListener=function(e,t){var n,a,i,l,c;if(wn(t),a=this._events,a===void 0)return this;if(n=a[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete a[e],a.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(i=-1,l=n.length-1;l>=0;l--)if(n[l]===t||n[l].listener===t){c=n[l].listener,i=l;break}if(i<0)return this;i===0?n.shift():Dh(n,i),n.length===1&&(a[e]=n[0]),a.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};pe.prototype.off=pe.prototype.removeListener;pe.prototype.removeAllListeners=function(e){var t,n,a;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var i=Object.keys(n),l;for(a=0;a<i.length;++a)l=i[a],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this};function gc(s,e,t){var n=s._events;if(n===void 0)return[];var a=n[e];return a===void 0?[]:typeof a=="function"?t?[a.listener||a]:[a]:t?Rh(a):yc(a,a.length)}pe.prototype.listeners=function(e){return gc(this,e,!0)};pe.prototype.rawListeners=function(e){return gc(this,e,!1)};pe.listenerCount=function(s,e){return typeof s.listenerCount=="function"?s.listenerCount(e):vc.call(s,e)};pe.prototype.listenerCount=vc;function vc(s){var e=this._events;if(e!==void 0){var t=e[s];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}pe.prototype.eventNames=function(){return this._eventsCount>0?Qs(this._events):[]};function yc(s,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=s[n];return t}function Dh(s,e){for(;e+1<s.length;e++)s[e]=s[e+1];s.pop()}function Rh(s){for(var e=new Array(s.length),t=0;t<e.length;++t)e[t]=s[t].listener||s[t];return e}function Fh(s,e){return new Promise(function(t,n){function a(l){s.removeListener(e,i),n(l)}function i(){typeof s.removeListener=="function"&&s.removeListener("error",a),t([].slice.call(arguments))}bc(s,e,i,{once:!0}),e!=="error"&&Vh(s,a,{once:!0})})}function Vh(s,e,t){typeof s.on=="function"&&bc(s,"error",e,t)}function bc(s,e,t,n){if(typeof s.on=="function")n.once?s.once(e,t):s.on(e,t);else if(typeof s.addEventListener=="function")s.addEventListener(e,function a(i){n.once&&s.removeEventListener(e,a),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof s)}var qh=Fr.exports,Sn={},Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.Api=Mt.HttpClient=Mt.ContentType=void 0;var q;(function(s){s.Json="application/json",s.JsonApi="application/vnd.api+json",s.FormData="multipart/form-data",s.UrlEncoded="application/x-www-form-urlencoded",s.Text="text/plain"})(q||(Mt.ContentType=q={}));class _c{constructor(e={}){X(this,"baseUrl","https://api.vapi.ai");X(this,"securityData",null);X(this,"securityWorker");X(this,"abortControllers",new Map);X(this,"customFetch",(...e)=>fetch(...e));X(this,"baseApiParams",{credentials:"same-origin",headers:{},redirect:"follow",referrerPolicy:"no-referrer"});X(this,"setSecurityData",e=>{this.securityData=e});X(this,"contentFormatters",{[q.Json]:e=>e!==null&&(typeof e=="object"||typeof e=="string")?JSON.stringify(e):e,[q.JsonApi]:e=>e!==null&&(typeof e=="object"||typeof e=="string")?JSON.stringify(e):e,[q.Text]:e=>e!==null&&typeof e!="string"?JSON.stringify(e):e,[q.FormData]:e=>Object.keys(e||{}).reduce((t,n)=>{const a=e[n];return t.append(n,a instanceof Blob?a:typeof a=="object"&&a!==null?JSON.stringify(a):`${a}`),t},new FormData),[q.UrlEncoded]:e=>this.toQueryString(e)});X(this,"createAbortSignal",e=>{if(this.abortControllers.has(e)){const n=this.abortControllers.get(e);return n?n.signal:void 0}const t=new AbortController;return this.abortControllers.set(e,t),t.signal});X(this,"abortRequest",e=>{const t=this.abortControllers.get(e);t&&(t.abort(),this.abortControllers.delete(e))});X(this,"request",async({body:e,secure:t,path:n,type:a,query:i,format:l,baseUrl:c,cancelToken:d,...m})=>{const g=(typeof t=="boolean"?t:this.baseApiParams.secure)&&this.securityWorker&&await this.securityWorker(this.securityData)||{},_=this.mergeRequestParams(m,g),M=i&&this.toQueryString(i),E=this.contentFormatters[a||q.Json],k=l||_.format;return this.customFetch(`${c||this.baseUrl||""}${n}${M?`?${M}`:""}`,{..._,headers:{..._.headers||{},...a&&a!==q.FormData?{"Content-Type":a}:{}},signal:(d?this.createAbortSignal(d):_.signal)||null,body:typeof e>"u"||e===null?null:E(e)}).then(async b=>{const x=b.clone();x.data=null,x.error=null;const p=k?await b[k]().then(T=>(x.ok?x.data=T:x.error=T,x)).catch(T=>(x.error=T,x)):x;if(d&&this.abortControllers.delete(d),!b.ok)throw p;return p})});Object.assign(this,e)}encodeQueryParam(e,t){return`${encodeURIComponent(e)}=${encodeURIComponent(typeof t=="number"?t:`${t}`)}`}addQueryParam(e,t){return this.encodeQueryParam(t,e[t])}addArrayQueryParam(e,t){return e[t].map(a=>this.encodeQueryParam(t,a)).join("&")}toQueryString(e){const t=e||{};return Object.keys(t).filter(a=>typeof t[a]<"u").map(a=>Array.isArray(t[a])?this.addArrayQueryParam(t,a):this.addQueryParam(t,a)).join("&")}addQueryParams(e){const t=this.toQueryString(e);return t?`?${t}`:""}mergeRequestParams(e,t){return{...this.baseApiParams,...e,...t||{},headers:{...this.baseApiParams.headers||{},...e.headers||{},...t&&t.headers||{}}}}}Mt.HttpClient=_c;class Uh extends _c{constructor(){super(...arguments);X(this,"call",{callControllerCreate:(t,n={})=>this.request({path:"/call",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),callControllerFindAll:(t,n={})=>this.request({path:"/call",method:"GET",query:t,secure:!0,format:"json",...n}),callControllerFindOne:(t,n={})=>this.request({path:`/call/${t}`,method:"GET",secure:!0,format:"json",...n}),callControllerUpdate:(t,n,a={})=>this.request({path:`/call/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),callControllerDeleteCallData:(t,n={})=>this.request({path:`/call/${t}`,method:"DELETE",secure:!0,format:"json",...n}),callControllerCreatePhoneCall:(t,n={})=>this.request({path:"/call/phone",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),callControllerCreateWebCall:(t,n={})=>this.request({path:"/call/web",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n})});X(this,"v2",{callControllerExportCalls:(t,n={})=>this.request({path:"/v2/call/export",method:"GET",query:t,secure:!0,...n}),callControllerFindAllPaginated:(t,n={})=>this.request({path:"/v2/call",method:"GET",query:t,secure:!0,format:"json",...n}),callControllerFindAllMetadataPaginated:(t,n={})=>this.request({path:"/v2/call/metadata",method:"GET",query:t,secure:!0,format:"json",...n}),assistantControllerFindAllPaginated:(t,n={})=>this.request({path:"/v2/assistant",method:"GET",query:t,secure:!0,format:"json",...n}),phoneNumberControllerFindAllPaginated:(t,n={})=>this.request({path:"/v2/phone-number",method:"GET",query:t,secure:!0,format:"json",...n})});X(this,"chat",{chatControllerListChats:(t,n={})=>this.request({path:"/chat",method:"GET",query:t,secure:!0,format:"json",...n}),chatControllerCreateChat:(t,n={})=>this.request({path:"/chat",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),chatControllerGetChat:(t,n={})=>this.request({path:`/chat/${t}`,method:"GET",secure:!0,format:"json",...n}),chatControllerDeleteChat:(t,n={})=>this.request({path:`/chat/${t}`,method:"DELETE",secure:!0,format:"json",...n}),chatControllerCreateOpenAiChat:(t,n={})=>this.request({path:"/chat/responses",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),chatControllerCreateWebChat:(t,n={})=>this.request({path:"/chat/web",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),chatControllerCreateOpenAiWebChat:(t,n={})=>this.request({path:"/chat/web/responses",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n})});X(this,"campaign",{campaignControllerCreate:(t,n={})=>this.request({path:"/campaign",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),campaignControllerFindAll:(t,n={})=>this.request({path:"/campaign",method:"GET",query:t,secure:!0,format:"json",...n}),campaignControllerFindAllPaginated:(t,n={})=>this.request({path:"/campaign/paginated",method:"GET",query:t,secure:!0,format:"json",...n}),campaignControllerFindOne:(t,n={})=>this.request({path:`/campaign/${t}`,method:"GET",secure:!0,format:"json",...n}),campaignControllerUpdate:(t,n,a={})=>this.request({path:`/campaign/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),campaignControllerRemove:(t,n={})=>this.request({path:`/campaign/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"session",{sessionControllerCreate:(t,n={})=>this.request({path:"/session",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),sessionControllerFindAllPaginated:(t,n={})=>this.request({path:"/session",method:"GET",query:t,secure:!0,format:"json",...n}),sessionControllerFindOne:(t,n={})=>this.request({path:`/session/${t}`,method:"GET",secure:!0,format:"json",...n}),sessionControllerUpdate:(t,n,a={})=>this.request({path:`/session/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),sessionControllerRemove:(t,n={})=>this.request({path:`/session/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"support",{supportControllerCreateTicket:(t,n={})=>this.request({path:"/support/ticket",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n})});X(this,"assistant",{assistantControllerCreate:(t,n={})=>this.request({path:"/assistant",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),assistantControllerFindAll:(t,n={})=>this.request({path:"/assistant",method:"GET",query:t,secure:!0,format:"json",...n}),assistantControllerFindOne:(t,n={})=>this.request({path:`/assistant/${t}`,method:"GET",secure:!0,format:"json",...n}),assistantControllerUpdate:(t,n,a={})=>this.request({path:`/assistant/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),assistantControllerReplace:(t,n,a={})=>this.request({path:`/assistant/${t}`,method:"PUT",body:n,secure:!0,type:q.Json,format:"json",...a}),assistantControllerRemove:(t,n={})=>this.request({path:`/assistant/${t}`,method:"DELETE",secure:!0,format:"json",...n}),assistantControllerFindVersions:(t,n,a={})=>this.request({path:`/assistant/${t}/version`,method:"GET",query:n,secure:!0,format:"json",...a})});X(this,"phoneNumber",{phoneNumberControllerImportTwilio:(t,n={})=>this.request({path:"/phone-number/import/twilio",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),phoneNumberControllerImportVonage:(t,n={})=>this.request({path:"/phone-number/import/vonage",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),phoneNumberControllerCreate:(t,n={})=>this.request({path:"/phone-number",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),phoneNumberControllerFindAll:(t,n={})=>this.request({path:"/phone-number",method:"GET",query:t,secure:!0,format:"json",...n}),phoneNumberControllerFindOne:(t,n={})=>this.request({path:`/phone-number/${t}`,method:"GET",secure:!0,format:"json",...n}),phoneNumberControllerUpdate:(t,n,a={})=>this.request({path:`/phone-number/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),phoneNumberControllerRemove:(t,n={})=>this.request({path:`/phone-number/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"tool",{toolControllerCreate:(t,n={})=>this.request({path:"/tool",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),toolControllerFindAll:(t,n={})=>this.request({path:"/tool",method:"GET",query:t,secure:!0,format:"json",...n}),toolControllerFindOne:(t,n={})=>this.request({path:`/tool/${t}`,method:"GET",secure:!0,format:"json",...n}),toolControllerUpdate:(t,n,a={})=>this.request({path:`/tool/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),toolControllerRemove:(t,n={})=>this.request({path:`/tool/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"file",{fileControllerCreateDeprecated:(t,n={})=>this.request({path:"/file/upload",method:"POST",body:t,secure:!0,type:q.FormData,format:"json",...n}),fileControllerCreate:(t,n={})=>this.request({path:"/file",method:"POST",body:t,secure:!0,type:q.FormData,format:"json",...n}),fileControllerFindAll:(t={})=>this.request({path:"/file",method:"GET",secure:!0,format:"json",...t}),fileControllerFindOne:(t,n={})=>this.request({path:`/file/${t}`,method:"GET",secure:!0,format:"json",...n}),fileControllerUpdate:(t,n,a={})=>this.request({path:`/file/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),fileControllerRemove:(t,n={})=>this.request({path:`/file/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"knowledgeBase",{knowledgeBaseControllerCreate:(t,n={})=>this.request({path:"/knowledge-base",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),knowledgeBaseControllerFindAll:(t,n={})=>this.request({path:"/knowledge-base",method:"GET",query:t,secure:!0,format:"json",...n}),knowledgeBaseControllerFindOne:(t,n={})=>this.request({path:`/knowledge-base/${t}`,method:"GET",secure:!0,format:"json",...n}),knowledgeBaseControllerUpdate:(t,n,a={})=>this.request({path:`/knowledge-base/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),knowledgeBaseControllerRemove:(t,n={})=>this.request({path:`/knowledge-base/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"workflow",{workflowControllerFindAll:(t={})=>this.request({path:"/workflow",method:"GET",secure:!0,format:"json",...t}),workflowControllerCreate:(t,n={})=>this.request({path:"/workflow",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),workflowControllerFindOne:(t,n={})=>this.request({path:`/workflow/${t}`,method:"GET",secure:!0,format:"json",...n}),workflowControllerDelete:(t,n={})=>this.request({path:`/workflow/${t}`,method:"DELETE",secure:!0,format:"json",...n}),workflowControllerUpdate:(t,n,a={})=>this.request({path:`/workflow/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),workflowControllerGenerateFromTranscripts:(t,n={})=>this.request({path:"/workflow/generate",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n})});X(this,"squad",{squadControllerCreate:(t,n={})=>this.request({path:"/squad",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),squadControllerFindAll:(t,n={})=>this.request({path:"/squad",method:"GET",query:t,secure:!0,format:"json",...n}),squadControllerFindOne:(t,n={})=>this.request({path:`/squad/${t}`,method:"GET",secure:!0,format:"json",...n}),squadControllerUpdate:(t,n,a={})=>this.request({path:`/squad/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),squadControllerRemove:(t,n={})=>this.request({path:`/squad/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"testSuite",{testSuiteControllerFindAllPaginated:(t,n={})=>this.request({path:"/test-suite",method:"GET",query:t,secure:!0,format:"json",...n}),testSuiteControllerCreate:(t,n={})=>this.request({path:"/test-suite",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),testSuiteControllerFindOne:(t,n={})=>this.request({path:`/test-suite/${t}`,method:"GET",secure:!0,format:"json",...n}),testSuiteControllerUpdate:(t,n,a={})=>this.request({path:`/test-suite/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),testSuiteControllerRemove:(t,n={})=>this.request({path:`/test-suite/${t}`,method:"DELETE",secure:!0,format:"json",...n}),testSuiteTestControllerFindAllPaginated:(t,n,a={})=>this.request({path:`/test-suite/${t}/test`,method:"GET",query:n,secure:!0,format:"json",...a}),testSuiteTestControllerCreate:(t,n,a={})=>this.request({path:`/test-suite/${t}/test`,method:"POST",body:n,secure:!0,type:q.Json,format:"json",...a}),testSuiteTestControllerFindOne:(t,n,a={})=>this.request({path:`/test-suite/${t}/test/${n}`,method:"GET",secure:!0,format:"json",...a}),testSuiteTestControllerUpdate:(t,n,a,i={})=>this.request({path:`/test-suite/${t}/test/${n}`,method:"PATCH",body:a,secure:!0,type:q.Json,format:"json",...i}),testSuiteTestControllerRemove:(t,n,a={})=>this.request({path:`/test-suite/${t}/test/${n}`,method:"DELETE",secure:!0,format:"json",...a}),testSuiteRunControllerFindAllPaginated:(t,n,a={})=>this.request({path:`/test-suite/${t}/run`,method:"GET",query:n,secure:!0,format:"json",...a}),testSuiteRunControllerCreate:(t,n,a={})=>this.request({path:`/test-suite/${t}/run`,method:"POST",body:n,secure:!0,type:q.Json,format:"json",...a}),testSuiteRunControllerFindOne:(t,n,a={})=>this.request({path:`/test-suite/${t}/run/${n}`,method:"GET",secure:!0,format:"json",...a}),testSuiteRunControllerUpdate:(t,n,a,i={})=>this.request({path:`/test-suite/${t}/run/${n}`,method:"PATCH",body:a,secure:!0,type:q.Json,format:"json",...i}),testSuiteRunControllerRemove:(t,n,a={})=>this.request({path:`/test-suite/${t}/run/${n}`,method:"DELETE",secure:!0,format:"json",...a})});X(this,"analytics",{analyticsControllerQuery:(t,n={})=>this.request({path:"/analytics",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n})});X(this,"log",{loggingControllerCallLogsQuery:(t,n={})=>this.request({path:"/log",method:"GET",query:t,secure:!0,format:"json",...n}),loggingControllerCallLogsDeleteQuery:(t,n={})=>this.request({path:"/log",method:"DELETE",query:t,secure:!0,...n})});X(this,"logs",{loggingControllerLogsQuery:(t,n={})=>this.request({path:"/logs",method:"GET",query:t,secure:!0,format:"json",...n}),loggingControllerLogsDeleteQuery:(t,n={})=>this.request({path:"/logs",method:"DELETE",query:t,secure:!0,...n})});X(this,"org",{orgControllerCreate:(t,n={})=>this.request({path:"/org",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),orgControllerFindAll:(t={})=>this.request({path:"/org",method:"GET",secure:!0,format:"json",...t}),orgControllerFindOne:(t,n={})=>this.request({path:`/org/${t}`,method:"GET",secure:!0,format:"json",...n}),orgControllerUpdate:(t,n,a={})=>this.request({path:`/org/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),orgControllerDeleteOrg:(t,n={})=>this.request({path:`/org/${t}`,method:"DELETE",secure:!0,...n}),orgControllerFindAllUsers:(t,n={})=>this.request({path:`/org/${t}/user`,method:"GET",secure:!0,format:"json",...n}),orgControllerOrgLeave:(t,n={})=>this.request({path:`/org/${t}/leave`,method:"DELETE",secure:!0,...n}),orgControllerOrgRemoveUser:(t,n,a={})=>this.request({path:`/org/${t}/member/${n}/leave`,method:"DELETE",secure:!0,...a}),orgControllerUsersInvite:(t,n,a={})=>this.request({path:`/org/${t}/invite`,method:"POST",body:n,secure:!0,type:q.Json,...a}),orgControllerUserUpdate:(t,n,a={})=>this.request({path:`/org/${t}/role`,method:"PATCH",body:n,secure:!0,type:q.Json,...a}),orgControllerOrgToken:(t,n={})=>this.request({path:`/org/${t}/auth`,method:"GET",secure:!0,format:"json",...n})});X(this,"token",{tokenControllerCreate:(t,n={})=>this.request({path:"/token",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),tokenControllerFindAll:(t,n={})=>this.request({path:"/token",method:"GET",query:t,secure:!0,format:"json",...n}),tokenControllerFindOne:(t,n={})=>this.request({path:`/token/${t}`,method:"GET",secure:!0,format:"json",...n}),tokenControllerUpdate:(t,n,a={})=>this.request({path:`/token/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),tokenControllerRemove:(t,n={})=>this.request({path:`/token/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"credential",{credentialControllerCreate:(t,n={})=>this.request({path:"/credential",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),credentialControllerFindAll:(t,n={})=>this.request({path:"/credential",method:"GET",query:t,secure:!0,format:"json",...n}),credentialControllerFindOne:(t,n={})=>this.request({path:`/credential/${t}`,method:"GET",secure:!0,format:"json",...n}),credentialControllerUpdate:(t,n,a={})=>this.request({path:`/credential/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),credentialControllerRemove:(t,n={})=>this.request({path:`/credential/${t}`,method:"DELETE",secure:!0,format:"json",...n}),credentialControllerGenerateSession:(t,n={})=>this.request({path:"/credential/session",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),credentialControllerHandleWebhook:(t,n={})=>this.request({path:"/credential/webhook",method:"POST",body:t,type:q.Json,...n}),credentialControllerCredentialActionTrigger:(t,n={})=>this.request({path:"/credential/trigger",method:"POST",body:t,secure:!0,type:q.Json,...n})});X(this,"template",{templateControllerCreate:(t,n={})=>this.request({path:"/template",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),templateControllerFindAll:(t,n={})=>this.request({path:"/template",method:"GET",query:t,secure:!0,format:"json",...n}),templateControllerFindAllPinned:(t={})=>this.request({path:"/template/pinned",method:"GET",secure:!0,format:"json",...t}),templateControllerFindOne:(t,n={})=>this.request({path:`/template/${t}`,method:"GET",secure:!0,format:"json",...n}),templateControllerUpdate:(t,n,a={})=>this.request({path:`/template/${t}`,method:"PATCH",body:n,secure:!0,type:q.Json,format:"json",...a}),templateControllerRemove:(t,n={})=>this.request({path:`/template/${t}`,method:"DELETE",secure:!0,format:"json",...n})});X(this,"voiceLibrary",{voiceLibraryControllerVoiceGetByProvider:(t,n,a={})=>this.request({path:`/voice-library/${t}`,method:"GET",query:n,secure:!0,format:"json",...a}),voiceLibraryControllerVoiceGetAccentsByProvider:(t,n={})=>this.request({path:`/voice-library/${t}/accents`,method:"GET",secure:!0,format:"json",...n}),voiceLibraryControllerVoiceLibrarySyncByProvider:(t,n={})=>this.request({path:`/voice-library/sync/${t}`,method:"POST",secure:!0,format:"json",...n}),voiceLibraryControllerVoiceLibrarySyncDefaultVoices:(t,n={})=>this.request({path:"/voice-library/sync",method:"POST",body:t,secure:!0,type:q.Json,format:"json",...n}),voiceLibraryControllerVoiceLibraryCreateSesameVoice:(t,n={})=>this.request({path:"/voice-library/create-sesame-voice",method:"POST",body:t,secure:!0,type:q.Json,...n})});X(this,"provider",{providerControllerGetWorkflows:(t,n,a={})=>this.request({path:`/${t}/workflows`,method:"GET",query:n,secure:!0,format:"json",...a}),providerControllerGetWorkflowTriggerHook:(t,n,a={})=>this.request({path:`/${t}/workflows/${n}/hooks`,method:"GET",secure:!0,format:"json",...a}),providerControllerGetLocations:(t,n={})=>this.request({path:`/${t}/locations`,method:"GET",secure:!0,format:"json",...n}),voiceProviderControllerSearchVoices:(t,n,a={})=>this.request({path:`/${t}/voices/search`,method:"GET",query:n,secure:!0,format:"json",...a}),voiceProviderControllerSearchVoice:(t,n,a={})=>this.request({path:`/${t}/voice/search`,method:"GET",query:n,secure:!0,format:"json",...a}),voiceProviderControllerAddVoices:(t,n,a={})=>this.request({path:`/${t}/voices/add`,method:"POST",body:n,secure:!0,type:q.Json,format:"json",...a}),voiceProviderControllerAddVoice:(t,n,a={})=>this.request({path:`/${t}/voice/add`,method:"POST",body:n,secure:!0,type:q.Json,format:"json",...a})});X(this,"v11Labs",{voiceProviderControllerCloneVoices:(t,n={})=>this.request({path:"/11labs/voice/clone",method:"POST",body:t,secure:!0,type:q.FormData,...n})})}}Mt.Api=Uh;Object.defineProperty(Sn,"__esModule",{value:!0});Sn.client=void 0;const Bh=Mt,$h=new Bh.Api({baseUrl:"https://api.vapi.ai",baseApiParams:{secure:!0},securityWorker:async s=>{if(s)return{headers:{Authorization:`Bearer ${s}`}}}});Sn.client=$h;var xc=va&&va.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(wo,"__esModule",{value:!0});const Jh=xc(Ih),Gh=xc(qh),$n=Sn;async function zh(s,e){s.muted=!1,s.autoplay=!0,e!=null&&(s.srcObject=new MediaStream([e]),await s.play())}async function Yh(s,e){const t=document.createElement("audio");return t.dataset.participantId=e,document.body.appendChild(t),await zh(t,s),t}function Wh(s){const e=document.querySelector(`audio[data-participant-id="${s}"]`);e==null||e.remove()}function Hh(s,e,t,n){s.participant.local||e.updateParticipant(s.participant.session_id,{setSubscribedTracks:{audio:!0,video:t||n}})}class Kh extends Gh.default{on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}emit(e,...t){return super.emit(e,...t)}removeListener(e,t){return super.removeListener(e,t),this}removeAllListeners(e){return super.removeAllListeners(e),this}}class Qh extends Kh{constructor(t,n,a,i){super();X(this,"started",!1);X(this,"call",null);X(this,"speakingTimeout",null);X(this,"dailyCallConfig",{});X(this,"dailyCallObject",{});X(this,"hasEmittedCallEndedStatus",!1);$n.client.baseUrl=n??"https://api.vapi.ai",$n.client.setSecurityData(t),this.dailyCallConfig=a??{},this.dailyCallObject=i??{}}cleanup(){var t;this.started=!1,this.hasEmittedCallEndedStatus=!1,(t=this.call)==null||t.destroy(),this.call=null,this.speakingTimeout=null}isMobileDevice(){if(typeof navigator>"u")return!1;const t=navigator.userAgent;return/android|iphone|ipad|ipod|iemobile|blackberry|bada/i.test(t.toLowerCase())}async sleep(t){return new Promise(n=>setTimeout(n,t))}async start(t,n,a,i,l){var d,m,g,_,M,E,k;const c=Date.now();if(!t&&!a&&!i){const b=new Error("Assistant or Squad or Workflow must be provided.");throw this.emit("error",{type:"validation-error",stage:"input-validation",message:b.message,timestamp:new Date().toISOString()}),b}if(this.started)return this.emit("call-start-progress",{stage:"validation",status:"failed",timestamp:new Date().toISOString(),metadata:{reason:"already-started"}}),null;this.emit("call-start-progress",{stage:"initialization",status:"started",timestamp:new Date().toISOString(),metadata:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i}}),this.started=!0;try{this.emit("call-start-progress",{stage:"web-call-creation",status:"started",timestamp:new Date().toISOString()});const b=Date.now(),x=(await $n.client.call.callControllerCreateWebCall({assistant:typeof t=="string"?void 0:t,assistantId:typeof t=="string"?t:void 0,assistantOverrides:n,squad:typeof a=="string"?void 0:a,squadId:typeof a=="string"?a:void 0,workflow:typeof i=="string"?void 0:i,workflowId:typeof i=="string"?i:void 0,workflowOverrides:l})).data,p=Date.now()-b;this.emit("call-start-progress",{stage:"web-call-creation",status:"completed",duration:p,timestamp:new Date().toISOString(),metadata:{callId:(x==null?void 0:x.id)||"unknown",videoRecordingEnabled:((d=x==null?void 0:x.artifactPlan)==null?void 0:d.videoRecordingEnabled)??!1,voiceProvider:((g=(m=x==null?void 0:x.assistant)==null?void 0:m.voice)==null?void 0:g.provider)||"unknown"}}),this.call&&(this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"started",timestamp:new Date().toISOString(),metadata:{action:"cleanup-existing"}}),this.cleanup());const T=((_=x==null?void 0:x.artifactPlan)==null?void 0:_.videoRecordingEnabled)??!1,L=((E=(M=x==null?void 0:x.assistant)==null?void 0:M.voice)==null?void 0:E.provider)==="tavus";this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"started",timestamp:new Date().toISOString(),metadata:{audioSource:this.dailyCallObject.audioSource??!0,videoSource:this.dailyCallObject.videoSource??T,isVideoRecordingEnabled:T,isVideoEnabled:L}});const j=Date.now();try{this.call=Jh.default.createCallObject({audioSource:this.dailyCallObject.audioSource??!0,videoSource:this.dailyCallObject.videoSource??T,dailyConfig:this.dailyCallConfig});const C=Date.now()-j;this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"completed",duration:C,timestamp:new Date().toISOString()})}catch(C){const G=Date.now()-j;throw this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"failed",duration:G,timestamp:new Date().toISOString(),metadata:{error:C==null?void 0:C.toString()}}),this.emit("error",{type:"daily-call-object-creation-error",stage:"daily-call-object-creation",error:C,timestamp:new Date().toISOString()}),C}(k=this.call.iframe())==null||k.style.setProperty("display","none"),this.call.on("left-meeting",()=>{var C;this.emit("call-end"),this.hasEmittedCallEndedStatus||(this.emit("message",{type:"status-update",status:"ended",endedReason:"customer-ended-call"}),this.hasEmittedCallEndedStatus=!0),T&&((C=this.call)==null||C.stopRecording()),this.cleanup()}),this.call.on("error",C=>{var G;this.emit("error",C),T&&((G=this.call)==null||G.stopRecording())}),this.call.on("camera-error",C=>{this.emit("camera-error",C)}),this.call.on("network-quality-change",C=>{this.emit("network-quality-change",C)}),this.call.on("network-connection",C=>{this.emit("network-connection",C)}),this.call.on("track-started",async C=>{var G,S,V;!C||!C.participant||(G=C.participant)!=null&&G.local||((S=C.participant)==null?void 0:S.user_name)==="Vapi Speaker"&&(C.track.kind==="video"&&this.emit("video",C.track),C.track.kind==="audio"&&await Yh(C.track,C.participant.session_id),(V=this.call)==null||V.sendAppMessage("playable"))}),this.call.on("participant-joined",C=>{!C||!this.call||Hh(C,this.call,T,L)}),this.call.on("participant-updated",C=>{C&&this.emit("daily-participant-updated",C.participant)}),this.call.on("participant-left",C=>{C&&Wh(C.participant.session_id)});const O=this.isMobileDevice();if(this.emit("call-start-progress",{stage:"mobile-permissions",status:"started",timestamp:new Date().toISOString(),metadata:{isMobile:O}}),O){const C=Date.now();await this.sleep(1e3);const G=Date.now()-C;this.emit("call-start-progress",{stage:"mobile-permissions",status:"completed",duration:G,timestamp:new Date().toISOString(),metadata:{action:"permissions-wait"}})}else this.emit("call-start-progress",{stage:"mobile-permissions",status:"completed",timestamp:new Date().toISOString(),metadata:{action:"skipped-not-mobile"}});this.emit("call-start-progress",{stage:"daily-call-join",status:"started",timestamp:new Date().toISOString()});const D=Date.now();try{await this.call.join({url:x.webCallUrl,subscribeToTracksAutomatically:!1});const C=Date.now()-D;this.emit("call-start-progress",{stage:"daily-call-join",status:"completed",duration:C,timestamp:new Date().toISOString()})}catch(C){const G=Date.now()-D;throw this.emit("call-start-progress",{stage:"daily-call-join",status:"failed",duration:G,timestamp:new Date().toISOString(),metadata:{error:C==null?void 0:C.toString()}}),this.emit("error",{type:"daily-call-join-error",stage:"daily-call-join",error:C,duration:G,timestamp:new Date().toISOString()}),C}if(T){this.emit("call-start-progress",{stage:"video-recording-setup",status:"started",timestamp:new Date().toISOString()});const C=new Date().getTime(),G=Date.now();try{this.call.startRecording({width:1280,height:720,backgroundColor:"#FF1F2D3D",layout:{preset:"default"}});const S=Date.now()-G;this.emit("call-start-progress",{stage:"video-recording-setup",status:"completed",duration:S,timestamp:new Date().toISOString()}),this.call.on("recording-started",()=>{const V=(new Date().getTime()-C)/1e3;this.emit("call-start-progress",{stage:"video-recording-started",status:"completed",timestamp:new Date().toISOString(),metadata:{delaySeconds:V}}),this.send({type:"control",control:"say-first-message",videoRecordingStartDelaySeconds:V})})}catch(S){const V=Date.now()-G;this.emit("call-start-progress",{stage:"video-recording-setup",status:"failed",duration:V,timestamp:new Date().toISOString(),metadata:{error:S==null?void 0:S.toString()}}),this.emit("error",{type:"video-recording-setup-error",stage:"video-recording-setup",error:S,timestamp:new Date().toISOString()})}}else this.emit("call-start-progress",{stage:"video-recording-setup",status:"completed",timestamp:new Date().toISOString(),metadata:{action:"skipped-not-enabled"}});this.emit("call-start-progress",{stage:"audio-observer-setup",status:"started",timestamp:new Date().toISOString()});const Y=Date.now();try{this.call.startRemoteParticipantsAudioLevelObserver(100);const C=Date.now()-Y;this.emit("call-start-progress",{stage:"audio-observer-setup",status:"completed",duration:C,timestamp:new Date().toISOString()})}catch(C){const G=Date.now()-Y;this.emit("call-start-progress",{stage:"audio-observer-setup",status:"failed",duration:G,timestamp:new Date().toISOString(),metadata:{error:C==null?void 0:C.toString()}}),this.emit("error",{type:"audio-observer-setup-error",stage:"audio-observer-setup",error:C,timestamp:new Date().toISOString()})}this.call.on("remote-participants-audio-level",C=>{C&&this.handleRemoteParticipantsAudioLevel(C)}),this.call.on("app-message",C=>this.onAppMessage(C)),this.call.on("nonfatal-error",C=>{var G;(C==null?void 0:C.type)==="audio-processor-error"&&((G=this.call)==null||G.updateInputSettings({audio:{processor:{type:"none"}}}).then(()=>{var S;(S=this.call)==null||S.setLocalAudio(!0)}))}),this.emit("call-start-progress",{stage:"audio-processing-setup",status:"started",timestamp:new Date().toISOString()});const te=Date.now();try{this.call.updateInputSettings({audio:{processor:{type:"noise-cancellation"}}});const C=Date.now()-te;this.emit("call-start-progress",{stage:"audio-processing-setup",status:"completed",duration:C,timestamp:new Date().toISOString()})}catch(C){const G=Date.now()-te;this.emit("call-start-progress",{stage:"audio-processing-setup",status:"failed",duration:G,timestamp:new Date().toISOString(),metadata:{error:C==null?void 0:C.toString()}}),this.emit("error",{type:"audio-processing-setup-error",stage:"audio-processing-setup",error:C,timestamp:new Date().toISOString()})}const re=Date.now()-c;return this.emit("call-start-success",{totalDuration:re,callId:(x==null?void 0:x.id)||"unknown",timestamp:new Date().toISOString()}),x}catch(b){const x=Date.now()-c;return this.emit("call-start-failed",{stage:"unknown",totalDuration:x,error:(b==null?void 0:b.toString())||"Unknown error occurred",errorStack:b instanceof Error?b.stack:"No stack trace available",timestamp:new Date().toISOString(),context:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i,isMobile:this.isMobileDevice()}}),this.emit("error",{type:"start-method-error",stage:"unknown",error:b,totalDuration:x,timestamp:new Date().toISOString(),context:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i,isMobile:this.isMobileDevice()}}),this.cleanup(),null}}onAppMessage(t){if(t)try{if(t.data==="listening")return this.emit("call-start");try{const n=JSON.parse(t.data);this.emit("message",n),n&&"type"in n&&"status"in n&&n.type==="status-update"&&n.status==="ended"&&(this.hasEmittedCallEndedStatus=!0)}catch(n){console.log("Error parsing message data: ",n)}}catch(n){console.error(n)}}handleRemoteParticipantsAudioLevel(t){const n=Object.values(t.participantsAudioLevel).reduce((i,l)=>i+l,0);this.emit("volume-level",Math.min(1,n/.15)),n>.01&&(this.speakingTimeout?(clearTimeout(this.speakingTimeout),this.speakingTimeout=null):this.emit("speech-start"),this.speakingTimeout=setTimeout(()=>{this.emit("speech-end"),this.speakingTimeout=null},1e3))}stop(){var t;this.started=!1,(t=this.call)==null||t.destroy(),this.call=null}send(t){var n;(n=this.call)==null||n.sendAppMessage(JSON.stringify(t))}setMuted(t){if(!this.call)throw new Error("Call object is not available.");this.call.setLocalAudio(!t)}isMuted(){return this.call?this.call.localAudio()===!1:!1}say(t,n,a,i){this.send({type:"say",message:t,endCallAfterSpoken:n,interruptionsEnabled:a??!1,interruptAssistantEnabled:i??!1})}setInputDevicesAsync(t){var n;(n=this.call)==null||n.setInputDevicesAsync(t)}async increaseMicLevel(t){if(!this.call)throw new Error("Call object is not available.");try{const n=await navigator.mediaDevices.getUserMedia({audio:!0}),a=new AudioContext,i=a.createMediaStreamSource(n),l=a.createGain();l.gain.value=t,i.connect(l);const c=a.createMediaStreamDestination();l.connect(c);const[d]=c.stream.getAudioTracks();await this.call.setInputDevicesAsync({audioSource:d})}catch(n){console.error("Error adjusting microphone level:",n)}}setOutputDeviceAsync(t){var n;(n=this.call)==null||n.setOutputDeviceAsync(t)}getDailyCallObject(){return this.call}startScreenSharing(t,n){var a;(a=this.call)==null||a.startScreenShare({displayMediaOptions:t,screenVideoSendSettings:n})}stopScreenSharing(){var t;(t=this.call)==null||t.stopScreenShare()}}var gs=wo.default=Qh;const Xh=({agentId:s,agentName:e="AI Assistant",agentConfig:t,onCallStart:n,onCallEnd:a,onError:i})=>{const l="eb3b26e3-7dbb-4fd6-a545-a954756a43aa",c=K.useRef(null),d=K.useRef(null),[m,g]=K.useState({isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,volumeLevel:0,callDuration:0,status:"idle",callId:void 0}),[_,M]=K.useState([]),E=K.useRef(null),k=l!=="your-vapi-public-key-here";console.log("🔍 VAPI Debug Info:"),console.log("- Vapi class available:",typeof gs),console.log("- Public API Key:",`${l.substring(0,8)}...`),console.log("- Is configured:",k),K.useEffect(()=>{console.log("🔧 Initializing VAPI for agent:",s),console.log("🔑 Public API Key:",`${l.substring(0,8)}...`),console.log("✅ Is VAPI Configured:",k);try{console.log("🧪 Testing VAPI import..."),console.log("- Vapi constructor:",gs),console.log("- typeof Vapi:",typeof gs),typeof gs=="function"?console.log("✅ VAPI import successful"):console.error("❌ VAPI import failed - not a constructor")}catch(S){console.error("❌ VAPI import test failed:",S)}try{c.current=new gs(l),console.log("✅ VAPI instance created successfully"),b()}catch(S){console.error("❌ Failed to initialize VAPI:",S),ee.error("Failed to initialize VAPI. Please check your API key.")}return()=>{c.current&&c.current.stop(),E.current&&clearInterval(E.current),d.current&&(d.current.getTracks().forEach(S=>S.stop()),d.current=null)}},[l,s]);const b=()=>{c.current&&(c.current.on("call-start",()=>{console.log("🎙️ VAPI call started"),g(S=>({...S,isConnected:!0,isConnecting:!1,status:"connected",callId:Date.now().toString()})),x(),ee.success("Call connected! You can now speak."),n==null||n()}),c.current.on("call-end",()=>{console.log("📞 VAPI call ended successfully"),g(S=>({...S,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"ended",callId:void 0})),E.current&&(clearInterval(E.current),E.current=null),d.current&&(d.current.getTracks().forEach(S=>S.stop()),d.current=null),ee.success("Call ended successfully"),a==null||a()}),c.current.on("error",S=>{console.error("❌ VAPI call error:",S),g(V=>({...V,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"error",callId:void 0})),E.current&&(clearInterval(E.current),E.current=null),ee.error(`Call error: ${S.message||"Unknown error"}`),i==null||i(S)}),c.current.on("speech-start",()=>{console.log("🗣️ Speech started")}),c.current.on("speech-end",()=>{console.log("🤐 Speech ended")}),c.current.on("volume-level",S=>{g(V=>({...V,volumeLevel:S}))}),c.current.on("message",S=>{if(console.log("📨 VAPI message:",S),S.type==="transcript"&&S.transcript){const V={role:S.role||"assistant",content:S.transcript,timestamp:new Date,type:"transcript"};M(z=>[...z,V])}}),c.current.on("error",S=>{console.error("❌ VAPI error:",S),g(z=>({...z,isConnected:!1,isConnecting:!1,status:"error"}));let V="Unknown error";S.message&&(V=S.message,S.message.includes("assistant")&&S.message.includes("not found")?V="Assistant not found in VAPI. Please ensure the agent is properly synced with VAPI dashboard.":S.message.includes("unauthorized")||S.message.includes("401")?V="Unauthorized access. Please check your VAPI API key configuration.":(S.message.includes("microphone")||S.message.includes("permission"))&&(V="Microphone permission denied. Please allow microphone access and try again.")),ee.error(`Call error: ${V}`),i==null||i(S)}))},x=()=>{E.current=setInterval(()=>{g(S=>({...S,callDuration:S.callDuration+1}))},1e3)},p=S=>{const V=Math.floor(S/60),z=S%60;return`${V}:${z.toString().padStart(2,"0")}`},T=()=>{const S={name:e,firstMessage:(t==null?void 0:t.firstMessage)||`Hello! I'm ${e}. How can I help you today?`,model:{provider:"openai",model:"gpt-4",temperature:.7,messages:[{role:"system",content:(t==null?void 0:t.systemMessage)||`You are ${e}, a helpful AI assistant. Keep responses conversational and under 30 words when possible.`}]},voice:{provider:"vapi",voiceId:(t==null?void 0:t.voiceId)||"Cole"}};return console.log("📋 Assistant config created:",S),S},L=async()=>{if(console.log("🚀 Starting VAPI agent call for:",s),console.log("🔑 VAPI Public Key:",`${l.substring(0,8)}...`),console.log("🤖 Agent Config:",t),!c.current){ee.error("VAPI not initialized. Please check your API key configuration.");return}try{g(V=>({...V,isConnecting:!0,status:"connecting",callDuration:0})),M([]);const S=(t==null?void 0:t.assistant_id)||(t==null?void 0:t.assistantId);if(S){console.log("📞 Using existing assistant ID from database:",S);const V={metadata:{portalAgentId:s,agentName:e,initiatedFrom:"portal"}};console.log("📋 Starting call with assistant ID:",S),console.log("📋 Assistant overrides:",V),await c.current.start(S,V)}else{console.log("🔄 Creating assistant configuration...");const V=T();console.log("📞 Starting agent call with assistant config"),console.log("🤖 Agent Name:",e);const z=V;console.log("📋 Call config:",z),await new Promise(Ee=>setTimeout(Ee,100)),await c.current.start(z)}}catch(S){console.error("❌ Error starting agent call:",S),g(z=>({...z,isConnecting:!1,status:"error"}));let V="Failed to start call";S.message?(V=S.message,S.message.includes("Authentication")||S.message.includes("401")?V="Authentication failed. Please check your VAPI API key.":S.message.includes("assistant")||S.message.includes("404")?V="Assistant not found. The assistant may not exist in VAPI.":S.message.includes("permission")||S.message.includes("microphone")?V="Microphone permission denied. Please allow microphone access.":(S.message.includes("network")||S.message.includes("fetch"))&&(V="Network error. Please check your internet connection.")):S.code?V=`Error code: ${S.code}`:typeof S=="string"&&(V=S),ee.error(`Failed to start call: ${V}`),console.error("📋 Full error details:",S)}},j=()=>{console.log("🛑 Stopping VAPI agent call...");try{c.current?(console.log("📞 VAPI instance found, stopping call..."),c.current.stop(),g(S=>({...S,isConnecting:!1})),console.log("✅ VAPI stop method called successfully")):(console.warn("⚠️ No VAPI instance found to stop"),ee.warning("No active call to end"))}catch(S){console.error("❌ Error stopping call:",S),ee.error(`Failed to end call: ${(S==null?void 0:S.message)||"Unknown error"}`),g(V=>({...V,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"ended",callId:void 0})),d.current&&(d.current.getTracks().forEach(V=>V.stop()),d.current=null)}},O=async()=>{try{if(!d.current){const S=await navigator.mediaDevices.getUserMedia({audio:!0});d.current=S}return d.current}catch(S){throw console.error("Error initializing media stream:",S),S}},D=()=>{try{if(!m.isConnected||!c.current){ee.warning("No active call to mute");return}const S=!m.isMuted;c.current.setMuted(S),g(V=>({...V,isMuted:S})),ee.info(S?"Microphone muted":"Microphone unmuted"),console.log(`🎤 Mute toggled: ${S}`)}catch(S){console.error("Error toggling mute:",S),ee.error(`Failed to toggle mute: ${(S==null?void 0:S.message)||"Unknown error"}`),Y()}},Y=async()=>{try{console.log("🔄 Using fallback mute method...");const V=(await O()).getAudioTracks();if(V.length>0){const z=!m.isMuted;V.forEach(Ee=>{Ee.enabled=!z}),g(Ee=>({...Ee,isMuted:z})),ee.info(z?"Microphone muted (fallback)":"Microphone unmuted (fallback)")}else ee.error("No audio tracks found")}catch(S){console.error("Fallback mute also failed:",S),ee.error("Failed to toggle mute. Please check microphone permissions.")}},te=async()=>{try{if(!m.isConnected){ee.warning("No active call to hold");return}const S=!m.isOnHold;(await O()).getAudioTracks().forEach(Ee=>{Ee.enabled=!S}),g(Ee=>({...Ee,isOnHold:S,isMuted:S})),ee.info(S?"Call on hold":"Call resumed")}catch(S){console.error("Error toggling hold:",S),ee.error("Failed to toggle hold. Please check microphone permissions.")}},re=()=>{const S=document.getElementById("call-button-container");return console.log("🎯 Looking for call-button-container:",S),S?(console.log("🎯 Rendering call button, call state:",m),Vc.createPortal(r.jsxs("div",{className:"flex items-center gap-2",children:[m.isConnected&&r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"text-sm font-mono font-semibold text-gray-800 bg-white px-3 py-1 rounded-md border border-gray-200",children:p(m.callDuration)}),r.jsx(Se,{onClick:D,variant:"outline",size:"sm",className:`border-gray-300 ${m.isMuted?"bg-red-50 text-red-700 hover:bg-red-100":"bg-white hover:bg-gray-50 text-gray-700"}`,title:m.isMuted?"Unmute microphone":"Mute microphone",children:m.isMuted?r.jsx(Ec,{className:"h-4 w-4"}):r.jsx(is,{className:"h-4 w-4"})}),r.jsx(Se,{onClick:te,variant:"outline",size:"sm",className:`border-gray-300 ${m.isOnHold?"bg-yellow-50 text-yellow-700 hover:bg-yellow-100":"bg-white hover:bg-gray-50 text-gray-700"}`,title:m.isOnHold?"Resume call":"Hold call",children:m.isOnHold?r.jsx(Nc,{className:"h-4 w-4"}):r.jsx(Tc,{className:"h-4 w-4"})}),r.jsx(Se,{variant:"outline",size:"sm",className:"border-gray-300 bg-white hover:bg-gray-50 text-gray-700",title:"Volume control",children:r.jsx(Ss,{className:"h-4 w-4"})})]}),!m.isConnected&&!m.isConnecting?r.jsxs(Se,{onClick:L,size:"sm",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-md transition-all duration-200",children:[r.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Call"]}):m.isConnecting?r.jsxs(Se,{size:"sm",className:"px-4 py-2 bg-amber-500 text-white text-sm font-medium rounded-md",disabled:!0,children:[r.jsx(Ot,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting"]}):r.jsxs(Se,{onClick:j,size:"sm",className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md transition-all duration-200",children:[r.jsx(Ac,{className:"h-4 w-4 mr-2"}),"End Call"]})]}),S)):(console.warn("⚠️ call-button-container not found!"),null)};console.log("🎯 VapiAgentCall render - isVapiConfigured:",k),console.log("🎯 VapiAgentCall render - callState:",m),console.log("🎯 VapiAgentCall render - agentId:",s),console.log("🎯 VapiAgentCall render - agentName:",e);const[C,G]=K.useState(!1);return K.useEffect(()=>{const S=()=>document.getElementById("call-button-container")?(console.log("✅ Found call-button-container"),G(!0),!0):(console.warn("❌ call-button-container not found"),!1);if(S())return;const V=setInterval(()=>{S()&&clearInterval(V)},100);return()=>{clearInterval(V)}},[]),r.jsxs("div",{className:"flex flex-col h-full bg-white",children:[re(),r.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[r.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:r.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[r.jsx(Xs,{className:"h-4 w-4"}),"Conversation"]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-white",children:_.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 py-12",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:r.jsx(Xs,{className:"h-8 w-8 text-gray-400"})}),r.jsx("p",{className:"text-center text-sm",children:m.isConnected?"Conversation will appear here...":"Start a call to begin the conversation"})]}):r.jsx("div",{className:"space-y-6",children:_.map((S,V)=>r.jsxs("div",{className:`flex gap-3 ${S.role==="user"?"justify-end":"justify-start"}`,children:[S.role==="assistant"&&r.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(ft,{className:"h-4 w-4 text-gray-600"})}),r.jsxs("div",{className:`max-w-[75%] ${S.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800 border border-gray-200"} rounded-lg px-4 py-3`,children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:`text-xs font-medium ${S.role==="user"?"text-blue-100":"text-gray-500"}`,children:S.role==="user"?"You":e}),r.jsx("span",{className:`text-xs ${S.role==="user"?"text-blue-200":"text-gray-400"}`,children:S.timestamp.toLocaleTimeString()})]}),r.jsx("p",{className:"text-sm leading-relaxed",children:S.content})]}),S.role==="user"&&r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(Mc,{className:"h-4 w-4 text-blue-600"})})]},V))})})]}),r.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-wide mb-1",children:"Assistant"}),r.jsx("p",{className:"font-medium text-gray-900",children:e})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-wide mb-1",children:"Connection"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:`w-2 h-2 rounded-full ${m.status==="connected"?"bg-green-500":m.status==="connecting"?"bg-amber-500 animate-pulse":m.status==="error"?"bg-red-500":"bg-gray-400"}`}),r.jsx("span",{className:"text-gray-700 capitalize",children:m.status==="idle"?"Ready":m.status==="connecting"?"Connecting":m.status==="connected"?"Active":m.status==="ended"?"Ended":"Error"})]})]})]})})]})},Zh=({open:s,onOpenChange:e,onTemplateSelect:t,onCreateCustom:n})=>{const[a,i]=K.useState(""),[l,c]=K.useState("all"),[d,m]=K.useState("initial"),{data:g,isLoading:_}=en({queryKey:["defaultAssistantTemplates",{category:l!=="all"?l:void 0}],queryFn:()=>{const j={is_active:!0};return l!=="all"&&(j.category=l),nu(j)},enabled:s}),{data:M}=en({queryKey:["templateCategories"],queryFn:ru,enabled:s}),E=(g==null?void 0:g.data)||[],k=(M==null?void 0:M.data)||[],b=E.filter(j=>j.name.toLowerCase().includes(a.toLowerCase())||j.description.toLowerCase().includes(a.toLowerCase())||j.category.toLowerCase().includes(a.toLowerCase())),x=async j=>{try{const O=await au(j.template_id);t(O.data),e(!1)}catch(O){console.error("Error using template:",O)}},p=()=>{m("initial"),i(""),c("all")},T=j=>{j||p(),e(j)},L=j=>({Business:"bg-blue-100 text-blue-800",Sales:"bg-green-100 text-green-800",Support:"bg-purple-100 text-purple-800",Scheduling:"bg-orange-100 text-orange-800",General:"bg-gray-100 text-gray-800"})[j]||"bg-gray-100 text-gray-800";return r.jsx(Zt,{open:s,onOpenChange:T,children:r.jsxs(es,{className:`
    max-w-7xl min-h-[700px] overflow-hidden
    bg-[#020617]
    border border-cyan-400/30
    shadow-[0_0_30px_rgba(34,211,238,0.35)]
    text-slate-200
  `,children:[r.jsx(ts,{children:r.jsxs(ss,{className:"flex items-center gap-2 text-white",children:[r.jsx(ft,{className:"h-5 w-5 text-white"}),d==="initial"?"Choose How to Create Your Assistant":"Select AI Service Provider"]})}),d==="initial"?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs(Ae,{className:`  cursor-pointer
  bg-cyan-500/10
  border border-cyan-400/30
  hover:shadow-[0_0_30px_rgba(34,211,238,0.45)]
  transition`,children:[r.jsx(Pe,{className:"pb-3",children:r.jsxs(Le,{className:"flex items-center gap-2 text-white",children:[r.jsx(bo,{className:"h-5 w-5 text-white"}),"Use Default Template"]})}),r.jsxs(Me,{children:[r.jsx("p",{className:"text-white text-sm mb-4",children:"Start with a pre-configured template designed for specific use cases. Perfect for quick setup with proven configurations."}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-white",children:[r.jsx(Oc,{className:"h-3 w-3 text-white"}),"Recommended for beginners"]})]})]}),r.jsxs(Ae,{className:`cursor-pointer bg-cyan-500/10
  border border-cyan-400/30
  hover:shadow-[0_0_30px_rgba(34,211,238,0.45)] transition`,onClick:()=>m("service_selection"),children:[r.jsx(Pe,{className:"pb-3",children:r.jsxs(Le,{className:"flex items-center gap-2 text-white",children:[r.jsx(_o,{className:"h-5 w-5 text-white"}),"Create Custom Assistant"]})}),r.jsxs(Me,{children:[r.jsx("p",{className:"text-white text-sm mb-4",children:"Build your assistant from scratch with full control over all settings. Ideal for specific requirements and advanced users."}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-white",children:[r.jsx(ft,{className:"h-3 w-3 text-white"}),"Full customization available"]})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium",children:"Available Templates"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("div",{className:"relative",children:[r.jsx(xo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white h-4 w-4  z-10"}),r.jsx(ye,{placeholder:"Search templates...",value:a,onChange:j=>i(j.target.value),className:` pl-10 w-64
    bg-black/40
    border border-cyan-400/30
    text-slate-200
    placeholder:text-slate-500
    focus:ring-cyan-400/50`})]}),r.jsxs(be,{value:l,onValueChange:c,children:[r.jsxs(_e,{className:`
    w-48
    bg-black/40
    border border-cyan-400/30
    text-slate-200
  `,children:[r.jsx(Ic,{className:"h-4 w-4 mr-2"}),r.jsx(xe,{placeholder:"Category"})]}),r.jsxs(we,{className:"bg-[#020617] text-white border border-cyan-400/30",children:[r.jsx(ue,{value:"all",children:"All Categories"}),k.map(j=>r.jsxs(ue,{value:j.category,children:[j.category," (",j.count,")"]},j.category))]})]})]})]}),r.jsx("div",{className:"max-h-96 overflow-y-auto",children:_?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((j,O)=>r.jsxs(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,children:[r.jsxs(Pe,{children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),r.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),r.jsx(Me,{children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"h-3 bg-gray-200 rounded"}),r.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})})]},O))}):b.length===0?r.jsx(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,children:r.jsxs(Me,{className:"p-8 text-center",children:[r.jsx(ft,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No templates found"}),r.jsx("p",{className:"text-gray-600 mb-4",children:a||l!=="all"?"Try adjusting your search or filter criteria.":"No templates are currently available."}),r.jsx(Se,{onClick:()=>m("service_selection"),children:"Create Custom Assistant Instead"})]})}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(j=>r.jsxs(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,onClick:()=>x(j),children:[r.jsx(Pe,{className:"pb-3",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx(Le,{className:"text-white flex items-center gap-2",children:j.name}),r.jsx("div",{className:"flex items-center gap-2 mt-2",children:r.jsx(Tt,{className:L(j.category),children:j.category})})]}),r.jsx(Pc,{className:"h-4 w-4 text-gray-400"})]})}),r.jsxs(Me,{className:"pt-0",children:[r.jsx("p",{className:"text-white/60 text-sm mb-3 line-clamp-2",children:j.description}),r.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500",children:r.jsx(Se,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs bg-primary text-white w-full ",children:"Use Template"})})]})]},j.template_id))})})]})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs(Se,{variant:"ghost",onClick:()=>m("initial"),className:"text-white/60 hover:text-white",children:[r.jsx(Lc,{className:"h-4 w-4 mr-2"}),"Back"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4",children:[r.jsxs(Ae,{className:"cursor-pointer bg-blue-500/10 border border-blue-400/30 hover:shadow-[0_0_30px_rgba(59,130,246,0.45)] transition group",onClick:()=>{n("vapi"),e(!1)},children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"flex items-center gap-3 text-white text-2xl",children:[r.jsx("div",{className:"p-3 rounded-lg bg-blue-500/20 group-hover:bg-blue-500/30 transition-colors",children:r.jsx(is,{className:"h-8 w-8 text-blue-400"})}),"Vapi Service"]})}),r.jsxs(Me,{className:"space-y-4",children:[r.jsx("p",{className:"text-white/80",children:"Advanced voice AI platform with ultra-low latency. Best for complex conversational flows and extensive customization."}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx(Tt,{variant:"outline",className:"border-blue-400/30 text-blue-300",children:"Customizable"}),r.jsx(Tt,{variant:"outline",className:"border-blue-400/30 text-blue-300",children:"Real-time"})]})]})]}),r.jsxs(Ae,{className:"cursor-pointer bg-purple-500/10 border border-purple-400/30 hover:shadow-[0_0_30px_rgba(168,85,247,0.45)] transition group",onClick:()=>{n("retell"),e(!1)},children:[r.jsx(Pe,{children:r.jsxs(Le,{className:"flex items-center gap-3 text-white text-2xl",children:[r.jsx("div",{className:"p-3 rounded-lg bg-purple-500/20 group-hover:bg-purple-500/30 transition-colors",children:r.jsx(Zs,{className:"h-8 w-8 text-purple-400"})}),"Retell AI"]})}),r.jsxs(Me,{className:"space-y-4",children:[r.jsx("p",{className:"text-white/80",children:"Powerful telephony and voice agent integration. Ideal for phone-based assistants and seamless call handling."}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsx(Tt,{variant:"outline",className:"border-purple-400/30 text-purple-300",children:"Telephony"}),r.jsx(Tt,{variant:"outline",className:"border-purple-400/30 text-purple-300",children:"Resilient"})]})]})]})]}),r.jsx("div",{className:"text-center text-sm text-white/50 pt-4",children:"Select the service provider that best fits your use case"})]})]})})},em=[{value:"default",label:"Default"},{value:"eleven_turbo_v2",label:"Eleven Turbo v2"},{value:"eleven_flash_v2",label:"Eleven Flash v2"},{value:"eleven_turbo_v2_5",label:"Eleven Turbo v2.5"},{value:"eleven_flash_v2_5",label:"Eleven Flash v2.5"},{value:"eleven_multilingual_v2",label:"Eleven Multilingual v2"},{value:"sonic-2",label:"Sonic 2"},{value:"sonic-3",label:"Sonic 3"},{value:"sonic-3-latest",label:"Sonic 3 Latest"},{value:"sonic-turbo",label:"Sonic Turbo"},{value:"tts-1",label:"TTS-1"},{value:"gpt-4o-mini-tts",label:"GPT-4o Mini TTS"},{value:"speech-02-turbo",label:"Speech 02 Turbo"}],tm=[{value:"none",label:"None (Default)"},{value:"calm",label:"Calm"},{value:"sympathetic",label:"Sympathetic"},{value:"happy",label:"Happy"},{value:"sad",label:"Sad"},{value:"angry",label:"Angry"},{value:"fearful",label:"Fearful"},{value:"surprised",label:"Surprised"}],sm=[{value:"none",label:"None"},{value:"coffee-shop",label:"Coffee Shop"},{value:"convention-hall",label:"Convention Hall"},{value:"summer-outdoor",label:"Summer Outdoor"},{value:"mountain-outdoor",label:"Mountain Outdoor"},{value:"static-noise",label:"Static Noise"},{value:"call-center",label:"Call Center"}],nm=[{value:"en-US",label:"English (US)"},{value:"en-GB",label:"English (UK)"},{value:"en-AU",label:"English (Australia)"},{value:"en-IN",label:"English (India)"},{value:"es-ES",label:"Spanish (Spain)"},{value:"es-419",label:"Spanish (Latin America)"},{value:"fr-FR",label:"French (France)"},{value:"fr-CA",label:"French (Canada)"},{value:"de-DE",label:"German"},{value:"it-IT",label:"Italian"},{value:"pt-BR",label:"Portuguese (Brazil)"},{value:"pt-PT",label:"Portuguese (Portugal)"},{value:"zh-CN",label:"Chinese (Simplified)"},{value:"ja-JP",label:"Japanese"},{value:"ko-KR",label:"Korean"},{value:"hi-IN",label:"Hindi"},{value:"ar-SA",label:"Arabic"},{value:"nl-NL",label:"Dutch"},{value:"pl-PL",label:"Polish"},{value:"ru-RU",label:"Russian"},{value:"tr-TR",label:"Turkish"},{value:"multi",label:"Multilingual"}],rm=[{value:"fast",label:"Fast"},{value:"accurate",label:"Accurate"},{value:"custom",label:"Custom"}],am=[{value:"general",label:"General"},{value:"medical",label:"Medical"}],im=[{value:"none",label:"None"},{value:"noise-cancellation",label:"Noise Cancellation"},{value:"noise-and-background-speech-cancellation",label:"Noise + Background Speech Cancellation"}],om=[{value:"everything",label:"Everything"},{value:"everything_except_pii",label:"Everything except PII"},{value:"basic_attributes_only",label:"Basic Attributes Only"}],lm=[{value:"gpt-4.1-mini",label:"GPT-4.1 Mini (Default)"},{value:"gpt-4.1",label:"GPT-4.1"},{value:"gpt-4.1-nano",label:"GPT-4.1 Nano"},{value:"claude-4.5-sonnet",label:"Claude 4.5 Sonnet"},{value:"claude-4.5-haiku",label:"Claude 4.5 Haiku"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"}],cm=[{value:"gpt-4.1",label:"GPT-4.1"},{value:"gpt-4.1-mini",label:"GPT-4.1 Mini"},{value:"gpt-4.1-nano",label:"GPT-4.1 Nano"},{value:"gpt-5",label:"GPT-5"},{value:"gpt-5-mini",label:"GPT-5 Mini"},{value:"claude-4.5-sonnet",label:"Claude 4.5 Sonnet"},{value:"claude-4.5-haiku",label:"Claude 4.5 Haiku"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"gemini-3.0-flash",label:"Gemini 3.0 Flash"}],um=[{value:"conversation_flow",label:"Conversation Flow Agent"},{value:"single_prompt",label:"Single Prompt Agent"},{value:"multi_prompt_legacy",label:"Multi-Prompt Agent (Legacy)"},{value:"custom_llm",label:"Custom LLM"}];function dm({isOpen:s,onClose:e,onSuccess:t}){var V,z,Ee,$e;const[n,a]=K.useState([]),[i,l]=K.useState([]),[c,d]=K.useState(!1),[m,g]=K.useState(!1),[_,M]=K.useState("voice"),[E,k]=K.useState(!1),[b,x]=K.useState(!1),[p,T]=K.useState({agent_type:"conversation_flow",agent_name:"",version_description:"",voice_id:"",voice_model:"default",fallback_voice_ids:"",voice_temperature:1,voice_speed:1,volume:1,voice_emotion:"none",llm_id:"",new_llm_model:"gpt-4.1",new_llm_begin_message:"",new_llm_general_prompt:"",new_llm_start_speaker:"agent",new_llm_temperature:0,responsiveness:1,interruption_sensitivity:1,enable_backchannel:!1,backchannel_frequency:.8,backchannel_words:"",reminder_trigger_ms:1e4,reminder_max_count:1,ambient_sound:"none",ambient_sound_volume:1,begin_message_delay_ms:0,end_call_after_silence_ms:6e5,max_call_duration_ms:36e5,ring_duration_ms:3e4,language:"en-US",boosted_keywords:"",stt_mode:"fast",vocab_specialization:"general",denoising_mode:"noise-cancellation",normalize_for_speech:!0,enable_voicemail_detection:!1,voicemail_message:"",voicemail_detection_timeout_ms:3e4,webhook_url:"",webhook_timeout_ms:1e4,post_call_analysis_model:"gpt-4.1-mini",analysis_successful_prompt:"",analysis_summary_prompt:"",data_storage_setting:"everything",opt_in_signed_url:!1,allow_user_dtmf:!0,is_public:!1});K.useEffect(()=>{s&&L()},[s]);const L=async()=>{d(!0);try{const[y,Ue]=await Promise.all([Os.get("/api/retell/voices"),Os.get("/api/retell/llms")]);a(y.data.data||[]),l(Ue.data.data||[])}catch(y){console.error("Error fetching Retell data:",y),ee.error("Failed to load Retell options")}finally{d(!1)}},j=(y,Ue)=>{T(Je=>({...Je,[y]:Ue}))},O=async y=>{var Ue,Je;y.preventDefault(),g(!0);try{let Ne=p.llm_id;if(E){if(!p.new_llm_general_prompt.trim()){ee.error("General Prompt is required when creating a new LLM"),g(!1);return}x(!0);const je={model:p.new_llm_model,start_speaker:p.new_llm_start_speaker,model_temperature:p.new_llm_temperature,general_prompt:p.new_llm_general_prompt};p.new_llm_begin_message.trim()&&(je.begin_message=p.new_llm_begin_message),console.log("Creating new LLM:",je),Ne=(await Os.post("/api/retell/create-llm",je)).data.data.llm_id,console.log("New LLM created with ID:",Ne),ee.success("LLM created successfully"),x(!1)}if(!Ne){if(p.agent_type==="custom_llm"){ee.error("Custom LLM requires selecting an existing LLM or creating a new one"),g(!1);return}if(p.agent_type==="single_prompt"){ee.error("Single Prompt Agent requires selecting an LLM or creating a new one"),g(!1);return}ee.error("Please select an LLM or create a new one"),g(!1);return}const B={agent_type:p.agent_type,agent_name:p.agent_name,voice_id:p.voice_id,response_engine:{type:"retell-llm",llm_id:Ne}};p.version_description&&(B.version_description=p.version_description),p.voice_model!=="default"&&(B.voice_model=p.voice_model),p.fallback_voice_ids.trim()&&(B.fallback_voice_ids=p.fallback_voice_ids.split(",").map(je=>je.trim()).filter(Boolean)),p.voice_temperature!==1&&(B.voice_temperature=p.voice_temperature),p.voice_speed!==1&&(B.voice_speed=p.voice_speed),p.volume!==1&&(B.volume=p.volume),p.voice_emotion!=="none"&&(B.voice_emotion=p.voice_emotion),p.responsiveness!==1&&(B.responsiveness=p.responsiveness),p.interruption_sensitivity!==1&&(B.interruption_sensitivity=p.interruption_sensitivity),p.enable_backchannel&&(B.enable_backchannel=!0,p.backchannel_frequency!==.8&&(B.backchannel_frequency=p.backchannel_frequency),p.backchannel_words.trim()&&(B.backchannel_words=p.backchannel_words.split(",").map(je=>je.trim()).filter(Boolean))),p.reminder_trigger_ms!==1e4&&(B.reminder_trigger_ms=p.reminder_trigger_ms),p.reminder_max_count!==1&&(B.reminder_max_count=p.reminder_max_count),p.ambient_sound!=="none"&&(B.ambient_sound=p.ambient_sound,p.ambient_sound_volume!==1&&(B.ambient_sound_volume=p.ambient_sound_volume)),p.begin_message_delay_ms>0&&(B.begin_message_delay_ms=p.begin_message_delay_ms),p.end_call_after_silence_ms!==6e5&&(B.end_call_after_silence_ms=p.end_call_after_silence_ms),p.max_call_duration_ms!==36e5&&(B.max_call_duration_ms=p.max_call_duration_ms),p.ring_duration_ms!==3e4&&(B.ring_duration_ms=p.ring_duration_ms),p.language!=="en-US"&&(B.language=p.language),p.boosted_keywords.trim()&&(B.boosted_keywords=p.boosted_keywords.split(",").map(je=>je.trim()).filter(Boolean)),p.stt_mode!=="fast"&&(B.stt_mode=p.stt_mode),p.vocab_specialization!=="general"&&(B.vocab_specialization=p.vocab_specialization),p.denoising_mode!=="noise-cancellation"&&(B.denoising_mode=p.denoising_mode),p.normalize_for_speech||(B.normalize_for_speech=!1),p.enable_voicemail_detection&&(B.enable_voicemail_detection=!0,p.voicemail_message&&(B.voicemail_message=p.voicemail_message),p.voicemail_detection_timeout_ms!==3e4&&(B.voicemail_detection_timeout_ms=p.voicemail_detection_timeout_ms)),p.webhook_url&&(B.webhook_url=p.webhook_url,p.webhook_timeout_ms!==1e4&&(B.webhook_timeout_ms=p.webhook_timeout_ms)),p.post_call_analysis_model!=="gpt-4.1-mini"&&(B.post_call_analysis_model=p.post_call_analysis_model),p.analysis_successful_prompt&&(B.analysis_successful_prompt=p.analysis_successful_prompt),p.analysis_summary_prompt&&(B.analysis_summary_prompt=p.analysis_summary_prompt),p.data_storage_setting!=="everything"&&(B.data_storage_setting=p.data_storage_setting),p.opt_in_signed_url&&(B.opt_in_signed_url=!0),p.allow_user_dtmf||(B.allow_user_dtmf=!1),p.is_public&&(B.is_public=!0),console.log("Creating Retell agent:",B),await Os.post("/api/retell/create-agent",B),ee.success("Retell Agent Created Successfully"),t(),e()}catch(Ne){console.error("Error creating agent:",Ne),ee.error("Failed to create agent: "+(((Je=(Ue=Ne.response)==null?void 0:Ue.data)==null?void 0:Je.message)||Ne.message))}finally{g(!1)}},D="bg-white/5 border-white/10 text-white focus:border-orange-500/50 placeholder:text-white/30",Y="bg-white/5 border-white/10 text-white focus:border-orange-500/50",te="bg-[#0b0f2e] border-white/10 text-white",re="focus:bg-white/10 focus:text-white",C="text-white/70 text-sm",G="space-y-4 p-4 rounded-xl bg-white/5",S=({label:y,value:Ue,onChange:Je,min:Ne,max:B,step:je,description:o})=>r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx(W,{className:C,children:y}),r.jsx("span",{className:"text-sm text-orange-400 font-mono",children:Ue})]}),r.jsx(iu,{value:[Ue],onValueChange:([h])=>Je(h),min:Ne,max:B,step:je,className:"[&_[role=slider]]:bg-orange-500"}),o&&r.jsx("p",{className:"text-xs text-white/40",children:o})]});return r.jsx(Zt,{open:s,onOpenChange:e,children:r.jsxs(es,{className:"sm:max-w-[1300px] max-h-[90vh] overflow-y-auto bg-[#0b0f2e] border-white/10 text-white neon-fire-scroll p-0",children:[r.jsx(ts,{className:"p-6 pb-0",children:r.jsxs(ss,{className:"flex items-center gap-2 text-2xl font-bold text-orange-500",children:[r.jsx(ft,{className:"h-6 w-6"}),"Create Retell AI Agent"]})}),r.jsxs("form",{onSubmit:O,className:"flex flex-col h-full",children:[r.jsx("div",{className:"px-6 py-3",children:r.jsxs("div",{className:"p-3 rounded-lg bg-orange-500/10 border border-orange-500/20 flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-orange-500/20 rounded-full",children:r.jsx(bo,{className:"h-4 w-4 text-orange-500"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-orange-400",children:"Retell AI Service"}),r.jsx("p",{className:"text-xs text-white/60",children:"Configure your AI voice agent with advanced settings"})]}),r.jsx("div",{className:"flex-1 max-w-xs",children:r.jsx(ye,{placeholder:"Agent Name *",value:p.agent_name,onChange:y=>j("agent_name",y.target.value),className:D,required:!0})})]})}),r.jsxs(wr,{value:_,onValueChange:M,className:"flex-1 flex flex-col",children:[r.jsx("div",{className:"px-6",children:r.jsxs(Sr,{className:"w-full bg-white/5 p-1 rounded-lg grid grid-cols-6 gap-1",children:[r.jsxs(Ye,{value:"voice",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[r.jsx(Ss,{className:"h-3 w-3 mr-1"})," Voice"]}),r.jsxs(Ye,{value:"llm",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[r.jsx(ft,{className:"h-3 w-3 mr-1"})," LLM"]}),r.jsxs(Ye,{value:"call",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[r.jsx(Zs,{className:"h-3 w-3 mr-1"})," Call"]}),r.jsxs(Ye,{value:"transcriber",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[r.jsx(is,{className:"h-3 w-3 mr-1"})," STT"]}),r.jsxs(Ye,{value:"voicemail",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[r.jsx(pa,{className:"h-3 w-3 mr-1"})," Voicemail"]}),r.jsxs(Ye,{value:"advanced",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[r.jsx(js,{className:"h-3 w-3 mr-1"})," Advanced"]})]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 pt-4",children:[r.jsxs(We,{value:"voice",className:"mt-0 space-y-4",children:[r.jsxs("div",{className:G,children:[r.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[r.jsx(Ss,{className:"h-4 w-4 text-orange-500"})," Voice Selection"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Voice *"}),r.jsxs(be,{value:p.voice_id,onValueChange:y=>j("voice_id",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{placeholder:c?"Loading...":"Select voice"})}),r.jsx(we,{className:te,children:n.map(y=>r.jsxs(ue,{value:y.voice_id,className:re,children:[y.voice_name||y.voice_id," (",y.provider||"Retell",")"]},y.voice_id))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Voice Model"}),r.jsxs(be,{value:p.voice_model,onValueChange:y=>j("voice_model",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:em.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]})]})]}),r.jsxs("div",{className:G,children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:"Voice Parameters"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsx(S,{label:"Speed",value:p.voice_speed,onChange:y=>j("voice_speed",y),min:.5,max:2,step:.1}),r.jsx(S,{label:"Temperature",value:p.voice_temperature,onChange:y=>j("voice_temperature",y),min:0,max:2,step:.1}),r.jsx(S,{label:"Volume",value:p.volume,onChange:y=>j("volume",y),min:0,max:2,step:.1})]})]}),r.jsxs("div",{className:G,children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:"Voice Emotion & Fallback"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Voice Emotion"}),r.jsxs(be,{value:p.voice_emotion,onValueChange:y=>j("voice_emotion",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:tm.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Fallback Voice IDs"}),r.jsx(ye,{placeholder:"openai-Alloy, deepgram-Angus",value:p.fallback_voice_ids,onChange:y=>j("fallback_voice_ids",y.target.value),className:D}),r.jsx("p",{className:"text-xs text-white/40",children:"Comma-separated, from different providers"})]})]})]})]}),r.jsxs(We,{value:"llm",className:"mt-0 space-y-4",children:[r.jsxs("div",{className:G,children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[r.jsx(ft,{className:"h-4 w-4 text-orange-500"})," Response Engine (LLM)"]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(W,{className:C,children:"Create New LLM"}),r.jsx(kt,{checked:E,onCheckedChange:k})]})]}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Agent Type"}),r.jsxs(be,{value:p.agent_type,onValueChange:y=>j("agent_type",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:um.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]})}),E?r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20",children:r.jsx("p",{className:"text-xs text-green-400",children:"A new LLM will be created when you submit this form"})}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Model *"}),r.jsxs(be,{value:p.new_llm_model,onValueChange:y=>j("new_llm_model",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:cm.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Start Speaker"}),r.jsxs(be,{value:p.new_llm_start_speaker,onValueChange:y=>j("new_llm_start_speaker",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsxs(we,{className:te,children:[r.jsx(ue,{value:"agent",className:re,children:"Agent (speaks first)"}),r.jsx(ue,{value:"user",className:re,children:"User (waits for user)"})]})]})]})]}),r.jsx(S,{label:"Model Temperature",value:p.new_llm_temperature,onChange:y=>j("new_llm_temperature",y),min:0,max:1,step:.1,description:"Lower = more deterministic, Higher = more random"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Begin Message (First Utterance)"}),r.jsx(ht,{placeholder:"Hey, I am a virtual assistant calling from [Company Name]. How can I help you today?",value:p.new_llm_begin_message,onChange:y=>j("new_llm_begin_message",y.target.value),className:D+" min-h-[80px]"}),r.jsx("p",{className:"text-xs text-white/40",children:'Leave empty for dynamic generation, or set to "" for user to speak first'})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"General Prompt (System Prompt) *"}),r.jsx(ht,{placeholder:"You are a friendly and professional AI assistant for [Company Name]. Your role is to help customers with their inquiries...",value:p.new_llm_general_prompt,onChange:y=>j("new_llm_general_prompt",y.target.value),className:D+" min-h-[200px]"}),r.jsx("p",{className:"text-xs text-white/40",children:"This prompt guides the agent's behavior and personality throughout the conversation"})]})]}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Select LLM *"}),r.jsxs(be,{value:p.llm_id,onValueChange:y=>j("llm_id",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{placeholder:c?"Loading...":"Select existing LLM"})}),r.jsx(we,{className:te,children:i.map(y=>r.jsx(ue,{value:y.llm_id,className:re,children:r.jsxs("div",{className:"flex flex-col",children:[r.jsxs("span",{children:[y.llm_id.substring(0,20),"..."]}),r.jsxs("span",{className:"text-xs text-white/50",children:["Model: ",y.model||"Default"]})]})},y.llm_id))})]}),r.jsx("p",{className:"text-xs text-white/40",children:'Select from existing LLMs in your Retell dashboard, or toggle "Create New" to configure a new one'})]}),p.llm_id&&i.find(y=>y.llm_id===p.llm_id)&&r.jsxs("div",{className:"p-3 rounded-lg bg-orange-500/10 border border-orange-500/20",children:[r.jsx("p",{className:"text-xs text-orange-400 mb-2",children:"Selected LLM Details"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-white/50",children:"Model:"})," ",r.jsx("span",{className:"text-white",children:((V=i.find(y=>y.llm_id===p.llm_id))==null?void 0:V.model)||"Default"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-white/50",children:"Start Speaker:"})," ",r.jsx("span",{className:"text-white",children:((z=i.find(y=>y.llm_id===p.llm_id))==null?void 0:z.start_speaker)||"agent"})]})]}),((Ee=i.find(y=>y.llm_id===p.llm_id))==null?void 0:Ee.begin_message)&&r.jsxs("div",{className:"mt-2",children:[r.jsx("span",{className:"text-white/50 text-xs",children:"Begin Message:"}),r.jsx("p",{className:"text-white text-xs mt-1 p-2 bg-white/5 rounded",children:($e=i.find(y=>y.llm_id===p.llm_id))==null?void 0:$e.begin_message})]})]})]})]}),r.jsxs("div",{className:G,children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:"Agent Version Description"}),r.jsx(ht,{className:D+" min-h-[100px]",placeholder:"Describe this agent version...",value:p.version_description,onChange:y=>j("version_description",y.target.value)})]})]}),r.jsxs(We,{value:"call",className:"mt-0 space-y-4",children:[r.jsxs("div",{className:G,children:[r.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[r.jsx(Zs,{className:"h-4 w-4 text-orange-500"})," Call Behavior"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(S,{label:"Responsiveness",value:p.responsiveness,onChange:y=>j("responsiveness",y),min:0,max:1,step:.1,description:"How fast the agent responds"}),r.jsx(S,{label:"Interruption Sensitivity",value:p.interruption_sensitivity,onChange:y=>j("interruption_sensitivity",y),min:0,max:1,step:.1,description:"How easily user can interrupt"})]})]}),r.jsxs("div",{className:G,children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:"Backchannel"}),r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx(W,{className:C,children:"Enable Backchannel"}),r.jsx("p",{className:"text-xs text-white/40",children:'Agent says "yeah", "uh-huh" during conversation'})]}),r.jsx(kt,{checked:p.enable_backchannel,onCheckedChange:y=>j("enable_backchannel",y)})]}),p.enable_backchannel&&r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsx(S,{label:"Frequency",value:p.backchannel_frequency,onChange:y=>j("backchannel_frequency",y),min:0,max:1,step:.1}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Custom Words"}),r.jsx(ye,{placeholder:"yeah, uh-huh, right",value:p.backchannel_words,onChange:y=>j("backchannel_words",y.target.value),className:D})]})]})]}),r.jsxs("div",{className:G,children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:"Reminders & Ambient"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Reminder Trigger (ms)"}),r.jsx(ye,{type:"number",value:p.reminder_trigger_ms,onChange:y=>j("reminder_trigger_ms",parseInt(y.target.value)||1e4),className:D})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Reminder Max Count"}),r.jsx(ye,{type:"number",min:0,value:p.reminder_max_count,onChange:y=>j("reminder_max_count",parseInt(y.target.value)||1),className:D})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Ambient Sound"}),r.jsxs(be,{value:p.ambient_sound,onValueChange:y=>j("ambient_sound",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:sm.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]}),p.ambient_sound!=="none"&&r.jsx(S,{label:"Ambient Volume",value:p.ambient_sound_volume,onChange:y=>j("ambient_sound_volume",y),min:0,max:2,step:.1})]})]}),r.jsxs("div",{className:G,children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:"Call Limits"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"End After Silence (ms)"}),r.jsx(ye,{type:"number",value:p.end_call_after_silence_ms,onChange:y=>j("end_call_after_silence_ms",parseInt(y.target.value)||6e5),className:D})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Max Duration (ms)"}),r.jsx(ye,{type:"number",value:p.max_call_duration_ms,onChange:y=>j("max_call_duration_ms",parseInt(y.target.value)||36e5),className:D})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Ring Duration (ms)"}),r.jsx(ye,{type:"number",value:p.ring_duration_ms,onChange:y=>j("ring_duration_ms",parseInt(y.target.value)||3e4),className:D})]})]})]})]}),r.jsxs(We,{value:"transcriber",className:"mt-0 space-y-4",children:[r.jsxs("div",{className:G,children:[r.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[r.jsx(vo,{className:"h-4 w-4 text-orange-500"})," Language & Recognition"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Language"}),r.jsxs(be,{value:p.language,onValueChange:y=>j("language",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:nm.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"STT Mode"}),r.jsxs(be,{value:p.stt_mode,onValueChange:y=>j("stt_mode",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:rm.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]})]})]}),r.jsxs("div",{className:G,children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:"Audio Processing"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Vocab Specialization"}),r.jsxs(be,{value:p.vocab_specialization,onValueChange:y=>j("vocab_specialization",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:am.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Denoising Mode"}),r.jsxs(be,{value:p.denoising_mode,onValueChange:y=>j("denoising_mode",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:im.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]})]}),r.jsxs("div",{className:"flex items-center justify-between mt-4",children:[r.jsxs("div",{children:[r.jsx(W,{className:C,children:"Normalize for Speech"}),r.jsx("p",{className:"text-xs text-white/40",children:"Convert numbers, dates to spoken form"})]}),r.jsx(kt,{checked:p.normalize_for_speech,onCheckedChange:y=>j("normalize_for_speech",y)})]})]}),r.jsxs("div",{className:G,children:[r.jsx("h4",{className:"text-sm font-semibold text-white",children:"Boosted Keywords"}),r.jsx(ht,{placeholder:"retell, company name, product names...",value:p.boosted_keywords,onChange:y=>j("boosted_keywords",y.target.value),className:D+" min-h-[80px]"}),r.jsx("p",{className:"text-xs text-white/40 mt-1",children:"Comma-separated words to prioritize in transcription"})]})]}),r.jsx(We,{value:"voicemail",className:"mt-0 space-y-4",children:r.jsxs("div",{className:G,children:[r.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[r.jsx(pa,{className:"h-4 w-4 text-orange-500"})," Voicemail Detection"]}),r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx(W,{className:C,children:"Enable Voicemail Detection"}),r.jsx("p",{className:"text-xs text-white/40",children:"Detect when call goes to voicemail"})]}),r.jsx(kt,{checked:p.enable_voicemail_detection,onCheckedChange:y=>j("enable_voicemail_detection",y)})]}),p.enable_voicemail_detection&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Voicemail Message"}),r.jsx(ht,{placeholder:"Hi, please give us a callback...",value:p.voicemail_message,onChange:y=>j("voicemail_message",y.target.value),className:D})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Detection Timeout (ms)"}),r.jsx(ye,{type:"number",value:p.voicemail_detection_timeout_ms,onChange:y=>j("voicemail_detection_timeout_ms",parseInt(y.target.value)||3e4),className:D})]})]})]})}),r.jsxs(We,{value:"advanced",className:"mt-0 space-y-4",children:[r.jsxs("div",{className:G,children:[r.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[r.jsx(Dc,{className:"h-4 w-4 text-orange-500"})," Webhooks"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Webhook URL"}),r.jsx(ye,{placeholder:"https://your-webhook.com/events",value:p.webhook_url,onChange:y=>j("webhook_url",y.target.value),className:D})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Webhook Timeout (ms)"}),r.jsx(ye,{type:"number",value:p.webhook_timeout_ms,onChange:y=>j("webhook_timeout_ms",parseInt(y.target.value)||1e4),className:D})]})]})]}),r.jsxs("div",{className:G,children:[r.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[r.jsx(ft,{className:"h-4 w-4 text-orange-500"})," Post-Call Analysis"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Analysis Model"}),r.jsxs(be,{value:p.post_call_analysis_model,onValueChange:y=>j("post_call_analysis_model",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:lm.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Success Criteria Prompt"}),r.jsx(ht,{placeholder:"The agent finished the task and the call was complete...",value:p.analysis_successful_prompt,onChange:y=>j("analysis_successful_prompt",y.target.value),className:D})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Summary Prompt"}),r.jsx(ht,{placeholder:"Summarize the outcome of the conversation...",value:p.analysis_summary_prompt,onChange:y=>j("analysis_summary_prompt",y.target.value),className:D})]})]})]}),r.jsxs("div",{className:G,children:[r.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[r.jsx(yo,{className:"h-4 w-4 text-orange-500"})," Data & Privacy"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(W,{className:C,children:"Data Storage Setting"}),r.jsxs(be,{value:p.data_storage_setting,onValueChange:y=>j("data_storage_setting",y),children:[r.jsx(_e,{className:Y,children:r.jsx(xe,{})}),r.jsx(we,{className:te,children:om.map(y=>r.jsx(ue,{value:y.value,className:re,children:y.label},y.value))})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(W,{className:C,children:"Signed URLs"}),r.jsx("p",{className:"text-xs text-white/40",children:"Enable signed URLs for recordings/logs"})]}),r.jsx(kt,{checked:p.opt_in_signed_url,onCheckedChange:y=>j("opt_in_signed_url",y)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(W,{className:C,children:"Allow DTMF Input"}),r.jsx("p",{className:"text-xs text-white/40",children:"Accept keypad input during calls"})]}),r.jsx(kt,{checked:p.allow_user_dtmf,onCheckedChange:y=>j("allow_user_dtmf",y)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(W,{className:C,children:"Public Agent"}),r.jsx("p",{className:"text-xs text-white/40",children:"Make available for public preview"})]}),r.jsx(kt,{checked:p.is_public,onCheckedChange:y=>j("is_public",y)})]})]})]})]})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 p-6 pt-4 border-t border-white/10",children:[r.jsx(Se,{type:"button",variant:"outline",onClick:e,disabled:m,className:"border-white/10 bg-transparent text-white hover:bg-white/10",children:"Cancel"}),r.jsx(Se,{type:"submit",className:"px-6 py-2 rounded-lg text-sm font-semibold text-white bg-orange-500/20 border border-orange-500/30 shadow-[0_2px_5px_rgba(249,115,22,0.45)] hover:shadow-[0_5px_10px_rgba(249,115,22,0.65)] hover:bg-orange-500/40 transition-all",disabled:m||!p.agent_name||!p.voice_id||(p.agent_type==="single_prompt"||p.agent_type==="custom_llm")&&!E&&!p.llm_id||!E&&!p.llm_id||E&&!p.new_llm_general_prompt.trim(),children:m?r.jsxs(r.Fragment,{children:[r.jsx(Ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Agent"})]})]})]})})}const hm={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_BASE_URL:"https://ai.research-hero.com",VITE_FACEBOOK_APP_ID:"1939628080270711",VITE_FACEBOOK_APP_SECRET:"9b4f0b6de06cf54cc1bcdd1c13c37995",VITE_FACEBOOK_REDIRECT_URI:"https://ai.research-hero.com/api/auth/facebook/callback",VITE_FRONTEND_URL:"https://aiagent.research-hero.com",VITE_GMAIL_CLIENT_ID:"686955346191-el9qo3bhbgfo7fk4juanq8bq7g7iis7d.apps.googleusercontent.com",VITE_GMAIL_REDIRECT_URI:"https://ai.research-hero.com/api/gmail/auth/callback",VITE_GOOGLE_MAPS_API_KEY:"YOUR_ACTUAL_API_KEY_HERE",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_51S8GFm2MMm3Fy1PB45KAluHAtFTOmAY9qKUE4sITR1TA1zfX97ON36OAcAALplq6LbLgqXaTyY0hRB7ae55LzpBQ00DfkbC8oy",VITE_VAPI_BASE_URL:"https://api.vapi.ai",VITE_VAPI_PUBLIC_KEY:"eb3b26e3-7dbb-4fd6-a545-a954756a43aa"},Cm=()=>{var _t,Lt,xt;ou();const[s,e]=K.useState(""),[t,n]=K.useState(null),[a,i]=K.useState(null),[l,c]=K.useState(!1),[d,m]=K.useState(!1),[g,_]=K.useState(!1),[M,E]=K.useState(!1),[k,b]=K.useState(!1),[x,p]=K.useState(!1),[T,L]=K.useState(!1),[j,O]=K.useState(!1),[D,Y]=K.useState(!1),[te,re]=K.useState(null),[C,G]=K.useState(null),[S,V]=K.useState(!1),[z,Ee]=K.useState(null),[$e,y]=K.useState(new Set);console.log("🔍 Environment Debug:"),console.log("- VITE_VAPI_PUBLIC_KEY:",`${"eb3b26e3-7dbb-4fd6-a545-a954756a43aa".substring(0,8)}...`),console.log("- All env vars:",hm);const[Ue,Je]=K.useState({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"office",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"vapi",voiceId:"Cole",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),Ne=Uc(),{user:B}=Zc(),{data:je,isLoading:o}=en({queryKey:["syncedAgents",B==null?void 0:B.id,s],queryFn:()=>Jc(s),staleTime:0,refetchInterval:1e3,gcTime:5*60*1e3,enabled:!!(B!=null&&B.id),placeholderData:w=>w,retry:(w,R)=>{var $;return[404,204,402].includes(($=R==null?void 0:R.response)==null?void 0:$.status)?!1:w<2}}),{data:h}=en({queryKey:["retellAgents"],queryFn:Gc,staleTime:0,refetchInterval:1e3}),u=qc.useMemo(()=>{const w=(je==null?void 0:je.data)||[],R=(h==null?void 0:h.data)||[],se=Array.isArray(R)?R.map($=>({id:$.agent_id,name:$.agent_name||"Unnamed Retell Agent",firstMessage:"Retell Agent (Details not loaded)",model:{provider:"retell",model:$.llm_id||"Unknown"},voice:{provider:"retell",voiceId:$.voice_id||"Unknown"},transcriber:{provider:"retell"},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),isRetell:!0})):[];return[...w,...se]},[je,h]);jn({mutationFn:zc,onSuccess:w=>{console.log("✅ Assistant created successfully:",w),ee.success(`Assistant "${Ue.name}" created successfully!`),_(!1),Je({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"office",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"11labs",voiceId:"21m00Tcm4TlvDq8ikWAM",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),Ne.invalidateQueries({queryKey:["syncedAgents"]}),Ne.invalidateQueries({queryKey:["agents"]})},onError:w=>{var se,$,ie,oe,he,ce;console.error("❌ Error creating assistant:",w);let R="Failed to create assistant";($=(se=w.response)==null?void 0:se.data)!=null&&$.message?R=w.response.data.message:(oe=(ie=w.response)==null?void 0:ie.data)!=null&&oe.error?R=w.response.data.error:w.message&&(R=w.message),ee.error(`Creation failed: ${R}`),console.error("Detailed error:",{status:(he=w.response)==null?void 0:he.status,data:(ce=w.response)==null?void 0:ce.data,message:w.message})}});const f=jn({mutationFn:({id:w,data:R})=>Hc(w,R),onSuccess:(w,R)=>{console.log("✅ Assistant updated successfully:",w);const se=Object.keys(R.data)[0];ee.success(`${se} updated successfully`),Ne.invalidateQueries({queryKey:["syncedAgents",B==null?void 0:B.id]}),t&&P(t.id)},onError:(w,R)=>{var ie,oe,he,ce,Ce,wt;console.error("❌ Error updating assistant:",w);let se="Failed to update assistant";(oe=(ie=w.response)==null?void 0:ie.data)!=null&&oe.message?se=w.response.data.message:(ce=(he=w.response)==null?void 0:he.data)!=null&&ce.error?se=w.response.data.error:w.message&&(se=w.message);const $=Object.keys(R.data)[0];ee.error(`Failed to update ${$}: ${se}`),console.error("Update error details:",{field:$,value:R.data[$],status:(Ce=w.response)==null?void 0:Ce.status,data:(wt=w.response)==null?void 0:wt.data,message:w.message})}}),v=jn({mutationFn:({id:w,isRetell:R})=>R?Kc(w):Qc(w),onSuccess:w=>{console.log("✅ Delete success:",w),ee.success(`Assistant "${z==null?void 0:z.name}" deleted successfully!`),V(!1),Ee(null),t&&z&&t.id===z.id&&(n(null),i(null)),Ne.invalidateQueries({queryKey:["syncedAgents",B==null?void 0:B.id]})},onError:w=>{var $,ie,oe,he,ce,Ce;console.error("❌ Error deleting assistant:",w);let R="Unknown error occurred";(ie=($=w.response)==null?void 0:$.data)!=null&&ie.message?R=w.response.data.message:(he=(oe=w.response)==null?void 0:oe.data)!=null&&he.error?R=w.response.data.error:w.message&&(R=w.message);const se=(z==null?void 0:z.name)||"Assistant";ee.error(`Failed to delete ${se}: ${R}`),console.error("Delete error details:",{assistantId:z==null?void 0:z.id,assistantName:z==null?void 0:z.name,status:(ce=w.response)==null?void 0:ce.status,data:(Ce=w.response)==null?void 0:Ce.data,message:w.message})}}),N=(B==null?void 0:B.isSuperAdmin)||!1,I=(je==null?void 0:je.total)||u.length;K.useEffect(()=>{if(u.length>0){console.log("🔍 Agent data structure (first agent):",u[0]),console.log("🔍 Total agents loaded:",u.length),console.log("👑 Pagination disabled (Super Admin):",N),console.log("📊 Total assistants available:",I);const w=new Set;u.forEach((R,se)=>{((R.assistant_data||{}).metadata||{}).published===!0&&w.add(String(R.id)),se<3&&console.log(`🔍 Agent ${se+1}:`,{name:R.name,localId:R.id,assistantId:R.assistant_id,hasAssistantId:!!R.assistant_id,structure:Object.keys(R)})}),y(w),console.log("📊 Initialized published agents from metadata:",Array.from(w))}},[u]),K.useEffect(()=>{if(t&&t.id){const w=t.assistant_id||t.id;P(w,t.isRetell)}},[t]);const P=async(w,R=!1)=>{var se,$,ie,oe,he,ce,Ce,wt,ms,Vr,qr,Ur,Br,$r,Jr,Gr,zr,Yr,Wr,Hr,Kr,Qr,Xr,Zr,ea,ta,sa,na,ra,aa,ia,oa,la,ca,ua,da,ha;c(!0);try{const St=String(w);if(R){console.log("🔍 Fetching complete Retell details for agent:",St);const Dt=await Yc(St);console.log("📋 Complete Retell agent details:",Dt),i(Dt.data||Dt)}else{console.log("🔍 Fetching complete VAPI details for agent:",St);const Dt=await Wc(St);console.log("📋 Complete VAPI agent details:",Dt);const U=Dt.data||Dt;i({name:U.name||(t==null?void 0:t.name),firstMessage:U.firstMessage||(t==null?void 0:t.firstMessage),firstMessageMode:U.firstMessageMode||"assistant-speaks-first",firstMessageInterruptionsEnabled:U.firstMessageInterruptionsEnabled||!1,model:{provider:((se=U.model)==null?void 0:se.provider)||"openai",model:(($=U.model)==null?void 0:$.model)||"gpt-4",temperature:((ie=U.model)==null?void 0:ie.temperature)||.7,maxTokens:((oe=U.model)==null?void 0:oe.maxTokens)||1e3,numFastTurns:((he=U.model)==null?void 0:he.numFastTurns)||0,messages:((ce=U.model)==null?void 0:ce.messages)||[],tools:((Ce=U.model)==null?void 0:Ce.tools)||[],toolIds:((wt=U.model)==null?void 0:wt.toolIds)||[],knowledgeBase:(ms=U.model)==null?void 0:ms.knowledgeBase,knowledgeBaseId:(Vr=U.model)==null?void 0:Vr.knowledgeBaseId,emotionRecognitionEnabled:((qr=U.model)==null?void 0:qr.emotionRecognitionEnabled)||!1,thinking:((Ur=U.model)==null?void 0:Ur.thinking)||{type:"disabled"}},voice:{provider:((Br=U.voice)==null?void 0:Br.provider)||"11labs",voiceId:(($r=U.voice)==null?void 0:$r.voiceId)||"21m00Tcm4TlvDq8ikWAM",speed:((Jr=U.voice)==null?void 0:Jr.speed)||1,stability:(Gr=U.voice)==null?void 0:Gr.stability,similarityBoost:(zr=U.voice)==null?void 0:zr.similarityBoost,cachingEnabled:((Yr=U.voice)==null?void 0:Yr.cachingEnabled)||!1,chunkPlan:((Wr=U.voice)==null?void 0:Wr.chunkPlan)||{enabled:!1},fallbackPlan:(Hr=U.voice)==null?void 0:Hr.fallbackPlan},transcriber:{provider:((Kr=U.transcriber)==null?void 0:Kr.provider)||"deepgram",model:((Qr=U.transcriber)==null?void 0:Qr.model)||"nova-2",language:((Xr=U.transcriber)==null?void 0:Xr.language)||"en",confidenceThreshold:((Zr=U.transcriber)==null?void 0:Zr.confidenceThreshold)||.4,endOfTurnConfidenceThreshold:((ea=U.transcriber)==null?void 0:ea.endOfTurnConfidenceThreshold)||.7,minEndOfTurnSilenceWhenConfident:((ta=U.transcriber)==null?void 0:ta.minEndOfTurnSilenceWhenConfident)||160,maxTurnSilence:((sa=U.transcriber)==null?void 0:sa.maxTurnSilence)||400,wordFinalizationMaxWaitTime:((na=U.transcriber)==null?void 0:na.wordFinalizationMaxWaitTime)||160,enableUniversalStreamingApi:((ra=U.transcriber)==null?void 0:ra.enableUniversalStreamingApi)||!1,formatTurns:((aa=U.transcriber)==null?void 0:aa.formatTurns)||!1,disablePartialTranscripts:((ia=U.transcriber)==null?void 0:ia.disablePartialTranscripts)||!1,keywords:((oa=U.transcriber)==null?void 0:oa.keywords)||[],wordBoost:((la=U.transcriber)==null?void 0:la.wordBoost)||[]},systemMessage:((da=(ua=(ca=U.model)==null?void 0:ca.messages)==null?void 0:ua[0])==null?void 0:da.content)||U.systemMessage||"You are a helpful AI assistant.",endCallMessage:U.endCallMessage,voicemailMessage:U.voicemailMessage,endCallPhrases:U.endCallPhrases||[],functions:U.functions||[],tools:U.tools||[],customFunctions:U.customFunctions,variableValues:U.variableValues,maxDurationSeconds:U.maxDurationSeconds||600,backgroundSound:U.backgroundSound||"off",modelOutputInMessagesEnabled:U.modelOutputInMessagesEnabled||!1,backgroundDenoisingEnabled:U.backgroundDenoisingEnabled||!1,clientMessages:U.clientMessages,serverMessages:U.serverMessages,transportConfigurations:U.transportConfigurations||[],server:U.server,observabilityPlan:U.observabilityPlan,startSpeakingPlan:U.startSpeakingPlan,stopSpeakingPlan:U.stopSpeakingPlan,credentialIds:U.credentialIds||[],metadata:U.metadata||{},createdAt:U.createdAt,updatedAt:U.updatedAt,_rawVapiData:U})}}catch(St){console.error("Error loading agent details:",St),console.error("Error details:",((ha=St.response)==null?void 0:ha.data)||St.message),i({model:{provider:"OpenAI",model:"GPT-4"},voice:{provider:"11Labs",voiceId:"Default Voice"},transcriber:{provider:"Deepgram"},systemMessage:"You are a helpful AI assistant."})}finally{c(!1)}},F=w=>w?w.split(" ").map(R=>R.charAt(0)).join("").toUpperCase().substring(0,2):"NA",Z=w=>{var R,se,$,ie,oe,he,ce,Ce,wt,ms;console.log("🎯 Template selected:",w),Je({name:w.name||"",firstMessage:w.first_message||"",systemMessage:w.system_message||"You are a helpful AI assistant.",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:w.end_call_message||"",voicemailMessage:"",endCallPhrases:w.end_call_phrases||[],maxDurationSeconds:w.max_duration_seconds||600,backgroundSound:w.background_sound||"off",model:{provider:((R=w.model)==null?void 0:R.provider)||"openai",model:((se=w.model)==null?void 0:se.model)||"gpt-4",temperature:(($=w.model)==null?void 0:$.temperature)||.7,maxTokens:((ie=w.model)==null?void 0:ie.maxTokens)||1e3,numFastTurns:((oe=w.model)==null?void 0:oe.numFastTurns)||0},voice:{provider:((he=w.voice)==null?void 0:he.provider)||"vapi",voiceId:((ce=w.voice)==null?void 0:ce.voiceId)||"Cole",speed:((Ce=w.voice)==null?void 0:Ce.speed)||1},transcriber:{provider:((wt=w.transcriber)==null?void 0:wt.provider)||"deepgram",model:"nova-2",language:((ms=w.transcriber)==null?void 0:ms.language)||"en"}}),_(!0)},ne=w=>{if(w==="retell"){b(!0);return}Je({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"off",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"11labs",voiceId:"21m00Tcm4TlvDq8ikWAM",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),_(!0)},Ge=(w,R)=>{if(!w)return"";const se=w.toLowerCase().trim();return(R==="model"?{openai:"openai","open-ai":"openai",anthropic:"anthropic",groq:"groq",together:"together",anyscale:"anyscale"}:{"11labs":"11labs",elevenlabs:"11labs","eleven-labs":"11labs",openai:"openai","open-ai":"openai",azure:"azure",playht:"playht","play-ht":"playht",deepgram:"deepgram",cartesia:"cartesia",lmnt:"lmnt"})[se]||se},it=(w,R)=>{if(!t){console.warn("No selected agent for field update");return}console.log("🔄 Field update:",w,"Value:",R,"Type:",typeof R,"Agent ID:",t.id),C&&clearTimeout(C),i($=>{const ie={...$};if(w.includes(".")){const[oe,he]=w.split(".");if(ie[oe]={...ie[oe],[he]:R},w==="model.provider"){const ce=ja(R);ce&&(ie.model.model=ce,console.log("🤖 Auto-selected model:",ce,"for provider:",R))}else if(w==="voice.provider"){const ce=ka(R);ce&&(ie.voice.voiceId=ce,console.log("🎤 Auto-selected voice:",ce,"for provider:",R))}else if(w==="transcriber.provider"){const ce=Ca(R);ce&&(ie.transcriber.model=ce,console.log("📝 Auto-selected transcriber model:",ce,"for provider:",R))}}else ie[w]=R;return ie});const se=setTimeout(()=>{const $={},ie=["status","published","publishedAt","systemMessage"];if(w.includes(".")){const[he,ce]=w.split(".");if(ie.includes(he)||ie.includes(ce)){console.log("⚠️ Skipping VAPI update for local-only field:",w);return}if($[he]={...a[he],[ce]:R},w==="model.provider"){const Ce=ja(R);Ce&&($.model.model=Ce)}else if(w==="voice.provider"){const Ce=ka(R);Ce&&($.voice.voiceId=Ce)}else if(w==="transcriber.provider"){const Ce=Ca(R);Ce&&($.transcriber.model=Ce)}}else{if(ie.includes(w)){console.log("⚠️ Skipping VAPI update for local-only field:",w);return}$[w]=R}console.log("🔄 Auto-saving field:",w,"with value:",R,"updateData:",$);const oe=t.assistant_id||t.id;console.log("🔍 Using assistant ID for VAPI:",oe,"Type:",typeof oe),f.mutate({id:String(oe),data:$})},1e3);G(se)},bt=w=>{if(!t){console.warn("No selected agent for system message update");return}console.log("🔄 System message update:",w),C&&clearTimeout(C),i(se=>{const $={...se};return $.systemMessage=w,$.model||($.model={}),$.model.messages||($.model.messages=[]),$.model.messages.length===0?$.model.messages.push({role:"system",content:w}):$.model.messages[0].role==="system"?$.model.messages[0].content=w:$.model.messages.unshift({role:"system",content:w}),$});const R=setTimeout(()=>{var he;const $=[...((he=a==null?void 0:a.model)==null?void 0:he.messages)||[]];$.length===0?$.push({role:"system",content:w}):$[0].role==="system"?$[0].content=w:$.unshift({role:"system",content:w});const ie={model:{...a==null?void 0:a.model,messages:$}};console.log("🔄 Auto-saving system message via model.messages:",ie);const oe=t.assistant_id||t.id;console.log("🔍 Using assistant ID for system message update:",oe),f.mutate({id:String(oe),data:ie})},1e3);G(R)};K.useEffect(()=>()=>{C&&clearTimeout(C)},[C]);const ke=w=>{Ee(w),V(!0)},Be=()=>{if(z){const w=z.isRetell,R=z.assistant_id||z.agent_id||z.id;console.log(`🗑️ Deleting ${w?"Retell":"VAPI"} agent:`,z.id,"Using ID:",R),v.mutate({id:String(R),isRetell:w})}else ee.error("No agent selected for deletion")},ot=async w=>{var $,ie;if(!w||!w.id)return;const R=String(w.id),se=$e.has(R);try{console.log(`🔄 ${se?"Unpublishing":"Publishing"} agent:`,w.name);const oe={metadata:{...a==null?void 0:a.metadata,published:!se,publishedAt:se?null:new Date().toISOString()}},he=w.assistant_id||w.id;console.log("🔍 Using assistant ID for VAPI publish:",he,"Type:",typeof he),await f.mutateAsync({id:String(he),data:oe});const ce=new Set($e);se?(ce.delete(R),ee.success(`${w.name} unpublished successfully`)):(ce.add(R),ee.success(`${w.name} published successfully`)),y(ce),t&&t.id===w.id&&i(Ce=>({...Ce,metadata:oe.metadata}))}catch(oe){console.error("❌ Error toggling publish status:",oe);let he="Failed to update publish status";(ie=($=oe.response)==null?void 0:$.data)!=null&&ie.message?he=oe.response.data.message:oe.message&&(he=oe.message),ee.error(`Failed to ${se?"unpublish":"publish"} ${w.name}: ${he}`)}};return r.jsxs("div",{className:"app-shell-bg flex flex-col h-screen text-white overflow-hidden",children:[r.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:r.jsxs("div",{className:"max-w-full mx-auto space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between pb-6 border-b border-white/10",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-white/60",children:"Agents"}),r.jsx("p",{className:"text-white/50 text-sm mt-1",children:"Manage and configure your AI voice agents"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"relative w-72",children:[r.jsx(xo,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/40"}),r.jsx(ye,{className:"bg-white/5 border-white/10 text-white pl-10 h-10",placeholder:"Search assistants...",value:s,onChange:w=>e(w.target.value)})]}),r.jsxs("button",{className:"px-5 py-2 rounded-lg text-sm font-semibold text-white bg-[linear-gradient(180deg,rgba(90,110,255,0.45),rgba(36,46,151,0.35))] border border-white/15 hover:shadow-[0_5px_10px_rgba(90,110,255,0.65)] hover:bg-[linear-gradient(180deg,rgba(90,110,255,0.6),rgba(36,46,151,0.45))] transition-all flex items-center gap-2",onClick:()=>E(!0),children:[r.jsx(_o,{className:"h-4 w-4"}),"Create Assistant"]})]})]}),r.jsx("div",{className:"neo-card p-1 overflow-hidden border-white/10 bg-[#0b0f2e]/50 backdrop-blur-xl rounded-xl",children:r.jsxs(eu,{children:[r.jsx(tu,{className:"bg-white/5",children:r.jsxs(As,{className:"border-white/10 hover:bg-transparent",children:[r.jsx(Ms,{className:"text-white/70 font-semibold h-12",children:"Agent ID"}),r.jsx(Ms,{className:"text-white/70 font-semibold h-12",children:"Agent"}),r.jsx(Ms,{className:"text-white/70 font-semibold h-12",children:"Provider"}),r.jsx(Ms,{className:"text-white/70 font-semibold h-12 text-right",children:"Actions"})]})}),r.jsx(su,{children:o?r.jsx(As,{children:r.jsx(Kt,{colSpan:5,className:"h-32 text-center",children:r.jsx(Ot,{className:"h-6 w-6 animate-spin text-white/20 mx-auto"})})}):u.filter(w=>(w==null?void 0:w.id)&&(w==null?void 0:w.name)).length===0?r.jsx(As,{children:r.jsx(Kt,{colSpan:5,className:"h-48 text-center",children:r.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2 opacity-30",children:[r.jsx(ft,{className:"h-12 w-12"}),r.jsx("p",{children:"No assistants found"})]})})}):u.filter(w=>(w==null?void 0:w.id)&&(w==null?void 0:w.name)).map(w=>r.jsxs(As,{className:"border-white/5 hover:bg-white/5 transition-colors group",children:[r.jsxs(Kt,{className:"text-white/80 font-mono text-xs",children:[String(w.assistant_id||w.id).substring(0,18),"..."]}),r.jsx(Kt,{className:"py-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(tn,{className:"h-10 w-10 ring-2 ring-white/10 transition-transform group-hover:scale-105",children:r.jsx(sn,{className:"bg-gradient-to-br from-indigo-500 to-green-500 text-indigo-100 font-medium",children:F(w.name)})}),r.jsx("div",{className:"font-medium text-white",children:w.name})]})}),r.jsx(Kt,{children:r.jsx(Tt,{variant:"outline",className:`capitalize font-normal ${w.isRetell?"border-orange-500/30 text-orange-400 bg-orange-500/5":"border-blue-500/30 text-blue-400 bg-blue-500/5"}`,children:w.isRetell?"Retell":"Vapi"})}),r.jsx(Kt,{className:"text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-1",children:[r.jsx(Se,{variant:"ghost",size:"icon",className:"h-8 w-8 text-white/30 text-orange-400 hover:text-white hover:bg-white/10",onClick:()=>{n(w),L(!0)},title:"View Details",children:r.jsx(Rc,{className:"h-4 w-4"})}),r.jsx(Se,{variant:"ghost",size:"icon",className:"h-8 w-8 text-cyan-400 hover:text-blue-400 hover:bg-blue-400/10",onClick:()=>{n(w),O(!0)},title:"Edit Agent",children:r.jsx(fa,{className:"h-4 w-4"})}),r.jsx(Se,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-400 hover:bg-red-400/10",onClick:()=>ke(w),title:"Delete Agent",children:r.jsx(Jn,{className:"h-4 w-4"})})]})})]},w.id))})]})})]})}),r.jsx(Zt,{open:T,onOpenChange:w=>{L(w),w||(n(null),i(null))},children:r.jsxs(es,{className:"bg-[#0b0f2e] border-white/10 text-white sm:max-w-[1200px] max-h-[95vh] overflow-y-auto neon-fire-scroll p-0",children:[r.jsx(ts,{className:"sr-only",children:r.jsx(ss,{children:"Agent Details"})}),t&&(t.isRetell?r.jsx(lu,{agent:t,details:a,isLoading:l,onEdit:()=>{L(!1),O(!0)},getInitials:F}):r.jsx(Ea,{agent:t,details:a,isLoading:l,onUpdateField:it,onUpdateSystemMessage:bt,onDelete:ke,onPublishToggle:ot,isPublished:$e.has(String(t.id)),isSaving:f.isPending,onTalkToAssistant:()=>m(!0),MODEL_PROVIDERS:Sa,VOICE_PROVIDERS:wa,TRANSCRIBER_PROVIDERS:xa,getProviderModels:_a,getProviderVoices:ba,getTranscriberModels:ya,normalizeProviderValue:Ge,getInitials:F}))]})}),t&&t.isRetell?r.jsx(cu,{isOpen:j,onClose:()=>O(!1),onSuccess:()=>{Ne.invalidateQueries({queryKey:["syncedAgents"]}),P(t.id,!0)},agentId:t.agent_id||t.id,initialData:a}):r.jsx(Zt,{open:j,onOpenChange:O,children:r.jsxs(es,{className:"bg-[#0b0f2e] border-white/10 text-white sm:max-w-[1200px] max-h-[95vh] overflow-y-auto neon-fire-scroll p-0",children:[r.jsx(ts,{className:"p-6 pb-0",children:r.jsxs(ss,{className:"text-xl font-bold flex items-center gap-2",children:[r.jsx(fa,{className:"h-5 w-5 text-indigo-400"}),"Update Vapi Assistant"]})}),t&&r.jsx(Ea,{agent:t,details:a,isLoading:l,onUpdateField:it,onUpdateSystemMessage:bt,onDelete:ke,onPublishToggle:ot,isPublished:$e.has(String(t.id)),isSaving:f.isPending,onTalkToAssistant:()=>m(!0),MODEL_PROVIDERS:Sa,VOICE_PROVIDERS:wa,TRANSCRIBER_PROVIDERS:xa,getProviderModels:_a,getProviderVoices:ba,getTranscriberModels:ya,normalizeProviderValue:Ge,getInitials:F})]})}),r.jsx(Zt,{open:S,onOpenChange:V,children:r.jsxs(es,{className:"bg-[#0b0f2e] border-white/10 w-[500px] text-white sm:max-w-[425px]",children:[r.jsx(ts,{children:r.jsxs(ss,{className:"flex items-center gap-2 text-red-400",children:[r.jsx(ga,{className:"h-5 w-5"}),"Delete Assistant"]})}),r.jsx("div",{className:"py-4",children:r.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-red-500/10 rounded-lg border border-red-400/30",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(ga,{className:"h-8 w-8 text-red-400"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-sm font-medium text-red-300",children:"Are you sure you want to delete this assistant?"}),r.jsxs("div",{className:"mt-2 text-sm text-red-200/80",children:[r.jsxs("p",{children:[r.jsx("strong",{children:z==null?void 0:z.name})," will be permanently deleted from both the provider and your database. This action cannot be undone."]}),r.jsxs("div",{className:"mt-2 text-xs text-red-300/70",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Agent ID:"})," ",z==null?void 0:z.id]}),(z==null?void 0:z.assistant_id)&&r.jsxs("p",{children:[r.jsx("strong",{children:"Provider Assistant ID:"})," ",z.assistant_id]})]})]})]})]})}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx(Se,{variant:"outline",onClick:()=>V(!1),disabled:v.isPending,className:"border-white/20 text-white/70 bg-white/10 hover:bg-white/10 hover:text-white",children:"Cancel"}),r.jsx(Se,{variant:"destructive",onClick:Be,disabled:v.isPending,className:"bg-red-600 hover:bg-red-700",children:v.isPending?r.jsxs(r.Fragment,{children:[r.jsx(Ot,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Jn,{className:"h-4 w-4 mr-2"}),"Delete Assistant"]})})]})]})}),d&&r.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[r.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:()=>m(!1)}),r.jsxs("div",{className:"ml-auto relative bg-[#0b0f2e] w-1/2 h-full shadow-2xl border-l border-white/10 transform transition-transform duration-300 ease-in-out",children:[r.jsx("div",{className:"bg-[#0b0f2e] border-b border-white/10 p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(tn,{className:"h-10 w-10 ring-2 ring-white/10",children:r.jsx(sn,{className:"text-white bg-gradient-to-br from-indigo-500/30 to-purple-500/30 font-medium",children:F((t==null?void 0:t.name)||"")})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:t==null?void 0:t.name}),r.jsx("p",{className:"text-white/50 text-sm",children:"AI Voice Assistant"})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{id:"call-button-container",className:"min-w-[100px] min-h-[40px] bg-red-500/20 border border-red-400/30 rounded flex items-center justify-center"}),r.jsx(Se,{variant:"ghost",size:"sm",onClick:()=>m(!1),className:"text-white/40 hover:text-white hover:bg-white/10 h-8 w-8 p-0 rounded-full",children:"×"})]})]})}),r.jsx("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:t&&r.jsx(Xh,{agentId:String(t.id),agentName:t.name||"Unknown Agent",agentConfig:{...a,assistant_id:t.assistant_id||(a==null?void 0:a.assistant_id),firstMessage:(a==null?void 0:a.firstMessage)||`Hello! I'm ${t.name}. How can I help you today?`,systemMessage:((xt=(Lt=(_t=a==null?void 0:a.model)==null?void 0:_t.messages)==null?void 0:Lt[0])==null?void 0:xt.content)||`You are ${t.name}, a helpful AI assistant.`},onCallStart:()=>{console.log("🎙️ Started call with assistant:",t.name),ee.success(`Connected to ${t.name}`)},onCallEnd:()=>{console.log("🎙️ Ended call with assistant:",t.name),ee.info("Call ended")},onError:w=>{console.error("🎙️ Call error:",w),ee.error(`Call error: ${w.message}`)}})})]})]}),r.jsx(Zh,{open:M,onOpenChange:E,onTemplateSelect:Z,onCreateCustom:ne}),r.jsx(dm,{isOpen:k,onClose:()=>b(!1),onSuccess:()=>{Ne.invalidateQueries({queryKey:["syncedAgents"]}),Ne.invalidateQueries({queryKey:["agents"]})}})]})};export{Cm as default};
//# sourceMappingURL=VapiStyleAgents-DdpffXw1.js.map
