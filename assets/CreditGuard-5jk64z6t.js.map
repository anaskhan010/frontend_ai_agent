{"version":3,"file":"CreditGuard-5jk64z6t.js","sources":["../../src/components/Credits/CreditGuard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { AlertTriangle, CreditCard, Lock } from 'lucide-react';\nimport { toast } from 'sonner';\nimport axiosInstance from '@/api/axios/axiosInstance';\n\nconst CreditGuard = ({ \n  children, \n  requiredCredits = 1, \n  feature = \"this feature\",\n  showUpgradeButton = true \n}) => {\n  const [balance, setBalance] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [hasAccess, setHasAccess] = useState(false);\n\n  useEffect(() => {\n    checkCreditBalance();\n    \n    // Listen for credit balance updates\n    const handleCreditUpdate = () => {\n      checkCreditBalance();\n    };\n    \n    window.addEventListener('creditBalanceUpdate', handleCreditUpdate);\n    \n    return () => {\n      window.removeEventListener('creditBalanceUpdate', handleCreditUpdate);\n    };\n  }, [requiredCredits]);\n\n  const checkCreditBalance = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get('/api/credits/balance');\n      const balanceData = response.data.data;\n      setBalance(balanceData);\n      \n      // Super admins have unlimited access\n      if (balanceData.isSuperAdmin) {\n        setHasAccess(true);\n      } else {\n        // Regular users need sufficient credits\n        setHasAccess(parseFloat(balanceData.available_credits) >= requiredCredits);\n      }\n    } catch (error) {\n      console.error('Error checking credit balance:', error);\n      setHasAccess(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleUpgrade = () => {\n    window.location.href = '/credits/purchase';\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (!hasAccess) {\n    return (\n      <Card className=\"border-orange-200 bg-orange-50\">\n        <CardContent className=\"p-8 text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"p-3 bg-orange-100 rounded-full\">\n              <Lock className=\"h-8 w-8 text-orange-600\" />\n            </div>\n          </div>\n          \n          <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n            Insufficient Credits\n          </h3>\n          \n          <p className=\"text-gray-600 mb-4\">\n            You need at least {requiredCredits} credit{requiredCredits > 1 ? 's' : ''} to use {feature}.\n            {balance && !balance.isSuperAdmin && (\n              <span className=\"block mt-1\">\n                Current balance: {balance.available_credits} credits\n              </span>\n            )}\n          </p>\n\n          {showUpgradeButton && (\n            <div className=\"space-y-3\">\n              {/* <Button \n                onClick={handleUpgrade}\n                className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n              >\n                <CreditCard className=\"h-4 w-4 mr-2\" />\n                Purchase Credits\n              </Button> */}\n              \n              <p className=\"text-xs text-gray-500\">\n                Credits are added instantly after purchase\n              </p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return children;\n};\n\nexport default CreditGuard;\n"],"names":["CreditGuard","children","requiredCredits","feature","showUpgradeButton","balance","setBalance","useState","loading","setLoading","hasAccess","setHasAccess","useEffect","checkCreditBalance","handleCreditUpdate","balanceData","axiosInstance","error","jsx","Card","jsxs","CardContent","Lock"],"mappings":"4IAOA,MAAMA,EAAc,CAAC,CACnB,SAAAC,EACA,gBAAAC,EAAkB,EAClB,QAAAC,EAAU,eACV,kBAAAC,EAAoB,EACtB,IAAM,CACJ,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,IAAI,EACrC,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAAWC,CAAY,EAAIJ,EAAAA,SAAS,EAAK,EAEhDK,EAAAA,UAAU,IAAM,CACKC,EAAA,EAGnB,MAAMC,EAAqB,IAAM,CACZD,EAAA,CACrB,EAEO,cAAA,iBAAiB,sBAAuBC,CAAkB,EAE1D,IAAM,CACJ,OAAA,oBAAoB,sBAAuBA,CAAkB,CACtE,CAAA,EACC,CAACZ,CAAe,CAAC,EAEpB,MAAMW,EAAqB,SAAY,CACjC,GAAA,CACFJ,EAAW,EAAI,EAET,MAAAM,GADW,MAAMC,EAAc,IAAI,sBAAsB,GAClC,KAAK,KAClCV,EAAWS,CAAW,EAGlBA,EAAY,aACdJ,EAAa,EAAI,EAGjBA,EAAa,WAAWI,EAAY,iBAAiB,GAAKb,CAAe,QAEpEe,EAAO,CACN,QAAA,MAAM,iCAAkCA,CAAK,EACrDN,EAAa,EAAK,CAAA,QAClB,CACAF,EAAW,EAAK,CAAA,CAEpB,EAMA,OAAID,EAEAU,MAAC,OAAI,UAAU,uCACb,eAAC,MAAI,CAAA,UAAU,+DAA+D,CAChF,CAAA,EAICR,EA2CET,QAzCFkB,EAAK,CAAA,UAAU,iCACd,SAACC,EAAA,KAAAC,EAAA,CAAY,UAAU,kBACrB,SAAA,CAAAH,EAAA,IAAC,MAAI,CAAA,UAAU,2BACb,SAAAA,EAAAA,IAAC,MAAI,CAAA,UAAU,iCACb,SAAAA,EAAA,IAACI,EAAK,CAAA,UAAU,yBAA0B,CAAA,CAC5C,CAAA,EACF,EAECJ,EAAA,IAAA,KAAA,CAAG,UAAU,2CAA2C,SAEzD,uBAAA,EAEAE,EAAAA,KAAC,IAAE,CAAA,UAAU,qBAAqB,SAAA,CAAA,qBACblB,EAAgB,UAAQA,EAAkB,EAAI,IAAM,GAAG,WAASC,EAAQ,IAC1FE,GAAW,CAACA,EAAQ,cAClBe,EAAAA,KAAA,OAAA,CAAK,UAAU,aAAa,SAAA,CAAA,oBACTf,EAAQ,kBAAkB,UAAA,CAC9C,CAAA,CAAA,EAEJ,EAECD,GACEc,EAAAA,IAAA,MAAA,CAAI,UAAU,YASb,eAAC,IAAE,CAAA,UAAU,wBAAwB,SAAA,4CAErC,CAAA,CACF,CAAA,CAAA,CAAA,CAEJ,CACF,CAAA,CAKN"}