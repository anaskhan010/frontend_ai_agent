import{j as e,H as Ce,I as ae,aS as T,bL as te,bP as re,aG as R,ba as Q,ax as ne,aC as ie,C as G,aq as q,aI as J,N as Se,T as Ue,K as Ae}from"./ui-CZ40mCLE.js";import{r as x}from"./vendor-DG599jyl.js";import{P as Fe}from"./Page-VJHnDaE2.js";import{H as Ee}from"./Header-DawW8U-1.js";import{a as Me,t as f,q as V,r as X,s as z,v as H,x as $,L as N,I as y,B as _,S as le,f as ce,g as oe,h as de,i as me,o as he,n as L,C as K,b as Z}from"./index-CN8YbPPQ.js";import{A as xe,b as ue,a as ge}from"./avatar-C1lkZNCT.js";import{S}from"./skeleton-DJyL3M7O.js";import{c as Ie,u as Pe,d as Le,g as Oe}from"./userService-Bqaxj32d.js";import{P as ke}from"./PermissionRoute-zXlwcaHE.js";import{A as Re,a as qe,b as Te,c as Ve,d as Xe,e as ze,f as He,g as $e}from"./alert-dialog-D9-9H4eL.js";import{t as F,c as Be,e as We,n as fe,a as Ye,g as Qe,m as Ge,o as ee,p as se,q as M,f as k}from"./format-C-QuTXqM.js";import"./sheet-DJIQkDZl.js";import"./router-BnJytTjr.js";import"./query-Dkjx6fBT.js";import"./usePermissions-CYV477z8.js";function I(r,l){const s=+F(r)-+F(l);return s<0?-1:s>0?1:s}function Je(r){return Be(r,Date.now())}function Ke(r){return l=>{const s=Math.trunc,i=s(l);return i===0?0:i}}function Ze(r,l){return+F(r)-+F(l)}function es(r,l){const s=F(r,l==null?void 0:l.in);return s.setHours(23,59,59,999),s}function ss(r,l){const s=F(r,l==null?void 0:l.in);return+es(s,l)==+We(s,l)}function as(r,l,s){const[i,t,u]=fe(s==null?void 0:s.in,r,r,l),g=I(t,u),d=Math.abs(Ye(t,u));if(d<1)return 0;t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-g*d);let m=I(t,u)===-g;ss(i)&&d===1&&I(i,u)===1&&(m=!1);const c=g*(d-+m);return c===0?0:c}function ts(r,l,s){const i=Ze(r,l)/1e3;return Ke()(i)}function rs(r,l,s){const i=Qe(),t=(s==null?void 0:s.locale)??i.locale??Ge,u=2520,g=I(r,l);if(isNaN(g))throw new RangeError("Invalid time value");const d=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:g}),[m,c]=fe(s==null?void 0:s.in,...g>0?[l,r]:[r,l]),v=ts(c,m),b=(ee(c)-ee(m))/1e3,h=Math.round((v-b)/60);let w;if(h<2)return s!=null&&s.includeSeconds?v<5?t.formatDistance("lessThanXSeconds",5,d):v<10?t.formatDistance("lessThanXSeconds",10,d):v<20?t.formatDistance("lessThanXSeconds",20,d):v<40?t.formatDistance("halfAMinute",0,d):v<60?t.formatDistance("lessThanXMinutes",1,d):t.formatDistance("xMinutes",1,d):h===0?t.formatDistance("lessThanXMinutes",1,d):t.formatDistance("xMinutes",h,d);if(h<45)return t.formatDistance("xMinutes",h,d);if(h<90)return t.formatDistance("aboutXHours",1,d);if(h<se){const n=Math.round(h/60);return t.formatDistance("aboutXHours",n,d)}else{if(h<u)return t.formatDistance("xDays",1,d);if(h<M){const n=Math.round(h/se);return t.formatDistance("xDays",n,d)}else if(h<M*2)return w=Math.round(h/M),t.formatDistance("aboutXMonths",w,d)}if(w=as(c,m),w<12){const n=Math.round(h/M);return t.formatDistance("xMonths",n,d)}else{const n=w%12,p=Math.trunc(w/12);return n<3?t.formatDistance("aboutXYears",p,d):n<9?t.formatDistance("overXYears",p,d):t.formatDistance("almostXYears",p+1,d)}}function P(r,l){return rs(r,Je(r),l)}const B=async()=>{try{const r=await Me.get("/api/roles");if(r.status===200)return r.data;throw new Error("Failed to get roles")}catch(r){throw console.error("Error getting roles:",r),r}},ns=({open:r,onOpenChange:l,onUserCreated:s})=>{const[i,t]=x.useState(!1),[u,g]=x.useState([]),[d,m]=x.useState(!1),[c,v]=x.useState({username:"",email:"",password:"",first_name:"",last_name:"",phone_number:"",role_id:"",is_active:!0});x.useEffect(()=>{r&&b()},[r]);const b=async()=>{try{const o=await B();if(o.success){const j=o.data.filter(D=>D.is_active);g(j)}else f.error("Failed to fetch roles")}catch(o){console.error("Error fetching roles:",o),f.error("Failed to fetch roles")}},h=(o,j)=>{v(D=>({...D,[o]:j}))},w=async o=>{var j,D;if(o.preventDefault(),!c.username||!c.email||!c.password||!c.first_name||!c.last_name||!c.role_id){f.error("Please fill in all required fields");return}if(c.password.length<6){f.error("Password must be at least 6 characters long");return}try{t(!0);const C=await Ie(c);C.success?(f.success("User created successfully"),s(),l(!1),n()):f.error(C.message||"Failed to create user")}catch(C){console.error("Error creating user:",C),f.error(((D=(j=C.response)==null?void 0:j.data)==null?void 0:D.message)||"Failed to create user")}finally{t(!1)}},n=()=>{v({username:"",email:"",password:"",first_name:"",last_name:"",phone_number:"",role_id:"",is_active:!0}),m(!1)},p=()=>{l(!1),n()};return e.jsx(V,{open:r,onOpenChange:p,children:e.jsxs(X,{className:"sm:max-w-7xl max-h-[90vh] overflow-y-auto bg-[#0e1340] border-white/10",children:[e.jsxs(z,{children:[e.jsx(H,{className:"text-xl font-semibold text-white",children:"Add New User"}),e.jsx($,{className:"text-white/60",children:"Create a new user account with role assignment."})]}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"first_name",className:"text-sm font-medium text-white",children:"First Name *"}),e.jsx(y,{id:"first_name",value:c.first_name,onChange:o=>h("first_name",o.target.value),placeholder:"Enter first name",required:!0,className:"h-11 bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-indigo-500/50"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"last_name",className:"text-sm font-medium text-white",children:"Last Name *"}),e.jsx(y,{id:"last_name",value:c.last_name,onChange:o=>h("last_name",o.target.value),placeholder:"Enter last name",required:!0,className:"h-11 bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-indigo-500/50"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"username",className:"text-sm font-medium text-white",children:"Username *"}),e.jsx(y,{id:"username",value:c.username,onChange:o=>h("username",o.target.value),placeholder:"Enter username",required:!0,className:"h-11 bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-indigo-500/50"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"email",className:"text-sm font-medium text-white",children:"Email *"}),e.jsx(y,{id:"email",type:"email",value:c.email,onChange:o=>h("email",o.target.value),placeholder:"Enter email address",required:!0,className:"h-11 bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-indigo-500/50"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"password",className:"text-sm font-medium text-white",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{id:"password",type:d?"text":"password",value:c.password,onChange:o=>h("password",o.target.value),placeholder:"Enter password (min 6 characters)",required:!0,minLength:6,className:"h-11 pr-10 bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-indigo-500/50"}),e.jsx(_,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-11 px-3 py-2 hover:bg-transparent text-white/60 hover:text-white",onClick:()=>m(!d),children:d?e.jsx(Ce,{className:"h-4 w-4"}):e.jsx(ae,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"phone_number",className:"text-sm font-medium text-white",children:"Phone Number"}),e.jsx(y,{id:"phone_number",value:c.phone_number,onChange:o=>h("phone_number",o.target.value),placeholder:"Enter phone number (optional)",className:"h-11 bg-white/5 border-white/20 text-white placeholder:text-white/40 focus:border-indigo-500/50"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"role_id",className:"text-sm font-medium text-white",children:"Role *"}),e.jsxs(le,{value:c.role_id,onValueChange:o=>h("role_id",o),required:!0,children:[e.jsx(ce,{className:"h-11 bg-white/5 border-white/20 text-white focus:border-indigo-500/50",children:e.jsx(oe,{placeholder:"Select a role",className:"text-white/40"})}),e.jsx(de,{className:"bg-[#0e1340] border-white/10",children:u.length>0?u.map(o=>e.jsx(me,{value:o.id.toString(),className:"text-white hover:bg-white/10 focus:bg-white/10",children:o.display_name},o.id)):e.jsx("div",{className:"px-2 py-1.5 text-sm text-white/40",children:"No roles available"})})]})]}),e.jsxs("div",{className:"flex items-end space-x-3 pb-2",children:[e.jsx(he,{id:"is_active",checked:c.is_active,onCheckedChange:o=>h("is_active",o)}),e.jsx(N,{htmlFor:"is_active",className:"text-sm font-medium text-white",children:"Active User"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-white/10",children:[e.jsx(_,{type:"button",variant:"outline",onClick:p,disabled:i,className:"h-11 px-6 bg-transparent border-white/20 text-white hover:bg-white/10",children:"Cancel"}),e.jsxs(_,{type:"submit",disabled:i,className:"h-11 px-6 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white",children:[i&&e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Create User"]})]})]})]})})},is=({open:r,onOpenChange:l,onUserUpdated:s,user:i})=>{const[t,u]=x.useState(!1),[g,d]=x.useState([]),[m,c]=x.useState({username:"",email:"",first_name:"",last_name:"",phone_number:"",role_id:"",is_active:!0});x.useEffect(()=>{var n;r&&i&&(c({username:i.username||"",email:i.email||"",first_name:i.first_name||"",last_name:i.last_name||"",phone_number:i.phone_number||"",role_id:((n=i.role_id)==null?void 0:n.toString())||"",is_active:i.is_active??!0}),v())},[r,i]);const v=async()=>{try{const n=await B();n.success&&d(n.data.filter(p=>p.is_active))}catch(n){console.error("Error fetching roles:",n),f.error("Failed to fetch roles")}},b=(n,p)=>{c(o=>({...o,[n]:p}))},h=async n=>{var p,o;if(n.preventDefault(),!!i){if(!m.username||!m.email||!m.first_name||!m.last_name||!m.role_id){f.error("Please fill in all required fields");return}try{u(!0);const j=await Pe(i.id,m);j.success?(f.success("User updated successfully"),s(),l(!1)):f.error(j.message||"Failed to update user")}catch(j){console.error("Error updating user:",j),f.error(((o=(p=j.response)==null?void 0:p.data)==null?void 0:o.message)||"Failed to update user")}finally{u(!1)}}},w=()=>{l(!1)};return i?e.jsx(V,{open:r,onOpenChange:w,children:e.jsxs(X,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(z,{children:[e.jsx(H,{children:"Edit User"}),e.jsx($,{children:"Update user information and role assignment."})]}),e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"first_name",className:"text-sm font-medium",children:"First Name *"}),e.jsx(y,{id:"first_name",value:m.first_name,onChange:n=>b("first_name",n.target.value),placeholder:"Enter first name",required:!0,className:"h-11"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{htmlFor:"last_name",className:"text-sm font-medium",children:"Last Name *"}),e.jsx(y,{id:"last_name",value:m.last_name,onChange:n=>b("last_name",n.target.value),placeholder:"Enter last name",required:!0,className:"h-11"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"username",children:"Username *"}),e.jsx(y,{id:"username",value:m.username,onChange:n=>b("username",n.target.value),placeholder:"Enter username",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"email",children:"Email *"}),e.jsx(y,{id:"email",type:"email",value:m.email,onChange:n=>b("email",n.target.value),placeholder:"Enter email address",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(y,{id:"phone_number",value:m.phone_number,onChange:n=>b("phone_number",n.target.value),placeholder:"Enter phone number (optional)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"role_id",children:"Role *"}),e.jsxs(le,{value:m.role_id,onValueChange:n=>b("role_id",n),required:!0,children:[e.jsx(ce,{children:e.jsx(oe,{placeholder:"Select a role"})}),e.jsx(de,{children:g.map(n=>e.jsx(me,{value:n.id.toString(),children:n.display_name},n.id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(he,{id:"is_active",checked:m.is_active,onCheckedChange:n=>b("is_active",n)}),e.jsx(N,{htmlFor:"is_active",children:"Active User"})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(_,{type:"button",variant:"outline",onClick:w,disabled:t,children:"Cancel"}),e.jsxs(_,{type:"submit",disabled:t,children:[t&&e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Update User"]})]})]})]})}):null},ls=({open:r,onOpenChange:l,onUserDeleted:s,user:i})=>{const[t,u]=x.useState(!1),g=async()=>{var d,m;if(i){if(i.is_super_admin){f.error("Cannot delete super admin user");return}try{u(!0);const c=await Le(i.id);c.success?(f.success("User deleted successfully"),s(),l(!1)):f.error(c.message||"Failed to delete user")}catch(c){console.error("Error deleting user:",c),f.error(((m=(d=c.response)==null?void 0:d.data)==null?void 0:m.message)||"Failed to delete user")}finally{u(!1)}}};return i?e.jsx(Re,{open:r,onOpenChange:l,children:e.jsxs(qe,{children:[e.jsxs(Te,{children:[e.jsx(Ve,{children:"Delete User"}),e.jsxs(Xe,{children:["Are you sure you want to delete ",e.jsxs("strong",{children:[i.first_name," ",i.last_name]})," (",i.email,")?",e.jsx("br",{}),e.jsx("br",{}),"This action cannot be undone. The user will be permanently removed from the system.",i.is_super_admin&&e.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-red-700",children:[e.jsx("strong",{children:"Warning:"})," This is a super admin user and cannot be deleted."]})]})]}),e.jsxs(ze,{children:[e.jsx(He,{disabled:t,children:"Cancel"}),e.jsxs($e,{onClick:g,disabled:t||i.is_super_admin,className:"bg-red-600 hover:bg-red-700",children:[t&&e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete User"]})]})]})}):null},cs=({open:r,onOpenChange:l,user:s})=>{if(!s)return null;const i=t=>t.roles&&t.roles.length>0?t.roles.map(u=>u.display_name).join(", "):t.is_super_admin?"Super Administrator":"No Role";return e.jsx(V,{open:r,onOpenChange:l,children:e.jsxs(X,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(z,{children:[e.jsx(H,{children:"User Details"}),e.jsx($,{children:"View detailed information about this user account."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs(xe,{className:"h-16 w-16",children:[e.jsx(ue,{src:`https://api.dicebear.com/7.x/initials/svg?seed=${s.first_name} ${s.last_name}`}),e.jsxs(ge,{className:"text-lg",children:[s.first_name.charAt(0),s.last_name.charAt(0)]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs("h3",{className:"text-xl font-semibold",children:[s.first_name," ",s.last_name]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{variant:s.is_active?"default":"secondary",children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),"Inactive"]})}),e.jsxs(L,{variant:"outline",children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),i(s)]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),"Contact Information"]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(ne,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Q,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Username"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.username})]})]}),s.phone_number&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(ie,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Phone Number"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.phone_number})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Account Information"]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(q,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Member Since"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[k(new Date(s.created_at),"PPP"),e.jsxs("span",{className:"text-gray-500 ml-1",children:["(",P(new Date(s.created_at),{addSuffix:!0}),")"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(q,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Last Updated"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[k(new Date(s.updated_at),"PPP"),e.jsxs("span",{className:"text-gray-500 ml-1",children:["(",P(new Date(s.updated_at),{addSuffix:!0}),")"]})]})]})]}),s.last_login&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(G,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Last Login"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[k(new Date(s.last_login),"PPP"),e.jsxs("span",{className:"text-gray-500 ml-1",children:["(",P(new Date(s.last_login),{addSuffix:!0}),")"]})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"System Information"]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"User ID"}),e.jsxs("p",{className:"text-sm text-gray-900",children:["#",s.id]})]})}),e.jsx("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Account Status"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.is_active?"Active - Can login and access system":"Inactive - Cannot login to system"})]})}),e.jsx("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Admin Privileges"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.is_super_admin?"Super Administrator - Full system access":"Regular User - Role-based access"})]})})]})]})]})]})})},_s=()=>{const[r,l]=x.useState([]),[s,i]=x.useState([]),[t,u]=x.useState(!0),[g,d]=x.useState(""),[m,c]=x.useState(null),[v,b]=x.useState(!1),[h,w]=x.useState(!1),[n,p]=x.useState(!1),[o,j]=x.useState(!1),[D,C]=x.useState(!1);x.useEffect(()=>{E(),pe()},[]);const E=async()=>{try{u(!0);const a=await Oe();if(a.success){const A=a.data.map(U=>({...U,username:U.username||U.email||`user_${U.id}`}));l(A)}else f.error("Failed to fetch users")}catch(a){console.error("Error fetching users:",a),f.error("Failed to fetch users")}finally{u(!1)}},pe=async()=>{try{const a=await B();a.success&&i(a.data)}catch(a){console.error("Error fetching roles:",a)}},O=(r||[]).filter(a=>a.username.toLowerCase().includes(g.toLowerCase())||a.email.toLowerCase().includes(g.toLowerCase())||a.first_name.toLowerCase().includes(g.toLowerCase())||a.last_name.toLowerCase().includes(g.toLowerCase())),je=a=>a.roles&&a.roles.length>0?a.roles.map(A=>A.display_name).join(", "):a.role_names?a.role_names.split(",").map(U=>{const Y=(s||[]).find(De=>De.name===U.trim());return Y?Y.display_name:U}).join(", "):a.is_super_admin?"Super Administrator":"No Role",Ne=a=>{c(a),C(!0)},we=a=>{c(a),p(!0)},ve=a=>{c(a),j(!0)},W=()=>{w(!0)},be=()=>{E()},ye=()=>{E()},_e=()=>{E()};return e.jsx(ke,{requireSuperAdmin:!0,children:e.jsxs(Fe,{children:[e.jsx("div",{"aria-hidden":!0,className:"absolute inset-0 pointer-events-none bg-gradient-to-r from-indigo-500/10 via-purple-500/10 to-pink-500/10"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(Ee,{title:"User Management",buttonText:"Add User",action:W,filterByName:!0,filterWord:g,onFilterChange:d,useSheet:!1,showViewToggle:!1,showFilters:!1}),e.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 gap-3",children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(L,{variant:"secondary",className:"px-3 py-1 bg-indigo-500/20 text-indigo-300 border border-indigo-500/30",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),e.jsxs("span",{children:[O.length," Users"]})]})})}),e.jsx("div",{className:"grid gap-4",children:t&&r.length===0?Array.from({length:3}).map((a,A)=>e.jsx(K,{className:"bg-white/5 backdrop-blur-md border border-white/10 hover:shadow-md transition-shadow",children:e.jsx(Z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(S,{className:"h-12 w-12 rounded-full bg-white/10"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(S,{className:"h-5 w-48 mb-2 bg-white/10"}),e.jsx(S,{className:"h-4 w-32 mb-1 bg-white/10"}),e.jsx(S,{className:"h-4 w-24 bg-white/10"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{className:"h-8 w-16 bg-white/10"}),e.jsx(S,{className:"h-8 w-8 bg-white/10"}),e.jsx(S,{className:"h-8 w-8 bg-white/10"}),e.jsx(S,{className:"h-8 w-8 bg-white/10"})]})]})})},`skeleton-${A}`)):O.map(a=>e.jsx(K,{className:"bg-white/5 backdrop-blur-md border border-white/10 hover:shadow-md hover:border-indigo-500/30 transition-all",children:e.jsx(Z,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(xe,{className:"h-12 w-12 border-2 border-white/20",children:[e.jsx(ue,{src:`https://api.dicebear.com/7.x/initials/svg?seed=${a.first_name} ${a.last_name}`}),e.jsxs(ge,{className:"bg-indigo-500/20 text-indigo-300",children:[a.first_name.charAt(0),a.last_name.charAt(0)]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"font-semibold text-lg text-white",children:[a.first_name," ",a.last_name]}),e.jsx(L,{variant:a.is_active?"default":"secondary",className:a.is_active?"bg-green-500/20 text-green-300 border border-green-500/30":"bg-gray-500/20 text-gray-300 border border-gray-500/30",children:a.is_active?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),"Inactive"]})})]}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"h-3 w-3"}),a.email]}),a.phone_number&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"h-3 w-3"}),a.phone_number]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"h-3 w-3"}),je(a)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3"}),"Joined ",P(new Date(a.created_at),{addSuffix:!0})]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>Ne(a),className:"flex items-center gap-1 bg-transparent border-white/20 text-white hover:bg-white/10",children:[e.jsx(ae,{className:"h-4 w-4"}),"View"]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>we(a),className:"flex items-center gap-1 bg-transparent border-white/20 text-white hover:bg-white/10",children:[e.jsx(Se,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>ve(a),className:"flex items-center gap-1 bg-transparent border-red-500/30 text-red-400 hover:bg-red-500/10",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Delete"]})]})]})})},a.id))}),O.length===0&&!t&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-white",children:"No users found"}),e.jsx("p",{className:"text-gray-400 mb-4",children:g?"No users match your search criteria.":"No users have been created yet."}),e.jsxs(_,{onClick:W,className:"bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 text-white border-0",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Add First User"]})]}),e.jsx(ns,{open:h,onOpenChange:w,onUserCreated:be}),e.jsx(is,{open:n,onOpenChange:p,onUserUpdated:ye,user:m}),e.jsx(ls,{open:o,onOpenChange:j,onUserDeleted:_e,user:m}),e.jsx(cs,{open:D,onOpenChange:C,user:m})]})]})})};export{_s as default};
//# sourceMappingURL=UserManagement-BsizLami.js.map
