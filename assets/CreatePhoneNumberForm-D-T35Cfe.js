import{j as e,aE as R,a9 as y,aS as S,aC as L}from"./ui-B8VyAbFl.js";import{r as d}from"./vendor-DG599jyl.js";import{u as D,a as M,c as _}from"./query-CWB_8EHL.js";import{a as q,C as B,b as K,u as O,E as V,t as a,L as o,g as C,h as I,i as T,j as P,k,I as h}from"./index-BJQAqHy1.js";import{i as $,c as Y}from"./phoneNumberService-IyXe8ahK.js";import{f as z}from"./agentService-CIaYz9sF.js";const G=({children:u,requiredCredits:m=1,feature:c="this feature",showUpgradeButton:w=!0})=>{const[t,A]=d.useState(null),[i,p]=d.useState(!0),[F,j]=d.useState(!1);d.useEffect(()=>{N();const l=()=>{N()};return window.addEventListener("creditBalanceUpdate",l),()=>{window.removeEventListener("creditBalanceUpdate",l)}},[m]);const N=async()=>{try{p(!0);const x=(await q.get("/api/credits/balance")).data.data;A(x),x.isSuperAdmin?j(!0):j(parseFloat(x.available_credits)>=m)}catch(l){console.error("Error checking credit balance:",l),j(!1)}finally{p(!1)}};return i?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):F?u:e.jsx(B,{className:"border-orange-200 bg-orange-50",children:e.jsxs(K,{className:"p-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:e.jsx(R,{className:"h-8 w-8 text-orange-600"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Insufficient Credits"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["You need at least ",m," credit",m>1?"s":""," to use ",c,".",t&&!t.isSuperAdmin&&e.jsxs("span",{className:"block mt-1",children:["Current balance: ",t.available_credits," credits"]})]}),w&&e.jsx("div",{className:"space-y-3",children:e.jsx("p",{className:"text-xs text-gray-500",children:"Credits are added instantly after purchase"})})]})})},ee=({onSuccess:u,onCancel:m})=>{const{user:c}=O(),{isSuperAdmin:w}=V(),[t,A]=d.useState({provider:"vapi",phoneNumber:"",name:"",assistantId:"",squadId:"",workflowId:"",fallbackDestination:"",serverUrl:"",serverUrlSecret:"",twilioAccountSid:"",twilioAuthToken:"",vonageApiKey:"",vonageApiSecret:"",telnyxApiKey:"",telnyxApiSecret:"",areaCode:"",twilioPhoneNumber:"",twilioLabel:"",smsEnabled:!0}),[i,p]=d.useState("free"),[F,j]=d.useState(!1),N=D(),{data:l,isLoading:x}=M({queryKey:["assistants","complete",c==null?void 0:c.id],queryFn:()=>z(""),retry:(s,r)=>{var b;return[404,204,402].includes((b=r==null?void 0:r.response)==null?void 0:b.status)?!1:s<1},enabled:!!(c!=null&&c.id)}),v=(l==null?void 0:l.data)||[],g=_({mutationFn:s=>i==="import"?$(s):Y(s),onSuccess:()=>{const s=i==="import"?"Twilio phone number imported successfully!":"Phone number created successfully!";a.success(s),N.invalidateQueries({queryKey:["phoneNumbers"]}),u==null||u()},onError:s=>{var f,b;const r=i==="import"?"Failed to import Twilio phone number":"Failed to create phone number";a.error(((b=(f=s.response)==null?void 0:f.data)==null?void 0:b.message)||r)}}),n=(s,r)=>{A(f=>({...f,[s]:r}))},E=()=>{if(!t.provider)return a.error("Please select a provider"),!1;if(t.provider==="vapi"&&i==="free"&&(!t.areaCode||t.areaCode.length!==3))return a.error("Please enter a valid 3-digit area code"),!1;if(i==="import"){if(!t.twilioPhoneNumber)return a.error("Please enter a Twilio phone number"),!1;if(!t.twilioAccountSid)return a.error("Please enter Twilio Account SID"),!1;if(!t.twilioAuthToken)return a.error("Please enter Twilio Auth Token"),!1;if(!t.twilioLabel)return a.error("Please enter a label for the phone number"),!1;if(!/^\+[1-9]\d{1,14}$/.test(t.twilioPhoneNumber))return a.error("Phone number must be in E.164 format (e.g., +14155551234)"),!1}if(t.provider!=="vapi"&&i!=="import"){if(!t.phoneNumber)return a.error("Please enter a phone number"),!1;if(!/^\+[1-9]\d{1,14}$/.test(t.phoneNumber))return a.error("Phone number must be in E.164 format (e.g., +1234567890)"),!1}if(!t.assistantId||t.assistantId==="unassigned")return a.error("Please select an assistant"),!1;if(t.serverUrl)try{new URL(t.serverUrl)}catch{return a.error("Server URL must be a valid URL"),!1}if(t.fallbackDestination)try{JSON.parse(t.fallbackDestination)}catch{return a.error("Fallback destination must be valid JSON"),!1}switch(t.provider){case"vapi":break;case"twilio":if(!t.twilioAccountSid||!t.twilioAuthToken)return a.error("Twilio Account SID and Auth Token are required"),!1;if(!t.twilioAccountSid.startsWith("AC"))return a.error("Twilio Account SID should start with 'AC'"),!1;if(t.twilioAccountSid.length!==34)return a.error("Twilio Account SID should be 34 characters long"),!1;break;case"vonage":if(!t.vonageApiKey||!t.vonageApiSecret)return a.error("Vonage API Key and Secret are required"),!1;break;case"telnyx":if(!t.telnyxApiKey)return a.error("Telnyx API Key is required"),!1;break}return!0},U=s=>{if(s.preventDefault(),!E())return;let r;i==="import"?r={twilioPhoneNumber:t.twilioPhoneNumber,twilioAccountSid:t.twilioAccountSid,twilioAuthToken:t.twilioAuthToken,twilioLabel:t.twilioLabel,assistantId:t.assistantId,smsEnabled:t.smsEnabled}:r={...t},g.mutate(r)};return e.jsx(G,{requiredCredits:1,feature:"phone number creation",showUpgradeButton:!0,children:e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsx("div",{className:"neo-card",children:e.jsx("div",{className:"p-6 space-y-5",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"w-52 space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"Phone Number Options"}),e.jsx("button",{type:"button",onClick:()=>p("free"),className:`w-full p-2.5 text-left rounded-md border text-xs transition-all ${i==="free"?"border-[#12a594] bg-[#12a594] text-white shadow-[0_0_20px_rgba(18,165,148,0.5)]":"border-white/20 bg-white/5 text-white hover:bg-white/10 hover:border-white/30"}`,children:"Phone Number (Voice Only)"}),e.jsx("button",{type:"button",onClick:()=>p("import"),className:`w-full p-2.5 text-left rounded-md border text-sm transition-all ${i==="import"?"border-[#12a594] bg-[#12a594] text-white shadow-[0_0_20px_rgba(18,165,148,0.5)]":"border-white/20 bg-white/5 text-[#12a594] hover:bg-white/10 hover:border-[#12a594]/50"}`,children:"Import Twilio (SMS & Voice)"})]}),e.jsx("div",{className:"flex-1 space-y-4",children:i==="free"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Free Vapi Number"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"provider",className:"text-sm font-medium text-white",children:"Provider *"}),e.jsxs(C,{value:t.provider,onValueChange:s=>n("provider",s),children:[e.jsx(I,{children:e.jsx(T,{placeholder:"Select a provider"})}),e.jsx(P,{children:e.jsx(k,{value:"vapi",className:"font-medium",children:e.jsxs("div",{className:"flex items-center text-white gap-2",children:[e.jsx("div",{className:"w-2 h-2 text-white rounded-full",style:{backgroundColor:"#12a594"}}),"AI CRUITMENT (Free US Number)"]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(o,{htmlFor:"areaCode",className:"flex items-center gap-2 text-sm font-medium text-white",children:["Area Code *",e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full text-white font-medium",style:{backgroundColor:"#12a594"},children:"Free"})]}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(h,{id:"areaCode",type:"text",placeholder:"000",value:t.areaCode,onChange:s=>{const r=s.target.value.replace(/\D/g,"").slice(0,3);n("areaCode",r),n("phoneNumber",r)},className:"font-mono text-white text-lg text-center border-2 focus:border-[#12a594] focus:ring-[#12a594]",style:{borderColor:t.areaCode?"#12a594":void 0},maxLength:3}),t.areaCode&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("svg",{className:"h-4 w-4",style:{color:"#12a594"},fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("p",{className:"text-xs mt-1",style:{color:"#12a594"},children:"Enter a 3-digit US area code (e.g., 415, 212, 310)"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"name",className:"text-sm font-medium text-white",children:"Friendly Name"}),e.jsx(h,{id:"name",type:"text",placeholder:"My AI CRUITMENT Number",value:t.name,onChange:s=>n("name",s.target.value),className:"mt-1 text-white"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"assistantId",className:"flex items-center gap-2 text-sm font-medium text-white",children:[e.jsx(y,{className:"h-4 w-4"}),"Assistant *"]}),e.jsxs(C,{value:t.assistantId,onValueChange:s=>n("assistantId",s),children:[e.jsx(I,{className:"text-white",children:e.jsx(T,{placeholder:"Select an assistant"})}),e.jsx(P,{children:x?e.jsxs("div",{className:"flex items-center justify-center p-2",children:[e.jsx(S,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading assistants..."})]}):v.length===0?e.jsx("div",{className:"flex items-center justify-center p-2 text-white/65",children:"No assistants available"}):e.jsx(e.Fragment,{children:v.map(s=>e.jsx(k,{value:s.assistant_id||s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-3 w-3"}),s.name]})},s.id))})})]}),e.jsx("p",{className:"text-xs text-white/65",children:w?"Super admin can see all assistants":"You can only see your own assistants"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(L,{className:"h-4 w-4 text-[#12a594]"}),e.jsx("span",{className:"text-sm font-medium",children:"AI CRUITMENT Free Phone Number"})]}),e.jsx("div",{className:"border border-[#12a594]/40 rounded-lg p-4 bg-[#12a594]/10 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"h-4 w-4 text-[#12a594]",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"No credentials required!"}),e.jsx("div",{className:"text-sm text-white/80",children:"AI CRUITMENT provides free US phone numbers instantly. Just enter your desired area code and we'll assign you a random number in that area."}),e.jsxs("div",{className:"space-y-1 text-xs text-white/65",children:[e.jsx("div",{children:"â€¢ Instant activation (2-3 minutes)"}),e.jsx("div",{children:"â€¢ US numbers only"})]})]})]})})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Import Twilio"}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"twilioPhoneNumber",className:"text-sm font-medium text-white",children:"Twilio Phone Number"}),e.jsxs("div",{className:"flex mt-1",children:[e.jsx("div",{className:"flex items-center px-3  bg-gray-50 rounded-l-md",children:e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"ðŸ‡ºðŸ‡¸"})}),e.jsx(h,{id:"twilioPhoneNumber",type:"tel",placeholder:"+1415689........",value:t.twilioPhoneNumber,onChange:s=>n("twilioPhoneNumber",s.target.value),className:"rounded-l-none font-mono text-white"})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"twilioAccountSid",className:"text-sm font-medium text-white",children:"Twilio Account SID"}),e.jsx(h,{id:"twilioAccountSid",type:"text",placeholder:"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",value:t.twilioAccountSid,onChange:s=>n("twilioAccountSid",s.target.value),className:"font-mono text-sm mt-1 text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"twilioAuthToken",className:"text-sm font-medium text-white",children:"Twilio Auth Token"}),e.jsx(h,{id:"twilioAuthToken",type:"password",placeholder:"Your Twilio Auth Token",value:t.twilioAuthToken,onChange:s=>n("twilioAuthToken",s.target.value),className:"font-mono text-sm mt-1 text-white"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"twilioLabel",className:"text-sm font-medium text-white",children:"Label"}),e.jsx(h,{id:"twilioLabel",type:"text",placeholder:"Label for Phone Number",value:t.twilioLabel,onChange:s=>n("twilioLabel",s.target.value),className:"mt-1 text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"assistantId",className:"flex items-center gap-2 text-sm font-medium text-white",children:[e.jsx(y,{className:"h-4 w-4"}),"Assistant *"]}),e.jsxs(C,{value:t.assistantId,onValueChange:s=>n("assistantId",s),children:[e.jsx(I,{className:"text-white",children:e.jsx(T,{placeholder:"Select an assistant"})}),e.jsx(P,{children:x?e.jsxs("div",{className:"flex items-center justify-center p-2",children:[e.jsx(S,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading assistants..."})]}):v.length===0?e.jsx("div",{className:"flex items-center justify-center p-2 text-white/65",children:"No assistants available"}):e.jsx(e.Fragment,{children:v.map(s=>e.jsx(k,{value:s.assistant_id||s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-3 w-3"}),s.name]})},s.id))})})]}),e.jsx("p",{className:"text-xs text-white/65",children:w?"Super admin can see all assistants":"You can only see your own assistants"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border border-white/20 rounded-lg bg-white/5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"SMS Enabled"}),e.jsx("div",{className:"text-xs text-white/65",children:"Enable SMS messaging for this phone number"})]}),e.jsx("button",{type:"button",onClick:()=>n("smsEnabled",!t.smsEnabled),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors ${t.smsEnabled?"bg-[#12a594]":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${t.smsEnabled?"translate-x-5":"translate-x-1"}`})})]})]})})]})})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",className:"neo-topbar-btn px-6 py-2 rounded-lg text-white",onClick:m,disabled:g.isPending,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g.isPending,className:"neo-btn min-w-[140px] flex items-center justify-center",children:g.isPending?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"h-4 w-4 mr-2 animate-spin"}),i==="import"?"Importing from Twilio...":"Getting Free Number..."]}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),i==="import"?"Import from Twilio":"Get Free Number"]})})]})]})})};export{ee as C};
//# sourceMappingURL=CreatePhoneNumberForm-D-T35Cfe.js.map
