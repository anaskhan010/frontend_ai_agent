import{j as e,a9 as u,aS as b,aC as T}from"./ui-CZ40mCLE.js";import{r as w}from"./vendor-DG599jyl.js";import{u as E,b as R,c as U}from"./query-Dkjx6fBT.js";import{u as D,A as M,t as a,L as l,S as N,f as j,g as v,h as g,i as y,I as d}from"./index-Bg3h4xhe.js";import{i as q,c as K}from"./phoneNumberService-CP2wZPD_.js";import{f as O}from"./agentService-D7CnAdG-.js";import{C as V}from"./CreditGuard-DB2pC661.js";const H=({onSuccess:p,onCancel:I})=>{const{user:o}=D(),{isSuperAdmin:A}=M(),[t,P]=w.useState({provider:"vapi",phoneNumber:"",name:"",assistantId:"",squadId:"",workflowId:"",fallbackDestination:"",serverUrl:"",serverUrlSecret:"",twilioAccountSid:"",twilioAuthToken:"",vonageApiKey:"",vonageApiSecret:"",telnyxApiKey:"",telnyxApiSecret:"",areaCode:"",twilioPhoneNumber:"",twilioLabel:"",smsEnabled:!0}),[r,S]=w.useState("free"),[_,$]=w.useState(!1),k=E(),{data:f,isLoading:C}=R({queryKey:["assistants","complete",o==null?void 0:o.id],queryFn:()=>O(""),retry:(s,i)=>{var m;return[404,204,402].includes((m=i==null?void 0:i.response)==null?void 0:m.status)?!1:s<1},enabled:!!(o!=null&&o.id)}),x=(f==null?void 0:f.data)||[],h=U({mutationFn:s=>r==="import"?q(s):K(s),onSuccess:()=>{const s=r==="import"?"Twilio phone number imported successfully!":"Phone number created successfully!";a.success(s),k.invalidateQueries({queryKey:["phoneNumbers"]}),p==null||p()},onError:s=>{var c,m;const i=r==="import"?"Failed to import Twilio phone number":"Failed to create phone number";a.error(((m=(c=s.response)==null?void 0:c.data)==null?void 0:m.message)||i)}}),n=(s,i)=>{P(c=>({...c,[s]:i}))},F=()=>{if(!t.provider)return a.error("Please select a provider"),!1;if(t.provider==="vapi"&&r==="free"&&(!t.areaCode||t.areaCode.length!==3))return a.error("Please enter a valid 3-digit area code"),!1;if(r==="import"){if(!t.twilioPhoneNumber)return a.error("Please enter a Twilio phone number"),!1;if(!t.twilioAccountSid)return a.error("Please enter Twilio Account SID"),!1;if(!t.twilioAuthToken)return a.error("Please enter Twilio Auth Token"),!1;if(!t.twilioLabel)return a.error("Please enter a label for the phone number"),!1;if(!/^\+[1-9]\d{1,14}$/.test(t.twilioPhoneNumber))return a.error("Phone number must be in E.164 format (e.g., +14155551234)"),!1}if(t.provider!=="vapi"&&r!=="import"){if(!t.phoneNumber)return a.error("Please enter a phone number"),!1;if(!/^\+[1-9]\d{1,14}$/.test(t.phoneNumber))return a.error("Phone number must be in E.164 format (e.g., +1234567890)"),!1}if(!t.assistantId||t.assistantId==="unassigned")return a.error("Please select an assistant"),!1;if(t.serverUrl)try{new URL(t.serverUrl)}catch{return a.error("Server URL must be a valid URL"),!1}if(t.fallbackDestination)try{JSON.parse(t.fallbackDestination)}catch{return a.error("Fallback destination must be valid JSON"),!1}switch(t.provider){case"vapi":break;case"twilio":if(!t.twilioAccountSid||!t.twilioAuthToken)return a.error("Twilio Account SID and Auth Token are required"),!1;if(!t.twilioAccountSid.startsWith("AC"))return a.error("Twilio Account SID should start with 'AC'"),!1;if(t.twilioAccountSid.length!==34)return a.error("Twilio Account SID should be 34 characters long"),!1;break;case"vonage":if(!t.vonageApiKey||!t.vonageApiSecret)return a.error("Vonage API Key and Secret are required"),!1;break;case"telnyx":if(!t.telnyxApiKey)return a.error("Telnyx API Key is required"),!1;break}return!0},L=s=>{if(s.preventDefault(),!F())return;let i;r==="import"?i={twilioPhoneNumber:t.twilioPhoneNumber,twilioAccountSid:t.twilioAccountSid,twilioAuthToken:t.twilioAuthToken,twilioLabel:t.twilioLabel,assistantId:t.assistantId,smsEnabled:t.smsEnabled}:i={...t},h.mutate(i)};return e.jsx(V,{requiredCredits:1,feature:"phone number creation",showUpgradeButton:!0,children:e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsx("div",{className:"neo-card",children:e.jsx("div",{className:"p-6 space-y-5",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"w-52 space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-white mb-3",children:"Phone Number Options"}),e.jsx("button",{type:"button",onClick:()=>S("free"),className:`w-full p-2.5 text-left rounded-md border text-xs transition-all ${r==="free"?"border-[#12a594] bg-[#12a594] text-white shadow-[0_0_20px_rgba(18,165,148,0.5)]":"border-white/20 bg-white/5 text-white hover:bg-white/10 hover:border-white/30"}`,children:"Phone Number (Voice Only)"}),e.jsx("button",{type:"button",onClick:()=>S("import"),className:`w-full p-2.5 text-left rounded-md border text-sm transition-all ${r==="import"?"border-[#12a594] bg-[#12a594] text-white shadow-[0_0_20px_rgba(18,165,148,0.5)]":"border-white/20 bg-white/5 text-[#12a594] hover:bg-white/10 hover:border-[#12a594]/50"}`,children:"Import Twilio (SMS & Voice)"})]}),e.jsx("div",{className:"flex-1 space-y-4",children:r==="free"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Free Vapi Number"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"provider",className:"text-sm font-medium text-white",children:"Provider *"}),e.jsxs(N,{value:t.provider,onValueChange:s=>n("provider",s),children:[e.jsx(j,{children:e.jsx(v,{placeholder:"Select a provider"})}),e.jsx(g,{children:e.jsx(y,{value:"vapi",className:"font-medium",children:e.jsxs("div",{className:"flex items-center text-white gap-2",children:[e.jsx("div",{className:"w-2 h-2 text-white rounded-full",style:{backgroundColor:"#12a594"}}),"AI CRUITMENT (Free US Number)"]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(l,{htmlFor:"areaCode",className:"flex items-center gap-2 text-sm font-medium text-white",children:["Area Code *",e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full text-white font-medium",style:{backgroundColor:"#12a594"},children:"Free"})]}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(d,{id:"areaCode",type:"text",placeholder:"000",value:t.areaCode,onChange:s=>{const i=s.target.value.replace(/\D/g,"").slice(0,3);n("areaCode",i),n("phoneNumber",i)},className:"font-mono text-white text-lg text-center border-2 focus:border-[#12a594] focus:ring-[#12a594]",style:{borderColor:t.areaCode?"#12a594":void 0},maxLength:3}),t.areaCode&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("svg",{className:"h-4 w-4",style:{color:"#12a594"},fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("p",{className:"text-xs mt-1",style:{color:"#12a594"},children:"Enter a 3-digit US area code (e.g., 415, 212, 310)"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"name",className:"text-sm font-medium text-white",children:"Friendly Name"}),e.jsx(d,{id:"name",type:"text",placeholder:"My AI CRUITMENT Number",value:t.name,onChange:s=>n("name",s.target.value),className:"mt-1 text-white"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"assistantId",className:"flex items-center gap-2 text-sm font-medium text-white",children:[e.jsx(u,{className:"h-4 w-4"}),"Assistant *"]}),e.jsxs(N,{value:t.assistantId,onValueChange:s=>n("assistantId",s),children:[e.jsx(j,{className:"text-white",children:e.jsx(v,{placeholder:"Select an assistant"})}),e.jsx(g,{children:C?e.jsxs("div",{className:"flex items-center justify-center p-2",children:[e.jsx(b,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading assistants..."})]}):x.length===0?e.jsx("div",{className:"flex items-center justify-center p-2 text-white/65",children:"No assistants available"}):e.jsx(e.Fragment,{children:x.map(s=>e.jsx(y,{value:s.assistant_id||s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-3 w-3"}),s.name]})},s.id))})})]}),e.jsx("p",{className:"text-xs text-white/65",children:A?"Super admin can see all assistants":"You can only see your own assistants"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(T,{className:"h-4 w-4 text-[#12a594]"}),e.jsx("span",{className:"text-sm font-medium",children:"AI CRUITMENT Free Phone Number"})]}),e.jsx("div",{className:"border border-[#12a594]/40 rounded-lg p-4 bg-[#12a594]/10 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("svg",{className:"h-4 w-4 text-[#12a594]",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"No credentials required!"}),e.jsx("div",{className:"text-sm text-white/80",children:"AI CRUITMENT provides free US phone numbers instantly. Just enter your desired area code and we'll assign you a random number in that area."}),e.jsxs("div",{className:"space-y-1 text-xs text-white/65",children:[e.jsx("div",{children:"â€¢ Instant activation (2-3 minutes)"}),e.jsx("div",{children:"â€¢ US numbers only"})]})]})]})})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Import Twilio"}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twilioPhoneNumber",className:"text-sm font-medium text-white",children:"Twilio Phone Number"}),e.jsxs("div",{className:"flex mt-1",children:[e.jsx("div",{className:"flex items-center px-3  bg-gray-50 rounded-l-md",children:e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"ðŸ‡ºðŸ‡¸"})}),e.jsx(d,{id:"twilioPhoneNumber",type:"tel",placeholder:"+1415689........",value:t.twilioPhoneNumber,onChange:s=>n("twilioPhoneNumber",s.target.value),className:"rounded-l-none font-mono text-white"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twilioAccountSid",className:"text-sm font-medium text-white",children:"Twilio Account SID"}),e.jsx(d,{id:"twilioAccountSid",type:"text",placeholder:"ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",value:t.twilioAccountSid,onChange:s=>n("twilioAccountSid",s.target.value),className:"font-mono text-sm mt-1 text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twilioAuthToken",className:"text-sm font-medium text-white",children:"Twilio Auth Token"}),e.jsx(d,{id:"twilioAuthToken",type:"password",placeholder:"Your Twilio Auth Token",value:t.twilioAuthToken,onChange:s=>n("twilioAuthToken",s.target.value),className:"font-mono text-sm mt-1 text-white"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"twilioLabel",className:"text-sm font-medium text-white",children:"Label"}),e.jsx(d,{id:"twilioLabel",type:"text",placeholder:"Label for Phone Number",value:t.twilioLabel,onChange:s=>n("twilioLabel",s.target.value),className:"mt-1 text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{htmlFor:"assistantId",className:"flex items-center gap-2 text-sm font-medium text-white",children:[e.jsx(u,{className:"h-4 w-4"}),"Assistant *"]}),e.jsxs(N,{value:t.assistantId,onValueChange:s=>n("assistantId",s),children:[e.jsx(j,{className:"text-white",children:e.jsx(v,{placeholder:"Select an assistant"})}),e.jsx(g,{children:C?e.jsxs("div",{className:"flex items-center justify-center p-2",children:[e.jsx(b,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading assistants..."})]}):x.length===0?e.jsx("div",{className:"flex items-center justify-center p-2 text-white/65",children:"No assistants available"}):e.jsx(e.Fragment,{children:x.map(s=>e.jsx(y,{value:s.assistant_id||s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-3 w-3"}),s.name]})},s.id))})})]}),e.jsx("p",{className:"text-xs text-white/65",children:A?"Super admin can see all assistants":"You can only see your own assistants"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border border-white/20 rounded-lg bg-white/5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white",children:"SMS Enabled"}),e.jsx("div",{className:"text-xs text-white/65",children:"Enable SMS messaging for this phone number"})]}),e.jsx("button",{type:"button",onClick:()=>n("smsEnabled",!t.smsEnabled),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors ${t.smsEnabled?"bg-[#12a594]":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${t.smsEnabled?"translate-x-5":"translate-x-1"}`})})]})]})})]})})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",className:"neo-topbar-btn px-6 py-2 rounded-lg text-white",onClick:I,disabled:h.isPending,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h.isPending,className:"neo-btn min-w-[140px] flex items-center justify-center",children:h.isPending?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),r==="import"?"Importing from Twilio...":"Getting Free Number..."]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),r==="import"?"Import from Twilio":"Get Free Number"]})})]})]})})};export{H as C};
//# sourceMappingURL=CreatePhoneNumberForm-h-rnukrh.js.map
