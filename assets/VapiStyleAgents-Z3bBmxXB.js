var wc=Object.defineProperty;var Sc=(s,e,t)=>e in s?wc(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ee=(s,e,t)=>Sc(s,typeof e!="symbol"?e+"":e,t);import{j as n,aS as Mt,c6 as jc,T as $r,bo as ma,ay as js,aB as is,Y as ks,aw as Xs,G as vo,C as kc,ab as Cc,aG as yo,bV as Ec,bX as Nc,bY as Tc,aC as Zs,bW as Ac,a9 as ut,ba as Mc,bv as bo,am as Ic,K as _o,X as xo,V as Oc,k as Pc,m as Lc,c7 as pa,c8 as Dc,I as Rc,N as fa,aQ as ga}from"./ui-h9OBLyTx.js";import{r as Q,g as Fc,d as va,a as Vc,b as Uc}from"./vendor-DG599jyl.js";import{a as er,u as qc,c as Sr}from"./query-B7U7fZu0.js";import{u as Bc,a as $c,b as Jc,c as Gc,d as zc,g as Yc,e as Wc,h as Hc,i as Kc,j as Qc}from"./agentService-BxVLY8J2.js";import{p as Nt,B as je,Q as wn,R as Sn,U as ze,V as Ye,C as Ae,d as Pe,e as Le,b as Me,g as _e,h as xe,i as we,j as Se,k as ue,I as ye,T as ht,s as Zt,v as es,w as ts,x as ss,y as Xc,L as Y,q as jt,t as H,u as Zc}from"./index-CzOkn7Aq.js";import{A as tr,a as sr}from"./avatar-BxSGXFF2.js";import{T as eu,a as tu,b as Ms,c as Is,d as su,e as Kt}from"./table-Bk-epEiU.js";import{g as ru,a as nu,u as au}from"./defaultAssistantTemplateService-q2_5ck8b.js";import{S as iu}from"./slider-CGpzGrid.js";import{a as ps}from"./client-BdnkQTr_.js";import{g as ya,a as ba,b as _a,T as xa,V as wa,M as Sa,c as ja,d as ka,e as Ca}from"./vapiProviders-BRLs3WqT.js";import{u as ou}from"./router-BnJytTjr.js";const Ea=({agent:s,details:e,isLoading:t,onUpdateField:r,onUpdateSystemMessage:a,onDelete:i,onPublishToggle:l,isPublished:c,isSaving:d,onTalkToAssistant:m,MODEL_PROVIDERS:v,VOICE_PROVIDERS:_,TRANSCRIBER_PROVIDERS:N,getProviderModels:E,getProviderVoices:j,getTranscriberModels:y,normalizeProviderValue:S,getInitials:C})=>{var T,f,L,I,O,Z,K,ae,A,G,x,R,q,Ee,$e;return t?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 min-h-[400px]",children:[n.jsx(Mt,{className:"h-10 w-10 animate-spin text-indigo-500 mb-4"}),n.jsx("p",{className:"text-white/60",children:"Fetching Vapi agent details..."})]}):n.jsxs("div",{className:"flex flex-col h-full bg-[#0b0f2e]",children:[n.jsxs("div",{className:"p-6 border-b border-white/10 flex items-center justify-between sticky top-0 bg-[#0b0f2e] z-10",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx(tr,{className:"h-16 w-16 ring-2 ring-indigo-500/20",children:n.jsx(sr,{className:"text-white bg-gradient-to-br from-indigo-500/30 to-purple-500/30 text-xl font-bold",children:C(s.name)})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:s.name}),n.jsxs("div",{className:"flex items-center space-x-4",children:[n.jsx(Nt,{variant:"secondary",className:"bg-green-500/20 text-green-400 border border-green-500/30",children:"Active"}),n.jsxs("span",{className:"text-sm text-white/50 font-mono",children:["ID: ",String(s.id).substring(0,12),"..."]}),d&&n.jsxs("div",{className:"flex items-center text-xs text-blue-400",children:[n.jsx(Mt,{className:"h-3 w-3 mr-1 animate-spin"}),"Auto-saving..."]})]})]})]}),n.jsxs("div",{className:"flex items-center space-x-3",children:[n.jsxs(je,{size:"sm",onClick:m,className:"bg-gradient-to-r from-teal-500 to-cyan-600 hover:from-teal-600 hover:to-cyan-700 text-white shadow-lg",children:[n.jsx(jc,{className:"h-4 w-4 mr-2"}),"Talk"]}),n.jsx(je,{variant:c?"default":"outline",size:"sm",onClick:()=>l(s),className:c?"bg-green-600 hover:bg-green-700 text-white":"text-white bg-transparent hover:bg-white/10 border-white/20",children:c?"Published":"Publish"}),n.jsx(je,{variant:"outline",size:"sm",onClick:()=>i(s),className:"text-red-400 hover:text-red-300 hover:bg-red-500/10 border-red-400/30",children:n.jsx($r,{className:"h-4 w-4"})})]})]}),n.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:n.jsxs(wn,{defaultValue:"model",className:"w-full",children:[n.jsxs(Sn,{className:"flex flex-wrap items-center gap-2 mb-8 bg-transparent p-0 h-auto",children:[n.jsxs(ze,{value:"model",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[n.jsx(ma,{className:"h-4 w-4 mr-2"}),"Model"]}),n.jsxs(ze,{value:"voice",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[n.jsx(js,{className:"h-4 w-4 mr-2"}),"Voice"]}),n.jsxs(ze,{value:"transcriber",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag mr-[-15px] z-10 data-[state=active]:z-20",children:[n.jsx(is,{className:"h-4 w-4 mr-2"}),"Transcriber"]}),n.jsxs(ze,{value:"advanced",className:"flag-tab h-12 min-w-[140px] border-0 bg-white/5 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-violet-600 data-[state=active]:text-white text-white/60 hover:text-white hover:bg-white/10 transition-all clip-path-flag z-0",children:[n.jsx(ks,{className:"h-4 w-4 mr-2"}),"Advanced"]})]}),n.jsxs(Ye,{value:"model",className:"space-y-6",children:[n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"flex items-center text-white gap-2",children:[n.jsx(ma,{className:"h-5 w-5 text-indigo-400"}),"Model Configuration"]})}),n.jsxs(Me,{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Provider"}),n.jsxs(_e,{value:S(((T=e==null?void 0:e.model)==null?void 0:T.provider)||"","model"),onValueChange:z=>r("model.provider",z),children:[n.jsx(xe,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(we,{placeholder:((f=e==null?void 0:e.model)==null?void 0:f.provider)||"Select provider"})}),n.jsx(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:v.map(z=>n.jsx(ue,{value:z.id,children:n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("span",{children:z.name})})},z.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Model"}),n.jsxs(_e,{value:((L=e==null?void 0:e.model)==null?void 0:L.model)||"",onValueChange:z=>r("model.model",z),children:[n.jsx(xe,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(we,{placeholder:((I=e==null?void 0:e.model)==null?void 0:I.model)||"Select model"})}),n.jsx(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:E(((O=e==null?void 0:e.model)==null?void 0:O.provider)||"openai").map(z=>n.jsx(ue,{value:z.id,children:n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"font-medium text-white",children:z.name}),n.jsx("span",{className:"text-xs text-white/50",children:z.id})]})},z.id))})]})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Temperature"}),n.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",type:"number",min:"0",max:"1",step:"0.1",value:((Z=e==null?void 0:e.model)==null?void 0:Z.temperature)||.7,onChange:z=>r("model.temperature",parseFloat(z.target.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Max Tokens"}),n.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",type:"number",value:((K=e==null?void 0:e.model)==null?void 0:K.maxTokens)||1e3,onChange:z=>r("model.maxTokens",parseInt(z.target.value))})]})]})]})]}),n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"flex items-center text-white gap-2",children:[n.jsx(Xs,{className:"h-5 w-5 text-indigo-400"}),"System Prompt"]})}),n.jsx(Me,{children:n.jsx(ht,{className:"bg-white/5 border-white/10 text-white min-h-[300px]",value:((G=(A=(ae=e==null?void 0:e.model)==null?void 0:ae.messages)==null?void 0:A[0])==null?void 0:G.content)||(e==null?void 0:e.systemMessage)||"",onChange:z=>a(z.target.value),placeholder:"You are a helpful assistant..."})})]})]}),n.jsx(Ye,{value:"voice",className:"space-y-6",children:n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"flex items-center text-white gap-2",children:[n.jsx(js,{className:"h-5 w-5 text-indigo-400"}),"Voice Configuration"]})}),n.jsx(Me,{className:"space-y-6",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Voice Provider"}),n.jsxs(_e,{value:S(((x=e==null?void 0:e.voice)==null?void 0:x.provider)||"","voice"),onValueChange:z=>r("voice.provider",z),children:[n.jsx(xe,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(we,{})}),n.jsx(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:_.map(z=>n.jsx(ue,{value:z.id,children:z.name},z.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Voice ID"}),n.jsxs(_e,{value:((R=e==null?void 0:e.voice)==null?void 0:R.voiceId)||"",onValueChange:z=>r("voice.voiceId",z),children:[n.jsx(xe,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(we,{placeholder:"Select voice..."})}),n.jsx(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:j(((q=e==null?void 0:e.voice)==null?void 0:q.provider)||"11labs").map(z=>n.jsx(ue,{value:z.id,children:z.name},z.id))})]})]})]})})]})}),n.jsx(Ye,{value:"transcriber",className:"space-y-6",children:n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"flex items-center text-white gap-2",children:[n.jsx(is,{className:"h-5 w-5 text-indigo-400"}),"Transcriber"]})}),n.jsx(Me,{className:"space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"STT Provider"}),n.jsxs(_e,{value:((Ee=e==null?void 0:e.transcriber)==null?void 0:Ee.provider)||"deepgram",onValueChange:z=>r("transcriber.provider",z),children:[n.jsx(xe,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(we,{})}),n.jsx(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:N.map(z=>n.jsx(ue,{value:z.id,children:z.name},z.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Language"}),n.jsx(ye,{className:"bg-white/5 border-white/10 text-white mt-1",value:(($e=e==null?void 0:e.transcriber)==null?void 0:$e.language)||"en",onChange:z=>r("transcriber.language",z.target.value)})]})]})})]})}),n.jsx(Ye,{value:"advanced",className:"space-y-6",children:n.jsxs(Ae,{className:"neo-card border-none bg-white/5",children:[n.jsx(Pe,{children:n.jsx(Le,{children:"Call Settings"})}),n.jsx(Me,{className:"space-y-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Max Duration (sec)"}),n.jsx(ye,{type:"number",className:"bg-white/5 border-white/10 text-white mt-1",value:(e==null?void 0:e.maxDurationSeconds)||600,onChange:z=>r("maxDurationSeconds",parseInt(z.target.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-white/70",children:"Background Sound"}),n.jsxs(_e,{value:(e==null?void 0:e.backgroundSound)||"off",onValueChange:z=>r("backgroundSound",z),children:[n.jsx(xe,{className:"mt-1 bg-white/5 border-white/10 text-white",children:n.jsx(we,{})}),n.jsxs(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(ue,{value:"off",children:"Off"}),n.jsx(ue,{value:"office",children:"Office"}),n.jsx(ue,{value:"cafe",children:"Cafe"})]})]})]})]})})]})})]})})]})},lu=({agent:s,details:e,isLoading:t,onEdit:r,getInitials:a})=>{var c,d,m,v,_,N,E,j,y;const i=e&&typeof e=="object"&&"data"in e?e.data:e||{},l=(i==null?void 0:i.llm)||((c=i==null?void 0:i.response_engine)==null?void 0:c.llm_details)||((d=i==null?void 0:i.response_engine)==null?void 0:d.llm)||null;return t?n.jsxs("div",{className:"flex flex-col items-center justify-center py-20 min-h-[400px]",children:[n.jsx(Mt,{className:"h-10 w-10 animate-spin text-orange-500 mb-4"}),n.jsx("p",{className:"text-white/60",children:"Fetching Retell agent details..."})]}):n.jsxs("div",{className:"flex flex-col h-full bg-[#0b0f2e]",children:[n.jsxs("div",{className:"p-8 border-b border-white/10 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsx(tr,{className:"h-20 w-20 ring-4 ring-orange-500/20",children:n.jsx(sr,{className:"text-white bg-gradient-to-br from-orange-500/30 to-red-500/30 text-2xl font-bold",children:a(s.name||(i==null?void 0:i.agent_name)||s.name)})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:(i==null?void 0:i.agent_name)||s.name}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Nt,{variant:"outline",className:"border-orange-500/30 text-orange-400 bg-orange-500/5 px-3 py-1",children:"Retell AI Agent"}),n.jsx("span",{className:"text-sm text-white/40 font-mono",children:(i==null?void 0:i.agent_id)||s.agent_id||s.id})]})]})]}),n.jsxs(je,{onClick:r,className:"bg-orange-600 hover:bg-orange-700 text-white px-6",children:[n.jsx(ks,{className:"h-4 w-4 mr-2"}),"Edit Agent"]})]}),n.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[n.jsxs(Ae,{className:"neo-card bg-white/5 border-white/10",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(ks,{className:"h-6 w-6"}),"Core Configuration"]})}),n.jsxs(Me,{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice ID"}),n.jsx("p",{className:"text-white font-medium",children:(i==null?void 0:i.voice_id)||"Not set"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Model"}),n.jsx("p",{className:"text-white font-medium",children:((m=i==null?void 0:i.response_engine)==null?void 0:m.llm_id)||((v=i==null?void 0:i.response_engine)==null?void 0:v.llm)||"Retell LLM"})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Language"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vo,{className:"h-4 w-4 text-white/40"}),n.jsx("p",{className:"text-white",children:((i==null?void 0:i.language)||"en-US").toUpperCase()})]})]})]})]}),n.jsxs(Ae,{className:"neo-card bg-white/5 border-white/10",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(is,{className:"h-6 w-6"}),"Speech & Interaction"]})}),n.jsxs(Me,{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Sensitivity"}),n.jsx("p",{className:"text-white",children:(i==null?void 0:i.interruption_sensitivity)||"Default"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Denoising"}),n.jsx("p",{className:"text-white",children:i!=null&&i.opt_out_sensitive_data_storage?"Enabled":"Disabled"})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Ambient Sound"}),n.jsx("p",{className:"text-white capitalize",children:(i==null?void 0:i.ambient_sound)||"None"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Emotion"}),n.jsx("p",{className:"text-white",children:(i==null?void 0:i.voice_emotion)||"—"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Model"}),n.jsx("p",{className:"text-white",children:(i==null?void 0:i.voice_model)||"—"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Temp"}),n.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.voice_temperature)<"u"?String(i.voice_temperature):"—"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Voice Speed"}),n.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.voice_speed)<"u"?String(i.voice_speed):"—"})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:"text-xs text-white/40 uppercase font-bold tracking-wider",children:"Volume"}),n.jsx("p",{className:"text-white",children:typeof(i==null?void 0:i.volume)<"u"?String(i.volume):"—"})]})]})]})]}),n.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(Xs,{className:"h-6 w-6"}),"Agent Instructions"]})}),n.jsx(Me,{children:n.jsx("div",{className:"bg-black/20 p-6 rounded-xl border border-white/5 text-white/80 leading-relaxed whitespace-pre-wrap min-h-[150px]",children:l?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase",children:"General Prompt"}),n.jsx("div",{className:"text-white mt-1",children:l.general_prompt||l.instructions||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase",children:"Begin Message"}),n.jsx("div",{className:"text-white mt-1",children:l.begin_message||"—"})]})]}):n.jsx("div",{className:"text-white/60",children:((_=i==null?void 0:i.response_engine)==null?void 0:_.instructions)||(i==null?void 0:i.instructions)||"No instructions provided."})})})]}),l&&n.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(kc,{className:"h-5 w-5"}),"LLM Details"]})}),n.jsx(Me,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"LLM ID"}),n.jsx("div",{className:"text-white mt-1",children:l.llm_id||l.llmId||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Model"}),n.jsx("div",{className:"text-white mt-1",children:l.model||l.llm_model||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Temperature"}),n.jsx("div",{className:"text-white mt-1",children:typeof l.model_temperature<"u"?String(l.model_temperature):"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Start Speaker"}),n.jsx("div",{className:"text-white mt-1",children:l.start_speaker||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"KB Config"}),n.jsx("div",{className:"text-white mt-1",children:l.kb_config?`top_k: ${l.kb_config.top_k}, filter_score: ${l.kb_config.filter_score}`:"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Published"}),n.jsx("div",{className:"text-white mt-1",children:l.is_published?"Yes":"No"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Last Modified"}),n.jsx("div",{className:"text-white mt-1",children:l.last_modification_timestamp?new Date(l.last_modification_timestamp).toLocaleString():l.lastModified?new Date(l.lastModified).toLocaleString():"—"})]})]})})]}),n.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(Cc,{className:"h-5 w-5"}),"Telephony & Call Flow"]})}),n.jsx(Me,{children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Webhook URL"}),n.jsx("div",{className:"text-white mt-1",children:(i==null?void 0:i.webhook_url)||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Webhook Timeout"}),n.jsx("div",{className:"text-white mt-1",children:i!=null&&i.webhook_timeout_ms?`${i.webhook_timeout_ms} ms`:"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"IVR Action"}),n.jsx("div",{className:"text-white mt-1",children:((E=(N=i==null?void 0:i.ivr_option)==null?void 0:N.action)==null?void 0:E.type)||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Action"}),n.jsx("div",{className:"text-white mt-1",children:((y=(j=i==null?void 0:i.voicemail_option)==null?void 0:j.action)==null?void 0:y.type)||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Message"}),n.jsx("div",{className:"text-white mt-1",children:(i==null?void 0:i.voicemail_message)||"—"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Voicemail Timeout"}),n.jsx("div",{className:"text-white mt-1",children:i!=null&&i.voicemail_detection_timeout_ms?`${i.voicemail_detection_timeout_ms} ms`:"—"})]})]})})]}),n.jsxs(Ae,{className:"md:col-span-2 neo-card bg-white/5 border-white/10",children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"text-lg flex items-center gap-2 text-orange-400",children:[n.jsx(yo,{className:"h-5 w-5"}),"Post-call Analysis"]})}),n.jsx(Me,{children:n.jsxs("div",{className:"space-y-3",children:[n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold",children:"Model"}),n.jsx("div",{className:"text-white",children:(i==null?void 0:i.post_call_analysis_model)||"—"}),n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold mt-2",children:"Analysis Prompts"}),n.jsx("div",{className:"text-white whitespace-pre-wrap mt-1",children:(i==null?void 0:i.analysis_summary_prompt)||"—"}),n.jsx("div",{className:"text-xs text-white/40 uppercase font-bold mt-2",children:"Analysis Data Schema"}),n.jsx("div",{className:"mt-1",children:Array.isArray(i==null?void 0:i.post_call_analysis_data)&&i.post_call_analysis_data.length>0?i.post_call_analysis_data.map((S,C)=>n.jsxs("div",{className:"text-white/90 mb-2",children:[n.jsxs("div",{className:"font-medium",children:[S.name," ",n.jsxs("span",{className:"text-white/60",children:["(",S.type,")"]})]}),n.jsx("div",{className:"text-white/70 text-sm",children:S.description}),Array.isArray(S.examples)&&n.jsxs("div",{className:"text-white/60 text-sm mt-1",children:["Examples: ",S.examples.join(", ")]})]},C)):n.jsx("div",{className:"text-white/60",children:"No post-call data configured."})})]})})]})]})})]})},cu=({isOpen:s,onClose:e,onSuccess:t,agentId:r,initialData:a})=>{var _,N,E,j,y,S,C,T,f,L;const[i,l]=Q.useState(!1),[c,d]=Q.useState(null);Q.useEffect(()=>{var I,O,Z;a&&s&&d({agent_name:a.agent_name||a.name,voice_id:a.voice_id,response_engine:{type:"retell-llm",llm_id:(I=a.response_engine)==null?void 0:I.llm_id,instructions:(O=a.response_engine)==null?void 0:O.instructions},language:m(a),ambient_sound:a.ambient_sound||"none",interruption_sensitivity:a.interruption_sensitivity||.8,llm:a.llm||((Z=a.response_engine)==null?void 0:Z.llm_details)||null})},[a,s]);function m(I){return I.language||I.lang||"en-US"}const v=async I=>{var O,Z,K;I.preventDefault(),l(!0);try{const ae={agent_name:c.agent_name,voice_id:c.voice_id,language:c.language,ambient_sound:c.ambient_sound,interruption_sensitivity:c.interruption_sensitivity};if(await Bc(r,ae),c.llm&&((O=c.response_engine)!=null&&O.llm_id)){const A=String(c.response_engine.llm_id),G={model:c.llm.model,model_temperature:c.llm.model_temperature,general_prompt:c.llm.general_prompt,begin_message:c.llm.begin_message,start_speaker:c.llm.start_speaker,kb_config:c.llm.kb_config,is_published:typeof c.llm.is_published<"u"?c.llm.is_published:void 0};await $c(A,G)}H.success("Retell agent updated successfully"),t(),e()}catch(ae){console.error("Error updating Retell agent:",ae),H.error(((K=(Z=ae.response)==null?void 0:Z.data)==null?void 0:K.message)||"Failed to update Retell agent")}finally{l(!1)}};return c?n.jsx(Zt,{open:s,onOpenChange:e,children:n.jsxs(es,{className:"sm:max-w-[700px] bg-[#0b0f2e] border-white/10 text-white max-h-[90vh] overflow-y-auto neon-fire-scroll",children:[n.jsxs(ts,{children:[n.jsxs(ss,{className:"text-2xl font-bold flex items-center gap-2",children:[n.jsx(ks,{className:"h-6 w-6 text-orange-500"}),"Update Retell Agent"]}),n.jsxs(Xc,{className:"text-white/60",children:["Modify configuration for agent: ",c.agent_name]})]}),n.jsxs("form",{onSubmit:v,className:"space-y-6 py-4",children:[n.jsxs(wn,{defaultValue:"general",className:"w-full",children:[n.jsxs(Sn,{className:"bg-white/5 border border-white/10 p-1 w-full grid grid-cols-3",children:[n.jsx(ze,{value:"general",className:"data-[state=active]:bg-orange-600",children:"General"}),n.jsx(ze,{value:"voice",className:"data-[state=active]:bg-orange-600",children:"Voice"}),n.jsx(ze,{value:"llm",className:"data-[state=active]:bg-orange-600",children:"LLM & Prompt"})]}),n.jsxs(Ye,{value:"general",className:"space-y-4 pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{htmlFor:"name",children:"Agent Name"}),n.jsx(ye,{id:"name",value:c.agent_name,onChange:I=>d({...c,agent_name:I.target.value}),className:"bg-white/5 border-white/10 text-white"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{children:"Language"}),n.jsxs(_e,{value:c.language,onValueChange:I=>d({...c,language:I}),children:[n.jsx(xe,{className:"bg-white/5 border-white/10",children:n.jsx(we,{})}),n.jsxs(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(ue,{value:"en-US",children:"English (US)"}),n.jsx(ue,{value:"en-GB",children:"English (UK)"}),n.jsx(ue,{value:"es-ES",children:"Spanish"})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{children:"Ambient Sound"}),n.jsxs(_e,{value:c.ambient_sound,onValueChange:I=>d({...c,ambient_sound:I}),children:[n.jsx(xe,{className:"bg-white/5 border-white/10",children:n.jsx(we,{})}),n.jsxs(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(ue,{value:"none",children:"None"}),n.jsx(ue,{value:"coffee-shop",children:"Coffee Shop"}),n.jsx(ue,{value:"office",children:"Office"})]})]})]})]})]}),n.jsxs(Ye,{value:"voice",className:"space-y-4 pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{htmlFor:"voiceId",children:"Voice ID"}),n.jsx(ye,{id:"voiceId",value:c.voice_id,onChange:I=>d({...c,voice_id:I.target.value}),className:"bg-white/5 border-white/10 text-white font-mono",placeholder:"e.g. 11labs-Adrian"}),n.jsx("p",{className:"text-[10px] text-white/40",children:"Enter a valid Retell Voice ID or ElevenLabs Voice ID"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{children:"Interruption Sensitivity (0.0 - 1.0)"}),n.jsx(ye,{type:"number",step:"0.1",min:"0",max:"1",value:c.interruption_sensitivity,onChange:I=>d({...c,interruption_sensitivity:parseFloat(I.target.value)}),className:"bg-white/5 border-white/10"})]})]}),n.jsxs(Ye,{value:"llm",className:"space-y-4 pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{children:"Instructions (System Prompt)"}),n.jsx(ht,{value:c.response_engine.instructions||((_=c.llm)==null?void 0:_.general_prompt)||"",onChange:I=>d({...c,response_engine:{...c.response_engine,instructions:I.target.value},llm:{...c.llm,general_prompt:I.target.value}}),className:"bg-white/5 border-white/10 text-white min-h-[120px]",placeholder:"You are an AI assistant..."})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{children:"Begin Message"}),n.jsx(ye,{value:((N=c.llm)==null?void 0:N.begin_message)||"",onChange:I=>d({...c,llm:{...c.llm,begin_message:I.target.value}}),className:"bg-white/5 border-white/10 text-white"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{children:"Model"}),n.jsx(ye,{value:((E=c.llm)==null?void 0:E.model)||"",onChange:I=>d({...c,llm:{...c.llm,model:I.target.value}}),className:"bg-white/5 border-white/10 text-white"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{children:"Temperature"}),n.jsx(ye,{type:"number",step:"0.1",min:"0",max:"2",value:typeof((j=c.llm)==null?void 0:j.model_temperature)<"u"?String(c.llm.model_temperature):"",onChange:I=>d({...c,llm:{...c.llm,model_temperature:parseFloat(I.target.value)}}),className:"bg-white/5 border-white/10"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{children:"Start Speaker"}),n.jsxs(_e,{value:((y=c.llm)==null?void 0:y.start_speaker)||"agent",onValueChange:I=>d({...c,llm:{...c.llm,start_speaker:I}}),children:[n.jsx(xe,{className:"bg-white/5 border-white/10",children:n.jsx(we,{})}),n.jsxs(Se,{className:"bg-[#0b0f2e] border-white/10 text-white",children:[n.jsx(ue,{value:"agent",children:"Agent"}),n.jsx(ue,{value:"user",children:"User"})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(Y,{children:"KB Top K"}),n.jsx(ye,{type:"number",value:((C=(S=c.llm)==null?void 0:S.kb_config)==null?void 0:C.top_k)||"",onChange:I=>{var O;return d({...c,llm:{...c.llm,kb_config:{...((O=c.llm)==null?void 0:O.kb_config)||{},top_k:parseInt(I.target.value||"0")}}})},className:"bg-white/5 border-white/10"})]}),n.jsxs("div",{children:[n.jsx(Y,{children:"KB Filter Score"}),n.jsx(ye,{type:"number",step:"0.01",value:((f=(T=c.llm)==null?void 0:T.kb_config)==null?void 0:f.filter_score)||"",onChange:I=>{var O;return d({...c,llm:{...c.llm,kb_config:{...((O=c.llm)==null?void 0:O.kb_config)||{},filter_score:parseFloat(I.target.value||"0")}}})},className:"bg-white/5 border-white/10"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Y,{children:"Published"}),n.jsx(jt,{checked:!!((L=c.llm)!=null&&L.is_published),onCheckedChange:I=>d({...c,llm:{...c.llm,is_published:I}})})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-white/10",children:[n.jsx(je,{type:"button",variant:"ghost",onClick:e,disabled:i,children:"Cancel"}),n.jsx(je,{type:"submit",className:"bg-orange-600 hover:bg-orange-700",disabled:i,children:i?n.jsx(Mt,{className:"mr-2 h-4 w-4 animate-spin"}):"Save Changes"})]})]})]})}):null};var wo={};function Na(s,e){if(s==null)return{};var t,r,a=function(l,c){if(l==null)return{};var d={};for(var m in l)if({}.hasOwnProperty.call(l,m)){if(c.indexOf(m)!==-1)continue;d[m]=l[m]}return d}(s,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(r=0;r<i.length;r++)t=i[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(s,t)&&(a[t]=s[t])}return a}function He(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function de(s){return de=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(s)}function So(s){var e=function(t,r){if(de(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var i=a.call(t,r||"default");if(de(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(t)}(s,"string");return de(e)=="symbol"?e:e+""}function Ta(s,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(s,So(r.key),r)}}function Ke(s,e,t){return e&&Ta(s.prototype,e),t&&Ta(s,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function mr(s,e){if(e&&(de(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(s)}function nt(s){return nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nt(s)}function Cs(s,e){return Cs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Cs(s,e)}function pr(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),e&&Cs(s,e)}function ct(s,e,t){return(e=So(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Aa(s,e,t,r,a,i,l){try{var c=s[i](l),d=c.value}catch(m){return void t(m)}c.done?e(d):Promise.resolve(d).then(r,a)}function W(s){return function(){var e=this,t=arguments;return new Promise(function(r,a){var i=s.apply(e,t);function l(d){Aa(i,r,a,l,c,"next",d)}function c(d){Aa(i,r,a,l,c,"throw",d)}l(void 0)})}}function Ma(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,r=Array(e);t<e;t++)r[t]=s[t];return r}function Re(s,e){return function(t){if(Array.isArray(t))return t}(s)||function(t,r){var a=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(a!=null){var i,l,c,d,m=[],v=!0,_=!1;try{if(c=(a=a.call(t)).next,r===0){if(Object(a)!==a)return;v=!1}else for(;!(v=(i=c.call(a)).done)&&(m.push(i.value),m.length!==r);v=!0);}catch(N){_=!0,l=N}finally{try{if(!v&&a.return!=null&&(d=a.return(),Object(d)!==d))return}finally{if(_)throw l}}return m}}(s,e)||function(t,r){if(t){if(typeof t=="string")return Ma(t,r);var a={}.toString.call(t).slice(8,-1);return a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set"?Array.from(t):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ma(t,r):void 0}}(s,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function uu(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Ia,Os={exports:{}},Jr=function(){if(Ia)return Os.exports;Ia=1;var s,e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(y,S,C){return Function.prototype.apply.call(y,S,C)};s=e&&typeof e.ownKeys=="function"?e.ownKeys:Object.getOwnPropertySymbols?function(y){return Object.getOwnPropertyNames(y).concat(Object.getOwnPropertySymbols(y))}:function(y){return Object.getOwnPropertyNames(y)};var r=Number.isNaN||function(y){return y!=y};function a(){a.init.call(this)}Os.exports=a,Os.exports.once=function(y,S){return new Promise(function(C,T){function f(I){y.removeListener(S,L),T(I)}function L(){typeof y.removeListener=="function"&&y.removeListener("error",f),C([].slice.call(arguments))}j(y,S,L,{once:!0}),S!=="error"&&function(I,O,Z){typeof I.on=="function"&&j(I,"error",O,Z)}(y,f,{once:!0})})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var i=10;function l(y){if(typeof y!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof y)}function c(y){return y._maxListeners===void 0?a.defaultMaxListeners:y._maxListeners}function d(y,S,C,T){var f,L,I,O;if(l(C),(L=y._events)===void 0?(L=y._events=Object.create(null),y._eventsCount=0):(L.newListener!==void 0&&(y.emit("newListener",S,C.listener?C.listener:C),L=y._events),I=L[S]),I===void 0)I=L[S]=C,++y._eventsCount;else if(typeof I=="function"?I=L[S]=T?[C,I]:[I,C]:T?I.unshift(C):I.push(C),(f=c(y))>0&&I.length>f&&!I.warned){I.warned=!0;var Z=new Error("Possible EventEmitter memory leak detected. "+I.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");Z.name="MaxListenersExceededWarning",Z.emitter=y,Z.type=S,Z.count=I.length,O=Z,console&&console.warn&&console.warn(O)}return y}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(y,S,C){var T={fired:!1,wrapFn:void 0,target:y,type:S,listener:C},f=m.bind(T);return f.listener=C,T.wrapFn=f,f}function _(y,S,C){var T=y._events;if(T===void 0)return[];var f=T[S];return f===void 0?[]:typeof f=="function"?C?[f.listener||f]:[f]:C?function(L){for(var I=new Array(L.length),O=0;O<I.length;++O)I[O]=L[O].listener||L[O];return I}(f):E(f,f.length)}function N(y){var S=this._events;if(S!==void 0){var C=S[y];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}function E(y,S){for(var C=new Array(S),T=0;T<S;++T)C[T]=y[T];return C}function j(y,S,C,T){if(typeof y.on=="function")T.once?y.once(S,C):y.on(S,C);else{if(typeof y.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof y);y.addEventListener(S,function f(L){T.once&&y.removeEventListener(S,f),C(L)})}}return Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(y){if(typeof y!="number"||y<0||r(y))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+y+".");i=y}}),a.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(y){if(typeof y!="number"||y<0||r(y))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+y+".");return this._maxListeners=y,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(y){for(var S=[],C=1;C<arguments.length;C++)S.push(arguments[C]);var T=y==="error",f=this._events;if(f!==void 0)T=T&&f.error===void 0;else if(!T)return!1;if(T){var L;if(S.length>0&&(L=S[0]),L instanceof Error)throw L;var I=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw I.context=L,I}var O=f[y];if(O===void 0)return!1;if(typeof O=="function")t(O,this,S);else{var Z=O.length,K=E(O,Z);for(C=0;C<Z;++C)t(K[C],this,S)}return!0},a.prototype.addListener=function(y,S){return d(this,y,S,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(y,S){return d(this,y,S,!0)},a.prototype.once=function(y,S){return l(S),this.on(y,v(this,y,S)),this},a.prototype.prependOnceListener=function(y,S){return l(S),this.prependListener(y,v(this,y,S)),this},a.prototype.removeListener=function(y,S){var C,T,f,L,I;if(l(S),(T=this._events)===void 0)return this;if((C=T[y])===void 0)return this;if(C===S||C.listener===S)--this._eventsCount==0?this._events=Object.create(null):(delete T[y],T.removeListener&&this.emit("removeListener",y,C.listener||S));else if(typeof C!="function"){for(f=-1,L=C.length-1;L>=0;L--)if(C[L]===S||C[L].listener===S){I=C[L].listener,f=L;break}if(f<0)return this;f===0?C.shift():function(O,Z){for(;Z+1<O.length;Z++)O[Z]=O[Z+1];O.pop()}(C,f),C.length===1&&(T[y]=C[0]),T.removeListener!==void 0&&this.emit("removeListener",y,I||S)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(y){var S,C,T;if((C=this._events)===void 0)return this;if(C.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):C[y]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete C[y]),this;if(arguments.length===0){var f,L=Object.keys(C);for(T=0;T<L.length;++T)(f=L[T])!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(S=C[y])=="function")this.removeListener(y,S);else if(S!==void 0)for(T=S.length-1;T>=0;T--)this.removeListener(y,S[T]);return this},a.prototype.listeners=function(y){return _(this,y,!0)},a.prototype.rawListeners=function(y){return _(this,y,!1)},a.listenerCount=function(y,S){return typeof y.listenerCount=="function"?y.listenerCount(S):N.call(y,S)},a.prototype.listenerCount=N,a.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]},Os.exports}(),Ps=uu(Jr),Oa=Object.prototype.hasOwnProperty;function Pa(s,e,t){for(t of s.keys())if(Ue(t,e))return t}function Ue(s,e){var t,r,a;if(s===e)return!0;if(s&&e&&(t=s.constructor)===e.constructor){if(t===Date)return s.getTime()===e.getTime();if(t===RegExp)return s.toString()===e.toString();if(t===Array){if((r=s.length)===e.length)for(;r--&&Ue(s[r],e[r]););return r===-1}if(t===Set){if(s.size!==e.size)return!1;for(r of s)if((a=r)&&typeof a=="object"&&!(a=Pa(e,a))||!e.has(a))return!1;return!0}if(t===Map){if(s.size!==e.size)return!1;for(r of s)if((a=r[0])&&typeof a=="object"&&!(a=Pa(e,a))||!Ue(r[1],e.get(a)))return!1;return!0}if(t===ArrayBuffer)s=new Uint8Array(s),e=new Uint8Array(e);else if(t===DataView){if((r=s.byteLength)===e.byteLength)for(;r--&&s.getInt8(r)===e.getInt8(r););return r===-1}if(ArrayBuffer.isView(s)){if((r=s.byteLength)===e.byteLength)for(;r--&&s[r]===e[r];);return r===-1}if(!t||typeof s=="object"){for(t in r=0,s)if(Oa.call(s,t)&&++r&&!Oa.call(e,t)||!(t in e)||!Ue(s[t],e[t]))return!1;return Object.keys(e).length===r}}return s!=s&&e!=e}const du={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},jo={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},Ne={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},Ve={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},kt={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class M{static getFirstMatch(e,t){const r=t.match(e);return r&&r.length>0&&r[1]||""}static getSecondMatch(e,t){const r=t.match(e);return r&&r.length>1&&r[2]||""}static matchAndReturnConst(e,t,r){if(e.test(t))return r}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const t=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(t.push(0),t[0]===10)switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const t=e.split(".").splice(0,2).map(r=>parseInt(r,10)||0);if(t.push(0),!(t[0]===1&&t[1]<5))return t[0]===1&&t[1]<6?"Cupcake":t[0]===1&&t[1]>=6?"Donut":t[0]===2&&t[1]<2?"Eclair":t[0]===2&&t[1]===2?"Froyo":t[0]===2&&t[1]>2?"Gingerbread":t[0]===3?"Honeycomb":t[0]===4&&t[1]<1?"Ice Cream Sandwich":t[0]===4&&t[1]<4?"Jelly Bean":t[0]===4&&t[1]>=4?"KitKat":t[0]===5?"Lollipop":t[0]===6?"Marshmallow":t[0]===7?"Nougat":t[0]===8?"Oreo":t[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,t,r=!1){const a=M.getVersionPrecision(e),i=M.getVersionPrecision(t);let l=Math.max(a,i),c=0;const d=M.map([e,t],m=>{const v=l-M.getVersionPrecision(m),_=m+new Array(v+1).join(".0");return M.map(_.split("."),N=>new Array(20-N.length).join("0")+N).reverse()});for(r&&(c=l-Math.min(a,i)),l-=1;l>=c;){if(d[0][l]>d[1][l])return 1;if(d[0][l]===d[1][l]){if(l===c)return 0;l-=1}else if(d[0][l]<d[1][l])return-1}}static map(e,t){const r=[];let a;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(a=0;a<e.length;a+=1)r.push(t(e[a]));return r}static find(e,t){let r,a;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,a=e.length;r<a;r+=1){const i=e[r];if(t(i,r))return i}}static assign(e,...t){const r=e;let a,i;if(Object.assign)return Object.assign(e,...t);for(a=0,i=t.length;a<i;a+=1){const l=t[a];typeof l=="object"&&l!==null&&Object.keys(l).forEach(c=>{r[c]=l[c]})}return e}static getBrowserAlias(e){return du[e]}static getBrowserTypeByAlias(e){return jo[e]||""}}const fe=/version\/(\d+(\.?_?\d+)+)/i,hu=[{test:[/googlebot/i],describe(s){const e={name:"Googlebot"},t=M.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/opera/i],describe(s){const e={name:"Opera"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/opr\/|opios/i],describe(s){const e={name:"Opera"},t=M.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/SamsungBrowser/i],describe(s){const e={name:"Samsung Internet for Android"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/Whale/i],describe(s){const e={name:"NAVER Whale Browser"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/MZBrowser/i],describe(s){const e={name:"MZ Browser"},t=M.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/focus/i],describe(s){const e={name:"Focus"},t=M.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/swing/i],describe(s){const e={name:"Swing"},t=M.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/coast/i],describe(s){const e={name:"Opera Coast"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(s){const e={name:"Opera Touch"},t=M.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/yabrowser/i],describe(s){const e={name:"Yandex Browser"},t=M.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/ucbrowser/i],describe(s){const e={name:"UC Browser"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/Maxthon|mxios/i],describe(s){const e={name:"Maxthon"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/epiphany/i],describe(s){const e={name:"Epiphany"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/puffin/i],describe(s){const e={name:"Puffin"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/sleipnir/i],describe(s){const e={name:"Sleipnir"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/k-meleon/i],describe(s){const e={name:"K-Meleon"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/micromessenger/i],describe(s){const e={name:"WeChat"},t=M.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/qqbrowser/i],describe(s){const e={name:/qqbrowserlite/i.test(s)?"QQ Browser Lite":"QQ Browser"},t=M.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/msie|trident/i],describe(s){const e={name:"Internet Explorer"},t=M.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/\sedg\//i],describe(s){const e={name:"Microsoft Edge"},t=M.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/edg([ea]|ios)/i],describe(s){const e={name:"Microsoft Edge"},t=M.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/vivaldi/i],describe(s){const e={name:"Vivaldi"},t=M.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/seamonkey/i],describe(s){const e={name:"SeaMonkey"},t=M.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/sailfish/i],describe(s){const e={name:"Sailfish"},t=M.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,s);return t&&(e.version=t),e}},{test:[/silk/i],describe(s){const e={name:"Amazon Silk"},t=M.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/phantom/i],describe(s){const e={name:"PhantomJS"},t=M.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/slimerjs/i],describe(s){const e={name:"SlimerJS"},t=M.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(s){const e={name:"BlackBerry"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/(web|hpw)[o0]s/i],describe(s){const e={name:"WebOS Browser"},t=M.getFirstMatch(fe,s)||M.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/bada/i],describe(s){const e={name:"Bada"},t=M.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/tizen/i],describe(s){const e={name:"Tizen"},t=M.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/qupzilla/i],describe(s){const e={name:"QupZilla"},t=M.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/firefox|iceweasel|fxios/i],describe(s){const e={name:"Firefox"},t=M.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/electron/i],describe(s){const e={name:"Electron"},t=M.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/MiuiBrowser/i],describe(s){const e={name:"Miui"},t=M.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/chromium/i],describe(s){const e={name:"Chromium"},t=M.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,s)||M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/chrome|crios|crmo/i],describe(s){const e={name:"Chrome"},t=M.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/GSA/i],describe(s){const e={name:"Google Search"},t=M.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test(s){const e=!s.test(/like android/i),t=s.test(/android/i);return e&&t},describe(s){const e={name:"Android Browser"},t=M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/playstation 4/i],describe(s){const e={name:"PlayStation 4"},t=M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/safari|applewebkit/i],describe(s){const e={name:"Safari"},t=M.getFirstMatch(fe,s);return t&&(e.version=t),e}},{test:[/.*/i],describe(s){const e=s.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:M.getFirstMatch(e,s),version:M.getSecondMatch(e,s)}}}];var mu=[{test:[/Roku\/DVP/],describe(s){const e=M.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,s);return{name:Ve.Roku,version:e}}},{test:[/windows phone/i],describe(s){const e=M.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,s);return{name:Ve.WindowsPhone,version:e}}},{test:[/windows /i],describe(s){const e=M.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,s),t=M.getWindowsVersionName(e);return{name:Ve.Windows,version:e,versionName:t}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(s){const e={name:Ve.iOS},t=M.getSecondMatch(/(Version\/)(\d[\d.]+)/,s);return t&&(e.version=t),e}},{test:[/macintosh/i],describe(s){const e=M.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,s).replace(/[_\s]/g,"."),t=M.getMacOSVersionName(e),r={name:Ve.MacOS,version:e};return t&&(r.versionName=t),r}},{test:[/(ipod|iphone|ipad)/i],describe(s){const e=M.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,s).replace(/[_\s]/g,".");return{name:Ve.iOS,version:e}}},{test(s){const e=!s.test(/like android/i),t=s.test(/android/i);return e&&t},describe(s){const e=M.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,s),t=M.getAndroidVersionName(e),r={name:Ve.Android,version:e};return t&&(r.versionName=t),r}},{test:[/(web|hpw)[o0]s/i],describe(s){const e=M.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,s),t={name:Ve.WebOS};return e&&e.length&&(t.version=e),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(s){const e=M.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,s)||M.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,s)||M.getFirstMatch(/\bbb(\d+)/i,s);return{name:Ve.BlackBerry,version:e}}},{test:[/bada/i],describe(s){const e=M.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,s);return{name:Ve.Bada,version:e}}},{test:[/tizen/i],describe(s){const e=M.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,s);return{name:Ve.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:Ve.Linux})},{test:[/CrOS/],describe:()=>({name:Ve.ChromeOS})},{test:[/PlayStation 4/],describe(s){const e=M.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,s);return{name:Ve.PlayStation4,version:e}}}],pu=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(s){const e=M.getFirstMatch(/(can-l01)/i,s)&&"Nova",t={type:Ne.mobile,vendor:"Huawei"};return e&&(t.model=e),t}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:Ne.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:Ne.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:Ne.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:Ne.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:Ne.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:Ne.tablet})},{test(s){const e=s.test(/ipod|iphone/i),t=s.test(/like (ipod|iphone)/i);return e&&!t},describe(s){const e=M.getFirstMatch(/(ipod|iphone)/i,s);return{type:Ne.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:Ne.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:Ne.mobile})},{test:s=>s.getBrowserName(!0)==="blackberry",describe:()=>({type:Ne.mobile,vendor:"BlackBerry"})},{test:s=>s.getBrowserName(!0)==="bada",describe:()=>({type:Ne.mobile})},{test:s=>s.getBrowserName()==="windows phone",describe:()=>({type:Ne.mobile,vendor:"Microsoft"})},{test(s){const e=Number(String(s.getOSVersion()).split(".")[0]);return s.getOSName(!0)==="android"&&e>=3},describe:()=>({type:Ne.tablet})},{test:s=>s.getOSName(!0)==="android",describe:()=>({type:Ne.mobile})},{test:s=>s.getOSName(!0)==="macos",describe:()=>({type:Ne.desktop,vendor:"Apple"})},{test:s=>s.getOSName(!0)==="windows",describe:()=>({type:Ne.desktop})},{test:s=>s.getOSName(!0)==="linux",describe:()=>({type:Ne.desktop})},{test:s=>s.getOSName(!0)==="playstation 4",describe:()=>({type:Ne.tv})},{test:s=>s.getOSName(!0)==="roku",describe:()=>({type:Ne.tv})}],fu=[{test:s=>s.getBrowserName(!0)==="microsoft edge",describe(s){if(/\sedg\//i.test(s))return{name:kt.Blink};const e=M.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,s);return{name:kt.EdgeHTML,version:e}}},{test:[/trident/i],describe(s){const e={name:kt.Trident},t=M.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:s=>s.test(/presto/i),describe(s){const e={name:kt.Presto},t=M.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test(s){const e=s.test(/gecko/i),t=s.test(/like gecko/i);return e&&!t},describe(s){const e={name:kt.Gecko},t=M.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:kt.Blink})},{test:[/(apple)?webkit/i],describe(s){const e={name:kt.WebKit},t=M.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,s);return t&&(e.version=t),e}}];class La{constructor(e,t=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},t!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=M.find(hu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=M.find(mu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:t}=this.getOS();return e?String(t).toLowerCase()||"":t||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:t}=this.getPlatform();return e?String(t).toLowerCase()||"":t||""}parsePlatform(){this.parsedResult.platform={};const e=M.find(pu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=M.find(fu,t=>{if(typeof t.test=="function")return t.test(this);if(t.test instanceof Array)return t.test.some(r=>this.test(r));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return M.assign({},this.parsedResult)}satisfies(e){const t={};let r=0;const a={};let i=0;if(Object.keys(e).forEach(l=>{const c=e[l];typeof c=="string"?(a[l]=c,i+=1):typeof c=="object"&&(t[l]=c,r+=1)}),r>0){const l=Object.keys(t),c=M.find(l,m=>this.isOS(m));if(c){const m=this.satisfies(t[c]);if(m!==void 0)return m}const d=M.find(l,m=>this.isPlatform(m));if(d){const m=this.satisfies(t[d]);if(m!==void 0)return m}}if(i>0){const l=Object.keys(a),c=M.find(l,d=>this.isBrowser(d,!0));if(c!==void 0)return this.compareVersion(a[c])}}isBrowser(e,t=!1){const r=this.getBrowserName().toLowerCase();let a=e.toLowerCase();const i=M.getBrowserTypeByAlias(a);return t&&i&&(a=i.toLowerCase()),a===r}compareVersion(e){let t=[0],r=e,a=!1;const i=this.getBrowserVersion();if(typeof i=="string")return e[0]===">"||e[0]==="<"?(r=e.substr(1),e[1]==="="?(a=!0,r=e.substr(2)):t=[],e[0]===">"?t.push(1):t.push(-1)):e[0]==="="?r=e.substr(1):e[0]==="~"&&(a=!0,r=e.substr(1)),t.indexOf(M.compareVersions(i,r,a))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,t=!1){return this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(t=>this.is(t))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class gu{static getParser(e,t=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new La(e,t)}static parse(e){return new La(e).getResult()}static get BROWSER_MAP(){return jo}static get ENGINE_MAP(){return kt}static get OS_MAP(){return Ve}static get PLATFORMS_MAP(){return Ne}}function fr(){return Date.now()+Math.random().toString()}function fs(){throw new Error("Method must be implemented in subclass")}function ko(s,e){return e!=null&&e.proxyUrl?e.proxyUrl+(e.proxyUrl.slice(-1)==="/"?"":"/")+s.substring(8):s}function rr(s){return s!=null&&s.callObjectBundleUrlOverride?s.callObjectBundleUrlOverride:ko("https://c.daily.co/call-machine/versioned/".concat("0.80.0","/static/call-machine-object-bundle.js"),s)}function nr(s){try{new URL(s)}catch{return!1}return!0}const ve=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,qt="8.55.0",me=globalThis;function ar(s,e,t){const r=me,a=r.__SENTRY__=r.__SENTRY__||{},i=a[qt]=a[qt]||{};return i[s]||(i[s]=e())}const Wt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Gr=["debug","info","warn","error","log","assert","trace"],ir={};function Ns(s){if(!("console"in me))return s();const e=me.console,t={},r=Object.keys(ir);r.forEach(a=>{const i=ir[a];t[a]=e[a],e[a]=i});try{return s()}finally{r.forEach(a=>{e[a]=t[a]})}}const X=ar("logger",function(){let s=!1;const e={enable:()=>{s=!0},disable:()=>{s=!1},isEnabled:()=>s};return Wt?Gr.forEach(t=>{e[t]=(...r)=>{s&&Ns(()=>{me.console[t](`Sentry Logger [${t}]:`,...r)})}}):Gr.forEach(t=>{e[t]=()=>{}}),e}),Ut="?",Da=/\(error: (.*)\)/,Ra=/captureMessage|captureException/;function Ls(s){return s[s.length-1]||{}}const Fa="<anonymous>";function It(s){try{return s&&typeof s=="function"&&s.name||Fa}catch{return Fa}}function Va(s){const e=s.exception;if(e){const t=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&t.push(...r.stacktrace.frames)}),t}catch{return}}}const zs={},Ua={};function Bt(s,e){zs[s]=zs[s]||[],zs[s].push(e)}function $t(s,e){if(!Ua[s]){Ua[s]=!0;try{e()}catch(t){Wt&&X.error(`Error while instrumenting ${s}`,t)}}}function rt(s,e){const t=s&&zs[s];if(t)for(const r of t)try{r(e)}catch(a){Wt&&X.error(`Error while triggering instrumentation handler.
Type: ${s}
Name: ${It(r)}
Error:`,a)}}let jr=null;function vu(){jr=me.onerror,me.onerror=function(s,e,t,r,a){return rt("error",{column:r,error:a,line:t,msg:s,url:e}),!!jr&&jr.apply(this,arguments)},me.onerror.__SENTRY_INSTRUMENTED__=!0}let kr=null;function yu(){kr=me.onunhandledrejection,me.onunhandledrejection=function(s){return rt("unhandledrejection",s),!kr||kr.apply(this,arguments)},me.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function gr(){return jn(me),me}function jn(s){const e=s.__SENTRY__=s.__SENTRY__||{};return e.version=e.version||qt,e[qt]=e[qt]||{}}const Co=Object.prototype.toString;function kn(s){switch(Co.call(s)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Jt(s,Error)}}function hs(s,e){return Co.call(s)===`[object ${e}]`}function Eo(s){return hs(s,"ErrorEvent")}function qa(s){return hs(s,"DOMError")}function ft(s){return hs(s,"String")}function Cn(s){return typeof s=="object"&&s!==null&&"__sentry_template_string__"in s&&"__sentry_template_values__"in s}function zr(s){return s===null||Cn(s)||typeof s!="object"&&typeof s!="function"}function os(s){return hs(s,"Object")}function vr(s){return typeof Event<"u"&&Jt(s,Event)}function yr(s){return!!(s&&s.then&&typeof s.then=="function")}function Jt(s,e){try{return s instanceof e}catch{return!1}}function No(s){return!(typeof s!="object"||s===null||!s.__isVue&&!s._isVue)}const En=me;function To(s,e={}){if(!s)return"<unknown>";try{let t=s;const r=5,a=[];let i=0,l=0;const c=" > ",d=c.length;let m;const v=Array.isArray(e)?e:e.keyAttrs,_=!Array.isArray(e)&&e.maxStringLength||80;for(;t&&i++<r&&(m=bu(t,v),!(m==="html"||i>1&&l+a.length*d+m.length>=_));)a.push(m),l+=m.length,t=t.parentNode;return a.reverse().join(c)}catch{return"<unknown>"}}function bu(s,e){const t=s,r=[];if(!t||!t.tagName)return"";if(En.HTMLElement&&t instanceof HTMLElement&&t.dataset){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}r.push(t.tagName.toLowerCase());const a=e&&e.length?e.filter(l=>t.getAttribute(l)).map(l=>[l,t.getAttribute(l)]):null;if(a&&a.length)a.forEach(l=>{r.push(`[${l[0]}="${l[1]}"]`)});else{t.id&&r.push(`#${t.id}`);const l=t.className;if(l&&ft(l)){const c=l.split(/\s+/);for(const d of c)r.push(`.${d}`)}}const i=["aria-label","type","name","title","alt"];for(const l of i){const c=t.getAttribute(l);c&&r.push(`[${l}="${c}"]`)}return r.join("")}function rs(s,e=0){return typeof s!="string"||e===0||s.length<=e?s:`${s.slice(0,e)}...`}function Ba(s,e){if(!Array.isArray(s))return"";const t=[];for(let r=0;r<s.length;r++){const a=s[r];try{No(a)?t.push("[VueViewModel]"):t.push(String(a))}catch{t.push("[value cannot be serialized]")}}return t.join(e)}function _u(s,e,t=!1){return!!ft(s)&&(hs(e,"RegExp")?e.test(s):!!ft(e)&&(t?s===e:s.includes(e)))}function Ds(s,e=[],t=!1){return e.some(r=>_u(s,r,t))}function We(s,e,t){if(!(e in s))return;const r=s[e],a=t(r);typeof a=="function"&&Ao(a,r);try{s[e]=a}catch{Wt&&X.log(`Failed to replace method "${e}" in object`,s)}}function Gt(s,e,t){try{Object.defineProperty(s,e,{value:t,writable:!0,configurable:!0})}catch{Wt&&X.log(`Failed to add non-enumerable property "${e}" to object`,s)}}function Ao(s,e){try{const t=e.prototype||{};s.prototype=e.prototype=t,Gt(s,"__sentry_original__",e)}catch{}}function Nn(s){return s.__sentry_original__}function Mo(s){if(kn(s))return{message:s.message,name:s.name,stack:s.stack,...Ja(s)};if(vr(s)){const e={type:s.type,target:$a(s.target),currentTarget:$a(s.currentTarget),...Ja(s)};return typeof CustomEvent<"u"&&Jt(s,CustomEvent)&&(e.detail=s.detail),e}return s}function $a(s){try{return e=s,typeof Element<"u"&&Jt(e,Element)?To(s):Object.prototype.toString.call(s)}catch{return"<unknown>"}var e}function Ja(s){if(typeof s=="object"&&s!==null){const e={};for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(e[t]=s[t]);return e}return{}}function Xe(s){return Yr(s,new Map)}function Yr(s,e){if(function(t){if(!os(t))return!1;try{const r=Object.getPrototypeOf(t).constructor.name;return!r||r==="Object"}catch{return!0}}(s)){const t=e.get(s);if(t!==void 0)return t;const r={};e.set(s,r);for(const a of Object.getOwnPropertyNames(s))s[a]!==void 0&&(r[a]=Yr(s[a],e));return r}if(Array.isArray(s)){const t=e.get(s);if(t!==void 0)return t;const r=[];return e.set(s,r),s.forEach(a=>{r.push(Yr(a,e))}),r}return s}function Ts(){return Date.now()/1e3}const vt=function(){const{performance:s}=me;if(!s||!s.now)return Ts;const e=Date.now()-s.now(),t=s.timeOrigin==null?e:s.timeOrigin;return()=>(t+s.now())/1e3}();function Ze(){const s=me,e=s.crypto||s.msCrypto;let t=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(t=()=>{const r=new Uint8Array(1);return e.getRandomValues(r),r[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,r=>(r^(15&t())>>r/4).toString(16))}function Io(s){return s.exception&&s.exception.values?s.exception.values[0]:void 0}function Et(s){const{message:e,event_id:t}=s;if(e)return e;const r=Io(s);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||t||"<unknown>":t||"<unknown>"}function Wr(s,e,t){const r=s.exception=s.exception||{},a=r.values=r.values||[],i=a[0]=a[0]||{};i.value||(i.value=e||""),i.type||(i.type="Error")}function ls(s,e){const t=Io(s);if(!t)return;const r=t.mechanism;if(t.mechanism={type:"generic",handled:!0,...r,...e},e&&"data"in e){const a={...r&&r.data,...e.data};t.mechanism.data=a}}function Ga(s){if(function(e){try{return e.__sentry_captured__}catch{}}(s))return!0;try{Gt(s,"__sentry_captured__",!0)}catch{}return!1}var mt;function zt(s){return new Qe(e=>{e(s)})}function or(s){return new Qe((e,t)=>{t(s)})}(()=>{const{performance:s}=me;!s||!s.now||(s.now(),s.timing&&s.timing.navigationStart)})(),function(s){s[s.PENDING=0]="PENDING",s[s.RESOLVED=1]="RESOLVED",s[s.REJECTED=2]="REJECTED"}(mt||(mt={}));class Qe{constructor(e){Qe.prototype.__init.call(this),Qe.prototype.__init2.call(this),Qe.prototype.__init3.call(this),Qe.prototype.__init4.call(this),this._state=mt.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(t){this._reject(t)}}then(e,t){return new Qe((r,a)=>{this._handlers.push([!1,i=>{if(e)try{r(e(i))}catch(l){a(l)}else r(i)},i=>{if(t)try{r(t(i))}catch(l){a(l)}else a(i)}]),this._executeHandlers()})}catch(e){return this.then(t=>t,e)}finally(e){return new Qe((t,r)=>{let a,i;return this.then(l=>{i=!1,a=l,e&&e()},l=>{i=!0,a=l,e&&e()}).then(()=>{i?r(a):t(a)})})}__init(){this._resolve=e=>{this._setResult(mt.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(mt.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{this._state===mt.PENDING&&(yr(t)?t.then(this._resolve,this._reject):(this._state=e,this._value=t,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===mt.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(t=>{t[0]||(this._state===mt.RESOLVED&&t[1](this._value),this._state===mt.REJECTED&&t[2](this._value),t[0]=!0)})}}}function xu(s){const e=vt(),t={sid:Ze(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(r){return Xe({sid:`${r.sid}`,init:r.init,started:new Date(1e3*r.started).toISOString(),timestamp:new Date(1e3*r.timestamp).toISOString(),status:r.status,errors:r.errors,did:typeof r.did=="number"||typeof r.did=="string"?`${r.did}`:void 0,duration:r.duration,abnormal_mechanism:r.abnormal_mechanism,attrs:{release:r.release,environment:r.environment,ip_address:r.ipAddress,user_agent:r.userAgent}})}(t)};return s&&cs(t,s),t}function cs(s,e={}){if(e.user&&(!s.ipAddress&&e.user.ip_address&&(s.ipAddress=e.user.ip_address),s.did||e.did||(s.did=e.user.id||e.user.email||e.user.username)),s.timestamp=e.timestamp||vt(),e.abnormal_mechanism&&(s.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(s.ignoreDuration=e.ignoreDuration),e.sid&&(s.sid=e.sid.length===32?e.sid:Ze()),e.init!==void 0&&(s.init=e.init),!s.did&&e.did&&(s.did=`${e.did}`),typeof e.started=="number"&&(s.started=e.started),s.ignoreDuration)s.duration=void 0;else if(typeof e.duration=="number")s.duration=e.duration;else{const t=s.timestamp-s.started;s.duration=t>=0?t:0}e.release&&(s.release=e.release),e.environment&&(s.environment=e.environment),!s.ipAddress&&e.ipAddress&&(s.ipAddress=e.ipAddress),!s.userAgent&&e.userAgent&&(s.userAgent=e.userAgent),typeof e.errors=="number"&&(s.errors=e.errors),e.status&&(s.status=e.status)}function za(){return Ze()}function Hr(){return Ze().substring(16)}function br(s,e,t=2){if(!e||typeof e!="object"||t<=0)return e;if(s&&e&&Object.keys(e).length===0)return s;const r={...s};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=br(r[a],e[a],t-1));return r}const Kr="_sentrySpan";function Ya(s,e){e?Gt(s,Kr,e):delete s[Kr]}function Wa(s){return s[Kr]}class Tn{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:za(),spanId:Hr()}}clone(){const e=new Tn;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Ya(e,Wa(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&cs(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return t===null?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t=typeof e=="function"?e(this):e,[r,a]=t instanceof Ot?[t.getScopeData(),t.getRequestSession()]:os(t)?[e,e.requestSession]:[],{tags:i,extra:l,user:c,contexts:d,level:m,fingerprint:v=[],propagationContext:_}=r||{};return this._tags={...this._tags,...i},this._extra={...this._extra,...l},this._contexts={...this._contexts,...d},c&&Object.keys(c).length&&(this._user=c),m&&(this._level=m),v.length&&(this._fingerprint=v),_&&(this._propagationContext=_),a&&(this._requestSession=a),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Ya(this,void 0),this._attachments=[],this.setPropagationContext({traceId:za()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const r=typeof t=="number"?t:100;if(r<=0)return this;const a={timestamp:Ts(),...e};return this._breadcrumbs.push(a),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Wa(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=br(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:Hr(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,t){const r=t&&t.event_id?t.event_id:Ze();if(!this._client)return X.warn("No client configured on scope - will not capture exception!"),r;const a=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:a,...t,event_id:r},this),r}captureMessage(e,t,r){const a=r&&r.event_id?r.event_id:Ze();if(!this._client)return X.warn("No client configured on scope - will not capture message!"),a;const i=new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:i,...r,event_id:a},this),a}captureEvent(e,t){const r=t&&t.event_id?t.event_id:Ze();return this._client?(this._client.captureEvent(e,{...t,event_id:r},this),r):(X.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const Ot=Tn;class wu{constructor(e,t){let r,a;r=e||new Ot,a=t||new Ot,this._stack=[{scope:r}],this._isolationScope=a}withScope(e){const t=this._pushScope();let r;try{r=e(t)}catch(a){throw this._popScope(),a}return yr(r)?r.then(a=>(this._popScope(),a),a=>{throw this._popScope(),a}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function us(){const s=jn(gr());return s.stack=s.stack||new wu(ar("defaultCurrentScope",()=>new Ot),ar("defaultIsolationScope",()=>new Ot))}function Su(s){return us().withScope(s)}function ju(s,e){const t=us();return t.withScope(()=>(t.getStackTop().scope=s,e(s)))}function Ha(s){return us().withScope(()=>s(us().getIsolationScope()))}function An(s){const e=jn(s);return e.acs?e.acs:{withIsolationScope:Ha,withScope:Su,withSetScope:ju,withSetIsolationScope:(t,r)=>Ha(r),getCurrentScope:()=>us().getScope(),getIsolationScope:()=>us().getIsolationScope()}}function Ht(){return An(gr()).getCurrentScope()}function As(){return An(gr()).getIsolationScope()}function De(){return Ht().getClient()}function ku(s){const e=s.getPropagationContext(),{traceId:t,spanId:r,parentSpanId:a}=e;return Xe({trace_id:t,span_id:r,parent_span_id:a})}function Cu(s){const e=s._sentryMetrics;if(!e)return;const t={};for(const[,[r,a]]of e)(t[r]||(t[r]=[])).push(Xe(a));return t}const Eu=/^sentry-/;function Nu(s){const e=function(r){if(!(!r||!ft(r)&&!Array.isArray(r)))return Array.isArray(r)?r.reduce((a,i)=>{const l=Ka(i);return Object.entries(l).forEach(([c,d])=>{a[c]=d}),a},{}):Ka(r)}(s);if(!e)return;const t=Object.entries(e).reduce((r,[a,i])=>(a.match(Eu)&&(r[a.slice(7)]=i),r),{});return Object.keys(t).length>0?t:void 0}function Ka(s){return s.split(",").map(e=>e.split("=").map(t=>decodeURIComponent(t.trim()))).reduce((e,[t,r])=>(t&&r&&(e[t]=r),e),{})}let Qa=!1;function Tu(s){const{spanId:e,traceId:t,isRemote:r}=s.spanContext();return Xe({parent_span_id:r?e:Mn(s).parent_span_id,span_id:r?Hr():e,trace_id:t})}function Xa(s){return typeof s=="number"?Za(s):Array.isArray(s)?s[0]+s[1]/1e9:s instanceof Date?Za(s.getTime()):vt()}function Za(s){return s>9999999999?s/1e3:s}function Mn(s){if(function(e){return typeof e.getSpanJSON=="function"}(s))return s.getSpanJSON();try{const{spanId:e,traceId:t}=s.spanContext();if(function(r){const a=r;return!!(a.attributes&&a.startTime&&a.name&&a.endTime&&a.status)}(s)){const{attributes:r,startTime:a,name:i,endTime:l,parentSpanId:c,status:d}=s;return Xe({span_id:e,trace_id:t,data:r,description:i,parent_span_id:c,start_timestamp:Xa(a),timestamp:Xa(l)||void 0,status:Au(d),op:r["sentry.op"],origin:r["sentry.origin"],_metrics_summary:Cu(s)})}return{span_id:e,trace_id:t}}catch{return{}}}function Au(s){if(s&&s.code!==0)return s.code===1?"ok":s.message||"unknown_error"}function Oo(s){return s._sentryRootSpan||s}function Mu(){Qa||(Ns(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")}),Qa=!0)}const In="production";function Po(s,e){const t=e.getOptions(),{publicKey:r}=e.getDsn()||{},a=Xe({environment:t.environment||In,release:t.release,public_key:r,trace_id:s});return e.emit("createDsc",a),a}function Iu(s){const e=De();if(!e)return{};const t=Oo(s),r=t._frozenDsc;if(r)return r;const a=t.spanContext().traceState,i=a&&a.get("sentry.dsc"),l=i&&Nu(i);if(l)return l;const c=Po(s.spanContext().traceId,e),d=Mn(t),m=d.data||{},v=m["sentry.sample_rate"];v!=null&&(c.sample_rate=`${v}`);const _=m["sentry.source"],N=d.description;return _!=="url"&&N&&(c.transaction=N),function(E){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const j=De(),y=j&&j.getOptions();return!!y&&(y.enableTracing||"tracesSampleRate"in y||"tracesSampler"in y)}()&&(c.sampled=String(function(E){const{traceFlags:j}=E.spanContext();return j===1}(t))),e.emit("createDsc",c,t),c}const Ou=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function lr(s,e=!1){const{host:t,path:r,pass:a,port:i,projectId:l,protocol:c,publicKey:d}=s;return`${c}://${d}${e&&a?`:${a}`:""}@${t}${i?`:${i}`:""}/${r&&`${r}/`}${l}`}function ei(s){return{protocol:s.protocol,publicKey:s.publicKey||"",pass:s.pass||"",host:s.host,port:s.port||"",path:s.path||"",projectId:s.projectId}}function Pu(s){const e=typeof s=="string"?function(t){const r=Ou.exec(t);if(!r)return void Ns(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});const[a,i,l="",c="",d="",m=""]=r.slice(1);let v="",_=m;const N=_.split("/");if(N.length>1&&(v=N.slice(0,-1).join("/"),_=N.pop()),_){const E=_.match(/^\d+/);E&&(_=E[0])}return ei({host:c,pass:l,path:v,projectId:_,port:d,protocol:a,publicKey:i})}(s):ei(s);if(e&&function(t){if(!Wt)return!0;const{port:r,projectId:a,protocol:i}=t;return!(["protocol","publicKey","host","projectId"].find(l=>!t[l]&&(X.error(`Invalid Sentry Dsn: ${l} missing`),!0))||(a.match(/^\d+$/)?function(l){return l==="http"||l==="https"}(i)?r&&isNaN(parseInt(r,10))&&(X.error(`Invalid Sentry Dsn: Invalid port ${r}`),1):(X.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),1):(X.error(`Invalid Sentry Dsn: Invalid projectId ${a}`),1)))}(e))return e}function pt(s,e=100,t=1/0){try{return Qr("",s,e,t)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function Lo(s,e=3,t=102400){const r=pt(s,e);return a=r,function(i){return~-encodeURI(i).split(/%..|./).length}(JSON.stringify(a))>t?Lo(s,e-1,t):r;var a}function Qr(s,e,t=1/0,r=1/0,a=function(){const i=typeof WeakSet=="function",l=i?new WeakSet:[];return[function(c){if(i)return!!l.has(c)||(l.add(c),!1);for(let d=0;d<l.length;d++)if(l[d]===c)return!0;return l.push(c),!1},function(c){if(i)l.delete(c);else for(let d=0;d<l.length;d++)if(l[d]===c){l.splice(d,1);break}}]}()){const[i,l]=a;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const c=function(E,j){try{if(E==="domain"&&j&&typeof j=="object"&&j._events)return"[Domain]";if(E==="domainEmitter")return"[DomainEmitter]";if(typeof globalThis<"u"&&j===globalThis)return"[Global]";if(typeof window<"u"&&j===window)return"[Window]";if(typeof document<"u"&&j===document)return"[Document]";if(No(j))return"[VueViewModel]";if(os(y=j)&&"nativeEvent"in y&&"preventDefault"in y&&"stopPropagation"in y)return"[SyntheticEvent]";if(typeof j=="number"&&!Number.isFinite(j))return`[${j}]`;if(typeof j=="function")return`[Function: ${It(j)}]`;if(typeof j=="symbol")return`[${String(j)}]`;if(typeof j=="bigint")return`[BigInt: ${String(j)}]`;const S=function(C){const T=Object.getPrototypeOf(C);return T?T.constructor.name:"null prototype"}(j);return/^HTML(\w*)Element$/.test(S)?`[HTMLElement: ${S}]`:`[object ${S}]`}catch(S){return`**non-serializable** (${S})`}var y}(s,e);if(!c.startsWith("[object "))return c;if(e.__sentry_skip_normalization__)return e;const d=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:t;if(d===0)return c.replace("object ","");if(i(e))return"[Circular ~]";const m=e;if(m&&typeof m.toJSON=="function")try{return Qr("",m.toJSON(),d-1,r,a)}catch{}const v=Array.isArray(e)?[]:{};let _=0;const N=Mo(e);for(const E in N){if(!Object.prototype.hasOwnProperty.call(N,E))continue;if(_>=r){v[E]="[MaxProperties ~]";break}const j=N[E];v[E]=Qr(E,j,d-1,r,a),_++}return l(e),v}function Es(s,e=[]){return[s,e]}function Lu(s,e){const[t,r]=s;return[t,[...r,e]]}function ti(s,e){const t=s[1];for(const r of t)if(e(r,r[0].type))return!0;return!1}function Xr(s){return me.__SENTRY__&&me.__SENTRY__.encodePolyfill?me.__SENTRY__.encodePolyfill(s):new TextEncoder().encode(s)}function Du(s){const[e,t]=s;let r=JSON.stringify(e);function a(i){typeof r=="string"?r=typeof i=="string"?r+i:[Xr(r),i]:r.push(typeof i=="string"?Xr(i):i)}for(const i of t){const[l,c]=i;if(a(`
${JSON.stringify(l)}
`),typeof c=="string"||c instanceof Uint8Array)a(c);else{let d;try{d=JSON.stringify(c)}catch{d=JSON.stringify(pt(c))}a(d)}}return typeof r=="string"?r:function(i){const l=i.reduce((m,v)=>m+v.length,0),c=new Uint8Array(l);let d=0;for(const m of i)c.set(m,d),d+=m.length;return c}(r)}function Ru(s){const e=typeof s.data=="string"?Xr(s.data):s.data;return[Xe({type:"attachment",length:e.length,filename:s.filename,content_type:s.contentType,attachment_type:s.attachmentType}),e]}const Fu={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function si(s){return Fu[s]}function Do(s){if(!s||!s.sdk)return;const{name:e,version:t}=s.sdk;return{name:e,version:t}}function Vu(s,e,t,r){const a=Do(t),i=s.type&&s.type!=="replay_event"?s.type:"event";(function(c,d){d&&(c.sdk=c.sdk||{},c.sdk.name=c.sdk.name||d.name,c.sdk.version=c.sdk.version||d.version,c.sdk.integrations=[...c.sdk.integrations||[],...d.integrations||[]],c.sdk.packages=[...c.sdk.packages||[],...d.packages||[]])})(s,t&&t.sdk);const l=function(c,d,m,v){const _=c.sdkProcessingMetadata&&c.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:c.event_id,sent_at:new Date().toISOString(),...d&&{sdk:d},...!!m&&v&&{dsn:lr(v)},..._&&{trace:Xe({..._})}}}(s,a,r,e);return delete s.sdkProcessingMetadata,Es(l,[[{type:i},s]])}function Zr(s,e,t,r=0){return new Qe((a,i)=>{const l=s[r];if(e===null||typeof l!="function")a(e);else{const c=l({...e},t);ve&&l.id&&c===null&&X.log(`Event processor "${l.id}" dropped event`),yr(c)?c.then(d=>Zr(s,d,t,r+1).then(a)).then(null,i):Zr(s,c,t,r+1).then(a).then(null,i)}})}let Rs,ri,Cr;function Uu(s,e){const{fingerprint:t,span:r,breadcrumbs:a,sdkProcessingMetadata:i}=e;(function(l,c){const{extra:d,tags:m,user:v,contexts:_,level:N,transactionName:E}=c,j=Xe(d);j&&Object.keys(j).length&&(l.extra={...j,...l.extra});const y=Xe(m);y&&Object.keys(y).length&&(l.tags={...y,...l.tags});const S=Xe(v);S&&Object.keys(S).length&&(l.user={...S,...l.user});const C=Xe(_);C&&Object.keys(C).length&&(l.contexts={...C,...l.contexts}),N&&(l.level=N),E&&l.type!=="transaction"&&(l.transaction=E)})(s,e),r&&function(l,c){l.contexts={trace:Tu(c),...l.contexts},l.sdkProcessingMetadata={dynamicSamplingContext:Iu(c),...l.sdkProcessingMetadata};const d=Oo(c),m=Mn(d).description;m&&!l.transaction&&l.type==="transaction"&&(l.transaction=m)}(s,r),function(l,c){l.fingerprint=l.fingerprint?Array.isArray(l.fingerprint)?l.fingerprint:[l.fingerprint]:[],c&&(l.fingerprint=l.fingerprint.concat(c)),l.fingerprint&&!l.fingerprint.length&&delete l.fingerprint}(s,t),function(l,c){const d=[...l.breadcrumbs||[],...c];l.breadcrumbs=d.length?d:void 0}(s,a),function(l,c){l.sdkProcessingMetadata={...l.sdkProcessingMetadata,...c}}(s,i)}function ni(s,e){const{extra:t,tags:r,user:a,contexts:i,level:l,sdkProcessingMetadata:c,breadcrumbs:d,fingerprint:m,eventProcessors:v,attachments:_,propagationContext:N,transactionName:E,span:j}=e;Fs(s,"extra",t),Fs(s,"tags",r),Fs(s,"user",a),Fs(s,"contexts",i),s.sdkProcessingMetadata=br(s.sdkProcessingMetadata,c,2),l&&(s.level=l),E&&(s.transactionName=E),j&&(s.span=j),d.length&&(s.breadcrumbs=[...s.breadcrumbs,...d]),m.length&&(s.fingerprint=[...s.fingerprint,...m]),v.length&&(s.eventProcessors=[...s.eventProcessors,...v]),_.length&&(s.attachments=[...s.attachments,..._]),s.propagationContext={...s.propagationContext,...N}}function Fs(s,e,t){s[e]=br(s[e],t,1)}function qu(s,e,t,r,a,i){const{normalizeDepth:l=3,normalizeMaxBreadth:c=1e3}=s,d={...e,event_id:e.event_id||t.event_id||Ze(),timestamp:e.timestamp||Ts()},m=t.integrations||s.integrations.map(j=>j.name);(function(j,y){const{environment:S,release:C,dist:T,maxValueLength:f=250}=y;j.environment=j.environment||S||In,!j.release&&C&&(j.release=C),!j.dist&&T&&(j.dist=T),j.message&&(j.message=rs(j.message,f));const L=j.exception&&j.exception.values&&j.exception.values[0];L&&L.value&&(L.value=rs(L.value,f));const I=j.request;I&&I.url&&(I.url=rs(I.url,f))})(d,s),function(j,y){y.length>0&&(j.sdk=j.sdk||{},j.sdk.integrations=[...j.sdk.integrations||[],...y])}(d,m),a&&a.emit("applyFrameMetadata",e),e.type===void 0&&function(j,y){const S=function(C){const T=me._sentryDebugIds;if(!T)return{};const f=Object.keys(T);return Cr&&f.length===ri||(ri=f.length,Cr=f.reduce((L,I)=>{Rs||(Rs={});const O=Rs[I];if(O)L[O[0]]=O[1];else{const Z=C(I);for(let K=Z.length-1;K>=0;K--){const ae=Z[K],A=ae&&ae.filename,G=T[I];if(A&&G){L[A]=G,Rs[I]=[A,G];break}}}return L},{})),Cr}(y);try{j.exception.values.forEach(C=>{C.stacktrace.frames.forEach(T=>{S&&T.filename&&(T.debug_id=S[T.filename])})})}catch{}}(d,s.stackParser);const v=function(j,y){if(!y)return j;const S=j?j.clone():new Ot;return S.update(y),S}(r,t.captureContext);t.mechanism&&ls(d,t.mechanism);const _=a?a.getEventProcessors():[],N=ar("globalScope",()=>new Ot).getScopeData();i&&ni(N,i.getScopeData()),v&&ni(N,v.getScopeData());const E=[...t.attachments||[],...N.attachments];return E.length&&(t.attachments=E),Uu(d,N),Zr([..._,...N.eventProcessors],d,t).then(j=>(j&&function(y){const S={};try{y.exception.values.forEach(T=>{T.stacktrace.frames.forEach(f=>{f.debug_id&&(f.abs_path?S[f.abs_path]=f.debug_id:f.filename&&(S[f.filename]=f.debug_id),delete f.debug_id)})})}catch{}if(Object.keys(S).length===0)return;y.debug_meta=y.debug_meta||{},y.debug_meta.images=y.debug_meta.images||[];const C=y.debug_meta.images;Object.entries(S).forEach(([T,f])=>{C.push({type:"sourcemap",code_file:T,debug_id:f})})}(j),typeof l=="number"&&l>0?function(y,S,C){if(!y)return null;const T={...y,...y.breadcrumbs&&{breadcrumbs:y.breadcrumbs.map(f=>({...f,...f.data&&{data:pt(f.data,S,C)}}))},...y.user&&{user:pt(y.user,S,C)},...y.contexts&&{contexts:pt(y.contexts,S,C)},...y.extra&&{extra:pt(y.extra,S,C)}};return y.contexts&&y.contexts.trace&&T.contexts&&(T.contexts.trace=y.contexts.trace,y.contexts.trace.data&&(T.contexts.trace.data=pt(y.contexts.trace.data,S,C))),y.spans&&(T.spans=y.spans.map(f=>({...f,...f.data&&{data:pt(f.data,S,C)}}))),y.contexts&&y.contexts.flags&&T.contexts&&(T.contexts.flags=pt(y.contexts.flags,3,C)),T}(j,l,c):j))}function ai(s,e){return Ht().captureEvent(s,e)}function ii(s){const e=De(),t=As(),r=Ht(),{release:a,environment:i=In}=e&&e.getOptions()||{},{userAgent:l}=me.navigator||{},c=xu({release:a,environment:i,user:r.getUser()||t.getUser(),...l&&{userAgent:l},...s}),d=t.getSession();return d&&d.status==="ok"&&cs(d,{status:"exited"}),Ro(),t.setSession(c),r.setSession(c),c}function Ro(){const s=As(),e=Ht(),t=e.getSession()||s.getSession();t&&function(r,a){let i={};r.status==="ok"&&(i={status:"exited"}),cs(r,i)}(t),Fo(),s.setSession(),e.setSession()}function Fo(){const s=As(),e=Ht(),t=De(),r=e.getSession()||s.getSession();r&&t&&t.captureSession(r)}function oi(s=!1){s?Ro():Fo()}function Bu(s,e,t){return e||`${function(r){return`${function(a){const i=a.protocol?`${a.protocol}:`:"",l=a.port?`:${a.port}`:"";return`${i}//${a.host}${l}${a.path?`/${a.path}`:""}/api/`}(r)}${r.projectId}/envelope/`}(s)}?${function(r,a){const i={sentry_version:"7"};return r.publicKey&&(i.sentry_key=r.publicKey),a&&(i.sentry_client=`${a.name}/${a.version}`),new URLSearchParams(i).toString()}(s,t)}`}const li=[];function ci(s,e){for(const t of e)t&&t.afterAllSetup&&t.afterAllSetup(s)}function ui(s,e,t){if(t[e.name])ve&&X.log(`Integration skipped because it was already installed: ${e.name}`);else{if(t[e.name]=e,li.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),li.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(s),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);s.on("preprocessEvent",(a,i)=>r(a,i,s))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),a=Object.assign((i,l)=>r(i,l,s),{id:e.name});s.addEventProcessor(a)}ve&&X.log(`Integration installed: ${e.name}`)}}class st extends Error{constructor(e,t="warn"){super(e),this.message=e,this.logLevel=t}}const di="Not capturing exception because it's already been captured.";class $u{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Pu(e.dsn):ve&&X.warn("No DSN provided, client will not send events."),this._dsn){const r=Bu(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:r})}const t=["enableTracing","tracesSampleRate","tracesSampler"].find(r=>r in e&&e[r]==null);t&&Ns(()=>{console.warn(`[Sentry] Deprecation warning: \`${t}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)})}captureException(e,t,r){const a=Ze();if(Ga(e))return ve&&X.log(di),a;const i={event_id:a,...t};return this._process(this.eventFromException(e,i).then(l=>this._captureEvent(l,i,r))),i.event_id}captureMessage(e,t,r,a){const i={event_id:Ze(),...r},l=Cn(e)?e:String(e),c=zr(e)?this.eventFromMessage(l,t,i):this.eventFromException(e,i);return this._process(c.then(d=>this._captureEvent(d,i,a))),i.event_id}captureEvent(e,t,r){const a=Ze();if(t&&t.originalException&&Ga(t.originalException))return ve&&X.log(di),a;const i={event_id:a,...t},l=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,i,l||r)),i.event_id}captureSession(e){typeof e.release!="string"?ve&&X.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),cs(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>t.flush(e).then(a=>r&&a))):zt(!0)}close(e){return this.flush(e).then(t=>(this.getOptions().enabled=!1,this.emit("close"),t))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const t=this._integrations[e.name];ui(this,e,this._integrations),t||ci(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let r=Vu(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of t.attachments||[])r=Lu(r,Ru(i));const a=this.sendEnvelope(r);a&&a.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){const t=function(r,a,i,l){const c=Do(i);return Es({sent_at:new Date().toISOString(),...c&&{sdk:c},...!!l&&a&&{dsn:lr(a)}},["aggregates"in r?[{type:"sessions"},r]:[{type:"session"},r.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(t)}recordDroppedEvent(e,t,r){if(this._options.sendClientReports){const a=typeof r=="number"?r:1,i=`${e}:${t}`;ve&&X.log(`Recording outcome: "${i}"${a>1?` (${a} times)`:""}`),this._outcomes[i]=(this._outcomes[i]||0)+a}}on(e,t){const r=this._hooks[e]=this._hooks[e]||[];return r.push(t),()=>{const a=r.indexOf(t);a>-1&&r.splice(a,1)}}emit(e,...t){const r=this._hooks[e];r&&r.forEach(a=>a(...t))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,t=>(ve&&X.error("Error while sending envelope:",t),t)):(ve&&X.error("Transport disabled"),zt({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(t,r){const a={};return r.forEach(i=>{i&&ui(t,i,a)}),a}(this,e),ci(this,e)}_updateSessionFromEvent(e,t){let r=t.level==="fatal",a=!1;const i=t.exception&&t.exception.values;if(i){a=!0;for(const c of i){const d=c.mechanism;if(d&&d.handled===!1){r=!0;break}}}const l=e.status==="ok";(l&&e.errors===0||l&&r)&&(cs(e,{...r&&{status:"crashed"},errors:e.errors||Number(a||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Qe(t=>{let r=0;const a=setInterval(()=>{this._numProcessing==0?(clearInterval(a),t(!0)):(r+=1,e&&r>=e&&(clearInterval(a),t(!1)))},1)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,t,r=Ht(),a=As()){const i=this.getOptions(),l=Object.keys(this._integrations);return!t.integrations&&l.length>0&&(t.integrations=l),this.emit("preprocessEvent",e,t),e.type||a.setLastEventId(e.event_id||t.event_id),qu(i,e,t,r,this,a).then(c=>{if(c===null)return c;c.contexts={trace:ku(r),...c.contexts};const d=function(m,v){const _=v.getPropagationContext();return _.dsc||Po(_.traceId,m)}(this,r);return c.sdkProcessingMetadata={dynamicSamplingContext:d,...c.sdkProcessingMetadata},c})}_captureEvent(e,t={},r){return this._processEvent(e,t,r).then(a=>a.event_id,a=>{ve&&(a instanceof st&&a.logLevel==="log"?X.log(a.message):X.warn(a))})}_processEvent(e,t,r){const a=this.getOptions(),{sampleRate:i}=a,l=mi(e),c=hi(e),d=e.type||"error",m=`before send for type \`${d}\``,v=i===void 0?void 0:function(E){if(typeof E=="boolean")return Number(E);const j=typeof E=="string"?parseFloat(E):E;if(!(typeof j!="number"||isNaN(j)||j<0||j>1))return j;ve&&X.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(E)} of type ${JSON.stringify(typeof E)}.`)}(i);if(c&&typeof v=="number"&&Math.random()>v)return this.recordDroppedEvent("sample_rate","error",e),or(new st(`Discarding event because it's not included in the random sample (sampling rate = ${i})`,"log"));const _=d==="replay_event"?"replay":d,N=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,r,N).then(E=>{if(E===null)throw this.recordDroppedEvent("event_processor",_,e),new st("An event processor returned `null`, will not send event.","log");if(t.data&&t.data.__sentry__===!0)return E;const j=function(y,S,C,T){const{beforeSend:f,beforeSendTransaction:L,beforeSendSpan:I}=S;if(hi(C)&&f)return f(C,T);if(mi(C)){if(C.spans&&I){const O=[];for(const Z of C.spans){const K=I(Z);K?O.push(K):(Mu(),y.recordDroppedEvent("before_send","span"))}C.spans=O}if(L){if(C.spans){const O=C.spans.length;C.sdkProcessingMetadata={...C.sdkProcessingMetadata,spanCountBeforeProcessing:O}}return L(C,T)}}return C}(this,a,E,t);return function(y,S){const C=`${S} must return \`null\` or a valid event.`;if(yr(y))return y.then(T=>{if(!os(T)&&T!==null)throw new st(C);return T},T=>{throw new st(`${S} rejected with ${T}`)});if(!os(y)&&y!==null)throw new st(C);return y}(j,m)}).then(E=>{if(E===null){if(this.recordDroppedEvent("before_send",_,e),l){const S=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",S)}throw new st(`${m} returned \`null\`, will not send event.`,"log")}const j=r&&r.getSession();if(!l&&j&&this._updateSessionFromEvent(j,E),l){const S=(E.sdkProcessingMetadata&&E.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(E.spans?E.spans.length:0);S>0&&this.recordDroppedEvent("before_send","span",S)}const y=E.transaction_info;if(l&&y&&E.transaction!==e.transaction){const S="custom";E.transaction_info={...y,source:S}}return this.sendEvent(E,t),E}).then(null,E=>{throw E instanceof st?E:(this.captureException(E,{data:{__sentry__:!0},originalException:E}),new st(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${E}`))})}_process(e){this._numProcessing++,e.then(t=>(this._numProcessing--,t),t=>(this._numProcessing--,t))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([t,r])=>{const[a,i]=t.split(":");return{reason:a,category:i,quantity:r}})}_flushOutcomes(){ve&&X.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0)return void(ve&&X.log("No outcomes to send"));if(!this._dsn)return void(ve&&X.log("No dsn provided, will not send outcomes"));ve&&X.log("Sending outcomes:",e);const t=(r=e,Es((a=this._options.tunnel&&lr(this._dsn))?{dsn:a}:{},[[{type:"client_report"},{timestamp:Ts(),discarded_events:r}]]));var r,a;this.sendEnvelope(t)}}function hi(s){return s.type===void 0}function mi(s){return s.type==="transaction"}function Ju(s){const e=[];function t(r){return e.splice(e.indexOf(r),1)[0]||Promise.resolve(void 0)}return{$:e,add:function(r){if(!(s===void 0||e.length<s))return or(new st("Not adding Promise because buffer limit was reached."));const a=r();return e.indexOf(a)===-1&&e.push(a),a.then(()=>t(a)).then(null,()=>t(a).then(null,()=>{})),a},drain:function(r){return new Qe((a,i)=>{let l=e.length;if(!l)return a(!0);const c=setTimeout(()=>{r&&r>0&&a(!1)},r);e.forEach(d=>{zt(d).then(()=>{--l||(clearTimeout(c),a(!0))},i)})})}}}function Gu(s,{statusCode:e,headers:t},r=Date.now()){const a={...s},i=t&&t["x-sentry-rate-limits"],l=t&&t["retry-after"];if(i)for(const c of i.trim().split(",")){const[d,m,,,v]=c.split(":",5),_=parseInt(d,10),N=1e3*(isNaN(_)?60:_);if(m)for(const E of m.split(";"))E==="metric_bucket"&&v&&!v.split(";").includes("custom")||(a[E]=r+N);else a.all=r+N}else l?a.all=r+function(c,d=Date.now()){const m=parseInt(`${c}`,10);if(!isNaN(m))return 1e3*m;const v=Date.parse(`${c}`);return isNaN(v)?6e4:v-d}(l,r):e===429&&(a.all=r+6e4);return a}function zu(s,e,t=Ju(s.bufferSize||64)){let r={};return{send:function(a){const i=[];if(ti(a,(d,m)=>{const v=si(m);if(function(_,N,E=Date.now()){return function(j,y){return j[y]||j.all||0}(_,N)>E}(r,v)){const _=pi(d,m);s.recordDroppedEvent("ratelimit_backoff",v,_)}else i.push(d)}),i.length===0)return zt({});const l=Es(a[0],i),c=d=>{ti(l,(m,v)=>{const _=pi(m,v);s.recordDroppedEvent(d,si(v),_)})};return t.add(()=>e({body:Du(l)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&ve&&X.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=Gu(r,d),d),d=>{throw c("network_error"),d})).then(d=>d,d=>{if(d instanceof st)return ve&&X.error("Skipped sending event because buffer is full."),c("queue_overflow"),zt({});throw d})},flush:a=>t.drain(a)}}function pi(s,e){if(e==="event"||e==="transaction")return Array.isArray(s)?s[1]:void 0}const Yu=100;function Rt(s,e){const t=De(),r=As();if(!t)return;const{beforeBreadcrumb:a=null,maxBreadcrumbs:i=Yu}=t.getOptions();if(i<=0)return;const l={timestamp:Ts(),...s},c=a?Ns(()=>a(l,e)):l;c!==null&&(t.emit&&t.emit("beforeAddBreadcrumb",c,e),r.addBreadcrumb(c,i))}let fi;const gi=new WeakMap,Wu=()=>({name:"FunctionToString",setupOnce(){fi=Function.prototype.toString;try{Function.prototype.toString=function(...s){const e=Nn(this),t=gi.has(De())&&e!==void 0?e:this;return fi.apply(t,s)}}catch{}},setup(s){gi.set(s,!0)}}),Hu=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],Ku=(s={})=>({name:"InboundFilters",processEvent(e,t,r){const a=r.getOptions(),i=function(l={},c={}){return{allowUrls:[...l.allowUrls||[],...c.allowUrls||[]],denyUrls:[...l.denyUrls||[],...c.denyUrls||[]],ignoreErrors:[...l.ignoreErrors||[],...c.ignoreErrors||[],...l.disableErrorDefaults?[]:Hu],ignoreTransactions:[...l.ignoreTransactions||[],...c.ignoreTransactions||[]],ignoreInternal:l.ignoreInternal===void 0||l.ignoreInternal}}(s,a);return function(l,c){return c.ignoreInternal&&function(d){try{return d.exception.values[0].type==="SentryError"}catch{}return!1}(l)?(ve&&X.warn(`Event dropped due to being internal Sentry Error.
Event: ${Et(l)}`),!0):function(d,m){return d.type||!m||!m.length?!1:function(v){const _=[];v.message&&_.push(v.message);let N;try{N=v.exception.values[v.exception.values.length-1]}catch{}return N&&N.value&&(_.push(N.value),N.type&&_.push(`${N.type}: ${N.value}`)),_}(d).some(v=>Ds(v,m))}(l,c.ignoreErrors)?(ve&&X.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Et(l)}`),!0):function(d){return d.type||!d.exception||!d.exception.values||d.exception.values.length===0?!1:!d.message&&!d.exception.values.some(m=>m.stacktrace||m.type&&m.type!=="Error"||m.value)}(l)?(ve&&X.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Et(l)}`),!0):function(d,m){if(d.type!=="transaction"||!m||!m.length)return!1;const v=d.transaction;return!!v&&Ds(v,m)}(l,c.ignoreTransactions)?(ve&&X.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Et(l)}`),!0):function(d,m){if(!m||!m.length)return!1;const v=Vs(d);return!!v&&Ds(v,m)}(l,c.denyUrls)?(ve&&X.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Et(l)}.
Url: ${Vs(l)}`),!0):function(d,m){if(!m||!m.length)return!0;const v=Vs(d);return!v||Ds(v,m)}(l,c.allowUrls)?!1:(ve&&X.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Et(l)}.
Url: ${Vs(l)}`),!0)}(e,i)?null:e}});function Vs(s){try{let e;try{e=s.exception.values[0].stacktrace.frames}catch{}return e?function(t=[]){for(let r=t.length-1;r>=0;r--){const a=t[r];if(a&&a.filename!=="<anonymous>"&&a.filename!=="[native code]")return a.filename||null}return null}(e):null}catch{return ve&&X.error(`Cannot extract url for event ${Et(s)}`),null}}function Qu(s,e,t=250,r,a,i,l){if(!(i.exception&&i.exception.values&&l&&Jt(l.originalException,Error)))return;const c=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;var d,m;c&&(i.exception.values=(d=en(s,e,a,l.originalException,r,i.exception.values,c,0),m=t,d.map(v=>(v.value&&(v.value=rs(v.value,m)),v))))}function en(s,e,t,r,a,i,l,c){if(i.length>=t+1)return i;let d=[...i];if(Jt(r[a],Error)){vi(l,c);const m=s(e,r[a]),v=d.length;yi(m,a,v,c),d=en(s,e,t,r[a],a,[m,...d],m,v)}return Array.isArray(r.errors)&&r.errors.forEach((m,v)=>{if(Jt(m,Error)){vi(l,c);const _=s(e,m),N=d.length;yi(_,`errors[${v}]`,N,c),d=en(s,e,t,m,a,[_,...d],_,N)}}),d}function vi(s,e){s.mechanism=s.mechanism||{type:"generic",handled:!0},s.mechanism={...s.mechanism,...s.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function yi(s,e,t,r){s.mechanism=s.mechanism||{type:"generic",handled:!0},s.mechanism={...s.mechanism,type:"chained",source:e,exception_id:t,parent_id:r}}function Er(s){if(!s)return{};const e=s.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const t=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:t,hash:r,relative:e[5]+t+r}}function Xu(){"console"in me&&Gr.forEach(function(s){s in me.console&&We(me.console,s,function(e){return ir[s]=e,function(...t){rt("console",{args:t,level:s});const r=ir[s];r&&r.apply(me.console,t)}})})}function Zu(s){return s==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(s)?s:"log"}const ed=()=>{let s;return{name:"Dedupe",processEvent(e){if(e.type)return e;try{if(function(t,r){return r?!!(function(a,i){const l=a.message,c=i.message;return!(!l&&!c||l&&!c||!l&&c||l!==c||!_i(a,i)||!bi(a,i))}(t,r)||function(a,i){const l=xi(i),c=xi(a);return!(!l||!c||l.type!==c.type||l.value!==c.value||!_i(a,i)||!bi(a,i))}(t,r)):!1}(e,s))return ve&&X.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return s=e}}};function bi(s,e){let t=Va(s),r=Va(e);if(!t&&!r)return!0;if(t&&!r||!t&&r||r.length!==t.length)return!1;for(let a=0;a<r.length;a++){const i=r[a],l=t[a];if(i.filename!==l.filename||i.lineno!==l.lineno||i.colno!==l.colno||i.function!==l.function)return!1}return!0}function _i(s,e){let t=s.fingerprint,r=e.fingerprint;if(!t&&!r)return!0;if(t&&!r||!t&&r)return!1;try{return t.join("")===r.join("")}catch{return!1}}function xi(s){return s.exception&&s.exception.values&&s.exception.values[0]}function wi(s){return s===void 0?void 0:s>=400&&s<500?"warning":s>=500?"error":void 0}const Nr=me;function tn(s){return s&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(s.toString())}function td(){if(typeof EdgeRuntime=="string")return!0;if(!function(){if(!("fetch"in Nr))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}())return!1;if(tn(Nr.fetch))return!0;let s=!1;const e=Nr.document;if(e&&typeof e.createElement=="function")try{const t=e.createElement("iframe");t.hidden=!0,e.head.appendChild(t),t.contentWindow&&t.contentWindow.fetch&&(s=tn(t.contentWindow.fetch)),e.head.removeChild(t)}catch(t){Wt&&X.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return s}function sd(s,e){const t="fetch";Bt(t,s),$t(t,()=>function(r,a=!1){a&&!td()||We(me,"fetch",function(i){return function(...l){const c=new Error,{method:d,url:m}=function(_){if(_.length===0)return{method:"GET",url:""};if(_.length===2){const[E,j]=_;return{url:Si(E),method:sn(j,"method")?String(j.method).toUpperCase():"GET"}}const N=_[0];return{url:Si(N),method:sn(N,"method")?String(N.method).toUpperCase():"GET"}}(l),v={args:l,fetchData:{method:d,url:m},startTimestamp:1e3*vt(),virtualError:c};return r||rt("fetch",{...v}),i.apply(me,l).then(async _=>(r?r(_):rt("fetch",{...v,endTimestamp:1e3*vt(),response:_}),_),_=>{throw rt("fetch",{...v,endTimestamp:1e3*vt(),error:_}),kn(_)&&_.stack===void 0&&(_.stack=c.stack,Gt(_,"framesToPop",1)),_})}})}(void 0,e))}function sn(s,e){return!!s&&typeof s=="object"&&!!s[e]}function Si(s){return typeof s=="string"?s:s?sn(s,"url")?s.url:s.toString?s.toString():"":""}const Us=me,Ie=me;let rn=0;function ji(){return rn>0}function ds(s,e={}){if(!function(r){return typeof r=="function"}(s))return s;try{const r=s.__sentry_wrapped__;if(r)return typeof r=="function"?r:s;if(Nn(s))return s}catch{return s}const t=function(...r){try{const a=r.map(i=>ds(i,e));return s.apply(this,a)}catch(a){throw rn++,setTimeout(()=>{rn--}),function(...i){const l=An(gr());if(i.length===2){const[c,d]=i;return c?l.withSetScope(c,d):l.withScope(d)}l.withScope(i[0])}(i=>{var l;i.addEventProcessor(c=>(e.mechanism&&(Wr(c,void 0),ls(c,e.mechanism)),c.extra={...c.extra,arguments:r},c)),l=a,Ht().captureException(l,void 0)}),a}};try{for(const r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}catch{}Ao(t,s),Gt(s,"__sentry_wrapped__",t);try{Object.getOwnPropertyDescriptor(t,"name").configurable&&Object.defineProperty(t,"name",{get:()=>s.name})}catch{}return t}const _r=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function On(s,e){const t=Pn(s,e),r={type:ad(e),value:id(e)};return t.length&&(r.stacktrace={frames:t}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function rd(s,e,t,r){const a=De(),i=a&&a.getOptions().normalizeDepth,l=function(m){for(const v in m)if(Object.prototype.hasOwnProperty.call(m,v)){const _=m[v];if(_ instanceof Error)return _}}(e),c={__serialized__:Lo(e,i)};if(l)return{exception:{values:[On(s,l)]},extra:c};const d={exception:{values:[{type:vr(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:od(e,{isUnhandledRejection:r})}]},extra:c};if(t){const m=Pn(s,t);m.length&&(d.exception.values[0].stacktrace={frames:m})}return d}function Tr(s,e){return{exception:{values:[On(s,e)]}}}function Pn(s,e){const t=e.stacktrace||e.stack||"",r=function(i){return i&&nd.test(i.message)?1:0}(e),a=function(i){return typeof i.framesToPop=="number"?i.framesToPop:0}(e);try{return s(t,r,a)}catch{}return[]}const nd=/Minified React error #\d+;/i;function Vo(s){return typeof WebAssembly<"u"&&WebAssembly.Exception!==void 0&&s instanceof WebAssembly.Exception}function ad(s){const e=s&&s.name;return!e&&Vo(s)?s.message&&Array.isArray(s.message)&&s.message.length==2?s.message[0]:"WebAssembly.Exception":e}function id(s){const e=s&&s.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:Vo(s)&&Array.isArray(s.message)&&s.message.length==2?s.message[1]:e:"No error message"}function nn(s,e,t,r,a){let i;if(Eo(e)&&e.error)return Tr(s,e.error);if(qa(e)||hs(e,"DOMException")){const l=e;if("stack"in e)i=Tr(s,e);else{const c=l.name||(qa(l)?"DOMError":"DOMException"),d=l.message?`${c}: ${l.message}`:c;i=an(s,d,t,r),Wr(i,d)}return"code"in l&&(i.tags={...i.tags,"DOMException.code":`${l.code}`}),i}return kn(e)?Tr(s,e):os(e)||vr(e)?(i=rd(s,e,t,a),ls(i,{synthetic:!0}),i):(i=an(s,e,t,r),Wr(i,`${e}`),ls(i,{synthetic:!0}),i)}function an(s,e,t,r){const a={};if(r&&t){const i=Pn(s,t);i.length&&(a.exception={values:[{value:e,stacktrace:{frames:i}}]}),ls(a,{synthetic:!0})}if(Cn(e)){const{__sentry_template_string__:i,__sentry_template_values__:l}=e;return a.logentry={message:i,params:l},a}return a.message=e,a}function od(s,{isUnhandledRejection:e}){const t=function(a,i=40){const l=Object.keys(Mo(a));l.sort();const c=l[0];if(!c)return"[object has no keys]";if(c.length>=i)return rs(c,i);for(let d=l.length;d>0;d--){const m=l.slice(0,d).join(", ");if(!(m.length>i))return d===l.length?m:rs(m,i)}return""}(s),r=e?"promise rejection":"exception";return Eo(s)?`Event \`ErrorEvent\` captured as ${r} with message \`${s.message}\``:vr(s)?`Event \`${function(a){try{const i=Object.getPrototypeOf(a);return i?i.constructor.name:void 0}catch{}}(s)}\` (type=${s.type}) captured as ${r}`:`Object captured as ${r} with keys: ${t}`}class ld extends $u{constructor(e){const t={parentSpanIsAlwaysRootSpan:!0,...e};(function(r,a,i=[a],l="npm"){const c=r._metadata||{};c.sdk||(c.sdk={name:`sentry.javascript.${a}`,packages:i.map(d=>({name:`${l}:@sentry/${d}`,version:qt})),version:qt}),r._metadata=c})(t,"browser",["browser"],Ie.SENTRY_SDK_SOURCE||"npm"),super(t),t.sendClientReports&&Ie.document&&Ie.document.addEventListener("visibilitychange",()=>{Ie.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,t){return function(r,a,i,l){const c=nn(r,a,i&&i.syntheticException||void 0,l);return ls(c),c.level="error",i&&i.event_id&&(c.event_id=i.event_id),zt(c)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e,t="info",r){return function(a,i,l="info",c,d){const m=an(a,i,c&&c.syntheticException||void 0,d);return m.level=l,c&&c.event_id&&(m.event_id=c.event_id),zt(m)}(this._options.stackParser,e,t,r,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(_r&&X.warn("SDK not enabled, will not capture user feedback."));const t=function(r,{metadata:a,tunnel:i,dsn:l}){const c={event_id:r.event_id,sent_at:new Date().toISOString(),...a&&a.sdk&&{sdk:{name:a.sdk.name,version:a.sdk.version}},...!!i&&!!l&&{dsn:lr(l)}};return Es(c,[function(m){return[{type:"user_report"},m]}(r)])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(t)}_prepareEvent(e,t,r){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,r)}}const cd=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,qe=me;let ki,Ar,Mr,qs;function ud(){if(!qe.document)return;const s=rt.bind(null,"dom"),e=Ci(s,!0);qe.document.addEventListener("click",e,!1),qe.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(t=>{const r=qe[t],a=r&&r.prototype;a&&a.hasOwnProperty&&a.hasOwnProperty("addEventListener")&&(We(a,"addEventListener",function(i){return function(l,c,d){if(l==="click"||l=="keypress")try{const m=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},v=m[l]=m[l]||{refCount:0};if(!v.handler){const _=Ci(s);v.handler=_,i.call(this,l,_,d)}v.refCount++}catch{}return i.call(this,l,c,d)}}),We(a,"removeEventListener",function(i){return function(l,c,d){if(l==="click"||l=="keypress")try{const m=this.__sentry_instrumentation_handlers__||{},v=m[l];v&&(v.refCount--,v.refCount<=0&&(i.call(this,l,v.handler,d),v.handler=void 0,delete m[l]),Object.keys(m).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return i.call(this,l,c,d)}}))})}function Ci(s,e=!1){return t=>{if(!t||t._sentryCaptured)return;const r=function(i){try{return i.target}catch{return null}}(t);if(function(i,l){return i==="keypress"&&(!l||!l.tagName||l.tagName!=="INPUT"&&l.tagName!=="TEXTAREA"&&!l.isContentEditable)}(t.type,r))return;Gt(t,"_sentryCaptured",!0),r&&!r._sentryId&&Gt(r,"_sentryId",Ze());const a=t.type==="keypress"?"input":t.type;(function(i){if(i.type!==Ar)return!1;try{if(!i.target||i.target._sentryId!==Mr)return!1}catch{}return!0})(t)||(s({event:t,name:a,global:e}),Ar=t.type,Mr=r?r._sentryId:void 0),clearTimeout(ki),ki=qe.setTimeout(()=>{Mr=void 0,Ar=void 0},1e3)}}function Uo(s){const e="history";Bt(e,s),$t(e,dd)}function dd(){if(!function(){const t=Us.chrome,r=t&&t.app&&t.app.runtime,a="history"in Us&&!!Us.history.pushState&&!!Us.history.replaceState;return!r&&a}())return;const s=qe.onpopstate;function e(t){return function(...r){const a=r.length>2?r[2]:void 0;if(a){const i=qs,l=String(a);qs=l,rt("history",{from:i,to:l})}return t.apply(this,r)}}qe.onpopstate=function(...t){const r=qe.location.href,a=qs;if(qs=r,rt("history",{from:a,to:r}),s)try{return s.apply(this,t)}catch{}},We(qe.history,"pushState",e),We(qe.history,"replaceState",e)}const Ys={};function Ei(s){Ys[s]=void 0}const ys="__sentry_xhr_v3__";function hd(){if(!qe.XMLHttpRequest)return;const s=XMLHttpRequest.prototype;s.open=new Proxy(s.open,{apply(e,t,r){const a=new Error,i=1e3*vt(),l=ft(r[0])?r[0].toUpperCase():void 0,c=function(m){if(ft(m))return m;try{return m.toString()}catch{}}(r[1]);if(!l||!c)return e.apply(t,r);t[ys]={method:l,url:c,request_headers:{}},l==="POST"&&c.match(/sentry_key/)&&(t.__sentry_own_request__=!0);const d=()=>{const m=t[ys];if(m&&t.readyState===4){try{m.status_code=t.status}catch{}rt("xhr",{endTimestamp:1e3*vt(),startTimestamp:i,xhr:t,virtualError:a})}};return"onreadystatechange"in t&&typeof t.onreadystatechange=="function"?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply:(m,v,_)=>(d(),m.apply(v,_))}):t.addEventListener("readystatechange",d),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(m,v,_){const[N,E]=_,j=v[ys];return j&&ft(N)&&ft(E)&&(j.request_headers[N.toLowerCase()]=E),m.apply(v,_)}}),e.apply(t,r)}}),s.send=new Proxy(s.send,{apply(e,t,r){const a=t[ys];return a?(r[0]!==void 0&&(a.body=r[0]),rt("xhr",{startTimestamp:1e3*vt(),xhr:t}),e.apply(t,r)):e.apply(t,r)}})}function md(s,e=function(t){const r=Ys[t];if(r)return r;let a=qe[t];if(tn(a))return Ys[t]=a.bind(qe);const i=qe.document;if(i&&typeof i.createElement=="function")try{const l=i.createElement("iframe");l.hidden=!0,i.head.appendChild(l);const c=l.contentWindow;c&&c[t]&&(a=c[t]),i.head.removeChild(l)}catch(l){cd&&X.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,l)}return a&&(Ys[t]=a.bind(qe))}("fetch")){let t=0,r=0;return zu(s,function(a){const i=a.body.length;t+=i,r++;const l={body:a.body,method:"POST",referrerPolicy:"origin",headers:s.headers,keepalive:t<=6e4&&r<15,...s.fetchOptions};if(!e)return Ei("fetch"),or("No fetch implementation available");try{return e(s.url,l).then(c=>(t-=i,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return Ei("fetch"),t-=i,r--,or(c)}})}function Ir(s,e,t,r){const a={filename:s,function:e==="<anonymous>"?Ut:e,in_app:!0};return t!==void 0&&(a.lineno=t),r!==void 0&&(a.colno=r),a}const pd=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,fd=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,gd=/\((\S*)(?::(\d+))(?::(\d+))\)/,vd=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,yd=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,bd=function(...s){const e=s.sort((t,r)=>t[0]-r[0]).map(t=>t[1]);return(t,r=0,a=0)=>{const i=[],l=t.split(`
`);for(let c=r;c<l.length;c++){const d=l[c];if(d.length>1024)continue;const m=Da.test(d)?d.replace(Da,"$1"):d;if(!m.match(/\S*Error: /)){for(const v of e){const _=v(m);if(_){i.push(_);break}}if(i.length>=50+a)break}}return function(c){if(!c.length)return[];const d=Array.from(c);return/sentryWrapped/.test(Ls(d).function||"")&&d.pop(),d.reverse(),Ra.test(Ls(d).function||"")&&(d.pop(),Ra.test(Ls(d).function||"")&&d.pop()),d.slice(0,50).map(m=>({...m,filename:m.filename||Ls(d).filename,function:m.function||Ut}))}(i.slice(a))}}([30,s=>{const e=pd.exec(s);if(e){const[,r,a,i]=e;return Ir(r,Ut,+a,+i)}const t=fd.exec(s);if(t){if(t[2]&&t[2].indexOf("eval")===0){const i=gd.exec(t[2]);i&&(t[2]=i[1],t[3]=i[2],t[4]=i[3])}const[r,a]=Ni(t[1]||Ut,t[2]);return Ir(a,r,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],[50,s=>{const e=vd.exec(s);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const a=yd.exec(e[3]);a&&(e[1]=e[1]||"eval",e[3]=a[1],e[4]=a[2],e[5]="")}let t=e[3],r=e[1]||Ut;return[r,t]=Ni(r,t),Ir(t,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]),Ni=(s,e)=>{const t=s.indexOf("safari-extension")!==-1,r=s.indexOf("safari-web-extension")!==-1;return t||r?[s.indexOf("@")!==-1?s.split("@")[0]:Ut,t?`safari-extension:${e}`:`safari-web-extension:${e}`]:[s,e]},Ti=1024,_d=(s={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...s};return{name:"Breadcrumbs",setup(t){var r;e.console&&function(a){const i="console";Bt(i,a),$t(i,Xu)}(function(a){return function(i){if(De()!==a)return;const l={category:"console",data:{arguments:i.args,logger:"console"},level:Zu(i.level),message:Ba(i.args," ")};if(i.level==="assert"){if(i.args[0]!==!1)return;l.message=`Assertion failed: ${Ba(i.args.slice(1)," ")||"console.assert"}`,l.data.arguments=i.args.slice(1)}Rt(l,{input:i.args,level:i.level})}}(t)),e.dom&&(r=function(a,i){return function(l){if(De()!==a)return;let c,d,m=typeof i=="object"?i.serializeAttribute:void 0,v=typeof i=="object"&&typeof i.maxStringLength=="number"?i.maxStringLength:void 0;v&&v>Ti&&(_r&&X.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${v} was configured. Sentry will use 1024 instead.`),v=Ti),typeof m=="string"&&(m=[m]);try{const N=l.event,E=function(j){return!!j&&!!j.target}(N)?N.target:N;c=To(E,{keyAttrs:m,maxStringLength:v}),d=function(j){if(!En.HTMLElement)return null;let y=j;for(let S=0;S<5;S++){if(!y)return null;if(y instanceof HTMLElement){if(y.dataset.sentryComponent)return y.dataset.sentryComponent;if(y.dataset.sentryElement)return y.dataset.sentryElement}y=y.parentNode}return null}(E)}catch{c="<unknown>"}if(c.length===0)return;const _={category:`ui.${l.name}`,message:c};d&&(_.data={"ui.component_name":d}),Rt(_,{event:l.event,name:l.name,global:l.global})}}(t,e.dom),Bt("dom",r),$t("dom",ud)),e.xhr&&function(a){Bt("xhr",a),$t("xhr",hd)}(function(a){return function(i){if(De()!==a)return;const{startTimestamp:l,endTimestamp:c}=i,d=i.xhr[ys];if(!l||!c||!d)return;const{method:m,url:v,status_code:_,body:N}=d,E={method:m,url:v,status_code:_},j={xhr:i.xhr,input:N,startTimestamp:l,endTimestamp:c};Rt({category:"xhr",data:E,type:"http",level:wi(_)},j)}}(t)),e.fetch&&sd(function(a){return function(i){if(De()!==a)return;const{startTimestamp:l,endTimestamp:c}=i;if(c&&(!i.fetchData.url.match(/sentry_key/)||i.fetchData.method!=="POST"))if(i.error)Rt({category:"fetch",data:i.fetchData,level:"error",type:"http"},{data:i.error,input:i.args,startTimestamp:l,endTimestamp:c});else{const d=i.response,m={...i.fetchData,status_code:d&&d.status},v={input:i.args,response:d,startTimestamp:l,endTimestamp:c};Rt({category:"fetch",data:m,type:"http",level:wi(m.status_code)},v)}}}(t)),e.history&&Uo(function(a){return function(i){if(De()!==a)return;let l=i.from,c=i.to;const d=Er(Ie.location.href);let m=l?Er(l):void 0;const v=Er(c);m&&m.path||(m=d),d.protocol===v.protocol&&d.host===v.host&&(c=v.relative),d.protocol===m.protocol&&d.host===m.host&&(l=m.relative),Rt({category:"navigation",data:{from:l,to:c}})}}(t)),e.sentry&&t.on("beforeSendEvent",function(a){return function(i){De()===a&&Rt({category:"sentry."+(i.type==="transaction"?"transaction":"event"),event_id:i.event_id,level:i.level,message:Et(i)},{event:i})}}(t))}}},xd=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],wd=(s={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...s};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&We(Ie,"setTimeout",Ai),e.setInterval&&We(Ie,"setInterval",Ai),e.requestAnimationFrame&&We(Ie,"requestAnimationFrame",Sd),e.XMLHttpRequest&&"XMLHttpRequest"in Ie&&We(XMLHttpRequest.prototype,"send",jd);const t=e.eventTarget;t&&(Array.isArray(t)?t:xd).forEach(kd)}}};function Ai(s){return function(...e){const t=e[0];return e[0]=ds(t,{mechanism:{data:{function:It(s)},handled:!1,type:"instrument"}}),s.apply(this,e)}}function Sd(s){return function(e){return s.apply(this,[ds(e,{mechanism:{data:{function:"requestAnimationFrame",handler:It(s)},handled:!1,type:"instrument"}})])}}function jd(s){return function(...e){const t=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(r=>{r in t&&typeof t[r]=="function"&&We(t,r,function(a){const i={mechanism:{data:{function:r,handler:It(a)},handled:!1,type:"instrument"}},l=Nn(a);return l&&(i.mechanism.data.handler=It(l)),ds(a,i)})}),s.apply(this,e)}}function kd(s){const e=Ie[s],t=e&&e.prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(We(t,"addEventListener",function(r){return function(a,i,l){try{typeof i.handleEvent=="function"&&(i.handleEvent=ds(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:It(i),target:s},handled:!1,type:"instrument"}}))}catch{}return r.apply(this,[a,ds(i,{mechanism:{data:{function:"addEventListener",handler:It(i),target:s},handled:!1,type:"instrument"}}),l])}}),We(t,"removeEventListener",function(r){return function(a,i,l){try{const c=i.__sentry_wrapped__;c&&r.call(this,a,c,l)}catch{}return r.call(this,a,i,l)}}))}const Cd=()=>({name:"BrowserSession",setupOnce(){Ie.document!==void 0?(ii({ignoreDuration:!0}),oi(),Uo(({from:s,to:e})=>{s!==void 0&&s!==e&&(ii({ignoreDuration:!0}),oi())})):_r&&X.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),Ed=(s={})=>{const e={onerror:!0,onunhandledrejection:!0,...s};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(t){e.onerror&&(function(r){(function(a){const i="error";Bt(i,a),$t(i,vu)})(a=>{const{stackParser:i,attachStacktrace:l}=Ii();if(De()!==r||ji())return;const{msg:c,url:d,line:m,column:v,error:_}=a,N=function(E,j,y,S){const C=E.exception=E.exception||{},T=C.values=C.values||[],f=T[0]=T[0]||{},L=f.stacktrace=f.stacktrace||{},I=L.frames=L.frames||[],O=S,Z=y,K=ft(j)&&j.length>0?j:function(){try{return En.document.location.href}catch{return""}}();return I.length===0&&I.push({colno:O,filename:K,function:Ut,in_app:!0,lineno:Z}),E}(nn(i,_||c,void 0,l,!1),d,m,v);N.level="error",ai(N,{originalException:_,mechanism:{handled:!1,type:"onerror"}})})}(t),Mi("onerror")),e.onunhandledrejection&&(function(r){(function(a){const i="unhandledrejection";Bt(i,a),$t(i,yu)})(a=>{const{stackParser:i,attachStacktrace:l}=Ii();if(De()!==r||ji())return;const c=function(m){if(zr(m))return m;try{if("reason"in m)return m.reason;if("detail"in m&&"reason"in m.detail)return m.detail.reason}catch{}return m}(a),d=zr(c)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(c)}`}]}}:nn(i,c,void 0,l,!0);d.level="error",ai(d,{originalException:c,mechanism:{handled:!1,type:"onunhandledrejection"}})})}(t),Mi("onunhandledrejection"))}}};function Mi(s){_r&&X.log(`Global Handler attached: ${s}`)}function Ii(){const s=De();return s&&s.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Nd=()=>({name:"HttpContext",preprocessEvent(s){if(!Ie.navigator&&!Ie.location&&!Ie.document)return;const e=s.request&&s.request.url||Ie.location&&Ie.location.href,{referrer:t}=Ie.document||{},{userAgent:r}=Ie.navigator||{},a={...s.request&&s.request.headers,...t&&{Referer:t},...r&&{"User-Agent":r}},i={...s.request,...e&&{url:e},headers:a};s.request=i}}),Td=(s={})=>{const e=s.limit||5,t=s.key||"cause";return{name:"LinkedErrors",preprocessEvent(r,a,i){const l=i.getOptions();Qu(On,l.stackParser,l.maxValueLength,t,e,r,a)}}};var on="new",Oi="loading",Pi="loaded",cr="joining-meeting",Tt="joined-meeting",Ct="left-meeting",dt="error",Ad="blocked",Md="off",Id="sendable",Od="loading",Pd="interrupted",qo="playable",Ws="unknown",Bo="full",Ld="lobby",Dd="none",$o="base",Rd="*",Fd="ejected",Vd="nbf-room",Ud="nbf-token",qd="exp-room",Bd="exp-token",ln="no-room",$d="meeting-full",Jo="end-of-life",Jd="not-allowed",Go="connection-error",Gd="cam-in-use",zd="mic-in-use",Yd="cam-mic-in-use",Wd="permissions",Hd="undefined-mediadevices",Kd="not-found",Qd="constraints",Xd="unknown",zo="iframe-ready-for-launch-config",Yo="iframe-launch-config",Wo="theme-updated",Ho="loading",Ko="load-attempt-failed",cn="loaded",Qo="started-camera",Xo="camera-error",Zo="joining-meeting",el="joined-meeting",tl="left-meeting",sl="participant-joined",rl="participant-updated",nl="participant-left",al="participant-counts-updated",il="access-state-updated",ol="meeting-session-summary-updated",ll="meeting-session-state-updated",Zd="meeting-session-data-error",cl="waiting-participant-added",ul="waiting-participant-updated",dl="waiting-participant-removed",hl="track-started",ml="track-stopped",pl="transcription-started",fl="transcription-stopped",gl="transcription-error",un="recording-started",dn="recording-stopped",vl="recording-stats",yl="recording-error",bl="recording-upload-completed",_l="recording-data",xl="app-message",wl="transcription-message",Sl="remote-media-player-started",jl="remote-media-player-updated",kl="remote-media-player-stopped",Cl="local-screen-share-started",El="local-screen-share-stopped",Nl="local-screen-share-canceled",Tl="active-speaker-change",Al="active-speaker-mode-change",Ml="network-quality-change",Il="network-connection",Ol="cpu-load-change",Pl="face-counts-updated",bs="fullscreen",_s="exited-fullscreen",Ll="live-streaming-started",Dl="live-streaming-updated",Rl="live-streaming-stopped",Fl="live-streaming-error",Vl="lang-updated",Ul="receive-settings-updated",hn="input-settings-updated",mn="nonfatal-error",pn="error",Or=4096,Li=102400,Pr="iframe-call-message",Di="local-screen-start",Ri="daily-method-update-live-streaming-endpoints",Bs="transmit-log",gt="daily-custom-track",Hs={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},ql={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},fn={PLAY:"play",PAUSE:"pause"},Lr=["jpg","png","jpeg"],eh="add-endpoints",th="remove-endpoints",Fi="sip-call-transfer";function et(){return!le()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function le(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function Bl(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function sh(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&(function(s,e){if(!s||!e)return!0;switch(s){case"Chrome":return e.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(e.major===13&&e.minor===0&&e.point===0);case"Firefox":return e.major>=67}return!0}(Yt(),ur())||le())}function Vi(){if(le()||!document)return!1;var s=document.createElement("iframe");return!!s.requestFullscreen||!!s.webkitRequestFullscreen}var gn="none",rh="software",nh="hardware",ah=function(){try{var s,e=document.createElement("canvas"),t=!1;(s=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(t=!0,s=e.getContext("webgl2"));var r=s!=null;return e.remove(),r?t?rh:nh:gn}catch{return gn}}();function $l(){var s=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!le()&&ah!==gn&&(s?function(){return qi()?!1:["Chrome","Firefox"].includes(Yt())}():function(){if(qi())return!1;var e=Yt();if(e==="Safari"){var t=Dn();if(t.major<15||t.major===15&&t.minor<4)return!1}return e==="Chrome"?Ln().major>=77:e==="Firefox"?Rn().major>=97:["Chrome","Firefox","Safari"].includes(e)}())}function Jl(){if(le()||Gl()||typeof AudioWorkletNode>"u")return!1;switch(Yt()){case"Chrome":case"Firefox":return!0;case"Safari":var s=ur();return s.major>17||s.major===17&&s.minor>=4}return!1}function Ui(){return Bl()&&!function(){var s,e=Yt();if(!et())return!0;switch(e){case"Chrome":return(s=Ln()).major&&s.major>0&&s.major<75;case"Firefox":return(s=Rn()).major<91;case"Safari":return(s=Dn()).major<13||s.major===13&&s.minor<1;default:return!0}}()}function Gl(){return et().match(/Linux; Android/)}function qi(){var s,e=et(),t=e.match(/Mac/)&&(!le()&&typeof window<"u"&&(s=window)!==null&&s!==void 0&&(s=s.navigator)!==null&&s!==void 0&&s.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(e.match(/Mobi/)||e.match(/Android/)||t)||!!et().match(/DailyAnd\//)||void 0}function Yt(){if(typeof window<"u"){var s=et();return zl()?"Safari":s.indexOf("Edge")>-1?"Edge":s.match(/Chrome\//)?"Chrome":s.indexOf("Safari")>-1||Yl()?"Safari":s.indexOf("Firefox")>-1?"Firefox":s.indexOf("MSIE")>-1||s.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function ur(){switch(Yt()){case"Chrome":return Ln();case"Safari":return Dn();case"Firefox":return Rn();case"Edge":return function(){var s=0,e=0;if(typeof window<"u"){var t=et().match(/Edge\/(\d+).(\d+)/);if(t)try{s=parseInt(t[1]),e=parseInt(t[2])}catch{}}return{major:s,minor:e}}()}}function Ln(){var s=0,e=0,t=0,r=0,a=!1;if(typeof window<"u"){var i=et(),l=i.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(l)try{s=parseInt(l[1]),e=parseInt(l[2]),t=parseInt(l[3]),r=parseInt(l[4]),a=i.indexOf("OPR/")>-1}catch{}}return{major:s,minor:e,build:t,patch:r,opera:a}}function zl(){return!!et().match(/iPad|iPhone|iPod/i)&&Bl()}function Yl(){return et().indexOf("AppleWebKit/605.1.15")>-1}function Dn(){var s=0,e=0,t=0;if(typeof window<"u"){var r=et().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(r)try{s=parseInt(r[1]),e=parseInt(r[2]),t=parseInt(r[4])}catch{}else(zl()||Yl())&&(s=14,e=0,t=3)}return{major:s,minor:e,point:t}}function Rn(){var s=0,e=0;if(typeof window<"u"){var t=et().match(/Firefox\/(\d+).(\d+)/);if(t)try{s=parseInt(t[1]),e=parseInt(t[2])}catch{}}return{major:s,minor:e}}var Wl=function(){return Ke(function s(){He(this,s)},[{key:"addListenerForMessagesFromCallMachine",value:function(s,e,t){fs()}},{key:"addListenerForMessagesFromDailyJs",value:function(s,e,t){fs()}},{key:"sendMessageToCallMachine",value:function(s,e,t,r){fs()}},{key:"sendMessageToDailyJs",value:function(s,e){fs()}},{key:"removeListener",value:function(s){fs()}}])}();function Bi(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,r)}return t}function Dr(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bi(Object(t),!0).forEach(function(r){ct(s,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Bi(Object(t)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(t,r))})}return s}function Hl(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Hl=function(){return!!s})()}var ih=function(){function s(){var e,t,r,a;return He(this,s),t=this,r=nt(r=s),(e=mr(t,Hl()?Reflect.construct(r,[],nt(t).constructor):r.apply(t,a)))._wrappedListeners={},e._messageCallbacks={},e}return pr(s,Wl),Ke(s,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,r){var a=this,i=function(l){if(l.data&&l.data.what==="iframe-call-message"&&(!l.data.callClientId||l.data.callClientId===t)&&(!l.data.from||l.data.from!=="module")){var c=Dr({},l.data);if(delete c.from,c.callbackStamp&&a._messageCallbacks[c.callbackStamp]){var d=c.callbackStamp;a._messageCallbacks[d].call(r,c),delete a._messageCallbacks[d]}delete c.what,delete c.callbackStamp,e.call(r,c)}};this._wrappedListeners[e]=i,window.addEventListener("message",i)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,r){var a=function(i){var l;if(!(!i.data||i.data.what!==Pr||!i.data.action||i.data.from&&i.data.from!=="module"||i.data.callClientId&&t&&i.data.callClientId!==t||i!=null&&(l=i.data)!==null&&l!==void 0&&l.callFrameId)){var c=i.data;e.call(r,c)}};this._wrappedListeners[e]=a,window.addEventListener("message",a)}},{key:"sendMessageToCallMachine",value:function(e,t,r,a){if(!r)throw new Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var i=Dr({},e);if(i.what=Pr,i.from="module",i.callClientId=r,t){var l=fr();this._messageCallbacks[l]=t,i.callbackStamp=l}var c=a?a.contentWindow:window,d=this._callMachineTargetOrigin(a);d&&c.postMessage(i,d)}},{key:"sendMessageToDailyJs",value:function(e,t){e.what=Pr,e.callClientId=t,e.from="embedded",window.postMessage(e,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,t,r){var a=Dr({},e);a.callClientId=r;var i=t?t.contentWindow:window,l=this._callMachineTargetOrigin(t);l&&i.postMessage(a,l)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,t){var r=function(a){if(a.data&&a.data.what==="iframe-call-message"&&(!a.data.callClientId||a.data.callClientId===t)&&(!a.data.from||a.data.from!=="module")){var i=a.data;e(i)}};return this._wrappedListeners[e]=r,window.addEventListener("message",r),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var t=this._wrappedListeners[e];t&&(window.removeEventListener("message",t),delete this._wrappedListeners[e])}},{key:"_callMachineTargetOrigin",value:function(e){return e?e.src?new URL(e.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return window.location.protocol==="file:"?"*":window.location.origin}}])}();function $i(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,r)}return t}function Kl(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kl=function(){return!!s})()}var oh=function(){function s(){var e,t,r,a;return He(this,s),t=this,r=nt(r=s),e=mr(t,Kl()?Reflect.construct(r,[],nt(t).constructor):r.apply(t,a)),globalThis.callMachineToDailyJsEmitter=globalThis.callMachineToDailyJsEmitter||new Jr.EventEmitter,globalThis.dailyJsToCallMachineEmitter=globalThis.dailyJsToCallMachineEmitter||new Jr.EventEmitter,e._wrappedListeners={},e._messageCallbacks={},e}return pr(s,Wl),Ke(s,[{key:"addListenerForMessagesFromCallMachine",value:function(e,t,r){this._addListener(e,globalThis.callMachineToDailyJsEmitter,t,r,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(e,t,r){this._addListener(e,globalThis.dailyJsToCallMachineEmitter,t,r,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(e,t,r){this._sendMessage(e,globalThis.dailyJsToCallMachineEmitter,r,t,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(e,t){this._sendMessage(e,globalThis.callMachineToDailyJsEmitter,t,null,"sending message to daily-js")}},{key:"removeListener",value:function(e){var t=this._wrappedListeners[e];t&&(globalThis.callMachineToDailyJsEmitter.removeListener("message",t),globalThis.dailyJsToCallMachineEmitter.removeListener("message",t),delete this._wrappedListeners[e])}},{key:"_addListener",value:function(e,t,r,a,i){var l=this,c=function(d){if(d.callClientId===r){if(d.callbackStamp&&l._messageCallbacks[d.callbackStamp]){var m=d.callbackStamp;l._messageCallbacks[m].call(a,d),delete l._messageCallbacks[m]}e.call(a,d)}};this._wrappedListeners[e]=c,t.addListener("message",c)}},{key:"_sendMessage",value:function(e,t,r,a,i){var l=function(d){for(var m=1;m<arguments.length;m++){var v=arguments[m]!=null?arguments[m]:{};m%2?$i(Object(v),!0).forEach(function(_){ct(d,_,v[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(v)):$i(Object(v)).forEach(function(_){Object.defineProperty(d,_,Object.getOwnPropertyDescriptor(v,_))})}return d}({},e);if(l.callClientId=r,a){var c=fr();this._messageCallbacks[c]=a,l.callbackStamp=c}t.emit("message",l)}}])}(),vn="replace",yn="shallow-merge",Ji=[vn,yn],lh=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.data,r=e.mergeStrategy,a=r===void 0?vn:r;He(this,s),s._validateMergeStrategy(a),s._validateData(t,a),this.mergeStrategy=a,this.data=t}return Ke(s,[{key:"isNoOp",value:function(){return s.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,t){return Object.keys(e).length===0&&t===yn}},{key:"_validateMergeStrategy",value:function(e){if(!Ji.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(Ji,"]"))}},{key:"_validateData",value:function(e,t){if(!function(c){if(c==null||de(c)!=="object")return!1;var d=Object.getPrototypeOf(c);return d==null||d===Object.prototype}(e))throw Error("Meeting session data must be a plain (map-like) object");var r;try{if(r=JSON.stringify(e),t===vn){var a=JSON.parse(r);Ue(a,e)||console.warn("The meeting session data provided will be modified when serialized.",a,e)}else if(t===yn){for(var i in e)if(Object.hasOwnProperty.call(e,i)&&e[i]!==void 0){var l=JSON.parse(JSON.stringify(e[i]));Ue(e[i],l)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",l,e[i])}}}catch(c){throw Error("Meeting session data must be serializable to JSON: ".concat(c))}if(r.length>Li)throw Error("Meeting session data is too large (".concat(r.length," characters). Maximum size suppported is ").concat(Li,"."))}}])}();function Ql(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ql=function(){return!!s})()}function bn(s){var e=typeof Map=="function"?new Map:void 0;return bn=function(t){if(t===null||!function(a){try{return Function.toString.call(a).indexOf("[native code]")!==-1}catch{return typeof a=="function"}}(t))return t;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(a,i,l){if(Ql())return Reflect.construct.apply(null,arguments);var c=[null];c.push.apply(c,i);var d=new(a.bind.apply(a,c));return l&&Cs(d,l.prototype),d}(t,arguments,nt(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Cs(r,t)},bn(s)}function Xl(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xl=function(){return!!s})()}function Gi(s){var e,t=(e=window._daily)===null||e===void 0?void 0:e.pendings;if(t){var r=t.indexOf(s);r!==-1&&t.splice(r,1)}}var ch=function(){return Ke(function s(e){He(this,s),this._currentLoad=null,this._callClientId=e},[{key:"load",value:function(){var s,e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;if(this.loaded)return window._daily.instances[this._callClientId].callMachine.reset(),void r(!0);s=this._callClientId,window._daily.pendings.push(s),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new uh(t,function(){r(!1)},function(i,l){l||Gi(e._callClientId),a(i,l)}),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),Gi(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}])}(),uh=function(){return Ke(function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;He(this,s),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=e,this._successCallback=t,this._failureCallback=r},[{key:"start",value:function(){var s=this;if(!this._currentAttempt){var e=function(t){s._currentAttempt.cancelled||(s._attemptsRemaining--,s._failureCallback(t,s._attemptsRemaining>0),s._attemptsRemaining<=0||setTimeout(function(){s._currentAttempt.cancelled||(s._currentAttempt=new zi(s._dailyConfig,s._successCallback,e),s._currentAttempt.start())},3e3))};this._currentAttempt=new zi(this._dailyConfig,this._successCallback,e),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}])}(),Rr=function(){function s(){return He(this,s),e=this,r=arguments,t=nt(t=s),mr(e,Xl()?Reflect.construct(t,r||[],nt(e).constructor):t.apply(e,r));var e,t,r}return pr(s,bn(Error)),Ke(s)}(),dr=2e4,zi=function(){return Ke(function e(t,r,a){He(this,e),this._loadAttemptImpl=le()||!t.avoidEval?new dh(t,r,a):new hh(t,r,a)},[{key:"start",value:(s=W(function*(){return this._loadAttemptImpl.start()}),function(){return s.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]);var s}(),dh=function(){return Ke(function a(i,l,c){He(this,a),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=i,this._successCallback=l,this._failureCallback=c},[{key:"start",value:(r=W(function*(){var a=rr(this._dailyConfig);!(yield this._tryLoadFromIOSCache(a))&&this._loadFromNetwork(a)}),function(){return r.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(t=W(function*(a){if(!this._iosCache)return!1;try{var i=yield this._iosCache.get(a);return!!this.cancelled||!!i&&(i.code?(Function('"use strict";'+i.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=i.refetchHeaders,!1))}catch{return!1}}),function(a){return t.apply(this,arguments)})},{key:"_loadFromNetwork",value:(e=W(function*(a){var i=this;this._networkTimeout=setTimeout(function(){i._networkTimedOut=!0,i._failureCallback({msg:"Timed out (>".concat(dr," ms) when loading call object bundle ").concat(a),type:"timeout"})},dr);try{var l=this._refetchHeaders?{headers:this._refetchHeaders}:{},c=yield fetch(a,l);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new Rr;var d=yield this._getBundleCodeFromResponse(a,c);if(this.cancelled)throw new Rr;Function('"use strict";'+d)(),this._iosCache&&this._iosCache.set(a,d,c.headers),this.succeeded=!0,this._successCallback()}catch(m){if(clearTimeout(this._networkTimeout),m instanceof Rr||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(a,": ").concat(m),type:m.message})}}),function(a){return e.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(s=W(function*(a,i){if(i.ok)return yield i.text();if(this._iosCache&&i.status===304)return(yield this._iosCache.renew(a,i.headers)).code;throw new Error("Received ".concat(i.status," response"))}),function(a,i){return s.apply(this,arguments)})}]);var s,e,t,r}(),hh=function(){return Ke(function s(e,t,r){He(this,s),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=e,this._successCallback=t,this._failureCallback=r,this._attemptId=fr(),this._networkTimeout=null,this._scriptElement=null},[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var s=rr(this._dailyConfig);(typeof document>"u"?"undefined":de(document))==="object"?this._startLoading(s):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(s){var e=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){e._stopLoading(),e._failureCallback({msg:"Timed out (>".concat(dr," ms) when loading call object bundle ").concat(s),type:"timeout"})},dr);var t=document.getElementsByTagName("head")[0],r=document.createElement("script");this._scriptElement=r,r.onload=function(){e._stopLoading(),e.succeeded=!0,e._successCallback()},r.onerror=function(a){e._stopLoading(),e._failureCallback({msg:"Failed to load call object bundle ".concat(a.target.src),type:a.message})},r.src=s,t.appendChild(r)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}])}(),$s=function(s,e,t){return ph(s.local,e,t)===!0},mh=function(s,e,t){return s.local.streams&&s.local.streams[e]&&s.local.streams[e].stream&&s.local.streams[e].stream["get".concat(t==="video"?"Video":"Audio","Tracks")]()[0]},Xt=function(s,e,t,r){var a=fh(s,e,t,r);return a&&a.pendingTrack},ph=function(s,e,t){if(!s)return!1;var r=function(i){switch(i){case"avatar":return!0;case"staged":return i;default:return!!i}},a=s.public.subscribedTracks;return a&&a[e]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(t)===-1&&a[e].custom?[!0,"staged"].includes(a[e].custom)?r(a[e].custom):r(a[e].custom[t]):r(a[e][t]):!a||r(a.ALL)},fh=function(s,e,t,r){var a=Object.values(s.streams||{}).filter(function(i){return i.participantId===e&&i.type===t&&i.pendingTrack&&i.pendingTrack.kind===r}).sort(function(i,l){return new Date(l.starttime)-new Date(i.starttime)});return a&&a[0]},gh=function(s,e){var t=s.local.public.customTracks;if(t&&t[e])return t[e].track};function Yi(s,e){for(var t=e.getState(),r=0,a=["cam","screen"];r<a.length;r++)for(var i=a[r],l=0,c=["video","audio"];l<c.length;l++){var d=c[l],m=i==="cam"?d:"screen".concat(d.charAt(0).toUpperCase()+d.slice(1)),v=s.tracks[m];if(v){var _=s.local?mh(t,i,d):Xt(t,s.session_id,i,d);v.state==="playable"&&(v.track=_),v.persistentTrack=_}}}function Wi(s,e){try{var t=e.getState();for(var r in s.tracks)if(!vh(r)){var a=s.tracks[r].kind;if(a){var i=s.tracks[r];if(i){var l=s.local?gh(t,r):Xt(t,s.session_id,r,a);i.state==="playable"&&(s.tracks[r].track=l),i.persistentTrack=l}}else console.error("unknown type for custom track")}}catch(c){console.error(c)}}function vh(s){return["video","audio","screenVideo","screenAudio"].includes(s)}function Hi(s,e,t){var r=t.getState();if(s.local){if(s.audio)try{s.audioTrack=r.local.streams.cam.stream.getAudioTracks()[0],s.audioTrack||(s.audio=!1)}catch{}if(s.video)try{s.videoTrack=r.local.streams.cam.stream.getVideoTracks()[0],s.videoTrack||(s.video=!1)}catch{}if(s.screen)try{s.screenVideoTrack=r.local.streams.screen.stream.getVideoTracks()[0],s.screenAudioTrack=r.local.streams.screen.stream.getAudioTracks()[0],s.screenVideoTrack||s.screenAudioTrack||(s.screen=!1)}catch{}}else{var a=!0;try{var i=r.participants[s.session_id];i&&i.public&&i.public.rtcType&&i.public.rtcType.impl==="peer-to-peer"&&i.private&&!["connected","completed"].includes(i.private.peeringState)&&(a=!1)}catch(v){console.error(v)}if(!a)return s.audio=!1,s.audioTrack=!1,s.video=!1,s.videoTrack=!1,s.screen=!1,void(s.screenTrack=!1);try{if(r.streams,s.audio&&$s(r,s.session_id,"cam-audio")){var l=Xt(r,s.session_id,"cam","audio");l&&(e&&e.audioTrack&&e.audioTrack.id===l.id?s.audioTrack=l:l.muted||(s.audioTrack=l)),s.audioTrack||(s.audio=!1)}if(s.video&&$s(r,s.session_id,"cam-video")){var c=Xt(r,s.session_id,"cam","video");c&&(e&&e.videoTrack&&e.videoTrack.id===c.id?s.videoTrack=c:c.muted||(s.videoTrack=c)),s.videoTrack||(s.video=!1)}if(s.screen&&$s(r,s.session_id,"screen-audio")){var d=Xt(r,s.session_id,"screen","audio");d&&(e&&e.screenAudioTrack&&e.screenAudioTrack.id===d.id?s.screenAudioTrack=d:d.muted||(s.screenAudioTrack=d))}if(s.screen&&$s(r,s.session_id,"screen-video")){var m=Xt(r,s.session_id,"screen","video");m&&(e&&e.screenVideoTrack&&e.screenVideoTrack.id===m.id?s.screenVideoTrack=m:m.muted||(s.screenVideoTrack=m))}s.screenVideoTrack||s.screenAudioTrack||(s.screen=!1)}catch(v){console.error("unexpected error matching up tracks",v)}}}function yh(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return Ki(d,m);var v={}.toString.call(d).slice(8,-1);return v==="Object"&&d.constructor&&(v=d.constructor.name),v==="Map"||v==="Set"?Array.from(d):v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v)?Ki(d,m):void 0}}(s))||e){t&&(s=t);var r=0,a=function(){};return{s:a,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function Ki(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,r=Array(e);t<e;t++)r[t]=s[t];return r}var ot=new Map,ns=null;function bh(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return Qi(d,m);var v={}.toString.call(d).slice(8,-1);return v==="Object"&&d.constructor&&(v=d.constructor.name),v==="Map"||v==="Set"?Array.from(d):v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v)?Qi(d,m):void 0}}(s))||e){t&&(s=t);var r=0,a=function(){};return{s:a,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function Qi(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,r=Array(e);t<e;t++)r[t]=s[t];return r}var lt=new Map,ws=null;function _h(s){Zl()?function(e){ot.has(e)||(ot.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(t){ot.has(e)&&(ot.get(e).lastDevicesString=JSON.stringify(t),ns||(ns=function(){var r=W(function*(){var a,i=yield navigator.mediaDevices.enumerateDevices(),l=yh(ot.keys());try{for(l.s();!(a=l.n()).done;){var c=a.value,d=JSON.stringify(i);d!==ot.get(c).lastDevicesString&&(ot.get(c).lastDevicesString=d,c(i))}}catch(m){l.e(m)}finally{l.f()}});return function(){return r.apply(this,arguments)}}(),navigator.mediaDevices.addEventListener("devicechange",ns)))}).catch(function(){}))}(s):function(e){lt.has(e)||(lt.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(t){lt.has(e)&&(lt.get(e).lastDevicesString=JSON.stringify(t),ws||(ws=setInterval(W(function*(){var r,a=yield navigator.mediaDevices.enumerateDevices(),i=bh(lt.keys());try{for(i.s();!(r=i.n()).done;){var l=r.value,c=JSON.stringify(a);c!==lt.get(l).lastDevicesString&&(lt.get(l).lastDevicesString=c,l(a))}}catch(d){i.e(d)}finally{i.f()}}),3e3)))}))}(s)}function xh(s){Zl()?function(e){ot.has(e)&&(ot.delete(e),ot.size===0&&ns&&(navigator.mediaDevices.removeEventListener("devicechange",ns),ns=null))}(s):function(e){lt.has(e)&&(lt.delete(e),lt.size===0&&ws&&(clearInterval(ws),ws=null))}(s)}function Zl(){var s;return le()||((s=navigator.mediaDevices)===null||s===void 0?void 0:s.ondevicechange)!==void 0}var wh=new Set;function Sh(s,e){return s&&s.readyState==="live"&&!function(t,r){return t.muted&&!wh.has(t.id)}(s)}function Xi(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,r)}return t}function St(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Xi(Object(t),!0).forEach(function(r){ct(s,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Xi(Object(t)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(t,r))})}return s}var xs=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),jh=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),Ss=Object.values(xs),Zi=["v","a","sv","sa","cv","ca"];Object.freeze(Ss.reduce(function(s,e,t){return s[e]=Zi[t],s},{})),Object.freeze(Zi.reduce(function(s,e,t){return s[e]=Ss[t],s},{}));var kh=[xs.VIDEO,xs.AUDIO,xs.SCREEN_VIDEO,xs.SCREEN_AUDIO],eo=Object.values(jh),to=["p","s","t"];Object.freeze(eo.reduce(function(s,e,t){return s[e]=to[t],s},{})),Object.freeze(to.reduce(function(s,e,t){return s[e]=eo[t],s},{}));var ec=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.base,r=e.byUserId,a=e.byParticipantId;He(this,s),this.base=t,this.byUserId=r,this.byParticipantId=a}return Ke(s,[{key:"clone",value:function(){var e=new s;if(this.base instanceof Oe?e.base=this.base.clone():e.base=this.base,this.byUserId!==void 0)for(var t in e.byUserId={},this.byUserId){var r=this.byUserId[t];e.byUserId[t]=r instanceof Oe?r.clone():r}if(this.byParticipantId!==void 0)for(var a in e.byParticipantId={},this.byParticipantId){var i=this.byParticipantId[a];e.byParticipantId[a]=i instanceof Oe?i.clone():i}return e}},{key:"toJSONObject",value:function(){var e={};if(typeof this.base=="boolean"?e.base=this.base:this.base instanceof Oe&&(e.base=this.base.toJSONObject()),this.byUserId!==void 0)for(var t in e.byUserId={},this.byUserId){var r=this.byUserId[t];e.byUserId[t]=r instanceof Oe?r.toJSONObject():r}if(this.byParticipantId!==void 0)for(var a in e.byParticipantId={},this.byParticipantId){var i=this.byParticipantId[a];e.byParticipantId[a]=i instanceof Oe?i.toJSONObject():i}return e}},{key:"toMinifiedJSONObject",value:function(){var e={};if(this.base!==void 0&&(typeof this.base=="boolean"?e.b=this.base:e.b=this.base.toMinifiedJSONObject()),this.byUserId!==void 0)for(var t in e.u={},this.byUserId){var r=this.byUserId[t];e.u[t]=typeof r=="boolean"?r:r.toMinifiedJSONObject()}if(this.byParticipantId!==void 0)for(var a in e.p={},this.byParticipantId){var i=this.byParticipantId[a];e.p[a]=typeof i=="boolean"?i:i.toMinifiedJSONObject()}return e}},{key:"normalize",value:function(){return this.base instanceof Oe&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map(function(e){var t=Re(e,2),r=t[0],a=t[1];return[r,a instanceof Oe?a.normalize():a]}))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map(function(e){var t=Re(e,2),r=t[0],a=t[1];return[r,a instanceof Oe?a.normalize():a]}))),this}}],[{key:"fromJSONObject",value:function(e){var t,r,a;if(e.base!==void 0&&(t=typeof e.base=="boolean"?e.base:Oe.fromJSONObject(e.base)),e.byUserId!==void 0)for(var i in r={},e.byUserId){var l=e.byUserId[i];r[i]=typeof l=="boolean"?l:Oe.fromJSONObject(l)}if(e.byParticipantId!==void 0)for(var c in a={},e.byParticipantId){var d=e.byParticipantId[c];a[c]=typeof d=="boolean"?d:Oe.fromJSONObject(d)}return new s({base:t,byUserId:r,byParticipantId:a})}},{key:"fromMinifiedJSONObject",value:function(e){var t,r,a;if(e.b!==void 0&&(t=typeof e.b=="boolean"?e.b:Oe.fromMinifiedJSONObject(e.b)),e.u!==void 0)for(var i in r={},e.u){var l=e.u[i];r[i]=typeof l=="boolean"?l:Oe.fromMinifiedJSONObject(l)}if(e.p!==void 0)for(var c in a={},e.p){var d=e.p[c];a[c]=typeof d=="boolean"?d:Oe.fromMinifiedJSONObject(d)}return new s({base:t,byUserId:r,byParticipantId:a})}},{key:"validateJSONObject",value:function(e){if(de(e)!=="object")return[!1,"canReceive must be an object"];for(var t=["base","byUserId","byParticipantId"],r=0,a=Object.keys(e);r<a.length;r++){var i=a[r];if(!t.includes(i))return[!1,"canReceive can only contain keys (".concat(t.join(", "),")")];if(i==="base"){var l=Re(Oe.validateJSONObject(e.base,!0),2),c=l[0],d=l[1];if(!c)return[!1,d]}else{if(de(e[i])!=="object")return[!1,"invalid (non-object) value for field '".concat(i,"' in canReceive")];for(var m=0,v=Object.values(e[i]);m<v.length;m++){var _=v[m],N=Re(Oe.validateJSONObject(_),2),E=N[0],j=N[1];if(!E)return[!1,j]}}}return[!0]}}])}(),Oe=function(){function s(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.video,r=e.audio,a=e.screenVideo,i=e.screenAudio,l=e.customVideo,c=e.customAudio;He(this,s),this.video=t,this.audio=r,this.screenVideo=a,this.screenAudio=i,this.customVideo=l,this.customAudio=c}return Ke(s,[{key:"clone",value:function(){var e=new s;return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=St({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=St({},this.customAudio)),e}},{key:"toJSONObject",value:function(){var e={};return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=St({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=St({},this.customAudio)),e}},{key:"toMinifiedJSONObject",value:function(){var e={};return this.video!==void 0&&(e.v=this.video),this.audio!==void 0&&(e.a=this.audio),this.screenVideo!==void 0&&(e.sv=this.screenVideo),this.screenAudio!==void 0&&(e.sa=this.screenAudio),this.customVideo!==void 0&&(e.cv=St({},this.customVideo)),this.customAudio!==void 0&&(e.ca=St({},this.customAudio)),e}},{key:"normalize",value:function(){function e(t,r){return t&&Object.keys(t).length===1&&t["*"]===r}return!(this.video!==!0||this.audio!==!0||this.screenVideo!==!0||this.screenAudio!==!0||!e(this.customVideo,!0)||!e(this.customAudio,!0))||(this.video!==!1||this.audio!==!1||this.screenVideo!==!1||this.screenAudio!==!1||!e(this.customVideo,!1)||!e(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(e){return new s({video:e,audio:e,screenVideo:e,screenAudio:e,customVideo:{"*":e},customAudio:{"*":e}})}},{key:"fromJSONObject",value:function(e){return new s({video:e.video,audio:e.audio,screenVideo:e.screenVideo,screenAudio:e.screenAudio,customVideo:e.customVideo!==void 0?St({},e.customVideo):void 0,customAudio:e.customAudio!==void 0?St({},e.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(e){return new s({video:e.v,audio:e.a,screenVideo:e.sv,screenAudio:e.sa,customVideo:e.cv,customAudio:e.ca})}},{key:"validateJSONObject",value:function(e,t){if(typeof e=="boolean")return[!0];if(de(e)!=="object")return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var r=Object.keys(e),a=0,i=r;a<i.length;a++){var l=i[a];if(!Ss.includes(l))return[!1,"invalid media type '".concat(l,"' in canReceive")];if(kh.includes(l)){if(typeof e[l]!="boolean")return[!1,"invalid (non-boolean) value for media type '".concat(l,"' in canReceive")]}else{if(de(e[l])!=="object")return[!1,"invalid (non-object) value for media type '".concat(l,"' in canReceive")];for(var c=0,d=Object.values(e[l]);c<d.length;c++)if(typeof d[c]!="boolean")return[!1,"invalid (non-boolean) value for entry within '".concat(l,"' in canReceive")];if(t&&e[l]["*"]===void 0)return[!1,`canReceive "base" permission must specify "*" as an entry within '`.concat(l,"'")]}}return t&&r.length!==Ss.length?[!1,'canReceive "base" permission must specify all media types: '.concat(Ss.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])}(),Ch=["result"],Eh=["preserveIframe"];function so(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),t.push.apply(t,r)}return t}function J(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?so(Object(t),!0).forEach(function(r){ct(s,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):so(Object(t)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(t,r))})}return s}function tc(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tc=function(){return!!s})()}function ro(s,e){var t=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!t){if(Array.isArray(s)||(t=function(d,m){if(d){if(typeof d=="string")return no(d,m);var v={}.toString.call(d).slice(8,-1);return v==="Object"&&d.constructor&&(v=d.constructor.name),v==="Map"||v==="Set"?Array.from(d):v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v)?no(d,m):void 0}}(s))||e){t&&(s=t);var r=0,a=function(){};return{s:a,n:function(){return r>=s.length?{done:!0}:{done:!1,value:s[r++]}},e:function(d){throw d},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,l=!0,c=!1;return{s:function(){t=t.call(s)},n:function(){var d=t.next();return l=d.done,d},e:function(d){c=!0,i=d},f:function(){try{l||t.return==null||t.return()}finally{if(c)throw i}}}}function no(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,r=Array(e);t<e;t++)r[t]=s[t];return r}var Ft={},ao="video",Nh="voice",io=le()?{data:{}}:{data:{},topology:"none"},oo={present:0,hidden:0},sc={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},Fr=Object.keys(sc),lo=["state","volume","simulcastEncodings"],co={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},hr={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},_n={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},Vt={customIntegrations:{validate:uc,help:lc()},customTrayButtons:{validate:cc,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(hr))},url:{validate:function(s){return typeof s=="string"},help:"url should be a string"},baseUrl:{validate:function(s){return typeof s=="string"},help:"baseUrl should be a string"},token:{validate:function(s){return typeof s=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(s,e){try{return e.validateDailyConfig(s),!0}catch(t){console.error("Failed to validate dailyConfig",t)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(s){return dc(s,co)},help:"reactNativeConfig should look like ".concat(JSON.stringify(co),", all fields optional")},lang:{validate:function(s){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(s)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(s){try{return rc(s),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(s,e){if(typeof s=="boolean")return e._preloadCache.allowLocalVideo=s,!0;var t;if(s instanceof MediaStreamTrack)e._sharedTracks.videoTrack=s,t={customTrack:gt};else{if(delete e._sharedTracks.videoTrack,typeof s!="string")return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;t={deviceId:s}}return e._updatePreloadCacheInputSettings({video:{settings:t}},!1),!0}},audioSource:{validate:function(s,e){if(typeof s=="boolean")return e._preloadCache.allowLocalAudio=s,!0;var t;if(s instanceof MediaStreamTrack)e._sharedTracks.audioTrack=s,t={customTrack:gt};else{if(delete e._sharedTracks.audioTrack,typeof s!="string")return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;t={deviceId:s}}return e._updatePreloadCacheInputSettings({audio:{settings:t}},!1),!0}},subscribeToTracksAutomatically:{validate:function(s,e){return e._preloadCache.subscribeToTracksAutomatically=s,!0}},theme:{validate:function(s){var e=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],t=function(r){for(var a=0,i=Object.keys(r);a<i.length;a++){var l=i[a];if(!e.includes(l))return console.error('unsupported color "'.concat(l,'". Valid colors: ').concat(e.join(", "))),!1;if(!r[l].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(l,' theme color should be provided in valid hex color format. Received: "').concat(r[l],'"')),!1}return!0};return de(s)==="object"&&("light"in s&&"dark"in s||"colors"in s)?"light"in s&&"dark"in s?"colors"in s.light?"colors"in s.dark?t(s.light.colors)&&t(s.dark.colors):(console.error('Dark theme is missing "colors" property.',s),!1):(console.error('Light theme is missing "colors" property.',s),!1):t(s.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',s),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(s){if("grid"in s){var e=s.grid;if("maxTilesPerPage"in e){if(!Number.isInteger(e.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(e.maxTilesPerPage,".")),!1;if(e.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in e){if(!Number.isInteger(e.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(e.minTilesPerPage,".")),!1;if(e.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in e&&e.minTilesPerPage>e.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(s){return nc(s,{allowAllParticipantsKey:!1})},help:oc({allowAllParticipantsKey:!1})},sendSettings:{validate:function(s,e){return!!function(t,r){try{return r.validateUpdateSendSettings(t),!0}catch(a){return console.error("Failed to validate send settings",a),!1}}(s,e)&&(e._preloadCache.sendSettings=s,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(s,e){var t;return!!ac(s)&&(e._inputSettings||(e._inputSettings={}),ic(s,(t=e.properties)===null||t===void 0?void 0:t.dailyConfig,e._sharedTracks),e._updatePreloadCacheInputSettings(s,!0),!0)},help:xn()},layout:{validate:function(s){return s==="custom-v1"||s==="browser"||s==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},Js={styles:{validate:function(s){for(var e in s)if(e!=="cam"&&e!=="screen")return!1;if(s.cam){for(var t in s.cam)if(t!=="div"&&t!=="video")return!1}if(s.screen){for(var r in s.screen)if(r!=="div"&&r!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(s,e){if(e._preloadCache.subscribeToTracksAutomatically)return!1;var t=[!0,!1,"staged"];if(t.includes(s)||!le()&&s==="avatar")return!0;var r=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],a=function(i){var l=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var c in i)if(c==="custom"){if(!t.includes(i[c])&&!a(i[c],!0))return!1}else{var d=!l&&!r.includes(c),m=!t.includes(i[c]);if(d||m)return!1}return!0};return a(s)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(le()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(s){return s===!1},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(s){for(var e=0,t=Object.entries(s);e<t.length;e++){var r=Re(t[e],2),a=r[0],i=r[1];switch(a){case"hasPresence":if(typeof i!="boolean")return!1;break;case"canSend":if(i instanceof Set||i instanceof Array||Array.isArray(i)){var l,c=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],d=ro(i);try{for(d.s();!(l=d.n()).done;){var m=l.value;if(!c.includes(m))return!1}}catch(C){d.e(C)}finally{d.f()}}else if(typeof i!="boolean")return!1;(i instanceof Array||Array.isArray(i))&&(s.canSend=new Set(i));break;case"canReceive":var v=Re(ec.validateJSONObject(i),2),_=v[0],N=v[1];if(!_)return console.error(N),!1;break;case"canAdmin":if(i instanceof Set||i instanceof Array||Array.isArray(i)){var E,j=["participants","streaming","transcription"],y=ro(i);try{for(y.s();!(E=y.n()).done;){var S=E.value;if(!j.includes(S))return!1}}catch(C){y.e(C)}finally{y.f()}}else if(typeof i!="boolean")return!1;(i instanceof Array||Array.isArray(i))&&(s.canAdmin=new Set(i));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};Promise.any||(Promise.any=function(){var s=W(function*(e){return new Promise(function(t,r){var a=[];e.forEach(function(i){return Promise.resolve(i).then(function(l){t(l)}).catch(function(l){a.push(l),a.length===e.length&&r(a)})})})});return function(e){return s.apply(this,arguments)}}());var Th=function(){function s(o){var h,u,p,g,k,P,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(He(this,s),p=this,g=nt(g=s),ct(u=mr(p,tc()?Reflect.construct(g,[],nt(p).constructor):g.apply(p,k)),"startListeningForDeviceChanges",function(){_h(u.handleDeviceChange)}),ct(u,"stopListeningForDeviceChanges",function(){xh(u.handleDeviceChange)}),ct(u,"handleDeviceChange",function(te){te=te.map(function(re){return JSON.parse(JSON.stringify(re))}),u.emitDailyJSEvent({action:"available-devices-updated",availableDevices:te})}),ct(u,"handleNativeAppStateChange",function(){var te=W(function*(re){if(re==="destroyed")return console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),void(yield u.destroy());var Je=re==="active";u.disableReactNativeAutoDeviceManagement("video")||(Je?u.camUnmutedBeforeLosingNativeActiveState&&u.setLocalVideo(!0):(u.camUnmutedBeforeLosingNativeActiveState=u.localVideo(),u.camUnmutedBeforeLosingNativeActiveState&&u.setLocalVideo(!1)))});return function(re){return te.apply(this,arguments)}}()),ct(u,"handleNativeAudioFocusChange",function(te){u.disableReactNativeAutoDeviceManagement("audio")||(u._hasNativeAudioFocus=te,u.toggleParticipantAudioBasedOnNativeAudioFocus(),u._hasNativeAudioFocus?u.micUnmutedBeforeLosingNativeAudioFocus&&u.setLocalAudio(!0):(u.micUnmutedBeforeLosingNativeAudioFocus=u.localAudio(),u.setLocalAudio(!1)))}),ct(u,"handleNativeSystemScreenCaptureStop",function(){u.stopScreenShare()}),u.strictMode=D.strictMode===void 0||D.strictMode,u.allowMultipleCallInstances=(h=D.allowMultipleCallInstances)!==null&&h!==void 0&&h,Object.keys(Ft).length&&(u._logDuplicateInstanceAttempt(),!u.allowMultipleCallInstances)){if(u.strictMode)throw new Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),u.callClientId=fr(),Ft[(P=u).callClientId]=P,window._daily.instances[u.callClientId]={},u._sharedTracks={},window._daily.instances[u.callClientId].tracks=u._sharedTracks,D.dailyJsVersion=s.version(),u._iframe=o,u._callObjectMode=D.layout==="none"&&!u._iframe,u._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},D.showLocalVideo!==void 0?u._callObjectMode?console.error("showLocalVideo is not available in call object mode"):u._showLocalVideo=!!D.showLocalVideo:u._showLocalVideo=!0,D.showParticipantsBar!==void 0?u._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):u._showParticipantsBar=!!D.showParticipantsBar:u._showParticipantsBar=!0,D.customIntegrations!==void 0?u._callObjectMode?console.error("customIntegrations is not available in call object mode"):u._customIntegrations=D.customIntegrations:u._customIntegrations={},D.customTrayButtons!==void 0?u._callObjectMode?console.error("customTrayButtons is not available in call object mode"):u._customTrayButtons=D.customTrayButtons:u._customTrayButtons={},D.activeSpeakerMode!==void 0?u._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):u._activeSpeakerMode=!!D.activeSpeakerMode:u._activeSpeakerMode=!1,D.receiveSettings?u._callObjectMode?u._receiveSettings=D.receiveSettings:console.error("receiveSettings is only available in call object mode"):u._receiveSettings={},u.validateProperties(D),u.properties=J({},D),u._inputSettings||(u._inputSettings={}),u._callObjectLoader=u._callObjectMode?new ch(u.callClientId):null,u._callState=on,u._isPreparingToJoin=!1,u._accessState={access:Ws},u._meetingSessionSummary={},u._finalSummaryOfPrevSession={},u._meetingSessionState=qr(io,u._callObjectMode),u._nativeInCallAudioMode=ao,u._participants={},u._isScreenSharing=!1,u._participantCounts=oo,u._rmpPlayerState={},u._waitingParticipants={},u._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},u._activeSpeaker={},u._localAudioLevel=0,u._isLocalAudioLevelObserverRunning=!1,u._remoteParticipantsAudioLevel={},u._isRemoteParticipantsAudioLevelObserverRunning=!1,u._maxAppMessageSize=Or,u._messageChannel=le()?new oh:new ih,u._iframe&&(u._iframe.requestFullscreen?u._iframe.addEventListener("fullscreenchange",function(){document.fullscreenElement===u._iframe?(u.emitDailyJSEvent({action:bs}),u.sendMessageToCallMachine({action:bs})):(u.emitDailyJSEvent({action:_s}),u.sendMessageToCallMachine({action:_s}))}):u._iframe.webkitRequestFullscreen&&u._iframe.addEventListener("webkitfullscreenchange",function(){document.webkitFullscreenElement===u._iframe?(u.emitDailyJSEvent({action:bs}),u.sendMessageToCallMachine({action:bs})):(u.emitDailyJSEvent({action:_s}),u.sendMessageToCallMachine({action:_s}))})),le()){var V=u.nativeUtils();V.addAudioFocusChangeListener&&V.removeAudioFocusChangeListener&&V.addAppStateChangeListener&&V.removeAppStateChangeListener&&V.addSystemScreenCaptureStopListener&&V.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),u._hasNativeAudioFocus=!0,V.addAudioFocusChangeListener(u.handleNativeAudioFocusChange),V.addAppStateChangeListener(u.handleNativeAppStateChange),V.addSystemScreenCaptureStopListener(u.handleNativeSystemScreenCaptureStop)}return u._callObjectMode&&u.startListeningForDeviceChanges(),u._messageChannel.addListenerForMessagesFromCallMachine(u.handleMessageFromCallMachine,u.callClientId,u),u}return pr(s,Ps),Ke(s,[{key:"destroy",value:(Fe=W(function*(){var o;try{yield this.leave()}catch{}var h=this._iframe;if(h){var u=h.parentElement;u&&u.removeChild(h)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),le()){var p=this.nativeUtils();p.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),p.removeAppStateChangeListener(this.handleNativeAppStateChange),p.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete Ft[this.callClientId],!((o=window)===null||o===void 0||(o=o._daily)===null||o===void 0)&&o.instances&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)}),function(){return Fe.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(o){var h=o.bodyClass,u=o.cssFile,p=o.cssText;return ne(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(u),bodyClass:h,cssText:p}),this}},{key:"iframe",value:function(){return ne(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return tt(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return tt(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(o,h){for(var u in h){if(!Js[u])throw new Error("unrecognized updateParticipant property ".concat(u));if(Js[u].validate&&!Js[u].validate(h[u],this,this._participants[o]))throw new Error(Js[u].help)}}},{key:"updateParticipant",value:function(o,h){return this._participants.local&&this._participants.local.session_id===o&&(o="local"),o&&h&&(this.validateParticipantProperties(o,h),this.sendMessageToCallMachine({action:"update-participant",id:o,properties:h})),this}},{key:"updateParticipants",value:function(o){var h=this._participants.local&&this._participants.local.session_id;for(var u in o)u===h&&(u="local"),u&&o[u]&&this.validateParticipantProperties(u,o[u]);return this.sendMessageToCallMachine({action:"update-participants",participants:o}),this}},{key:"updateWaitingParticipant",value:(be=W(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(tt(this._callObjectMode,"updateWaitingParticipant()"),ge(this._callState,"updateWaitingParticipant()"),typeof h!="string"||de(u)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(p,g){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:h,updates:u},function(k){k.error&&g(k.error),k.id||g(new Error("unknown error in updateWaitingParticipant()")),p({id:k.id})})})}),function(){return be.apply(this,arguments)})},{key:"updateWaitingParticipants",value:(Te=W(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tt(this._callObjectMode,"updateWaitingParticipants()"),ge(this._callState,"updateWaitingParticipants()"),de(h)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(u,p){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:h},function(g){g.error&&p(g.error),g.ids||p(new Error("unknown error in updateWaitingParticipants()")),u({ids:g.ids})})})}),function(){return Te.apply(this,arguments)})},{key:"requestAccess",value:(b=W(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=h.access,p=u===void 0?{level:Bo}:u,g=h.name,k=g===void 0?"":g;return tt(this._callObjectMode,"requestAccess()"),ge(this._callState,"requestAccess()"),new Promise(function(P,D){o.sendMessageToCallMachine({action:"daily-method-request-access",access:p,name:k},function(V){V.error&&D(V.error),V.access||D(new Error("unknown error in requestAccess()")),P({access:V.access,granted:V.granted})})})}),function(){return b.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"forceDiscardTrack"in h&&(le()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),h={}):o&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),h={})),this.sendMessageToCallMachine({action:"local-audio",state:o,options:h}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(o){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:o}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(o){return this.sendMessageToCallMachine({action:"local-video",state:o}),this}},{key:"_setAllowLocalAudio",value:function(o){if(this._preloadCache.allowLocalAudio=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:o}),this}},{key:"_setAllowLocalVideo",value:function(o){if(this._preloadCache.allowLocalVideo=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:o}),this}},{key:"getReceiveSettings",value:(Pt=W(function*(o){var h=this,u=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,p=u!==void 0&&u;if(tt(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(de(o)){case"string":return new Promise(function(g){h.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:o,showInheritedValues:p},function(k){g(k.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}}),function(o){return Pt.apply(this,arguments)})},{key:"updateReceiveSettings",value:(z=W(function*(o){var h=this;if(tt(this._callObjectMode,"updateReceiveSettings()"),!nc(o,{allowAllParticipantsKey:!0}))throw new Error(oc({allowAllParticipantsKey:!0}));return ge(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise(function(u){h.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:o},function(p){u({receiveSettings:p.receiveSettings})})})}),function(o){return z.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(o,h){if(o){var u={};if(o.audio){var p,g,k;o.audio.settings&&(!Object.keys(o.audio.settings).length&&h||(u.audio={settings:J({},o.audio.settings)})),h&&(p=u.audio)!==null&&p!==void 0&&(p=p.settings)!==null&&p!==void 0&&p.customTrack&&(u.audio.settings={customTrack:this._sharedTracks.audioTrack});var P=((g=o.audio.processor)===null||g===void 0?void 0:g.type)==="none"&&((k=o.audio.processor)===null||k===void 0?void 0:k._isDefaultWhenNone);if(o.audio.processor&&!P){var D=J({},o.audio.processor);delete D._isDefaultWhenNone,u.audio=J(J({},u.audio),{},{processor:D})}}if(o.video){var V,te,re;o.video.settings&&(!Object.keys(o.video.settings).length&&h||(u.video={settings:J({},o.video.settings)})),h&&(V=u.video)!==null&&V!==void 0&&(V=V.settings)!==null&&V!==void 0&&V.customTrack&&(u.video.settings={customTrack:this._sharedTracks.videoTrack});var Je=((te=o.video.processor)===null||te===void 0?void 0:te.type)==="none"&&((re=o.video.processor)===null||re===void 0?void 0:re._isDefaultWhenNone);if(o.video.processor&&!Je){var at=J({},o.video.processor);delete at._isDefaultWhenNone,u.video=J(J({},u.video),{},{processor:at})}}return u}}},{key:"getInputSettings",value:function(){var o=this;return ne(),new Promise(function(h){h(o._getInputSettings())})}},{key:"_getInputSettings",value:function(){var o,h,u,p,g,k,P={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(o=((u=this._inputSettings)===null||u===void 0?void 0:u.video)||P,h=((p=this._inputSettings)===null||p===void 0?void 0:p.audio)||P):(o=((g=this._preloadCache)===null||g===void 0||(g=g.inputSettings)===null||g===void 0?void 0:g.video)||P,h=((k=this._preloadCache)===null||k===void 0||(k=k.inputSettings)===null||k===void 0?void 0:k.audio)||P);var D={audio:h,video:o};return this._prepInputSettingsForSharing(D,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(o,h){var u=this._inputSettings||{},p={};if(o.video){var g,k,P;p.video={},o.video.settings?(p.video.settings={},h||o.video.settings.customTrack||(P=u.video)===null||P===void 0||!P.settings?p.video.settings=o.video.settings:p.video.settings=J(J({},u.video.settings),o.video.settings),Object.keys(p.video.settings).length||delete p.video.settings):(g=u.video)!==null&&g!==void 0&&g.settings&&(p.video.settings=u.video.settings),o.video.processor?p.video.processor=o.video.processor:(k=u.video)!==null&&k!==void 0&&k.processor&&(p.video.processor=u.video.processor)}else u.video&&(p.video=u.video);if(o.audio){var D,V,te;p.audio={},o.audio.settings?(p.audio.settings={},h||o.audio.settings.customTrack||(te=u.audio)===null||te===void 0||!te.settings?p.audio.settings=o.audio.settings:p.audio.settings=J(J({},u.audio.settings),o.audio.settings),Object.keys(p.audio.settings).length||delete p.audio.settings):(D=u.audio)!==null&&D!==void 0&&D.settings&&(p.audio.settings=u.audio.settings),o.audio.processor?p.audio.processor=o.audio.processor:(V=u.audio)!==null&&V!==void 0&&V.processor&&(p.audio.processor=u.audio.processor)}else u.audio&&(p.audio=u.audio);this._maybeUpdateInputSettings(p)}},{key:"_devicesFromInputSettings",value:function(o){var h,u,p=(o==null||(h=o.video)===null||h===void 0||(h=h.settings)===null||h===void 0?void 0:h.deviceId)||null,g=(o==null||(u=o.audio)===null||u===void 0||(u=u.settings)===null||u===void 0?void 0:u.deviceId)||null,k=this._preloadCache.outputDeviceId||null;return{camera:p?{deviceId:p}:{},mic:g?{deviceId:g}:{},speaker:k?{deviceId:k}:{}}}},{key:"updateInputSettings",value:($e=W(function*(o){var h=this;return ne(),ac(o)?o.video||o.audio?(ic(o,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(o,!0),this._getInputSettings()):new Promise(function(u,p){h.sendMessageToCallMachine({action:"update-input-settings",inputSettings:o},function(g){if(g.error)p(g.error);else{if(g.returnPreloadCache)return h._updatePreloadCacheInputSettings(o,!0),void u(h._getInputSettings());h._maybeUpdateInputSettings(g.inputSettings),u(h._prepInputSettingsForSharing(g.inputSettings,!0))}})})):this._getInputSettings():(console.error(xn()),Promise.reject(xn()))}),function(o){return $e.apply(this,arguments)})},{key:"setBandwidth",value:function(o){var h=o.kbs,u=o.trackConstraints;if(ne(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:h,trackConstraints:u}),this}},{key:"getDailyLang",value:function(){var o=this;if(ne(),this._callMachineInitialized)return new Promise(function(h){o.sendMessageToCallMachine({action:"get-daily-lang"},function(u){delete u.action,delete u.callbackStamp,h(u)})})}},{key:"setDailyLang",value:function(o){return ne(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:o}),this}},{key:"setProxyUrl",value:function(o){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:o}),this}},{key:"setIceConfig",value:function(o){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:o}),this}},{key:"meetingSessionSummary",value:function(){return[Ct,dt].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(Ee=W(function*(){var o=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),ge(this._callState,"getMeetingSession()"),new Promise(function(h){o.sendMessageToCallMachine({action:"get-meeting-session"},function(u){delete u.action,delete u.callbackStamp,h(u)})})}),function(){return Ee.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return ge(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"replace";tt(this._callObjectMode,"setMeetingSessionData()"),ge(this._callState,"setMeetingSessionData");try{(function(u,p){new lh({data:u,mergeStrategy:p})})(o,h)}catch(u){throw console.error(u),u}try{this.sendMessageToCallMachine({action:"set-session-data",data:o,mergeStrategy:h})}catch(u){throw new Error("Error setting meeting session data: ".concat(u))}}},{key:"setUserName",value:function(o,h){var u=this;return this.properties.userName=o,new Promise(function(p){u.sendMessageToCallMachine({action:"set-user-name",name:o??"",thisMeetingOnly:le()||!!h&&!!h.thisMeetingOnly},function(g){delete g.action,delete g.callbackStamp,p(g)})})}},{key:"setUserData",value:(q=W(function*(o){var h=this;try{rc(o)}catch(u){throw console.error(u),u}if(this.properties.userData=o,this._callMachineInitialized)return new Promise(function(u){try{h.sendMessageToCallMachine({action:"set-user-data",userData:o},function(p){delete p.action,delete p.callbackStamp,u(p)})}catch(p){throw new Error("Error setting user data: ".concat(p))}})}),function(o){return q.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(o){if(o&&(o<100||typeof o!="number"))throw new Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(o){var h=this;if(typeof AudioWorkletNode>"u"&&!le())throw new Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise(function(u,p){h.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:o},function(g){h._isLocalAudioLevelObserverRunning=!g.error,g.error?p({error:g.error}):u()})});this._preloadCache.localAudioLevelObserver={enabled:!0,interval:o}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(o){var h=this;if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise(function(u,p){h.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:o},function(g){h._isRemoteParticipantsAudioLevelObserverRunning=!g.error,g.error?p({error:g.error}):u()})});this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:o}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(R=W(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tt(this._callObjectMode,"startCamera()"),Vr(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(h)}catch(u){return Promise.reject(u)}else{if(this._didPreAuth){if(h.url&&h.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(h.token&&h.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(h),this.properties=J(J({},this.properties),h)}return new Promise(function(u){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"start-camera",properties:Qt(o.properties,o.callClientId),preloadCache:Qt(o._preloadCache,o.callClientId)},function(p){u({camera:p.camera,mic:p.mic,speaker:p.speaker})})})}),function(){return R.apply(this,arguments)})},{key:"validateCustomTrack",value:function(o,h,u){if(u&&u.length>50)throw new Error("Custom track `trackName` must not be more than 50 characters");if(h&&h!=="music"&&h!=="speech"&&!(h instanceof Object))throw new Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(u&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(u))throw new Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(o instanceof MediaStreamTrack))throw new Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{track,mode,trackName};return ne(),ge(this._callState,"startCustomTrack()"),this.validateCustomTrack(h.track,h.mode,h.trackName),new Promise(function(u,p){o._sharedTracks.customTrack=h.track,h.track=gt,o.sendMessageToCallMachine({action:"start-custom-track",properties:h},function(g){g.error?p({error:g.error}):u(g.mediaTag)})})}},{key:"stopCustomTrack",value:function(o){var h=this;return ne(),ge(this._callState,"stopCustomTrack()"),new Promise(function(u){h.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:o},function(p){u(p.mediaTag)})})}},{key:"setCamera",value:function(o){var h=this;return gs(),Gs(this._callMachineInitialized,"setCamera()"),new Promise(function(u){h.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:o},function(p){u({device:p.device})})})}},{key:"setAudioDevice",value:(x=W(function*(o){return gs(),this.nativeUtils().setAudioDevice(o),{deviceId:yield this.nativeUtils().getAudioDevice()}}),function(o){return x.apply(this,arguments)})},{key:"cycleCamera",value:function(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(u){o.sendMessageToCallMachine({action:"cycle-camera",properties:h},function(p){u({device:p.device})})})}},{key:"cycleMic",value:function(){var o=this;return ne(),new Promise(function(h){o.sendMessageToCallMachine({action:"cycle-mic"},function(u){h({device:u.device})})})}},{key:"getCameraFacingMode",value:function(){var o=this;return gs(),new Promise(function(h){o.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(u){h(u.facingMode)})})}},{key:"setInputDevicesAsync",value:(G=W(function*(o){var h=this,u=o.audioDeviceId,p=o.videoDeviceId,g=o.audioSource,k=o.videoSource;if(ne(),g!==void 0&&(u=g),k!==void 0&&(p=k),typeof u=="boolean"&&(this._setAllowLocalAudio(u),u=void 0),typeof p=="boolean"&&(this._setAllowLocalVideo(p),p=void 0),!u&&!p)return yield this.getInputDevices();var P={};return u&&(u instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=u,u=gt,P.audio={settings:{customTrack:u}}):(delete this._sharedTracks.audioTrack,P.audio={settings:{deviceId:u}})),p&&(p instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=p,p=gt,P.video={settings:{customTrack:p}}):(delete this._sharedTracks.videoTrack,P.video={settings:{deviceId:p}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(P,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise(function(D){h.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:u,videoDeviceId:p},function(V){if(delete V.action,delete V.callbackStamp,V.returnPreloadCache)return h._updatePreloadCacheInputSettings(P,!1),void D(h._devicesFromInputSettings(h._inputSettings));D(V)})})}),function(o){return G.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(A=W(function*(o){var h=this,u=o.outputDeviceId;return ne(),u&&(this._preloadCache.outputDeviceId=u),this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(p){h.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:u},function(g){delete g.action,delete g.callbackStamp,g.returnPreloadCache?p(h._devicesFromInputSettings(h._inputSettings)):p(g)})})}),function(o){return A.apply(this,arguments)})},{key:"getInputDevices",value:(ae=W(function*(){var o=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(h){o.sendMessageToCallMachine({action:"get-input-devices"},function(u){u.returnPreloadCache?h(o._devicesFromInputSettings(o._inputSettings)):h({camera:u.camera,mic:u.mic,speaker:u.speaker})})})}),function(){return ae.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return gs(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(o){if(gs(),[ao,Nh].includes(o)){if(o!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=o,!this.disableReactNativeAutoDeviceManagement("audio")&&Ks(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",o)}},{key:"preAuth",value:(K=W(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(tt(this._callObjectMode,"preAuth()"),Vr(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(h)),!h.url)throw new Error("preAuth() requires at least a url to be provided");return this.validateProperties(h),this.properties=J(J({},this.properties),h),new Promise(function(u,p){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"daily-method-preauth",properties:Qt(o.properties,o.callClientId),preloadCache:Qt(o._preloadCache,o.callClientId)},function(g){return g.error?p(g.error):g.access?(o._didPreAuth=!0,void u({access:g.access})):p(new Error("unknown error in preAuth()"))})})}),function(){return K.apply(this,arguments)})},{key:"load",value:(Z=W(function*(o){var h=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");if(o&&(this.validateProperties(o),this.properties=J(J({},this.properties),o)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");return this._updateCallState(Oi),this.emitDailyJSEvent({action:Ho}),this._callObjectMode?new Promise(function(u,p){h._callObjectLoader.cancel();var g=Date.now();h._callObjectLoader.load(h.properties.dailyConfig,function(k){h._bundleLoadTime=k?"no-op":Date.now()-g,h._updateCallState(Pi),k&&h.emitDailyJSEvent({action:cn}),u()},function(k,P){if(h.emitDailyJSEvent({action:Ko}),!P){h._updateCallState(dt),h.resetMeetingDependentVars();var D={action:pn,errorMsg:k.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:k,bundleUrl:rr(h.properties.dailyConfig)}}};h._maybeSendToSentry(D),h.emitDailyJSEvent(D),p(k.msg)}})}):(this._iframe.src=ko(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise(function(u,p){h._loadedCallback=function(g){h._callState!==dt?(h._updateCallState(Pi),(h.properties.cssFile||h.properties.cssText)&&h.loadCss(h.properties),u()):p(g)}}))}}),function(o){return Z.apply(this,arguments)})},{key:"join",value:(O=W(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._testCallInProgress&&this.stopTestCallQuality();var u=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(h)}catch(p){return this.updateIsPreparingToJoin(!1),Promise.reject(p)}}else{if(u=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(h.url&&h.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(h.token&&h.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(h.url&&!this._callObjectMode&&h.url&&h.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(h.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(h),this.properties=J(J({},this.properties),h)}return h.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!h.showLocalVideo),h.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!h.showParticipantsBar),this._callState===Tt||this._callState===cr?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(cr,!1),this.emitDailyJSEvent({action:Zo}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:Qt(this.properties,this.callClientId),preloadCache:Qt(this._preloadCache,this.callClientId)}),new Promise(function(p,g){o._joinedCallback=function(k,P){if(o._callState!==dt){if(o._updateCallState(Tt),k)for(var D in k){if(o._callObjectMode){var V=o._callMachine().store;Yi(k[D],V),Wi(k[D],V),Hi(k[D],o._participants[D],V)}o._participants[D]=J({},k[D]),o.toggleParticipantAudioBasedOnNativeAudioFocus()}u&&o.loadCss(o.properties),p(k)}else g(P)}}))}),function(){return O.apply(this,arguments)})},{key:"leave",value:(I=W(function*(){var o=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise(function(h){o._callState===Ct||o._callState===dt?h():o._callObjectLoader&&!o._callObjectLoader.loaded?(o._callObjectLoader.cancel(),o._updateCallState(Ct),o.resetMeetingDependentVars(),o.emitDailyJSEvent({action:Ct}),h()):(o._resolveLeave=h,o.sendMessageToCallMachine({action:"leave-meeting"}))})}),function(){return I.apply(this,arguments)})},{key:"startScreenShare",value:(L=W(function*(){var o=this,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Gs(this._callMachineInitialized,"startScreenShare()"),h.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",h.screenVideoSendSettings),h.mediaStream&&(this._sharedTracks.screenMediaStream=h.mediaStream,h.mediaStream=gt),typeof DailyNativeUtils<"u"&&DailyNativeUtils.isIOS!==void 0&&DailyNativeUtils.isIOS){var u=this.nativeUtils();if(yield u.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:mn,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});u.setSystemScreenCaptureStartCallback(function(){u.setSystemScreenCaptureStartCallback(null),o.sendMessageToCallMachine({action:Di,captureOptions:h})}),u.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:Di,captureOptions:h})}),function(){return L.apply(this,arguments)})},{key:"stopScreenShare",value:function(){Gs(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=o.type;if(h&&h!=="cloud"&&h!=="raw-tracks"&&h!=="local")throw new Error("invalid type: ".concat(h,", allowed values 'cloud', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(J({action:"local-recording-start"},o))}},{key:"updateRecording",value:function(o){var h=o.layout,u=h===void 0?{preset:"default"}:h,p=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:u,instanceId:p})}},{key:"stopRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(J({action:"local-recording-stop"},o))}},{key:"startLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(J({action:"daily-method-start-live-streaming"},o))}},{key:"updateLiveStreaming",value:function(o){var h=o.layout,u=h===void 0?{preset:"default"}:h,p=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:u,instanceId:p})}},{key:"addLiveStreamingEndpoints",value:function(o){var h=o.endpoints,u=o.instanceId;this.sendMessageToCallMachine({action:Ri,endpointsOp:eh,endpoints:h,instanceId:u})}},{key:"removeLiveStreamingEndpoints",value:function(o){var h=o.endpoints,u=o.instanceId;this.sendMessageToCallMachine({action:Ri,endpointsOp:th,endpoints:h,instanceId:u})}},{key:"stopLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(J({action:"daily-method-stop-live-streaming"},o))}},{key:"validateDailyConfig",value:function(o){o.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(o.camSimulcastEncodings)),o.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),Gl()&&o.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,u=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(o){if(!(o instanceof Array||Array.isArray(o)))throw new Error("encodings must be an Array");if(!po(o.length,1,3))throw new Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var p=0;p<o.length;p++){var g=o[p];for(var k in this._validateEncodingLayerHasValidProperties(g),g)if(Fr.includes(k)){if(typeof g[k]!="number")throw new Error("".concat(k," must be a number"));if(h){var P=h[k],D=P.min,V=P.max;if(!po(g[k],D,V))throw new Error("".concat(k," value not in range. valid range: ").concat(D," to ").concat(V))}}else if(!["active","scalabilityMode"].includes(k))throw new Error("Invalid key ".concat(k,", valid keys are:")+Object.values(Fr));if(u&&!g.hasOwnProperty("maxBitrate"))throw new Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(f=W(function*(o){var h=this,u=o.url,p=o.settings,g=p===void 0?{state:fn.PLAY}:p;try{(function(k){if(typeof k!="string")throw new Error('url parameter must be "string" type')})(u),mo(g),function(k){for(var P in k)if(!lo.includes(P))throw new Error("Invalid key ".concat(P,", valid keys are: ").concat(lo));k.simulcastEncodings&&this.validateSimulcastEncodings(k.simulcastEncodings,sc,!0)}(g)}catch(k){throw console.error("invalid argument Error: ".concat(k)),console.error(`startRemoteMediaPlayer arguments must be of the form:
  { url: "playback url",
  settings?:
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),k}return new Promise(function(k,P){h.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:u,settings:g},function(D){D.error?P({error:D.error,errorMsg:D.errorMsg}):k({session_id:D.session_id,remoteMediaPlayerState:{state:D.state,settings:D.settings}})})})}),function(o){return f.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(T=W(function*(o){var h=this;if(typeof o!="string")throw new Error(" remotePlayerID must be of type string");return new Promise(function(u,p){h.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:o},function(g){g.error?p({error:g.error,errorMsg:g.errorMsg}):u()})})}),function(o){return T.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(C=W(function*(o){var h=this,u=o.session_id,p=o.settings;try{mo(p)}catch(g){throw console.error("invalid argument Error: ".concat(g)),console.error(`updateRemoteMediaPlayer arguments must be of the form:
  session_id: "participant session",
  { settings?: {state: "play"|"pause"} }`),g}return new Promise(function(g,k){h.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:u,settings:p},function(P){P.error?k({error:P.error,errorMsg:P.errorMsg}):g({session_id:P.session_id,remoteMediaPlayerState:{state:P.state,settings:P.settings}})})})}),function(o){return C.apply(this,arguments)})},{key:"startTranscription",value:function(o){ge(this._callState,"startTranscription()"),this.sendMessageToCallMachine(J({action:"daily-method-start-transcription"},o))}},{key:"updateTranscription",value:function(o){if(ge(this._callState,"updateTranscription()"),!o)throw new Error("updateTranscription Error: options is mandatory");if(de(o)!=="object")throw new Error("updateTranscription Error: options must be object type");if(o.participants&&!Array.isArray(o.participants))throw new Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(J({action:"daily-method-update-transcription"},o))}},{key:"stopTranscription",value:function(o){if(ge(this._callState,"stopTranscription()"),o&&de(o)!=="object")throw new Error("stopTranscription Error: options must be object type");if(o&&!o.instanceId)throw new Error('"instanceId" not provided');this.sendMessageToCallMachine(J({action:"daily-method-stop-transcription"},o))}},{key:"startDialOut",value:(S=W(function*(o){var h=this;ge(this._callState,"startDialOut()");var u=function(P){if(P){if(!Array.isArray(P))throw new Error("Error starting dial out: audio codec must be an array");if(P.length<=0)throw new Error("Error starting dial out: audio codec array specified but empty");P.forEach(function(D){if(typeof D!="string")throw new Error("Error starting dial out: audio codec must be a string");if(D!=="OPUS"&&D!=="PCMU"&&D!=="PCMA"&&D!=="G722")throw new Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")})}};if(!o.sipUri&&!o.phoneNumber)throw new Error("Error starting dial out: either a sip uri or phone number must be provided");if(o.sipUri&&o.phoneNumber)throw new Error("Error starting dial out: only one of sip uri or phone number must be provided");if(o.sipUri){if(typeof o.sipUri!="string")throw new Error("Error starting dial out: sipUri must be a string");if(!o.sipUri.startsWith("sip:"))throw new Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(o.video&&typeof o.video!="boolean")throw new Error("Error starting dial out: video must be a boolean value");(function(P){if(P&&(u(P.audio),P.video)){if(!Array.isArray(P.video))throw new Error("Error starting dial out: video codec must be an array");if(P.video.length<=0)throw new Error("Error starting dial out: video codec array specified but empty");P.video.forEach(function(D){if(typeof D!="string")throw new Error("Error starting dial out: video codec must be a string");if(D!=="H264"&&D!=="VP8")throw new Error("Error starting dial out: video codec must be H264 or VP8")})}})(o.codecs)}if(o.phoneNumber){if(typeof o.phoneNumber!="string")throw new Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(o.phoneNumber))throw new Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");o.codecs&&u(o.codecs.audio)}if(o.callerId){if(typeof o.callerId!="string")throw new Error("Error starting dial out: callerId must be a string");if(o.sipUri)throw new Error("Error starting dial out: callerId not allowed with sipUri")}if(o.displayName){if(typeof o.displayName!="string")throw new Error("Error starting dial out: displayName must be a string");if(o.displayName.length>=200)throw new Error("Error starting dial out: displayName length must be less than 200")}if(o.userId){if(typeof o.userId!="string")throw new Error("Error starting dial out: userId must be a string");if(o.userId.length>36)throw new Error("Error starting dial out: userId length must be less than or equal to 36")}if(o.permissions&&o.permissions.canReceive){var p=Re(ec.validateJSONObject(o.permissions.canReceive),2),g=p[0],k=p[1];if(!g)throw new Error(k)}return new Promise(function(P,D){h.sendMessageToCallMachine(J({action:"dialout-start"},o),function(V){V.error?D(V.error):P(V)})})}),function(o){return S.apply(this,arguments)})},{key:"stopDialOut",value:function(o){var h=this;return ge(this._callState,"stopDialOut()"),new Promise(function(u,p){h.sendMessageToCallMachine(J({action:"dialout-stop"},o),function(g){g.error?p(g.error):u(g)})})}},{key:"sipCallTransfer",value:(y=W(function*(o){var h=this;if(ge(this._callState,"sipCallTransfer()"),!o)throw new Error("sipCallTransfer() requires a sessionId and toEndPoint");return o.useSipRefer=!1,ho(o,"sipCallTransfer"),new Promise(function(u,p){h.sendMessageToCallMachine(J({action:Fi},o),function(g){g.error?p(g.error):u(g)})})}),function(o){return y.apply(this,arguments)})},{key:"sipRefer",value:(j=W(function*(o){var h=this;if(ge(this._callState,"sipRefer()"),!o)throw new Error("sessionId and toEndPoint are mandatory parameter");return o.useSipRefer=!0,ho(o,"sipRefer"),new Promise(function(u,p){h.sendMessageToCallMachine(J({action:Fi},o),function(g){g.error?p(g.error):u(g)})})}),function(o){return j.apply(this,arguments)})},{key:"sendDTMF",value:(E=W(function*(o){var h=this;return ge(this._callState,"sendDTMF()"),function(u){var p=u.sessionId,g=u.tones;if(!p||!g)throw new Error("sessionId and tones are mandatory parameter");if(typeof p!="string"||typeof g!="string")throw new Error("sessionId and tones should be of string type");if(g.length>20)throw new Error("tones string must be upto 20 characters");var k=/[^0-9A-D*#]/g,P=g.match(k);if(P&&P[0])throw new Error("".concat(P[0]," is not valid DTMF tone"))}(o),new Promise(function(u,p){h.sendMessageToCallMachine(J({action:"send-dtmf"},o),function(g){g.error?p(g.error):u(g)})})}),function(o){return E.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var o=this;return this._callState!==Tt?Promise.resolve(J({stats:{latest:{}}},this._network)):new Promise(function(h){o.sendMessageToCallMachine({action:"get-calc-stats"},function(u){h(J(J({},o._network),{},{stats:u.stats}))})})}},{key:"testWebsocketConnectivity",value:(N=W(function*(){var o=this;if(Ur(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(h){return Promise.reject(h)}return new Promise(function(h,u){o.sendMessageToCallMachine({action:"test-websocket-connectivity"},function(p){p.error?u(p.error):h(p.results)})})}),function(){return N.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(o){return o?o instanceof MediaStreamTrack?!!Sh(o)||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(_=W(function*(){var o=this;ne(),tt(this._callObjectMode,"testCallQuality()"),Gs(this._callMachineInitialized,"testCallQuality()",null,!0),Vr(this._callState,this._isPreparingToJoin,"testCallQuality()");var h=this._testCallAlreadyInProgress,u=function(g){h||(o._testCallInProgress=g)};if(u(!0),this.needsLoad())try{var p=this._callState;yield this.load(),this._callState=p}catch(g){return u(!1),Promise.reject(g)}return new Promise(function(g){o.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:o.properties.dailyJsVersion},function(k){var P=k.results,D=P.result,V=Na(P,Ch);if(D==="failed"){var te,re=J({},V);(te=V.error)!==null&&te!==void 0&&te.details?(V.error.details=JSON.parse(V.error.details),re.error=J(J({},re.error),{},{details:J({},re.error.details)}),re.error.details.duringTest="testCallQuality"):(re.error=re.error?J({},re.error):{},re.error.details={duringTest:"testCallQuality"}),o._maybeSendToSentry(re)}u(!1),g(J({result:D},V))})})}),function(){return _.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(v=W(function*(o){var h;le()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),h=yield this.testPeerToPeerCallQuality(o)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),h=yield this.testCallQuality());var u={result:h.result,secondsElapsed:h.secondsElapsed};return h.data&&(u.data={maxRTT:h.data.maxRoundTripTime,packetLoss:h.data.avgRecvPacketLoss}),u}),function(o){return v.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(m=W(function*(o){var h=this;if(Ur(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(g){return Promise.reject(g)}var u=o.videoTrack,p=o.duration;if(!this._validateVideoTrackForNetworkTests(u))throw new Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=u,new Promise(function(g,k){h.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:p},function(P){P.error?k(P.error):g(P.results)})})}),function(o){return m.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){le()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(d=W(function*(o){var h=this;if(Ur(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(u){return Promise.reject(u)}if(!this._validateVideoTrackForNetworkTests(o))throw new Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=o,new Promise(function(u,p){h.sendMessageToCallMachine({action:"test-network-connectivity"},function(g){g.error?p(g.error):u(g.results)})})}),function(o){return d.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var o=this;return new Promise(function(h){o._callState===Tt?o.sendMessageToCallMachine({action:"get-cpu-load-stats"},function(u){h(u.cpuStats)}):h({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})})}},{key:"_validateEncodingLayerHasValidProperties",value:function(o){var h;if(!(((h=Object.keys(o))===null||h===void 0?void 0:h.length)>0))throw new Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(Fr))}},{key:"_validateVideoSendSettings",value:function(o,h){var u=o==="screenVideo"?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],p="Video send settings should be either an object or one of the supported presets: ".concat(u.join());if(typeof h=="string"){if(!u.includes(h))throw new Error(p)}else{if(de(h)!=="object")throw new Error(p);if(!h.maxQuality&&!h.encodings&&h.allowAdaptiveLayers===void 0)throw new Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(h.maxQuality&&["low","medium","high"].indexOf(h.maxQuality)===-1)throw new Error("maxQuality must be either low, medium or high");if(h.encodings){var g=!1;switch(Object.keys(h.encodings).length){case 1:g=!h.encodings.low;break;case 2:g=!h.encodings.low||!h.encodings.medium;break;case 3:g=!h.encodings.low||!h.encodings.medium||!h.encodings.high;break;default:g=!0}if(g)throw new Error("Encodings must be defined as: low, low and medium, or low, medium and high.");h.encodings.low&&this._validateEncodingLayerHasValidProperties(h.encodings.low),h.encodings.medium&&this._validateEncodingLayerHasValidProperties(h.encodings.medium),h.encodings.high&&this._validateEncodingLayerHasValidProperties(h.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(o){var h=this;if(!o||Object.keys(o).length===0)throw new Error("Send settings must contain at least information for one track!");Object.entries(o).forEach(function(u){var p=Re(u,2),g=p[0],k=p[1];h._validateVideoSendSettings(g,k)})}},{key:"updateSendSettings",value:function(o){var h=this;return this.validateUpdateSendSettings(o),this.needsLoad()?(this._preloadCache.sendSettings=o,{sendSettings:this._preloadCache.sendSettings}):new Promise(function(u,p){h.sendMessageToCallMachine({action:"update-send-settings",sendSettings:o},function(g){g.error?p(g.error):u(g.sendSettings)})})}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return ne(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(o){return ne(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:o}),this}},{key:"activeSpeakerMode",value:function(){return ne(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(o){return ge(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=o,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:o}),this}},{key:"enumerateDevices",value:(c=W(function*(){var o=this;if(this._callObjectMode){var h=yield navigator.mediaDevices.enumerateDevices();return Yt()==="Firefox"&&ur().major>115&&ur().major<123&&(h=h.filter(function(u){return u.kind!=="audiooutput"})),{devices:h.map(function(u){var p=JSON.parse(JSON.stringify(u));if(!le()&&u.kind==="videoinput"&&u.getCapabilities){var g,k=u.getCapabilities();p.facing=(k==null||(g=k.facingMode)===null||g===void 0?void 0:g.length)>=1?k.facingMode[0]:void 0}return p})}}return new Promise(function(u){o.sendMessageToCallMachine({action:"enumerate-devices"},function(p){u({devices:p.devices})})})}),function(){return c.apply(this,arguments)})},{key:"sendAppMessage",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(ge(this._callState,"sendAppMessage()"),JSON.stringify(o).length>this._maxAppMessageSize)throw new Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:o,to:h}),this}},{key:"addFakeParticipant",value:function(o){return ne(),ge(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(J({action:"add-fake-participant"},o)),this}},{key:"setShowNamesMode",value:function(o){return Ge(this._callObjectMode,"setShowNamesMode()"),ne(),o&&o!=="always"&&o!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:o}),this)}},{key:"setShowLocalVideo",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return Ge(this._callObjectMode,"setShowLocalVideo()"),ne(),ge(this._callState,"setShowLocalVideo()"),typeof o!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:o}),this._showLocalVideo=o,this)}},{key:"showLocalVideo",value:function(){return Ge(this._callObjectMode,"showLocalVideo()"),ne(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return Ge(this._callObjectMode,"setShowParticipantsBar()"),ne(),ge(this._callState,"setShowParticipantsBar()"),typeof o!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:o}),this._showParticipantsBar=o,this)}},{key:"showParticipantsBar",value:function(){return Ge(this._callObjectMode,"showParticipantsBar()"),ne(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return ne(),Ge(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(o){return ne(),Ge(this._callObjectMode,"setCustomIntegrations()"),ge(this._callState,"setCustomIntegrations()"),uc(o)?(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:o}),this._customIntegrations=o,this):this}},{key:"startCustomIntegrations",value:function(o){var h=this;if(ne(),Ge(this._callObjectMode,"startCustomIntegrations()"),ge(this._callState,"startCustomIntegrations()"),Array.isArray(o)&&o.some(function(g){return typeof g!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("startCustomIntegrations() only accepts string | string[]"),this;var u=typeof o=="string"?[o]:o,p=u.filter(function(g){return!(g in h._customIntegrations)});return p.length?(console.error(`Can't find custom integration(s): "`.concat(p.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"start-custom-integrations",ids:u}),this)}},{key:"stopCustomIntegrations",value:function(o){var h=this;if(ne(),Ge(this._callObjectMode,"stopCustomIntegrations()"),ge(this._callState,"stopCustomIntegrations()"),Array.isArray(o)&&o.some(function(g){return typeof g!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var u=typeof o=="string"?[o]:o,p=u.filter(function(g){return!(g in h._customIntegrations)});return p.length?(console.error(`Can't find custom integration(s): "`.concat(p.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:u}),this)}},{key:"customTrayButtons",value:function(){return Ge(this._callObjectMode,"customTrayButtons()"),ne(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(o){return Ge(this._callObjectMode,"updateCustomTrayButtons()"),ne(),ge(this._callState,"updateCustomTrayButtons()"),cc(o)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:o}),this._customTrayButtons=o,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(hr))),this)}},{key:"theme",value:function(){return Ge(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(o){var h=this;return Ge(this._callObjectMode,"setTheme()"),new Promise(function(u,p){try{h.validateProperties({theme:o}),h.properties.theme=J({},o),h.sendMessageToCallMachine({action:"set-theme",theme:h.properties.theme});try{h.emitDailyJSEvent({action:Wo,theme:h.properties.theme})}catch(g){console.log("could not emit 'theme-updated'",g)}u(h.properties.theme)}catch(g){p(g)}})}},{key:"requestFullscreen",value:(l=W(function*(){if(ne(),this._iframe&&!document.fullscreenElement&&Vi())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(o){console.log("could not make video call fullscreen",o)}}),function(){return l.apply(this,arguments)})},{key:"exitFullscreen",value:function(){ne(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(i=W(function*(){var o=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise(function(h){o.sendMessageToCallMachine({action:"get-sidebar-view"},function(u){h(u.view)})})}),function(){return i.apply(this,arguments)})},{key:"setSidebarView",value:function(o){return this._callObjectMode?(console.error("setSidebarView is not available in callObject mode"),this):(this.sendMessageToCallMachine({action:"set-sidebar-view",view:o}),this)}},{key:"room",value:(a=W(function*(){var o=this,h=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,u=h===void 0||h;return this._accessState.access===Ws||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(p){o.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:u},function(g){delete g.action,delete g.callbackStamp,p(g)})})}),function(){return a.apply(this,arguments)})},{key:"geo",value:(r=W(function*(){try{var o=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield o.json()).geo}}catch(h){return console.error("geo lookup failed",h),{current:""}}}),function(){return r.apply(this,arguments)})},{key:"setNetworkTopology",value:(t=W(function*(o){var h=this;return ne(),ge(this._callState,"setNetworkTopology()"),new Promise(function(u,p){h.sendMessageToCallMachine({action:"set-network-topology",opts:o},function(g){g.error?p({error:g.error}):u({workerId:g.workerId})})})}),function(o){return t.apply(this,arguments)})},{key:"getNetworkTopology",value:(e=W(function*(){var o=this;return new Promise(function(h,u){o.needsLoad()&&h({topology:"none"}),o.sendMessageToCallMachine({action:"get-network-topology"},function(p){p.error?u({error:p.error}):h({topology:p.topology})})})}),function(){return e.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(o){if(ne(),typeof o!="number"&&o!==!0&&o!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(o));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:o})}},{key:"on",value:function(o,h){return Ps.prototype.on.call(this,o,h)}},{key:"once",value:function(o,h){return Ps.prototype.once.call(this,o,h)}},{key:"off",value:function(o,h){return Ps.prototype.off.call(this,o,h)}},{key:"validateProperties",value:function(o){var h,u;if(o!=null&&(h=o.dailyConfig)!==null&&h!==void 0&&h.userMediaAudioConstraints){var p,g;le()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var k=o.inputSettings||{};k.audio=((p=o.inputSettings)===null||p===void 0?void 0:p.audio)||{},k.audio.settings=((g=o.inputSettings)===null||g===void 0||(g=g.audio)===null||g===void 0?void 0:g.settings)||{},k.audio.settings=J(J({},k.audio.settings),o.dailyConfig.userMediaAudioConstraints),o.inputSettings=k,delete o.dailyConfig.userMediaAudioConstraints}if(o!=null&&(u=o.dailyConfig)!==null&&u!==void 0&&u.userMediaVideoConstraints){var P,D;le()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var V=o.inputSettings||{};V.video=((P=o.inputSettings)===null||P===void 0?void 0:P.video)||{},V.video.settings=((D=o.inputSettings)===null||D===void 0||(D=D.video)===null||D===void 0?void 0:D.settings)||{},V.video.settings=J(J({},V.video.settings),o.dailyConfig.userMediaVideoConstraints),o.inputSettings=V,delete o.dailyConfig.userMediaVideoConstraints}for(var te in o){if(!Vt[te])throw new Error("unrecognized property '".concat(te,"'"));if(Vt[te].validate&&!Vt[te].validate(o[te],this))throw new Error("property '".concat(te,"': ").concat(Vt[te].help))}}},{key:"assembleMeetingUrl",value:function(){var o,h,u=J(J({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:(o=this.properties.dailyConfig)!==null&&o!==void 0&&o.proxyUrl?encodeURIComponent((h=this.properties.dailyConfig)===null||h===void 0?void 0:h.proxyUrl):void 0}),p=u.url.match(/\?/)?"&":"?";return u.url+p+Object.keys(Vt).filter(function(g){return Vt[g].queryString&&u[g]!==void 0}).map(function(g){return"".concat(Vt[g].queryString,"=").concat(u[g])}).join("&")}},{key:"needsLoad",value:function(){return[on,Oi,Ct,dt].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(o,h){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(o,h,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(o){this._messageChannel.forwardPackagedMessageToCallMachine(o,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(o){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(o,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(o){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(o)}},{key:"handleMessageFromCallMachine",value:function(o){switch(o.action){case zo:this.sendMessageToCallMachine(J({action:Yo},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var h={action:Bs,level:"log",code:1011,stats:{event:"bundle load",time:this._bundleLoadTime==="no-op"?0:this._bundleLoadTime,preLoaded:this._bundleLoadTime==="no-op",url:rr(this.properties.dailyConfig)}};this.sendMessageToCallMachine(h),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case cn:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(o);break;case el:var u,p=J({},o);delete p.internal,this._maxAppMessageSize=((u=o.internal)===null||u===void 0?void 0:u._maxAppMessageSize)||Or,this._joinedCallback&&(this._joinedCallback(o.participants),this._joinedCallback=null),this.emitDailyJSEvent(p);break;case sl:case rl:if(this._callState===Ct)return;if(o.participant&&o.participant.session_id){var g=o.participant.local?"local":o.participant.session_id;if(this._callObjectMode){var k=this._callMachine().store;Yi(o.participant,k),Wi(o.participant,k),Hi(o.participant,this._participants[g],k)}try{this.maybeParticipantTracksStopped(this._participants[g],o.participant),this.maybeParticipantTracksStarted(this._participants[g],o.participant),this.maybeEventRecordingStopped(this._participants[g],o.participant),this.maybeEventRecordingStarted(this._participants[g],o.participant)}catch($){console.error("track events error",$)}this.compareEqualForParticipantUpdateEvent(o.participant,this._participants[g])||(this._participants[g]=J({},o.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(o))}break;case nl:if(o.participant&&o.participant.session_id){var P=this._participants[o.participant.session_id];P&&this.maybeParticipantTracksStopped(P,null),delete this._participants[o.participant.session_id],this.emitDailyJSEvent(o)}break;case al:Ue(this._participantCounts,o.participantCounts)||(this._participantCounts=o.participantCounts,this.emitDailyJSEvent(o));break;case il:var D={access:o.access};o.awaitingAccess&&(D.awaitingAccess=o.awaitingAccess),Ue(this._accessState,D)||(this._accessState=D,this.emitDailyJSEvent(o));break;case ol:if(o.meetingSession){this._meetingSessionSummary=o.meetingSession,this.emitDailyJSEvent(o);var V=J(J({},o),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(V)}break;case pn:var te;this._iframe&&!o.preserveIframe&&(this._iframe.src=""),this._updateCallState(dt),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(o.errorMsg),this._loadedCallback=null),o.preserveIframe;var re=Na(o,Eh);re!=null&&(te=re.error)!==null&&te!==void 0&&te.details&&(re.error.details=JSON.parse(re.error.details)),this._maybeSendToSentry(o),this._joinedCallback&&(this._joinedCallback(null,re),this._joinedCallback=null),this.emitDailyJSEvent(re);break;case tl:this._callState!==dt&&this._updateCallState(Ct),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(o);break;case"selected-devices-updated":o.devices&&this.emitDailyJSEvent(o);break;case Ml:var Je=o.state,at=o.threshold,yt=o.quality,ke=Je.state,Be=Je.reasons;ke===this._network.networkState&&Ue(Be,this._network.networkStateReasons)&&at===this._network.threshold&&yt===this._network.quality||(this._network.networkState=ke,this._network.networkStateReasons=Be,this._network.quality=yt,this._network.threshold=at,o.networkState=ke,Be.length&&(o.networkStateReasons=Be),delete o.state,this.emitDailyJSEvent(o));break;case Ol:o&&o.cpuLoadState&&this.emitDailyJSEvent(o);break;case Pl:o&&o.faceCounts!==void 0&&this.emitDailyJSEvent(o);break;case Tl:var it=o.activeSpeaker;this._activeSpeaker.peerId!==it.peerId&&(this._activeSpeaker.peerId=it.peerId,this.emitDailyJSEvent({action:o.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var bt=o.show;this._showLocalVideo=bt,this.emitDailyJSEvent({action:o.action,show:bt});break;case Al:var Lt=o.enabled;this._activeSpeakerMode!==Lt&&(this._activeSpeakerMode=Lt,this.emitDailyJSEvent({action:o.action,enabled:this._activeSpeakerMode}));break;case cl:case ul:case dl:this._waitingParticipants=o.allWaitingParticipants,this.emitDailyJSEvent({action:o.action,participant:o.participant});break;case Ul:Ue(this._receiveSettings,o.receiveSettings)||(this._receiveSettings=o.receiveSettings,this.emitDailyJSEvent({action:o.action,receiveSettings:o.receiveSettings}));break;case hn:this._maybeUpdateInputSettings(o.inputSettings);break;case"send-settings-updated":Ue(this._sendSettings,o.sendSettings)||(this._sendSettings=o.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:o.action,sendSettings:o.sendSettings}));break;case"local-audio-level":this._localAudioLevel=o.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=o.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case Sl:var _t=o.session_id;this._rmpPlayerState[_t]=o.playerState,this.emitDailyJSEvent(o);break;case kl:delete this._rmpPlayerState[o.session_id],this.emitDailyJSEvent(o);break;case jl:var w=o.session_id,F=this._rmpPlayerState[w];F&&this.compareEqualForRMPUpdateEvent(F,o.remoteMediaPlayerState)||(this._rmpPlayerState[w]=o.remoteMediaPlayerState,this.emitDailyJSEvent(o));break;case"custom-button-click":case"sidebar-view-changed":this.emitDailyJSEvent(o);break;case ll:var se=this._meetingSessionState.topology!==(o.meetingSessionState&&o.meetingSessionState.topology);this._meetingSessionState=qr(o.meetingSessionState,this._callObjectMode),(this._callObjectMode||se)&&this.emitDailyJSEvent(o);break;case Cl:this._isScreenSharing=!0,this.emitDailyJSEvent(o);break;case El:case Nl:this._isScreenSharing=!1,this.emitDailyJSEvent(o);break;case un:case dn:case vl:case yl:case bl:case pl:case fl:case gl:case Qo:case Xo:case xl:case wl:case"test-completed":case Il:case _l:case Ll:case Dl:case Rl:case Fl:case mn:case Vl:case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(o);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(o,h){var u="record";o&&(h.local||h[u]!==!1||o[u]===h[u]||this.emitDailyJSEvent({action:dn}))}},{key:"maybeEventRecordingStarted",value:function(o,h){var u="record";o&&(h.local||h[u]!==!0||o[u]===h[u]||this.emitDailyJSEvent({action:un}))}},{key:"_trackStatePlayable",value:function(o){return!(!o||o.state!==qo)}},{key:"_trackChanged",value:function(o,h){return(o==null?void 0:o.id)!==(h==null?void 0:h.id)}},{key:"maybeEventTrackStopped",value:function(o,h,u){var p,g,k=(p=h==null?void 0:h.tracks[o])!==null&&p!==void 0?p:null,P=(g=u==null?void 0:u.tracks[o])!==null&&g!==void 0?g:null,D=k==null?void 0:k.track;if(D){var V=this._trackStatePlayable(k),te=this._trackStatePlayable(P),re=this._trackChanged(D,P==null?void 0:P.track);V&&(te&&!re||this.emitDailyJSEvent({action:ml,track:D,participant:u??h,type:o}))}}},{key:"maybeEventTrackStarted",value:function(o,h,u){var p,g,k=(p=h==null?void 0:h.tracks[o])!==null&&p!==void 0?p:null,P=(g=u==null?void 0:u.tracks[o])!==null&&g!==void 0?g:null,D=P==null?void 0:P.track;if(D){var V=this._trackStatePlayable(k),te=this._trackStatePlayable(P),re=this._trackChanged(k==null?void 0:k.track,D);te&&(V&&!re||this.emitDailyJSEvent({action:hl,track:D,participant:u,type:o}))}}},{key:"maybeParticipantTracksStopped",value:function(o,h){if(o)for(var u in o.tracks)this.maybeEventTrackStopped(u,o,h)}},{key:"maybeParticipantTracksStarted",value:function(o,h){if(h)for(var u in h.tracks)this.maybeEventTrackStarted(u,o,h)}},{key:"compareEqualForRMPUpdateEvent",value:function(o,h){var u,p;return o.state===h.state&&((u=o.settings)===null||u===void 0?void 0:u.volume)===((p=h.settings)===null||p===void 0?void 0:p.volume)}},{key:"emitDailyJSEvent",value:function(o){try{o.callClientId=this.callClientId,this.emit(o.action,o)}catch(h){console.log("could not emit",o,h)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(o,h){return!!Ue(o,h)&&(!o.videoTrack||!h.videoTrack||o.videoTrack.id===h.videoTrack.id&&o.videoTrack.muted===h.videoTrack.muted&&o.videoTrack.enabled===h.videoTrack.enabled)&&(!o.audioTrack||!h.audioTrack||o.audioTrack.id===h.audioTrack.id&&o.audioTrack.muted===h.audioTrack.muted&&o.audioTrack.enabled===h.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return le()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(o){this._updateCallState(this._callState,o)}},{key:"_updateCallState",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(o!==this._callState||h!==this._isPreparingToJoin){var u=this._callState,p=this._isPreparingToJoin;this._callState=o,this._isPreparingToJoin=h;var g=this._callState===Tt;this.updateShowAndroidOngoingMeetingNotification(g);var k=Ks(u,p),P=Ks(this._callState,this._isPreparingToJoin);k!==P&&(this.updateKeepDeviceAwake(P),this.updateDeviceAudioMode(P),this.updateNoOpRecordingEnsuringBackgroundContinuity(P))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=oo,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:Ws},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=qr(io,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=Or,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(o){le()&&this.nativeUtils().setKeepDeviceAwake(o,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(o){if(le()&&!this.disableReactNativeAutoDeviceManagement("audio")){var h=o?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(h)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(o){if(le()&&this.nativeUtils().setShowOngoingMeetingNotification){var h,u,p,g;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var k=this.properties.reactNativeConfig.androidInCallNotification;h=k.title,u=k.subtitle,p=k.iconName,g=k.disableForCustomOverride}g&&(o=!1),this.nativeUtils().setShowOngoingMeetingNotification(o,h,u,p,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(o){le()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(o)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var o;if(le()){var h=(o=this._callMachine())===null||o===void 0||(o=o.store)===null||o===void 0?void 0:o.getState();for(var u in h==null?void 0:h.streams){var p=h.streams[u];p&&p.pendingTrack&&p.pendingTrack.kind==="audio"&&(p.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(o){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[o]}},{key:"absoluteUrl",value:function(o){if(o!==void 0){var h=document.createElement("a");return h.href=o,h.href}}},{key:"sayHello",value:function(){var o="hello, world.";return console.log(o),o}},{key:"_logUseAfterDestroy",value:function(){var o=Object.values(Ft)[0];if(this.needsLoad())if(o&&!o.needsLoad()){var h={action:Bs,level:"error",code:this.strictMode?9995:9997};o.sendMessageToCallMachine(h)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var u={action:Bs,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(u,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var o=0,h=Object.values(Ft);o<h.length;o++){var u=h[o];u._callMachineInitialized?(u.sendMessageToCallMachine({action:Bs,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),u._delayDuplicateInstanceLog=!1):u._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(o){var h,u,p,g;if(!((h=o.error)!==null&&h!==void 0&&h.type&&(![Go,Jo,ln].includes(o.error.type)||o.error.type===ln&&o.error.msg.includes("deleted")))){var k=(u=this.properties)!==null&&u!==void 0&&u.url?new URL(this.properties.url):void 0,P="production";k&&k.host.includes(".staging.daily")&&(P="staging");var D,V,te,re,Je,at=function(_t){const w=[Ku(),Wu(),wd(),_d(),Ed(),Td(),ed(),Nd()];return _t.autoSessionTracking!==!1&&w.push(Cd()),w}({}).filter(function(_t){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(_t.name)}),yt=new ld({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:md,stackParser:bd,integrations:at,environment:P}),ke=new Ot;if(ke.setClient(yt),yt.init(),this.session_id&&ke.setExtra("sessionId",this.session_id),this.properties){var Be=J({},this.properties);Be.userName=Be.userName?"[Filtered]":void 0,Be.userData=Be.userData?"[Filtered]":void 0,Be.token=Be.token?"[Filtered]":void 0,ke.setExtra("properties",Be)}if(k){var it=k.searchParams.get("domain");if(!it){var bt=k.host.match(/(.*?)\./);it=bt&&bt[1]||""}it&&ke.setTag("domain",it)}o.error&&(ke.setTag("fatalErrorType",o.error.type),ke.setExtra("errorDetails",o.error.details),!((D=o.error.details)===null||D===void 0)&&D.uri&&ke.setTag("serverAddress",o.error.details.uri),!((V=o.error.details)===null||V===void 0)&&V.workerGroup&&ke.setTag("workerGroup",o.error.details.workerGroup),!((te=o.error.details)===null||te===void 0)&&te.geoGroup&&ke.setTag("geoGroup",o.error.details.geoGroup),!((re=o.error.details)===null||re===void 0)&&re.on&&ke.setTag("connectionAttempt",o.error.details.on),(Je=o.error.details)!==null&&Je!==void 0&&Je.bundleUrl&&(ke.setTag("bundleUrl",o.error.details.bundleUrl),ke.setTag("bundleError",o.error.details.sourceError.type))),ke.setTags({callMode:this._callObjectMode?le()?"reactNative":(p=this.properties)!==null&&p!==void 0&&(p=p.dailyConfig)!==null&&p!==void 0&&(p=p.callMode)!==null&&p!==void 0&&p.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:s.version()});var Lt=((g=o.error)===null||g===void 0?void 0:g.msg)||o.errorMsg;ke.captureException(new Error(Lt))}}},{key:"_callMachine",value:function(){var o;return(o=window._daily)===null||o===void 0||(o=o.instances)===null||o===void 0||(o=o[this.callClientId])===null||o===void 0?void 0:o.callMachine}},{key:"_maybeUpdateInputSettings",value:function(o){if(!Ue(this._inputSettings,o)){var h=this._getInputSettings();this._inputSettings=o;var u=this._getInputSettings();Ue(h,u)||this.emitDailyJSEvent({action:hn,inputSettings:u})}}}],[{key:"supportedBrowser",value:function(){if(le())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var o=gu.getParser(et());return{supported:!!Ui(),mobile:o.getPlatformType()==="mobile",name:o.getBrowserName(),version:o.getBrowserVersion(),supportsFullscreen:!!Vi(),supportsScreenShare:!!sh(),supportsSfu:!!Ui(),supportsVideoProcessing:$l(),supportsAudioProcessing:Jl()}}},{key:"version",value:function(){return"0.80.0"}},{key:"createCallObject",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return o.layout="none",new s(null,o)}},{key:"wrap",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ne(),!o||!o.contentWindow||typeof o.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return h.layout||(h.customLayout?h.layout="custom-v1":h.layout="browser"),new s(o,h)}},{key:"createFrame",value:function(o,h){var u,p;ne(),o&&h?(u=o,p=h):o&&o.append?(u=o,p={}):(u=document.body,p=o||{});var g=p.iframeStyle;g||(g=u===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var k=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?k.allow="microphone, camera":k.allow="microphone; camera; autoplay; display-capture; screen-wake-lock",k.style.visibility="hidden",u.appendChild(k),k.style.visibility=null,Object.keys(g).forEach(function(P){return k.style[P]=g[P]}),p.layout||(p.customLayout?p.layout="custom-v1":p.layout="browser");try{return new s(k,p)}catch(P){throw u.removeChild(k),P}}},{key:"createTransparentFrame",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ne();var h=document.createElement("iframe");return h.allow="microphone; camera; autoplay",h.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(h),o.layout||(o.layout="custom-v1"),s.wrap(h,o)}},{key:"getCallInstance",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return o?Ft[o]:Object.values(Ft)[0]}}]);var e,t,r,a,i,l,c,d,m,v,_,N,E,j,y,S,C,T,f,L,I,O,Z,K,ae,A,G,x,R,q,Ee,$e,z,Pt,b,Te,be,Fe}();function Qt(s,e){var t={};for(var r in s)if(s[r]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",r),t[r]=gt;else if(r==="dailyConfig"){if(s[r].modifyLocalSdpHook){var a=window._daily.instances[e].customCallbacks||{};a.modifyLocalSdpHook=s[r].modifyLocalSdpHook,window._daily.instances[e].customCallbacks=a,delete s[r].modifyLocalSdpHook}if(s[r].modifyRemoteSdpHook){var i=window._daily.instances[e].customCallbacks||{};i.modifyRemoteSdpHook=s[r].modifyRemoteSdpHook,window._daily.instances[e].customCallbacks=i,delete s[r].modifyRemoteSdpHook}t[r]=s[r]}else t[r]=s[r];return t}function ge(s){var e=arguments.length>2?arguments[2]:void 0;if(s!==Tt){var t="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," only supported after join.");throw e&&(t+=" ".concat(e)),console.error(t),new Error(t)}}function Ks(s,e){return[cr,Tt].includes(s)||e}function Vr(s,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"This daily-js method",r=arguments.length>3?arguments[3]:void 0;if(Ks(s,e)){var a="".concat(t," not supported after joining a meeting.");throw r&&(a+=" ".concat(r)),console.error(a),new Error(a)}}function Gs(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method",t=arguments.length>2?arguments[2]:void 0;if(!s){var r="".concat(e,arguments.length>3&&arguments[3]!==void 0&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw t&&(r+=" ".concat(t)),console.error(r),new Error(r)}}function Ur(s){if(s){var e="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(e),new Error(e)}}function tt(s){if(!s){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(e),new Error(e)}}function Ge(s){if(s){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(e),new Error(e)}}function ne(){if(le())throw new Error("This daily-js method is not currently supported in React Native")}function gs(){if(!le())throw new Error("This daily-js method is only supported in React Native")}function rc(s){if(s===void 0)return!0;var e;if(typeof s=="string")e=s;else try{e=JSON.stringify(s),Ue(JSON.parse(e),s)||console.warn("The userData provided will be modified when serialized.")}catch(t){throw Error("userData must be serializable to JSON: ".concat(t))}if(e.length>4096)throw Error("userData is too large (".concat(e.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function nc(s,e){for(var t=e.allowAllParticipantsKey,r=function(_){var N=["local"];return t||N.push("*"),_&&!N.includes(_)},a=function(_){return!!(_.layer===void 0||Number.isInteger(_.layer)&&_.layer>=0||_.layer==="inherit")},i=function(_){return!!_&&!(_.video&&!a(_.video))&&!(_.screenVideo&&!a(_.screenVideo))},l=0,c=Object.entries(s);l<c.length;l++){var d=Re(c[l],2),m=d[0],v=d[1];if(!r(m)||!i(v))return!1}return!0}function ac(s){if(de(s)!=="object")return!1;for(var e=0,t=Object.entries(s);e<t.length;e++){var r=Re(t[e],2),a=r[0],i=r[1];switch(a){case"video":if(de(i)!=="object")return!1;for(var l=0,c=Object.entries(i);l<c.length;l++){var d=Re(c[l],2),m=d[0],v=d[1];switch(m){case"processor":if(!Mh(v))return!1;break;case"settings":if(!uo(v))return!1;break;default:return!1}}break;case"audio":if(de(i)!=="object")return!1;for(var _=0,N=Object.entries(i);_<N.length;_++){var E=Re(N[_],2),j=E[0],y=E[1];switch(j){case"processor":if(!Ah(y))return!1;break;case"settings":if(!uo(y))return!1;break;default:return!1}}break;default:return!1}}return!0}function ic(s,e,t){var r,a=[];s.video&&s.video.processor&&($l((r=e==null?void 0:e.useLegacyVideoProcessor)!==null&&r!==void 0&&r)||(s.video.settings?delete s.video.processor:delete s.video,a.push("video"))),s.audio&&s.audio.processor&&(Jl()||(s.audio.settings?delete s.audio.processor:delete s.audio,a.push("audio"))),a.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(a.join(", "))),s.audio&&s.audio.settings&&(s.audio.settings.customTrack?(t.audioTrack=s.audio.settings.customTrack,s.audio.settings={customTrack:gt}):delete t.audioTrack),s.video&&s.video.settings&&(s.video.settings.customTrack?(t.videoTrack=s.video.settings.customTrack,s.video.settings={customTrack:gt}):delete t.videoTrack)}function Ah(s){if(le())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type"];return!!s&&de(s)==="object"&&(Object.keys(s).filter(function(t){return!e.includes(t)}).forEach(function(t){console.warn("invalid key inputSettings -> audio -> processor : ".concat(t)),delete s[t]}),!!function(t){return typeof t!="string"?!1:Object.values(ql).includes(t)?!0:(console.error("inputSettings audio processor type invalid"),!1)}(s.type))}function Mh(s){if(le())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type","config"];return!s||de(s)!=="object"||!function(t){return typeof t!="string"?!1:Object.values(Hs).includes(t)?!0:(console.error("inputSettings video processor type invalid"),!1)}(s.type)||s.config&&(de(s.config)!=="object"||!function(t,r){var a=Object.keys(r);if(a.length===0)return!0;var i="invalid object in inputSettings -> video -> processor -> config";switch(t){case Hs.BGBLUR:return a.length>1||a[0]!=="strength"?(console.error(i),!1):!(typeof r.strength!="number"||r.strength<=0||r.strength>1||isNaN(r.strength))||(console.error("".concat(i,"; expected: {0 < strength <= 1}, got: ").concat(r.strength)),!1);case Hs.BGIMAGE:return!(r.source!==void 0&&!function(l){if(l.source==="default")return l.type="default",!0;if(l.source instanceof ArrayBuffer)return!0;if(nr(l.source))return l.type="url",!!function(m){var v=new URL(m),_=v.pathname;if(v.protocol==="data:")try{var N=_.substring(_.indexOf(":")+1,_.indexOf(";")).split("/")[1];return Lr.includes(N)}catch(j){return console.error("failed to deduce blob content type",j),!1}var E=_.split(".").at(-1).toLowerCase().trim();return Lr.includes(E)}(l.source)||(console.error("invalid image type; supported types: [".concat(Lr.join(", "),"]")),!1);return c=l.source,d=Number(c),isNaN(d)||!Number.isInteger(d)||d<=0||d>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(l.type="daily-preselect",!0);var c,d}(r));default:return!0}}(s.type,s.config))?!1:(Object.keys(s).filter(function(t){return!e.includes(t)}).forEach(function(t){console.warn("invalid key inputSettings -> video -> processor : ".concat(t)),delete s[t]}),!0)}function uo(s){return de(s)==="object"&&(!s.customTrack||s.customTrack instanceof MediaStreamTrack)}function xn(){var s=Object.values(Hs).join(" | "),e=Object.values(ql).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(s," ], config?: {} } }, audio?: { processor: {type: [ ").concat(e," ] } } }")}function oc(s){var e=s.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat($o).concat(e?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function lc(){return"customIntegrations should be an object of type ".concat(JSON.stringify(_n),".")}function cc(s){if(s&&de(s)!=="object"||Array.isArray(s))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(hr),".")),!1;if(s)for(var e=0,t=Object.entries(s);e<t.length;e++)for(var r=Re(t[e],1)[0],a=0,i=Object.entries(s[r]);a<i.length;a++){var l=Re(i[a],2),c=l[0],d=l[1],m=hr.id[c];if(!m)return console.error("customTrayButton does not support key ".concat(c)),!1;switch(c){case"iconPath":case"iconPathDarkMode":if(!nr(d))return console.error("customTrayButton ".concat(c," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(d))return console.error("customTrayButton ".concat(c," should be ").concat(m,". Got: ").concat(d)),!1;break;default:if(de(d)!==m)return console.error("customTrayButton ".concat(c," should be a ").concat(m,".")),!1}}return!0}function uc(s){if(!s||s&&de(s)!=="object"||Array.isArray(s))return console.error(lc()),!1;for(var e=function(_){return"".concat(_," should be ").concat(_n.id[_])},t=function(_,N){return console.error("customIntegration ".concat(_,": ").concat(N))},r=0,a=Object.entries(s);r<a.length;r++){var i=Re(a[r],1)[0];if(!("label"in s[i]))return t(i,"label is required"),!1;if(!("location"in s[i]))return t(i,"location is required"),!1;if(!("src"in s[i])&&!("srcdoc"in s[i]))return t(i,"src or srcdoc is required"),!1;for(var l=0,c=Object.entries(s[i]);l<c.length;l++){var d=Re(c[l],2),m=d[0],v=d[1];switch(m){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if(typeof v!="string")return t(i,e(m)),!1;break;case"iconURL":if(!nr(v))return t(i,"".concat(m," should be a url")),!1;break;case"src":if("srcdoc"in s[i])return t(i,"cannot have both src and srcdoc"),!1;if(!nr(v))return t(i,'src "'.concat(v,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in s[i])return t(i,"cannot have both src and srcdoc"),!1;if(typeof v!="string")return t(i,e(m)),!1;break;case"location":if(!["main","sidebar"].includes(v))return t(i,e(m)),!1;break;case"controlledBy":if(v!=="*"&&v!=="owners"&&(!Array.isArray(v)||v.some(function(_){return typeof _!="string"})))return t(i,e(m)),!1;break;case"shared":if((!Array.isArray(v)||v.some(function(_){return typeof _!="string"}))&&v!=="owners"&&typeof v!="boolean")return t(i,e(m)),!1;break;default:if(!_n.id[m])return console.error("customIntegration does not support key ".concat(m)),!1}}}return!0}function dc(s,e){if(e===void 0)return!1;switch(de(e)){case"string":return de(s)===e;case"object":if(de(s)!=="object")return!1;for(var t in s)if(!dc(s[t],e[t]))return!1;return!0;default:return!1}}function ho(s,e){var t=s.sessionId,r=s.toEndPoint,a=s.callerId,i=s.useSipRefer;if(!t||!r)throw new Error("".concat(e,"() requires a sessionId and toEndPoint"));if(typeof t!="string"||typeof r!="string")throw new Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(i&&!r.startsWith("sip:"))throw new Error('"toEndPoint" must be a "sip" address');if(!r.startsWith("sip:")&&!r.startsWith("+"))throw new Error("toEndPoint: ".concat(r,' must starts with either "sip:" or "+"'));if(a&&typeof a!="string")throw new Error("callerId must be of type string");if(a&&!r.startsWith("+"))throw new Error("callerId is only valid when transferring to a PSTN number")}function mo(s){if(de(s)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(s.state&&!Object.values(fn).includes(s.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(fn));if(s.volume){if(typeof s.volume!="number")throw new Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(s.volume<0||s.volume>2)throw new Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function po(s,e,t){return!(typeof s!="number"||s<e||s>t)}function qr(s,e){return s&&!e&&delete s.data,s}const Ih=Object.freeze(Object.defineProperty({__proto__:null,DAILY_ACCESS_LEVEL_FULL:Bo,DAILY_ACCESS_LEVEL_LOBBY:Ld,DAILY_ACCESS_LEVEL_NONE:Dd,DAILY_ACCESS_UNKNOWN:Ws,DAILY_CAMERA_ERROR_CAM_AND_MIC_IN_USE:Yd,DAILY_CAMERA_ERROR_CAM_IN_USE:Gd,DAILY_CAMERA_ERROR_CONSTRAINTS:Qd,DAILY_CAMERA_ERROR_MIC_IN_USE:zd,DAILY_CAMERA_ERROR_NOT_FOUND:Kd,DAILY_CAMERA_ERROR_PERMISSIONS:Wd,DAILY_CAMERA_ERROR_UNDEF_MEDIADEVICES:Hd,DAILY_CAMERA_ERROR_UNKNOWN:Xd,DAILY_EVENT_ACCESS_STATE_UPDATED:il,DAILY_EVENT_ACTIVE_SPEAKER_CHANGE:Tl,DAILY_EVENT_ACTIVE_SPEAKER_MODE_CHANGE:Al,DAILY_EVENT_APP_MSG:xl,DAILY_EVENT_CAMERA_ERROR:Xo,DAILY_EVENT_CPU_LOAD_CHANGE:Ol,DAILY_EVENT_ERROR:pn,DAILY_EVENT_EXIT_FULLSCREEN:_s,DAILY_EVENT_FACE_COUNTS_UPDATED:Pl,DAILY_EVENT_FULLSCREEN:bs,DAILY_EVENT_IFRAME_LAUNCH_CONFIG:Yo,DAILY_EVENT_IFRAME_READY_FOR_LAUNCH_CONFIG:zo,DAILY_EVENT_INPUT_SETTINGS_UPDATED:hn,DAILY_EVENT_JOINED_MEETING:el,DAILY_EVENT_JOINING_MEETING:Zo,DAILY_EVENT_LANG_UPDATED:Vl,DAILY_EVENT_LEFT_MEETING:tl,DAILY_EVENT_LIVE_STREAMING_ERROR:Fl,DAILY_EVENT_LIVE_STREAMING_STARTED:Ll,DAILY_EVENT_LIVE_STREAMING_STOPPED:Rl,DAILY_EVENT_LIVE_STREAMING_UPDATED:Dl,DAILY_EVENT_LOADED:cn,DAILY_EVENT_LOADING:Ho,DAILY_EVENT_LOAD_ATTEMPT_FAILED:Ko,DAILY_EVENT_LOCAL_SCREEN_SHARE_CANCELED:Nl,DAILY_EVENT_LOCAL_SCREEN_SHARE_STARTED:Cl,DAILY_EVENT_LOCAL_SCREEN_SHARE_STOPPED:El,DAILY_EVENT_MEETING_SESSION_DATA_ERROR:Zd,DAILY_EVENT_MEETING_SESSION_STATE_UPDATED:ll,DAILY_EVENT_MEETING_SESSION_SUMMARY_UPDATED:ol,DAILY_EVENT_NETWORK_CONNECTION:Il,DAILY_EVENT_NETWORK_QUALITY_CHANGE:Ml,DAILY_EVENT_NONFATAL_ERROR:mn,DAILY_EVENT_PARTICIPANT_COUNTS_UPDATED:al,DAILY_EVENT_PARTICIPANT_JOINED:sl,DAILY_EVENT_PARTICIPANT_LEFT:nl,DAILY_EVENT_PARTICIPANT_UPDATED:rl,DAILY_EVENT_RECEIVE_SETTINGS_UPDATED:Ul,DAILY_EVENT_RECORDING_DATA:_l,DAILY_EVENT_RECORDING_ERROR:yl,DAILY_EVENT_RECORDING_STARTED:un,DAILY_EVENT_RECORDING_STATS:vl,DAILY_EVENT_RECORDING_STOPPED:dn,DAILY_EVENT_RECORDING_UPLOAD_COMPLETED:bl,DAILY_EVENT_REMOTE_MEDIA_PLAYER_STARTED:Sl,DAILY_EVENT_REMOTE_MEDIA_PLAYER_STOPPED:kl,DAILY_EVENT_REMOTE_MEDIA_PLAYER_UPDATED:jl,DAILY_EVENT_STARTED_CAMERA:Qo,DAILY_EVENT_THEME_UPDATED:Wo,DAILY_EVENT_TRACK_STARTED:hl,DAILY_EVENT_TRACK_STOPPED:ml,DAILY_EVENT_TRANSCRIPTION_ERROR:gl,DAILY_EVENT_TRANSCRIPTION_MSG:wl,DAILY_EVENT_TRANSCRIPTION_STARTED:pl,DAILY_EVENT_TRANSCRIPTION_STOPPED:fl,DAILY_EVENT_WAITING_PARTICIPANT_ADDED:cl,DAILY_EVENT_WAITING_PARTICIPANT_REMOVED:dl,DAILY_EVENT_WAITING_PARTICIPANT_UPDATED:ul,DAILY_FATAL_ERROR_CONNECTION:Go,DAILY_FATAL_ERROR_EJECTED:Fd,DAILY_FATAL_ERROR_EOL:Jo,DAILY_FATAL_ERROR_EXP_ROOM:qd,DAILY_FATAL_ERROR_EXP_TOKEN:Bd,DAILY_FATAL_ERROR_MEETING_FULL:$d,DAILY_FATAL_ERROR_NBF_ROOM:Vd,DAILY_FATAL_ERROR_NBF_TOKEN:Ud,DAILY_FATAL_ERROR_NOT_ALLOWED:Jd,DAILY_FATAL_ERROR_NO_ROOM:ln,DAILY_RECEIVE_SETTINGS_ALL_PARTICIPANTS_KEY:Rd,DAILY_RECEIVE_SETTINGS_BASE_KEY:$o,DAILY_STATE_ERROR:dt,DAILY_STATE_JOINED:Tt,DAILY_STATE_JOINING:cr,DAILY_STATE_LEFT:Ct,DAILY_STATE_NEW:on,DAILY_TRACK_STATE_BLOCKED:Ad,DAILY_TRACK_STATE_INTERRUPTED:Pd,DAILY_TRACK_STATE_LOADING:Od,DAILY_TRACK_STATE_OFF:Md,DAILY_TRACK_STATE_PLAYABLE:qo,DAILY_TRACK_STATE_SENDABLE:Id,default:Th},Symbol.toStringTag,{value:"Module"})),Oh=Fc(Ih);var Fn={exports:{}},as=typeof Reflect=="object"?Reflect:null,fo=as&&typeof as.apply=="function"?as.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)},Qs;as&&typeof as.ownKeys=="function"?Qs=as.ownKeys:Object.getOwnPropertySymbols?Qs=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Qs=function(e){return Object.getOwnPropertyNames(e)};function Ph(s){console&&console.warn&&console.warn(s)}var hc=Number.isNaN||function(e){return e!==e};function pe(){pe.init.call(this)}Fn.exports=pe;Fn.exports.once=Fh;pe.EventEmitter=pe;pe.prototype._events=void 0;pe.prototype._eventsCount=0;pe.prototype._maxListeners=void 0;var go=10;function xr(s){if(typeof s!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}Object.defineProperty(pe,"defaultMaxListeners",{enumerable:!0,get:function(){return go},set:function(s){if(typeof s!="number"||s<0||hc(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");go=s}});pe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};pe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||hc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function mc(s){return s._maxListeners===void 0?pe.defaultMaxListeners:s._maxListeners}pe.prototype.getMaxListeners=function(){return mc(this)};pe.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var a=e==="error",i=this._events;if(i!==void 0)a=a&&i.error===void 0;else if(!a)return!1;if(a){var l;if(t.length>0&&(l=t[0]),l instanceof Error)throw l;var c=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw c.context=l,c}var d=i[e];if(d===void 0)return!1;if(typeof d=="function")fo(d,this,t);else for(var m=d.length,v=yc(d,m),r=0;r<m;++r)fo(v[r],this,t);return!0};function pc(s,e,t,r){var a,i,l;if(xr(t),i=s._events,i===void 0?(i=s._events=Object.create(null),s._eventsCount=0):(i.newListener!==void 0&&(s.emit("newListener",e,t.listener?t.listener:t),i=s._events),l=i[e]),l===void 0)l=i[e]=t,++s._eventsCount;else if(typeof l=="function"?l=i[e]=r?[t,l]:[l,t]:r?l.unshift(t):l.push(t),a=mc(s),a>0&&l.length>a&&!l.warned){l.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=s,c.type=e,c.count=l.length,Ph(c)}return s}pe.prototype.addListener=function(e,t){return pc(this,e,t,!1)};pe.prototype.on=pe.prototype.addListener;pe.prototype.prependListener=function(e,t){return pc(this,e,t,!0)};function Lh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function fc(s,e,t){var r={fired:!1,wrapFn:void 0,target:s,type:e,listener:t},a=Lh.bind(r);return a.listener=t,r.wrapFn=a,a}pe.prototype.once=function(e,t){return xr(t),this.on(e,fc(this,e,t)),this};pe.prototype.prependOnceListener=function(e,t){return xr(t),this.prependListener(e,fc(this,e,t)),this};pe.prototype.removeListener=function(e,t){var r,a,i,l,c;if(xr(t),a=this._events,a===void 0)return this;if(r=a[e],r===void 0)return this;if(r===t||r.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete a[e],a.removeListener&&this.emit("removeListener",e,r.listener||t));else if(typeof r!="function"){for(i=-1,l=r.length-1;l>=0;l--)if(r[l]===t||r[l].listener===t){c=r[l].listener,i=l;break}if(i<0)return this;i===0?r.shift():Dh(r,i),r.length===1&&(a[e]=r[0]),a.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};pe.prototype.off=pe.prototype.removeListener;pe.prototype.removeAllListeners=function(e){var t,r,a;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),l;for(a=0;a<i.length;++a)l=i[a],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=r[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this};function gc(s,e,t){var r=s._events;if(r===void 0)return[];var a=r[e];return a===void 0?[]:typeof a=="function"?t?[a.listener||a]:[a]:t?Rh(a):yc(a,a.length)}pe.prototype.listeners=function(e){return gc(this,e,!0)};pe.prototype.rawListeners=function(e){return gc(this,e,!1)};pe.listenerCount=function(s,e){return typeof s.listenerCount=="function"?s.listenerCount(e):vc.call(s,e)};pe.prototype.listenerCount=vc;function vc(s){var e=this._events;if(e!==void 0){var t=e[s];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}pe.prototype.eventNames=function(){return this._eventsCount>0?Qs(this._events):[]};function yc(s,e){for(var t=new Array(e),r=0;r<e;++r)t[r]=s[r];return t}function Dh(s,e){for(;e+1<s.length;e++)s[e]=s[e+1];s.pop()}function Rh(s){for(var e=new Array(s.length),t=0;t<e.length;++t)e[t]=s[t].listener||s[t];return e}function Fh(s,e){return new Promise(function(t,r){function a(l){s.removeListener(e,i),r(l)}function i(){typeof s.removeListener=="function"&&s.removeListener("error",a),t([].slice.call(arguments))}bc(s,e,i,{once:!0}),e!=="error"&&Vh(s,a,{once:!0})})}function Vh(s,e,t){typeof s.on=="function"&&bc(s,"error",e,t)}function bc(s,e,t,r){if(typeof s.on=="function")r.once?s.once(e,t):s.on(e,t);else if(typeof s.addEventListener=="function")s.addEventListener(e,function a(i){r.once&&s.removeEventListener(e,a),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof s)}var Uh=Fn.exports,wr={},At={};Object.defineProperty(At,"__esModule",{value:!0});At.Api=At.HttpClient=At.ContentType=void 0;var U;(function(s){s.Json="application/json",s.JsonApi="application/vnd.api+json",s.FormData="multipart/form-data",s.UrlEncoded="application/x-www-form-urlencoded",s.Text="text/plain"})(U||(At.ContentType=U={}));class _c{constructor(e={}){ee(this,"baseUrl","https://api.vapi.ai");ee(this,"securityData",null);ee(this,"securityWorker");ee(this,"abortControllers",new Map);ee(this,"customFetch",(...e)=>fetch(...e));ee(this,"baseApiParams",{credentials:"same-origin",headers:{},redirect:"follow",referrerPolicy:"no-referrer"});ee(this,"setSecurityData",e=>{this.securityData=e});ee(this,"contentFormatters",{[U.Json]:e=>e!==null&&(typeof e=="object"||typeof e=="string")?JSON.stringify(e):e,[U.JsonApi]:e=>e!==null&&(typeof e=="object"||typeof e=="string")?JSON.stringify(e):e,[U.Text]:e=>e!==null&&typeof e!="string"?JSON.stringify(e):e,[U.FormData]:e=>Object.keys(e||{}).reduce((t,r)=>{const a=e[r];return t.append(r,a instanceof Blob?a:typeof a=="object"&&a!==null?JSON.stringify(a):`${a}`),t},new FormData),[U.UrlEncoded]:e=>this.toQueryString(e)});ee(this,"createAbortSignal",e=>{if(this.abortControllers.has(e)){const r=this.abortControllers.get(e);return r?r.signal:void 0}const t=new AbortController;return this.abortControllers.set(e,t),t.signal});ee(this,"abortRequest",e=>{const t=this.abortControllers.get(e);t&&(t.abort(),this.abortControllers.delete(e))});ee(this,"request",async({body:e,secure:t,path:r,type:a,query:i,format:l,baseUrl:c,cancelToken:d,...m})=>{const v=(typeof t=="boolean"?t:this.baseApiParams.secure)&&this.securityWorker&&await this.securityWorker(this.securityData)||{},_=this.mergeRequestParams(m,v),N=i&&this.toQueryString(i),E=this.contentFormatters[a||U.Json],j=l||_.format;return this.customFetch(`${c||this.baseUrl||""}${r}${N?`?${N}`:""}`,{..._,headers:{..._.headers||{},...a&&a!==U.FormData?{"Content-Type":a}:{}},signal:(d?this.createAbortSignal(d):_.signal)||null,body:typeof e>"u"||e===null?null:E(e)}).then(async y=>{const S=y.clone();S.data=null,S.error=null;const C=j?await y[j]().then(T=>(S.ok?S.data=T:S.error=T,S)).catch(T=>(S.error=T,S)):S;if(d&&this.abortControllers.delete(d),!y.ok)throw C;return C})});Object.assign(this,e)}encodeQueryParam(e,t){return`${encodeURIComponent(e)}=${encodeURIComponent(typeof t=="number"?t:`${t}`)}`}addQueryParam(e,t){return this.encodeQueryParam(t,e[t])}addArrayQueryParam(e,t){return e[t].map(a=>this.encodeQueryParam(t,a)).join("&")}toQueryString(e){const t=e||{};return Object.keys(t).filter(a=>typeof t[a]<"u").map(a=>Array.isArray(t[a])?this.addArrayQueryParam(t,a):this.addQueryParam(t,a)).join("&")}addQueryParams(e){const t=this.toQueryString(e);return t?`?${t}`:""}mergeRequestParams(e,t){return{...this.baseApiParams,...e,...t||{},headers:{...this.baseApiParams.headers||{},...e.headers||{},...t&&t.headers||{}}}}}At.HttpClient=_c;class qh extends _c{constructor(){super(...arguments);ee(this,"call",{callControllerCreate:(t,r={})=>this.request({path:"/call",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),callControllerFindAll:(t,r={})=>this.request({path:"/call",method:"GET",query:t,secure:!0,format:"json",...r}),callControllerFindOne:(t,r={})=>this.request({path:`/call/${t}`,method:"GET",secure:!0,format:"json",...r}),callControllerUpdate:(t,r,a={})=>this.request({path:`/call/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),callControllerDeleteCallData:(t,r={})=>this.request({path:`/call/${t}`,method:"DELETE",secure:!0,format:"json",...r}),callControllerCreatePhoneCall:(t,r={})=>this.request({path:"/call/phone",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),callControllerCreateWebCall:(t,r={})=>this.request({path:"/call/web",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r})});ee(this,"v2",{callControllerExportCalls:(t,r={})=>this.request({path:"/v2/call/export",method:"GET",query:t,secure:!0,...r}),callControllerFindAllPaginated:(t,r={})=>this.request({path:"/v2/call",method:"GET",query:t,secure:!0,format:"json",...r}),callControllerFindAllMetadataPaginated:(t,r={})=>this.request({path:"/v2/call/metadata",method:"GET",query:t,secure:!0,format:"json",...r}),assistantControllerFindAllPaginated:(t,r={})=>this.request({path:"/v2/assistant",method:"GET",query:t,secure:!0,format:"json",...r}),phoneNumberControllerFindAllPaginated:(t,r={})=>this.request({path:"/v2/phone-number",method:"GET",query:t,secure:!0,format:"json",...r})});ee(this,"chat",{chatControllerListChats:(t,r={})=>this.request({path:"/chat",method:"GET",query:t,secure:!0,format:"json",...r}),chatControllerCreateChat:(t,r={})=>this.request({path:"/chat",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),chatControllerGetChat:(t,r={})=>this.request({path:`/chat/${t}`,method:"GET",secure:!0,format:"json",...r}),chatControllerDeleteChat:(t,r={})=>this.request({path:`/chat/${t}`,method:"DELETE",secure:!0,format:"json",...r}),chatControllerCreateOpenAiChat:(t,r={})=>this.request({path:"/chat/responses",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),chatControllerCreateWebChat:(t,r={})=>this.request({path:"/chat/web",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),chatControllerCreateOpenAiWebChat:(t,r={})=>this.request({path:"/chat/web/responses",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r})});ee(this,"campaign",{campaignControllerCreate:(t,r={})=>this.request({path:"/campaign",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),campaignControllerFindAll:(t,r={})=>this.request({path:"/campaign",method:"GET",query:t,secure:!0,format:"json",...r}),campaignControllerFindAllPaginated:(t,r={})=>this.request({path:"/campaign/paginated",method:"GET",query:t,secure:!0,format:"json",...r}),campaignControllerFindOne:(t,r={})=>this.request({path:`/campaign/${t}`,method:"GET",secure:!0,format:"json",...r}),campaignControllerUpdate:(t,r,a={})=>this.request({path:`/campaign/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),campaignControllerRemove:(t,r={})=>this.request({path:`/campaign/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"session",{sessionControllerCreate:(t,r={})=>this.request({path:"/session",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),sessionControllerFindAllPaginated:(t,r={})=>this.request({path:"/session",method:"GET",query:t,secure:!0,format:"json",...r}),sessionControllerFindOne:(t,r={})=>this.request({path:`/session/${t}`,method:"GET",secure:!0,format:"json",...r}),sessionControllerUpdate:(t,r,a={})=>this.request({path:`/session/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),sessionControllerRemove:(t,r={})=>this.request({path:`/session/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"support",{supportControllerCreateTicket:(t,r={})=>this.request({path:"/support/ticket",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r})});ee(this,"assistant",{assistantControllerCreate:(t,r={})=>this.request({path:"/assistant",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),assistantControllerFindAll:(t,r={})=>this.request({path:"/assistant",method:"GET",query:t,secure:!0,format:"json",...r}),assistantControllerFindOne:(t,r={})=>this.request({path:`/assistant/${t}`,method:"GET",secure:!0,format:"json",...r}),assistantControllerUpdate:(t,r,a={})=>this.request({path:`/assistant/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),assistantControllerReplace:(t,r,a={})=>this.request({path:`/assistant/${t}`,method:"PUT",body:r,secure:!0,type:U.Json,format:"json",...a}),assistantControllerRemove:(t,r={})=>this.request({path:`/assistant/${t}`,method:"DELETE",secure:!0,format:"json",...r}),assistantControllerFindVersions:(t,r,a={})=>this.request({path:`/assistant/${t}/version`,method:"GET",query:r,secure:!0,format:"json",...a})});ee(this,"phoneNumber",{phoneNumberControllerImportTwilio:(t,r={})=>this.request({path:"/phone-number/import/twilio",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),phoneNumberControllerImportVonage:(t,r={})=>this.request({path:"/phone-number/import/vonage",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),phoneNumberControllerCreate:(t,r={})=>this.request({path:"/phone-number",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),phoneNumberControllerFindAll:(t,r={})=>this.request({path:"/phone-number",method:"GET",query:t,secure:!0,format:"json",...r}),phoneNumberControllerFindOne:(t,r={})=>this.request({path:`/phone-number/${t}`,method:"GET",secure:!0,format:"json",...r}),phoneNumberControllerUpdate:(t,r,a={})=>this.request({path:`/phone-number/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),phoneNumberControllerRemove:(t,r={})=>this.request({path:`/phone-number/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"tool",{toolControllerCreate:(t,r={})=>this.request({path:"/tool",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),toolControllerFindAll:(t,r={})=>this.request({path:"/tool",method:"GET",query:t,secure:!0,format:"json",...r}),toolControllerFindOne:(t,r={})=>this.request({path:`/tool/${t}`,method:"GET",secure:!0,format:"json",...r}),toolControllerUpdate:(t,r,a={})=>this.request({path:`/tool/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),toolControllerRemove:(t,r={})=>this.request({path:`/tool/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"file",{fileControllerCreateDeprecated:(t,r={})=>this.request({path:"/file/upload",method:"POST",body:t,secure:!0,type:U.FormData,format:"json",...r}),fileControllerCreate:(t,r={})=>this.request({path:"/file",method:"POST",body:t,secure:!0,type:U.FormData,format:"json",...r}),fileControllerFindAll:(t={})=>this.request({path:"/file",method:"GET",secure:!0,format:"json",...t}),fileControllerFindOne:(t,r={})=>this.request({path:`/file/${t}`,method:"GET",secure:!0,format:"json",...r}),fileControllerUpdate:(t,r,a={})=>this.request({path:`/file/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),fileControllerRemove:(t,r={})=>this.request({path:`/file/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"knowledgeBase",{knowledgeBaseControllerCreate:(t,r={})=>this.request({path:"/knowledge-base",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),knowledgeBaseControllerFindAll:(t,r={})=>this.request({path:"/knowledge-base",method:"GET",query:t,secure:!0,format:"json",...r}),knowledgeBaseControllerFindOne:(t,r={})=>this.request({path:`/knowledge-base/${t}`,method:"GET",secure:!0,format:"json",...r}),knowledgeBaseControllerUpdate:(t,r,a={})=>this.request({path:`/knowledge-base/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),knowledgeBaseControllerRemove:(t,r={})=>this.request({path:`/knowledge-base/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"workflow",{workflowControllerFindAll:(t={})=>this.request({path:"/workflow",method:"GET",secure:!0,format:"json",...t}),workflowControllerCreate:(t,r={})=>this.request({path:"/workflow",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),workflowControllerFindOne:(t,r={})=>this.request({path:`/workflow/${t}`,method:"GET",secure:!0,format:"json",...r}),workflowControllerDelete:(t,r={})=>this.request({path:`/workflow/${t}`,method:"DELETE",secure:!0,format:"json",...r}),workflowControllerUpdate:(t,r,a={})=>this.request({path:`/workflow/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),workflowControllerGenerateFromTranscripts:(t,r={})=>this.request({path:"/workflow/generate",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r})});ee(this,"squad",{squadControllerCreate:(t,r={})=>this.request({path:"/squad",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),squadControllerFindAll:(t,r={})=>this.request({path:"/squad",method:"GET",query:t,secure:!0,format:"json",...r}),squadControllerFindOne:(t,r={})=>this.request({path:`/squad/${t}`,method:"GET",secure:!0,format:"json",...r}),squadControllerUpdate:(t,r,a={})=>this.request({path:`/squad/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),squadControllerRemove:(t,r={})=>this.request({path:`/squad/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"testSuite",{testSuiteControllerFindAllPaginated:(t,r={})=>this.request({path:"/test-suite",method:"GET",query:t,secure:!0,format:"json",...r}),testSuiteControllerCreate:(t,r={})=>this.request({path:"/test-suite",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),testSuiteControllerFindOne:(t,r={})=>this.request({path:`/test-suite/${t}`,method:"GET",secure:!0,format:"json",...r}),testSuiteControllerUpdate:(t,r,a={})=>this.request({path:`/test-suite/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),testSuiteControllerRemove:(t,r={})=>this.request({path:`/test-suite/${t}`,method:"DELETE",secure:!0,format:"json",...r}),testSuiteTestControllerFindAllPaginated:(t,r,a={})=>this.request({path:`/test-suite/${t}/test`,method:"GET",query:r,secure:!0,format:"json",...a}),testSuiteTestControllerCreate:(t,r,a={})=>this.request({path:`/test-suite/${t}/test`,method:"POST",body:r,secure:!0,type:U.Json,format:"json",...a}),testSuiteTestControllerFindOne:(t,r,a={})=>this.request({path:`/test-suite/${t}/test/${r}`,method:"GET",secure:!0,format:"json",...a}),testSuiteTestControllerUpdate:(t,r,a,i={})=>this.request({path:`/test-suite/${t}/test/${r}`,method:"PATCH",body:a,secure:!0,type:U.Json,format:"json",...i}),testSuiteTestControllerRemove:(t,r,a={})=>this.request({path:`/test-suite/${t}/test/${r}`,method:"DELETE",secure:!0,format:"json",...a}),testSuiteRunControllerFindAllPaginated:(t,r,a={})=>this.request({path:`/test-suite/${t}/run`,method:"GET",query:r,secure:!0,format:"json",...a}),testSuiteRunControllerCreate:(t,r,a={})=>this.request({path:`/test-suite/${t}/run`,method:"POST",body:r,secure:!0,type:U.Json,format:"json",...a}),testSuiteRunControllerFindOne:(t,r,a={})=>this.request({path:`/test-suite/${t}/run/${r}`,method:"GET",secure:!0,format:"json",...a}),testSuiteRunControllerUpdate:(t,r,a,i={})=>this.request({path:`/test-suite/${t}/run/${r}`,method:"PATCH",body:a,secure:!0,type:U.Json,format:"json",...i}),testSuiteRunControllerRemove:(t,r,a={})=>this.request({path:`/test-suite/${t}/run/${r}`,method:"DELETE",secure:!0,format:"json",...a})});ee(this,"analytics",{analyticsControllerQuery:(t,r={})=>this.request({path:"/analytics",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r})});ee(this,"log",{loggingControllerCallLogsQuery:(t,r={})=>this.request({path:"/log",method:"GET",query:t,secure:!0,format:"json",...r}),loggingControllerCallLogsDeleteQuery:(t,r={})=>this.request({path:"/log",method:"DELETE",query:t,secure:!0,...r})});ee(this,"logs",{loggingControllerLogsQuery:(t,r={})=>this.request({path:"/logs",method:"GET",query:t,secure:!0,format:"json",...r}),loggingControllerLogsDeleteQuery:(t,r={})=>this.request({path:"/logs",method:"DELETE",query:t,secure:!0,...r})});ee(this,"org",{orgControllerCreate:(t,r={})=>this.request({path:"/org",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),orgControllerFindAll:(t={})=>this.request({path:"/org",method:"GET",secure:!0,format:"json",...t}),orgControllerFindOne:(t,r={})=>this.request({path:`/org/${t}`,method:"GET",secure:!0,format:"json",...r}),orgControllerUpdate:(t,r,a={})=>this.request({path:`/org/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),orgControllerDeleteOrg:(t,r={})=>this.request({path:`/org/${t}`,method:"DELETE",secure:!0,...r}),orgControllerFindAllUsers:(t,r={})=>this.request({path:`/org/${t}/user`,method:"GET",secure:!0,format:"json",...r}),orgControllerOrgLeave:(t,r={})=>this.request({path:`/org/${t}/leave`,method:"DELETE",secure:!0,...r}),orgControllerOrgRemoveUser:(t,r,a={})=>this.request({path:`/org/${t}/member/${r}/leave`,method:"DELETE",secure:!0,...a}),orgControllerUsersInvite:(t,r,a={})=>this.request({path:`/org/${t}/invite`,method:"POST",body:r,secure:!0,type:U.Json,...a}),orgControllerUserUpdate:(t,r,a={})=>this.request({path:`/org/${t}/role`,method:"PATCH",body:r,secure:!0,type:U.Json,...a}),orgControllerOrgToken:(t,r={})=>this.request({path:`/org/${t}/auth`,method:"GET",secure:!0,format:"json",...r})});ee(this,"token",{tokenControllerCreate:(t,r={})=>this.request({path:"/token",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),tokenControllerFindAll:(t,r={})=>this.request({path:"/token",method:"GET",query:t,secure:!0,format:"json",...r}),tokenControllerFindOne:(t,r={})=>this.request({path:`/token/${t}`,method:"GET",secure:!0,format:"json",...r}),tokenControllerUpdate:(t,r,a={})=>this.request({path:`/token/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),tokenControllerRemove:(t,r={})=>this.request({path:`/token/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"credential",{credentialControllerCreate:(t,r={})=>this.request({path:"/credential",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),credentialControllerFindAll:(t,r={})=>this.request({path:"/credential",method:"GET",query:t,secure:!0,format:"json",...r}),credentialControllerFindOne:(t,r={})=>this.request({path:`/credential/${t}`,method:"GET",secure:!0,format:"json",...r}),credentialControllerUpdate:(t,r,a={})=>this.request({path:`/credential/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),credentialControllerRemove:(t,r={})=>this.request({path:`/credential/${t}`,method:"DELETE",secure:!0,format:"json",...r}),credentialControllerGenerateSession:(t,r={})=>this.request({path:"/credential/session",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),credentialControllerHandleWebhook:(t,r={})=>this.request({path:"/credential/webhook",method:"POST",body:t,type:U.Json,...r}),credentialControllerCredentialActionTrigger:(t,r={})=>this.request({path:"/credential/trigger",method:"POST",body:t,secure:!0,type:U.Json,...r})});ee(this,"template",{templateControllerCreate:(t,r={})=>this.request({path:"/template",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),templateControllerFindAll:(t,r={})=>this.request({path:"/template",method:"GET",query:t,secure:!0,format:"json",...r}),templateControllerFindAllPinned:(t={})=>this.request({path:"/template/pinned",method:"GET",secure:!0,format:"json",...t}),templateControllerFindOne:(t,r={})=>this.request({path:`/template/${t}`,method:"GET",secure:!0,format:"json",...r}),templateControllerUpdate:(t,r,a={})=>this.request({path:`/template/${t}`,method:"PATCH",body:r,secure:!0,type:U.Json,format:"json",...a}),templateControllerRemove:(t,r={})=>this.request({path:`/template/${t}`,method:"DELETE",secure:!0,format:"json",...r})});ee(this,"voiceLibrary",{voiceLibraryControllerVoiceGetByProvider:(t,r,a={})=>this.request({path:`/voice-library/${t}`,method:"GET",query:r,secure:!0,format:"json",...a}),voiceLibraryControllerVoiceGetAccentsByProvider:(t,r={})=>this.request({path:`/voice-library/${t}/accents`,method:"GET",secure:!0,format:"json",...r}),voiceLibraryControllerVoiceLibrarySyncByProvider:(t,r={})=>this.request({path:`/voice-library/sync/${t}`,method:"POST",secure:!0,format:"json",...r}),voiceLibraryControllerVoiceLibrarySyncDefaultVoices:(t,r={})=>this.request({path:"/voice-library/sync",method:"POST",body:t,secure:!0,type:U.Json,format:"json",...r}),voiceLibraryControllerVoiceLibraryCreateSesameVoice:(t,r={})=>this.request({path:"/voice-library/create-sesame-voice",method:"POST",body:t,secure:!0,type:U.Json,...r})});ee(this,"provider",{providerControllerGetWorkflows:(t,r,a={})=>this.request({path:`/${t}/workflows`,method:"GET",query:r,secure:!0,format:"json",...a}),providerControllerGetWorkflowTriggerHook:(t,r,a={})=>this.request({path:`/${t}/workflows/${r}/hooks`,method:"GET",secure:!0,format:"json",...a}),providerControllerGetLocations:(t,r={})=>this.request({path:`/${t}/locations`,method:"GET",secure:!0,format:"json",...r}),voiceProviderControllerSearchVoices:(t,r,a={})=>this.request({path:`/${t}/voices/search`,method:"GET",query:r,secure:!0,format:"json",...a}),voiceProviderControllerSearchVoice:(t,r,a={})=>this.request({path:`/${t}/voice/search`,method:"GET",query:r,secure:!0,format:"json",...a}),voiceProviderControllerAddVoices:(t,r,a={})=>this.request({path:`/${t}/voices/add`,method:"POST",body:r,secure:!0,type:U.Json,format:"json",...a}),voiceProviderControllerAddVoice:(t,r,a={})=>this.request({path:`/${t}/voice/add`,method:"POST",body:r,secure:!0,type:U.Json,format:"json",...a})});ee(this,"v11Labs",{voiceProviderControllerCloneVoices:(t,r={})=>this.request({path:"/11labs/voice/clone",method:"POST",body:t,secure:!0,type:U.FormData,...r})})}}At.Api=qh;Object.defineProperty(wr,"__esModule",{value:!0});wr.client=void 0;const Bh=At,$h=new Bh.Api({baseUrl:"https://api.vapi.ai",baseApiParams:{secure:!0},securityWorker:async s=>{if(s)return{headers:{Authorization:`Bearer ${s}`}}}});wr.client=$h;var xc=va&&va.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(wo,"__esModule",{value:!0});const Jh=xc(Oh),Gh=xc(Uh),Br=wr;async function zh(s,e){s.muted=!1,s.autoplay=!0,e!=null&&(s.srcObject=new MediaStream([e]),await s.play())}async function Yh(s,e){const t=document.createElement("audio");return t.dataset.participantId=e,document.body.appendChild(t),await zh(t,s),t}function Wh(s){const e=document.querySelector(`audio[data-participant-id="${s}"]`);e==null||e.remove()}function Hh(s,e,t,r){s.participant.local||e.updateParticipant(s.participant.session_id,{setSubscribedTracks:{audio:!0,video:t||r}})}class Kh extends Gh.default{on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}emit(e,...t){return super.emit(e,...t)}removeListener(e,t){return super.removeListener(e,t),this}removeAllListeners(e){return super.removeAllListeners(e),this}}class Qh extends Kh{constructor(t,r,a,i){super();ee(this,"started",!1);ee(this,"call",null);ee(this,"speakingTimeout",null);ee(this,"dailyCallConfig",{});ee(this,"dailyCallObject",{});ee(this,"hasEmittedCallEndedStatus",!1);Br.client.baseUrl=r??"https://api.vapi.ai",Br.client.setSecurityData(t),this.dailyCallConfig=a??{},this.dailyCallObject=i??{}}cleanup(){var t;this.started=!1,this.hasEmittedCallEndedStatus=!1,(t=this.call)==null||t.destroy(),this.call=null,this.speakingTimeout=null}isMobileDevice(){if(typeof navigator>"u")return!1;const t=navigator.userAgent;return/android|iphone|ipad|ipod|iemobile|blackberry|bada/i.test(t.toLowerCase())}async sleep(t){return new Promise(r=>setTimeout(r,t))}async start(t,r,a,i,l){var d,m,v,_,N,E,j;const c=Date.now();if(!t&&!a&&!i){const y=new Error("Assistant or Squad or Workflow must be provided.");throw this.emit("error",{type:"validation-error",stage:"input-validation",message:y.message,timestamp:new Date().toISOString()}),y}if(this.started)return this.emit("call-start-progress",{stage:"validation",status:"failed",timestamp:new Date().toISOString(),metadata:{reason:"already-started"}}),null;this.emit("call-start-progress",{stage:"initialization",status:"started",timestamp:new Date().toISOString(),metadata:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i}}),this.started=!0;try{this.emit("call-start-progress",{stage:"web-call-creation",status:"started",timestamp:new Date().toISOString()});const y=Date.now(),S=(await Br.client.call.callControllerCreateWebCall({assistant:typeof t=="string"?void 0:t,assistantId:typeof t=="string"?t:void 0,assistantOverrides:r,squad:typeof a=="string"?void 0:a,squadId:typeof a=="string"?a:void 0,workflow:typeof i=="string"?void 0:i,workflowId:typeof i=="string"?i:void 0,workflowOverrides:l})).data,C=Date.now()-y;this.emit("call-start-progress",{stage:"web-call-creation",status:"completed",duration:C,timestamp:new Date().toISOString(),metadata:{callId:(S==null?void 0:S.id)||"unknown",videoRecordingEnabled:((d=S==null?void 0:S.artifactPlan)==null?void 0:d.videoRecordingEnabled)??!1,voiceProvider:((v=(m=S==null?void 0:S.assistant)==null?void 0:m.voice)==null?void 0:v.provider)||"unknown"}}),this.call&&(this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"started",timestamp:new Date().toISOString(),metadata:{action:"cleanup-existing"}}),this.cleanup());const T=((_=S==null?void 0:S.artifactPlan)==null?void 0:_.videoRecordingEnabled)??!1,f=((E=(N=S==null?void 0:S.assistant)==null?void 0:N.voice)==null?void 0:E.provider)==="tavus";this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"started",timestamp:new Date().toISOString(),metadata:{audioSource:this.dailyCallObject.audioSource??!0,videoSource:this.dailyCallObject.videoSource??T,isVideoRecordingEnabled:T,isVideoEnabled:f}});const L=Date.now();try{this.call=Jh.default.createCallObject({audioSource:this.dailyCallObject.audioSource??!0,videoSource:this.dailyCallObject.videoSource??T,dailyConfig:this.dailyCallConfig});const A=Date.now()-L;this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"completed",duration:A,timestamp:new Date().toISOString()})}catch(A){const G=Date.now()-L;throw this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"failed",duration:G,timestamp:new Date().toISOString(),metadata:{error:A==null?void 0:A.toString()}}),this.emit("error",{type:"daily-call-object-creation-error",stage:"daily-call-object-creation",error:A,timestamp:new Date().toISOString()}),A}(j=this.call.iframe())==null||j.style.setProperty("display","none"),this.call.on("left-meeting",()=>{var A;this.emit("call-end"),this.hasEmittedCallEndedStatus||(this.emit("message",{type:"status-update",status:"ended",endedReason:"customer-ended-call"}),this.hasEmittedCallEndedStatus=!0),T&&((A=this.call)==null||A.stopRecording()),this.cleanup()}),this.call.on("error",A=>{var G;this.emit("error",A),T&&((G=this.call)==null||G.stopRecording())}),this.call.on("camera-error",A=>{this.emit("camera-error",A)}),this.call.on("network-quality-change",A=>{this.emit("network-quality-change",A)}),this.call.on("network-connection",A=>{this.emit("network-connection",A)}),this.call.on("track-started",async A=>{var G,x,R;!A||!A.participant||(G=A.participant)!=null&&G.local||((x=A.participant)==null?void 0:x.user_name)==="Vapi Speaker"&&(A.track.kind==="video"&&this.emit("video",A.track),A.track.kind==="audio"&&await Yh(A.track,A.participant.session_id),(R=this.call)==null||R.sendAppMessage("playable"))}),this.call.on("participant-joined",A=>{!A||!this.call||Hh(A,this.call,T,f)}),this.call.on("participant-updated",A=>{A&&this.emit("daily-participant-updated",A.participant)}),this.call.on("participant-left",A=>{A&&Wh(A.participant.session_id)});const I=this.isMobileDevice();if(this.emit("call-start-progress",{stage:"mobile-permissions",status:"started",timestamp:new Date().toISOString(),metadata:{isMobile:I}}),I){const A=Date.now();await this.sleep(1e3);const G=Date.now()-A;this.emit("call-start-progress",{stage:"mobile-permissions",status:"completed",duration:G,timestamp:new Date().toISOString(),metadata:{action:"permissions-wait"}})}else this.emit("call-start-progress",{stage:"mobile-permissions",status:"completed",timestamp:new Date().toISOString(),metadata:{action:"skipped-not-mobile"}});this.emit("call-start-progress",{stage:"daily-call-join",status:"started",timestamp:new Date().toISOString()});const O=Date.now();try{await this.call.join({url:S.webCallUrl,subscribeToTracksAutomatically:!1});const A=Date.now()-O;this.emit("call-start-progress",{stage:"daily-call-join",status:"completed",duration:A,timestamp:new Date().toISOString()})}catch(A){const G=Date.now()-O;throw this.emit("call-start-progress",{stage:"daily-call-join",status:"failed",duration:G,timestamp:new Date().toISOString(),metadata:{error:A==null?void 0:A.toString()}}),this.emit("error",{type:"daily-call-join-error",stage:"daily-call-join",error:A,duration:G,timestamp:new Date().toISOString()}),A}if(T){this.emit("call-start-progress",{stage:"video-recording-setup",status:"started",timestamp:new Date().toISOString()});const A=new Date().getTime(),G=Date.now();try{this.call.startRecording({width:1280,height:720,backgroundColor:"#FF1F2D3D",layout:{preset:"default"}});const x=Date.now()-G;this.emit("call-start-progress",{stage:"video-recording-setup",status:"completed",duration:x,timestamp:new Date().toISOString()}),this.call.on("recording-started",()=>{const R=(new Date().getTime()-A)/1e3;this.emit("call-start-progress",{stage:"video-recording-started",status:"completed",timestamp:new Date().toISOString(),metadata:{delaySeconds:R}}),this.send({type:"control",control:"say-first-message",videoRecordingStartDelaySeconds:R})})}catch(x){const R=Date.now()-G;this.emit("call-start-progress",{stage:"video-recording-setup",status:"failed",duration:R,timestamp:new Date().toISOString(),metadata:{error:x==null?void 0:x.toString()}}),this.emit("error",{type:"video-recording-setup-error",stage:"video-recording-setup",error:x,timestamp:new Date().toISOString()})}}else this.emit("call-start-progress",{stage:"video-recording-setup",status:"completed",timestamp:new Date().toISOString(),metadata:{action:"skipped-not-enabled"}});this.emit("call-start-progress",{stage:"audio-observer-setup",status:"started",timestamp:new Date().toISOString()});const Z=Date.now();try{this.call.startRemoteParticipantsAudioLevelObserver(100);const A=Date.now()-Z;this.emit("call-start-progress",{stage:"audio-observer-setup",status:"completed",duration:A,timestamp:new Date().toISOString()})}catch(A){const G=Date.now()-Z;this.emit("call-start-progress",{stage:"audio-observer-setup",status:"failed",duration:G,timestamp:new Date().toISOString(),metadata:{error:A==null?void 0:A.toString()}}),this.emit("error",{type:"audio-observer-setup-error",stage:"audio-observer-setup",error:A,timestamp:new Date().toISOString()})}this.call.on("remote-participants-audio-level",A=>{A&&this.handleRemoteParticipantsAudioLevel(A)}),this.call.on("app-message",A=>this.onAppMessage(A)),this.call.on("nonfatal-error",A=>{var G;(A==null?void 0:A.type)==="audio-processor-error"&&((G=this.call)==null||G.updateInputSettings({audio:{processor:{type:"none"}}}).then(()=>{var x;(x=this.call)==null||x.setLocalAudio(!0)}))}),this.emit("call-start-progress",{stage:"audio-processing-setup",status:"started",timestamp:new Date().toISOString()});const K=Date.now();try{this.call.updateInputSettings({audio:{processor:{type:"noise-cancellation"}}});const A=Date.now()-K;this.emit("call-start-progress",{stage:"audio-processing-setup",status:"completed",duration:A,timestamp:new Date().toISOString()})}catch(A){const G=Date.now()-K;this.emit("call-start-progress",{stage:"audio-processing-setup",status:"failed",duration:G,timestamp:new Date().toISOString(),metadata:{error:A==null?void 0:A.toString()}}),this.emit("error",{type:"audio-processing-setup-error",stage:"audio-processing-setup",error:A,timestamp:new Date().toISOString()})}const ae=Date.now()-c;return this.emit("call-start-success",{totalDuration:ae,callId:(S==null?void 0:S.id)||"unknown",timestamp:new Date().toISOString()}),S}catch(y){const S=Date.now()-c;return this.emit("call-start-failed",{stage:"unknown",totalDuration:S,error:(y==null?void 0:y.toString())||"Unknown error occurred",errorStack:y instanceof Error?y.stack:"No stack trace available",timestamp:new Date().toISOString(),context:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i,isMobile:this.isMobileDevice()}}),this.emit("error",{type:"start-method-error",stage:"unknown",error:y,totalDuration:S,timestamp:new Date().toISOString(),context:{hasAssistant:!!t,hasSquad:!!a,hasWorkflow:!!i,isMobile:this.isMobileDevice()}}),this.cleanup(),null}}onAppMessage(t){if(t)try{if(t.data==="listening")return this.emit("call-start");try{const r=JSON.parse(t.data);this.emit("message",r),r&&"type"in r&&"status"in r&&r.type==="status-update"&&r.status==="ended"&&(this.hasEmittedCallEndedStatus=!0)}catch(r){console.log("Error parsing message data: ",r)}}catch(r){console.error(r)}}handleRemoteParticipantsAudioLevel(t){const r=Object.values(t.participantsAudioLevel).reduce((i,l)=>i+l,0);this.emit("volume-level",Math.min(1,r/.15)),r>.01&&(this.speakingTimeout?(clearTimeout(this.speakingTimeout),this.speakingTimeout=null):this.emit("speech-start"),this.speakingTimeout=setTimeout(()=>{this.emit("speech-end"),this.speakingTimeout=null},1e3))}stop(){var t;this.started=!1,(t=this.call)==null||t.destroy(),this.call=null}send(t){var r;(r=this.call)==null||r.sendAppMessage(JSON.stringify(t))}setMuted(t){if(!this.call)throw new Error("Call object is not available.");this.call.setLocalAudio(!t)}isMuted(){return this.call?this.call.localAudio()===!1:!1}say(t,r,a,i){this.send({type:"say",message:t,endCallAfterSpoken:r,interruptionsEnabled:a??!1,interruptAssistantEnabled:i??!1})}setInputDevicesAsync(t){var r;(r=this.call)==null||r.setInputDevicesAsync(t)}async increaseMicLevel(t){if(!this.call)throw new Error("Call object is not available.");try{const r=await navigator.mediaDevices.getUserMedia({audio:!0}),a=new AudioContext,i=a.createMediaStreamSource(r),l=a.createGain();l.gain.value=t,i.connect(l);const c=a.createMediaStreamDestination();l.connect(c);const[d]=c.stream.getAudioTracks();await this.call.setInputDevicesAsync({audioSource:d})}catch(r){console.error("Error adjusting microphone level:",r)}}setOutputDeviceAsync(t){var r;(r=this.call)==null||r.setOutputDeviceAsync(t)}getDailyCallObject(){return this.call}startScreenSharing(t,r){var a;(a=this.call)==null||a.startScreenShare({displayMediaOptions:t,screenVideoSendSettings:r})}stopScreenSharing(){var t;(t=this.call)==null||t.stopScreenShare()}}var vs=wo.default=Qh;const Xh=({agentId:s,agentName:e="AI Assistant",agentConfig:t,onCallStart:r,onCallEnd:a,onError:i})=>{const l="eb3b26e3-7dbb-4fd6-a545-a954756a43aa",c=Q.useRef(null),d=Q.useRef(null),[m,v]=Q.useState({isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,volumeLevel:0,callDuration:0,status:"idle",callId:void 0}),[_,N]=Q.useState([]),E=Q.useRef(null),j=l!=="your-vapi-public-key-here";console.log("🔍 VAPI Debug Info:"),console.log("- Vapi class available:",typeof vs),console.log("- Public API Key:",`${l.substring(0,8)}...`),console.log("- Is configured:",j),Q.useEffect(()=>{console.log("🔧 Initializing VAPI for agent:",s),console.log("🔑 Public API Key:",`${l.substring(0,8)}...`),console.log("✅ Is VAPI Configured:",j);try{console.log("🧪 Testing VAPI import..."),console.log("- Vapi constructor:",vs),console.log("- typeof Vapi:",typeof vs),typeof vs=="function"?console.log("✅ VAPI import successful"):console.error("❌ VAPI import failed - not a constructor")}catch(x){console.error("❌ VAPI import test failed:",x)}try{c.current=new vs(l),console.log("✅ VAPI instance created successfully"),y()}catch(x){console.error("❌ Failed to initialize VAPI:",x),H.error("Failed to initialize VAPI. Please check your API key.")}return()=>{c.current&&c.current.stop(),E.current&&clearInterval(E.current),d.current&&(d.current.getTracks().forEach(x=>x.stop()),d.current=null)}},[l,s]);const y=()=>{c.current&&(c.current.on("call-start",()=>{console.log("🎙️ VAPI call started"),v(x=>({...x,isConnected:!0,isConnecting:!1,status:"connected",callId:Date.now().toString()})),S(),H.success("Call connected! You can now speak."),r==null||r()}),c.current.on("call-end",()=>{console.log("📞 VAPI call ended successfully"),v(x=>({...x,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"ended",callId:void 0})),E.current&&(clearInterval(E.current),E.current=null),d.current&&(d.current.getTracks().forEach(x=>x.stop()),d.current=null),H.success("Call ended successfully"),a==null||a()}),c.current.on("error",x=>{console.error("❌ VAPI call error:",x),v(R=>({...R,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"error",callId:void 0})),E.current&&(clearInterval(E.current),E.current=null),H.error(`Call error: ${x.message||"Unknown error"}`),i==null||i(x)}),c.current.on("speech-start",()=>{console.log("🗣️ Speech started")}),c.current.on("speech-end",()=>{console.log("🤐 Speech ended")}),c.current.on("volume-level",x=>{v(R=>({...R,volumeLevel:x}))}),c.current.on("message",x=>{if(console.log("📨 VAPI message:",x),x.type==="transcript"&&x.transcript){const R={role:x.role||"assistant",content:x.transcript,timestamp:new Date,type:"transcript"};N(q=>[...q,R])}}),c.current.on("error",x=>{console.error("❌ VAPI error:",x),v(q=>({...q,isConnected:!1,isConnecting:!1,status:"error"}));let R="Unknown error";x.message&&(R=x.message,x.message.includes("assistant")&&x.message.includes("not found")?R="Assistant not found in VAPI. Please ensure the agent is properly synced with VAPI dashboard.":x.message.includes("unauthorized")||x.message.includes("401")?R="Unauthorized access. Please check your VAPI API key configuration.":(x.message.includes("microphone")||x.message.includes("permission"))&&(R="Microphone permission denied. Please allow microphone access and try again.")),H.error(`Call error: ${R}`),i==null||i(x)}))},S=()=>{E.current=setInterval(()=>{v(x=>({...x,callDuration:x.callDuration+1}))},1e3)},C=x=>{const R=Math.floor(x/60),q=x%60;return`${R}:${q.toString().padStart(2,"0")}`},T=()=>{const x={name:e,firstMessage:(t==null?void 0:t.firstMessage)||`Hello! I'm ${e}. How can I help you today?`,model:{provider:"openai",model:"gpt-4",temperature:.7,messages:[{role:"system",content:(t==null?void 0:t.systemMessage)||`You are ${e}, a helpful AI assistant. Keep responses conversational and under 30 words when possible.`}]},voice:{provider:"vapi",voiceId:(t==null?void 0:t.voiceId)||"Cole"}};return console.log("📋 Assistant config created:",x),x},f=async()=>{if(console.log("🚀 Starting VAPI agent call for:",s),console.log("🔑 VAPI Public Key:",`${l.substring(0,8)}...`),console.log("🤖 Agent Config:",t),!c.current){H.error("VAPI not initialized. Please check your API key configuration.");return}try{v(R=>({...R,isConnecting:!0,status:"connecting",callDuration:0})),N([]);const x=(t==null?void 0:t.assistant_id)||(t==null?void 0:t.assistantId);if(x){console.log("📞 Using existing assistant ID from database:",x);const R={metadata:{portalAgentId:s,agentName:e,initiatedFrom:"portal"}};console.log("📋 Starting call with assistant ID:",x),console.log("📋 Assistant overrides:",R),await c.current.start(x,R)}else{console.log("🔄 Creating assistant configuration...");const R=T();console.log("📞 Starting agent call with assistant config"),console.log("🤖 Agent Name:",e);const q=R;console.log("📋 Call config:",q),await new Promise(Ee=>setTimeout(Ee,100)),await c.current.start(q)}}catch(x){console.error("❌ Error starting agent call:",x),v(q=>({...q,isConnecting:!1,status:"error"}));let R="Failed to start call";x.message?(R=x.message,x.message.includes("Authentication")||x.message.includes("401")?R="Authentication failed. Please check your VAPI API key.":x.message.includes("assistant")||x.message.includes("404")?R="Assistant not found. The assistant may not exist in VAPI.":x.message.includes("permission")||x.message.includes("microphone")?R="Microphone permission denied. Please allow microphone access.":(x.message.includes("network")||x.message.includes("fetch"))&&(R="Network error. Please check your internet connection.")):x.code?R=`Error code: ${x.code}`:typeof x=="string"&&(R=x),H.error(`Failed to start call: ${R}`),console.error("📋 Full error details:",x)}},L=()=>{console.log("🛑 Stopping VAPI agent call...");try{c.current?(console.log("📞 VAPI instance found, stopping call..."),c.current.stop(),v(x=>({...x,isConnecting:!1})),console.log("✅ VAPI stop method called successfully")):(console.warn("⚠️ No VAPI instance found to stop"),H.warning("No active call to end"))}catch(x){console.error("❌ Error stopping call:",x),H.error(`Failed to end call: ${(x==null?void 0:x.message)||"Unknown error"}`),v(R=>({...R,isConnected:!1,isConnecting:!1,isMuted:!1,isOnHold:!1,status:"ended",callId:void 0})),d.current&&(d.current.getTracks().forEach(R=>R.stop()),d.current=null)}},I=async()=>{try{if(!d.current){const x=await navigator.mediaDevices.getUserMedia({audio:!0});d.current=x}return d.current}catch(x){throw console.error("Error initializing media stream:",x),x}},O=()=>{try{if(!m.isConnected||!c.current){H.warning("No active call to mute");return}const x=!m.isMuted;c.current.setMuted(x),v(R=>({...R,isMuted:x})),H.info(x?"Microphone muted":"Microphone unmuted"),console.log(`🎤 Mute toggled: ${x}`)}catch(x){console.error("Error toggling mute:",x),H.error(`Failed to toggle mute: ${(x==null?void 0:x.message)||"Unknown error"}`),Z()}},Z=async()=>{try{console.log("🔄 Using fallback mute method...");const R=(await I()).getAudioTracks();if(R.length>0){const q=!m.isMuted;R.forEach(Ee=>{Ee.enabled=!q}),v(Ee=>({...Ee,isMuted:q})),H.info(q?"Microphone muted (fallback)":"Microphone unmuted (fallback)")}else H.error("No audio tracks found")}catch(x){console.error("Fallback mute also failed:",x),H.error("Failed to toggle mute. Please check microphone permissions.")}},K=async()=>{try{if(!m.isConnected){H.warning("No active call to hold");return}const x=!m.isOnHold;(await I()).getAudioTracks().forEach(Ee=>{Ee.enabled=!x}),v(Ee=>({...Ee,isOnHold:x,isMuted:x})),H.info(x?"Call on hold":"Call resumed")}catch(x){console.error("Error toggling hold:",x),H.error("Failed to toggle hold. Please check microphone permissions.")}},ae=()=>{const x=document.getElementById("call-button-container");return console.log("🎯 Looking for call-button-container:",x),x?(console.log("🎯 Rendering call button, call state:",m),Vc.createPortal(n.jsxs("div",{className:"flex items-center gap-2",children:[m.isConnected&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"text-sm font-mono font-semibold text-gray-800 bg-white px-3 py-1 rounded-md border border-gray-200",children:C(m.callDuration)}),n.jsx(je,{onClick:O,variant:"outline",size:"sm",className:`border-gray-300 ${m.isMuted?"bg-red-50 text-red-700 hover:bg-red-100":"bg-white hover:bg-gray-50 text-gray-700"}`,title:m.isMuted?"Unmute microphone":"Mute microphone",children:m.isMuted?n.jsx(Ec,{className:"h-4 w-4"}):n.jsx(is,{className:"h-4 w-4"})}),n.jsx(je,{onClick:K,variant:"outline",size:"sm",className:`border-gray-300 ${m.isOnHold?"bg-yellow-50 text-yellow-700 hover:bg-yellow-100":"bg-white hover:bg-gray-50 text-gray-700"}`,title:m.isOnHold?"Resume call":"Hold call",children:m.isOnHold?n.jsx(Nc,{className:"h-4 w-4"}):n.jsx(Tc,{className:"h-4 w-4"})}),n.jsx(je,{variant:"outline",size:"sm",className:"border-gray-300 bg-white hover:bg-gray-50 text-gray-700",title:"Volume control",children:n.jsx(js,{className:"h-4 w-4"})})]}),!m.isConnected&&!m.isConnecting?n.jsxs(je,{onClick:f,size:"sm",className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-md transition-all duration-200",children:[n.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Call"]}):m.isConnecting?n.jsxs(je,{size:"sm",className:"px-4 py-2 bg-amber-500 text-white text-sm font-medium rounded-md",disabled:!0,children:[n.jsx(Mt,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting"]}):n.jsxs(je,{onClick:L,size:"sm",className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-md transition-all duration-200",children:[n.jsx(Ac,{className:"h-4 w-4 mr-2"}),"End Call"]})]}),x)):(console.warn("⚠️ call-button-container not found!"),null)};console.log("🎯 VapiAgentCall render - isVapiConfigured:",j),console.log("🎯 VapiAgentCall render - callState:",m),console.log("🎯 VapiAgentCall render - agentId:",s),console.log("🎯 VapiAgentCall render - agentName:",e);const[A,G]=Q.useState(!1);return Q.useEffect(()=>{const x=()=>document.getElementById("call-button-container")?(console.log("✅ Found call-button-container"),G(!0),!0):(console.warn("❌ call-button-container not found"),!1);if(x())return;const R=setInterval(()=>{x()&&clearInterval(R)},100);return()=>{clearInterval(R)}},[]),n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[ae(),n.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[n.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:n.jsxs("h3",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[n.jsx(Xs,{className:"h-4 w-4"}),"Conversation"]})}),n.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-white",children:_.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 py-12",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:n.jsx(Xs,{className:"h-8 w-8 text-gray-400"})}),n.jsx("p",{className:"text-center text-sm",children:m.isConnected?"Conversation will appear here...":"Start a call to begin the conversation"})]}):n.jsx("div",{className:"space-y-6",children:_.map((x,R)=>n.jsxs("div",{className:`flex gap-3 ${x.role==="user"?"justify-end":"justify-start"}`,children:[x.role==="assistant"&&n.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0",children:n.jsx(ut,{className:"h-4 w-4 text-gray-600"})}),n.jsxs("div",{className:`max-w-[75%] ${x.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800 border border-gray-200"} rounded-lg px-4 py-3`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:`text-xs font-medium ${x.role==="user"?"text-blue-100":"text-gray-500"}`,children:x.role==="user"?"You":e}),n.jsx("span",{className:`text-xs ${x.role==="user"?"text-blue-200":"text-gray-400"}`,children:x.timestamp.toLocaleTimeString()})]}),n.jsx("p",{className:"text-sm leading-relaxed",children:x.content})]}),x.role==="user"&&n.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:n.jsx(Mc,{className:"h-4 w-4 text-blue-600"})})]},R))})})]}),n.jsx("div",{className:"bg-gray-50 border-t border-gray-200 px-6 py-4",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-wide mb-1",children:"Assistant"}),n.jsx("p",{className:"font-medium text-gray-900",children:e})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-500 text-xs uppercase tracking-wide mb-1",children:"Connection"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${m.status==="connected"?"bg-green-500":m.status==="connecting"?"bg-amber-500 animate-pulse":m.status==="error"?"bg-red-500":"bg-gray-400"}`}),n.jsx("span",{className:"text-gray-700 capitalize",children:m.status==="idle"?"Ready":m.status==="connecting"?"Connecting":m.status==="connected"?"Active":m.status==="ended"?"Ended":"Error"})]})]})]})})]})},Zh=({open:s,onOpenChange:e,onTemplateSelect:t,onCreateCustom:r})=>{const[a,i]=Q.useState(""),[l,c]=Q.useState("all"),[d,m]=Q.useState("initial"),{data:v,isLoading:_}=er({queryKey:["defaultAssistantTemplates",{category:l!=="all"?l:void 0}],queryFn:()=>{const L={is_active:!0};return l!=="all"&&(L.category=l),ru(L)},enabled:s}),{data:N}=er({queryKey:["templateCategories"],queryFn:nu,enabled:s}),E=(v==null?void 0:v.data)||[],j=(N==null?void 0:N.data)||[],y=E.filter(L=>L.name.toLowerCase().includes(a.toLowerCase())||L.description.toLowerCase().includes(a.toLowerCase())||L.category.toLowerCase().includes(a.toLowerCase())),S=async L=>{try{const I=await au(L.template_id);t(I.data),e(!1)}catch(I){console.error("Error using template:",I)}},C=()=>{m("initial"),i(""),c("all")},T=L=>{L||C(),e(L)},f=L=>({Business:"bg-blue-100 text-blue-800",Sales:"bg-green-100 text-green-800",Support:"bg-purple-100 text-purple-800",Scheduling:"bg-orange-100 text-orange-800",General:"bg-gray-100 text-gray-800"})[L]||"bg-gray-100 text-gray-800";return n.jsx(Zt,{open:s,onOpenChange:T,children:n.jsxs(es,{className:`
    max-w-7xl min-h-[700px] overflow-hidden
    bg-[#020617]
    border border-cyan-400/30
    shadow-[0_0_30px_rgba(34,211,238,0.35)]
    text-slate-200
  `,children:[n.jsx(ts,{children:n.jsxs(ss,{className:"flex items-center gap-2 text-white",children:[n.jsx(ut,{className:"h-5 w-5 text-white"}),d==="initial"?"Choose How to Create Your Assistant":"Select AI Service Provider"]})}),d==="initial"?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs(Ae,{className:`  cursor-pointer
  bg-cyan-500/10
  border border-cyan-400/30
  hover:shadow-[0_0_30px_rgba(34,211,238,0.45)]
  transition`,children:[n.jsx(Pe,{className:"pb-3",children:n.jsxs(Le,{className:"flex items-center gap-2 text-white",children:[n.jsx(bo,{className:"h-5 w-5 text-white"}),"Use Default Template"]})}),n.jsxs(Me,{children:[n.jsx("p",{className:"text-white text-sm mb-4",children:"Start with a pre-configured template designed for specific use cases. Perfect for quick setup with proven configurations."}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-white",children:[n.jsx(Ic,{className:"h-3 w-3 text-white"}),"Recommended for beginners"]})]})]}),n.jsxs(Ae,{className:`cursor-pointer bg-cyan-500/10
  border border-cyan-400/30
  hover:shadow-[0_0_30px_rgba(34,211,238,0.45)] transition`,onClick:()=>m("service_selection"),children:[n.jsx(Pe,{className:"pb-3",children:n.jsxs(Le,{className:"flex items-center gap-2 text-white",children:[n.jsx(_o,{className:"h-5 w-5 text-white"}),"Create Custom Assistant"]})}),n.jsxs(Me,{children:[n.jsx("p",{className:"text-white text-sm mb-4",children:"Build your assistant from scratch with full control over all settings. Ideal for specific requirements and advanced users."}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-white",children:[n.jsx(ut,{className:"h-3 w-3 text-white"}),"Full customization available"]})]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-medium",children:"Available Templates"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative",children:[n.jsx(xo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-white h-4 w-4  z-10"}),n.jsx(ye,{placeholder:"Search templates...",value:a,onChange:L=>i(L.target.value),className:` pl-10 w-64
    bg-black/40
    border border-cyan-400/30
    text-slate-200
    placeholder:text-slate-500
    focus:ring-cyan-400/50`})]}),n.jsxs(_e,{value:l,onValueChange:c,children:[n.jsxs(xe,{className:`
    w-48
    bg-black/40
    border border-cyan-400/30
    text-slate-200
  `,children:[n.jsx(Oc,{className:"h-4 w-4 mr-2"}),n.jsx(we,{placeholder:"Category"})]}),n.jsxs(Se,{className:"bg-[#020617] text-white border border-cyan-400/30",children:[n.jsx(ue,{value:"all",children:"All Categories"}),j.map(L=>n.jsxs(ue,{value:L.category,children:[L.category," (",L.count,")"]},L.category))]})]})]})]}),n.jsx("div",{className:"max-h-96 overflow-y-auto",children:_?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((L,I)=>n.jsxs(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,children:[n.jsxs(Pe,{children:[n.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),n.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),n.jsx(Me,{children:n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"h-3 bg-gray-200 rounded"}),n.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})})]},I))}):y.length===0?n.jsx(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,children:n.jsxs(Me,{className:"p-8 text-center",children:[n.jsx(ut,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No templates found"}),n.jsx("p",{className:"text-gray-600 mb-4",children:a||l!=="all"?"Try adjusting your search or filter criteria.":"No templates are currently available."}),n.jsx(je,{onClick:()=>m("service_selection"),children:"Create Custom Assistant Instead"})]})}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(L=>n.jsxs(Ae,{className:`
    cursor-pointer
    bg-white/5
    border border-cyan-400/20
    hover:shadow-[0_0_25px_rgba(34,211,238,0.4)]
    transition
  `,onClick:()=>S(L),children:[n.jsx(Pe,{className:"pb-3",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx(Le,{className:"text-white flex items-center gap-2",children:L.name}),n.jsx("div",{className:"flex items-center gap-2 mt-2",children:n.jsx(Nt,{className:f(L.category),children:L.category})})]}),n.jsx(Pc,{className:"h-4 w-4 text-gray-400"})]})}),n.jsxs(Me,{className:"pt-0",children:[n.jsx("p",{className:"text-white/60 text-sm mb-3 line-clamp-2",children:L.description}),n.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500",children:n.jsx(je,{size:"sm",variant:"ghost",className:"h-6 px-2 text-xs bg-primary text-white w-full ",children:"Use Template"})})]})]},L.template_id))})})]})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(je,{variant:"ghost",onClick:()=>m("initial"),className:"text-white/60 hover:text-white",children:[n.jsx(Lc,{className:"h-4 w-4 mr-2"}),"Back"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4",children:[n.jsxs(Ae,{className:"cursor-pointer bg-blue-500/10 border border-blue-400/30 hover:shadow-[0_0_30px_rgba(59,130,246,0.45)] transition group",onClick:()=>{r("vapi"),e(!1)},children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"flex items-center gap-3 text-white text-2xl",children:[n.jsx("div",{className:"p-3 rounded-lg bg-blue-500/20 group-hover:bg-blue-500/30 transition-colors",children:n.jsx(is,{className:"h-8 w-8 text-blue-400"})}),"Vapi Service"]})}),n.jsxs(Me,{className:"space-y-4",children:[n.jsx("p",{className:"text-white/80",children:"Advanced voice AI platform with ultra-low latency. Best for complex conversational flows and extensive customization."}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx(Nt,{variant:"outline",className:"border-blue-400/30 text-blue-300",children:"Customizable"}),n.jsx(Nt,{variant:"outline",className:"border-blue-400/30 text-blue-300",children:"Real-time"})]})]})]}),n.jsxs(Ae,{className:"cursor-pointer bg-purple-500/10 border border-purple-400/30 hover:shadow-[0_0_30px_rgba(168,85,247,0.45)] transition group",onClick:()=>{r("retell"),e(!1)},children:[n.jsx(Pe,{children:n.jsxs(Le,{className:"flex items-center gap-3 text-white text-2xl",children:[n.jsx("div",{className:"p-3 rounded-lg bg-purple-500/20 group-hover:bg-purple-500/30 transition-colors",children:n.jsx(Zs,{className:"h-8 w-8 text-purple-400"})}),"Retell AI"]})}),n.jsxs(Me,{className:"space-y-4",children:[n.jsx("p",{className:"text-white/80",children:"Powerful telephony and voice agent integration. Ideal for phone-based assistants and seamless call handling."}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx(Nt,{variant:"outline",className:"border-purple-400/30 text-purple-300",children:"Telephony"}),n.jsx(Nt,{variant:"outline",className:"border-purple-400/30 text-purple-300",children:"Resilient"})]})]})]})]}),n.jsx("div",{className:"text-center text-sm text-white/50 pt-4",children:"Select the service provider that best fits your use case"})]})]})})},em=[{value:"default",label:"Default"},{value:"eleven_turbo_v2",label:"Eleven Turbo v2"},{value:"eleven_flash_v2",label:"Eleven Flash v2"},{value:"eleven_turbo_v2_5",label:"Eleven Turbo v2.5"},{value:"eleven_flash_v2_5",label:"Eleven Flash v2.5"},{value:"eleven_multilingual_v2",label:"Eleven Multilingual v2"},{value:"sonic-2",label:"Sonic 2"},{value:"sonic-3",label:"Sonic 3"},{value:"sonic-3-latest",label:"Sonic 3 Latest"},{value:"sonic-turbo",label:"Sonic Turbo"},{value:"tts-1",label:"TTS-1"},{value:"gpt-4o-mini-tts",label:"GPT-4o Mini TTS"},{value:"speech-02-turbo",label:"Speech 02 Turbo"}],tm=[{value:"none",label:"None (Default)"},{value:"calm",label:"Calm"},{value:"sympathetic",label:"Sympathetic"},{value:"happy",label:"Happy"},{value:"sad",label:"Sad"},{value:"angry",label:"Angry"},{value:"fearful",label:"Fearful"},{value:"surprised",label:"Surprised"}],sm=[{value:"none",label:"None"},{value:"coffee-shop",label:"Coffee Shop"},{value:"convention-hall",label:"Convention Hall"},{value:"summer-outdoor",label:"Summer Outdoor"},{value:"mountain-outdoor",label:"Mountain Outdoor"},{value:"static-noise",label:"Static Noise"},{value:"call-center",label:"Call Center"}],rm=[{value:"en-US",label:"English (US)"},{value:"en-GB",label:"English (UK)"},{value:"en-AU",label:"English (Australia)"},{value:"en-IN",label:"English (India)"},{value:"es-ES",label:"Spanish (Spain)"},{value:"es-419",label:"Spanish (Latin America)"},{value:"fr-FR",label:"French (France)"},{value:"fr-CA",label:"French (Canada)"},{value:"de-DE",label:"German"},{value:"it-IT",label:"Italian"},{value:"pt-BR",label:"Portuguese (Brazil)"},{value:"pt-PT",label:"Portuguese (Portugal)"},{value:"zh-CN",label:"Chinese (Simplified)"},{value:"ja-JP",label:"Japanese"},{value:"ko-KR",label:"Korean"},{value:"hi-IN",label:"Hindi"},{value:"ar-SA",label:"Arabic"},{value:"nl-NL",label:"Dutch"},{value:"pl-PL",label:"Polish"},{value:"ru-RU",label:"Russian"},{value:"tr-TR",label:"Turkish"},{value:"multi",label:"Multilingual"}],nm=[{value:"fast",label:"Fast"},{value:"accurate",label:"Accurate"},{value:"custom",label:"Custom"}],am=[{value:"general",label:"General"},{value:"medical",label:"Medical"}],im=[{value:"none",label:"None"},{value:"noise-cancellation",label:"Noise Cancellation"},{value:"noise-and-background-speech-cancellation",label:"Noise + Background Speech Cancellation"}],om=[{value:"everything",label:"Everything"},{value:"everything_except_pii",label:"Everything except PII"},{value:"basic_attributes_only",label:"Basic Attributes Only"}],lm=[{value:"gpt-4.1-mini",label:"GPT-4.1 Mini (Default)"},{value:"gpt-4.1",label:"GPT-4.1"},{value:"gpt-4.1-nano",label:"GPT-4.1 Nano"},{value:"claude-4.5-sonnet",label:"Claude 4.5 Sonnet"},{value:"claude-4.5-haiku",label:"Claude 4.5 Haiku"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"}],cm=[{value:"gpt-4.1",label:"GPT-4.1"},{value:"gpt-4.1-mini",label:"GPT-4.1 Mini"},{value:"gpt-4.1-nano",label:"GPT-4.1 Nano"},{value:"gpt-5",label:"GPT-5"},{value:"gpt-5-mini",label:"GPT-5 Mini"},{value:"claude-4.5-sonnet",label:"Claude 4.5 Sonnet"},{value:"claude-4.5-haiku",label:"Claude 4.5 Haiku"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash"},{value:"gemini-3.0-flash",label:"Gemini 3.0 Flash"}],um=[{value:"single_prompt",label:"Single Prompt Agent",description:"Simple AI agent using one LLM for all conversations"},{value:"conversation_flow",label:"Conversation Flow Agent",description:"Advanced agent with workflow logic (requires workflow configuration in Retell dashboard)"},{value:"custom_llm",label:"Custom LLM",description:"Use your own LLM via webhook (requires webhook URL configuration)"},{value:"multi_prompt_legacy",label:"Multi-Prompt Agent (Legacy)",description:"Deprecated - Use Single Prompt instead"}];function dm({isOpen:s,onClose:e,onSuccess:t}){var Ee,$e,z,Pt;const[r,a]=Q.useState([]),[i,l]=Q.useState([]),[c,d]=Q.useState([]),[m,v]=Q.useState(!1),[_,N]=Q.useState(!1),[E,j]=Q.useState("voice"),[y,S]=Q.useState(!1),[C,T]=Q.useState(!1),[f,L]=Q.useState({agent_type:"single_prompt",agent_name:"",version_description:"",voice_id:"",voice_model:"default",fallback_voice_ids:"",voice_temperature:1,voice_speed:1,volume:1,voice_emotion:"none",llm_id:"",new_llm_model:"gpt-4.1",new_llm_begin_message:"",new_llm_general_prompt:"",new_llm_start_speaker:"agent",new_llm_temperature:0,workflow_id:"",create_new_workflow:!1,new_workflow_name:"",new_workflow_steps:"",custom_llm_websocket_url:"",custom_llm_api_key:"",responsiveness:1,interruption_sensitivity:1,enable_backchannel:!1,backchannel_frequency:.8,backchannel_words:"",reminder_trigger_ms:1e4,reminder_max_count:1,ambient_sound:"none",ambient_sound_volume:1,begin_message_delay_ms:0,end_call_after_silence_ms:6e5,max_call_duration_ms:36e5,ring_duration_ms:3e4,language:"en-US",boosted_keywords:"",stt_mode:"fast",vocab_specialization:"general",denoising_mode:"noise-cancellation",normalize_for_speech:!0,enable_voicemail_detection:!1,voicemail_message:"",voicemail_detection_timeout_ms:3e4,webhook_url:"",webhook_timeout_ms:1e4,post_call_analysis_model:"gpt-4.1-mini",analysis_successful_prompt:"",analysis_summary_prompt:"",data_storage_setting:"everything",opt_in_signed_url:!1,allow_user_dtmf:!0,is_public:!1});Q.useEffect(()=>{s&&I()},[s]);const I=async()=>{v(!0);try{const[b,Te]=await Promise.all([ps.get("/api/retell/voices"),ps.get("/api/retell/llms")]);a(b.data.data||[]),l(Te.data.data||[])}catch(b){console.error("Error fetching Retell data:",b),H.error("Failed to load Retell options")}finally{v(!1)}},O=(b,Te)=>{L(be=>({...be,[b]:Te}))},Z=async b=>{var Te,be,Fe,o,h;b.preventDefault(),N(!0);try{let u=f.llm_id;if(y){if(!f.new_llm_general_prompt.trim()){H.error("General Prompt is required when creating a new LLM"),N(!1);return}T(!0);const g={model:f.new_llm_model,start_speaker:f.new_llm_start_speaker,model_temperature:f.new_llm_temperature,general_prompt:f.new_llm_general_prompt};f.new_llm_begin_message.trim()&&(g.begin_message=f.new_llm_begin_message),console.log("Creating new LLM:",g),u=(await ps.post("/api/retell/create-llm",g)).data.data.llm_id,console.log("New LLM created with ID:",u),H.success("LLM created successfully"),T(!1)}if(!u){if(f.agent_type==="custom_llm"&&!f.custom_llm_websocket_url){H.error("Custom LLM requires selecting an existing LLM or creating a new one (or provide webhook URL)"),N(!1);return}if(f.agent_type==="single_prompt"){H.error("Single Prompt Agent requires selecting an LLM or creating a new one"),N(!1);return}if(f.agent_type==="conversation_flow"){H.error("Conversation Flow requires selecting an LLM or creating a new one"),N(!1);return}H.error("Please select an LLM or create a new one"),N(!1);return}const p={agent_name:f.agent_name,voice_id:f.voice_id};switch(f.agent_type){case"single_prompt":case"multi_prompt_legacy":p.response_engine={type:"retell-llm",llm_id:u},f.agent_type==="multi_prompt_legacy"&&console.log("Note: Multi-Prompt Legacy is deprecated. It will appear as Single Prompt in Retell dashboard.");break;case"conversation_flow":try{console.log("Creating conversation flow for agent..."),H.info("Creating conversation flow...",{duration:3e3});const g={name:`${f.agent_name} Flow`,model_choice:{model:f.new_llm_model||"gpt-4o",type:"cascading"},start_speaker:"agent",start_node_id:"start",nodes:[{id:"start",type:"conversation",instruction:{type:"prompt",text:f.new_llm_general_prompt||"You are a helpful assistant."},edges:[{id:"edge_start_to_end",destination_node_id:"end",transition_condition:{type:"prompt",prompt:"User says goodbye or wants to end the call"}}]},{id:"end",type:"end"}]};console.log("Creating conversation flow with payload:",g);const k=await ps.post("/api/retell/create-conversation-flow",g),P=k.data.conversation_flow_id||((Te=k.data.data)==null?void 0:Te.conversation_flow_id)||k.data.id;if(!P)throw new Error("Conversation flow created but no ID returned");console.log("Conversation flow created successfully with ID:",P),H.success("Conversation flow created!"),p.response_engine={type:"conversation-flow",conversation_flow_id:P},console.log("Creating Conversation Flow agent with flow:",P)}catch(g){console.error("Error creating conversation flow:",g);const k=((Fe=(be=g.response)==null?void 0:be.data)==null?void 0:Fe.message)||g.message;H.error("Failed to create conversation flow: "+k,{duration:6e3}),N(!1);return}break;case"custom_llm":f.custom_llm_websocket_url?p.response_engine={type:"custom-llm",websocket_url:f.custom_llm_websocket_url,api_key:f.custom_llm_api_key}:(p.response_engine={type:"retell-llm",llm_id:u},console.log("Note: Custom LLM requires webhook URL. Using retell-llm as fallback."),H.info("Custom LLM created with standard engine. Add webhook URL for custom behavior.",{duration:5e3}));break;default:p.response_engine={type:"retell-llm",llm_id:u}}f.version_description&&(p.version_description=f.version_description),f.voice_model!=="default"&&(p.voice_model=f.voice_model),f.fallback_voice_ids.trim()&&(p.fallback_voice_ids=f.fallback_voice_ids.split(",").map(g=>g.trim()).filter(Boolean)),f.voice_temperature!==1&&(p.voice_temperature=f.voice_temperature),f.voice_speed!==1&&(p.voice_speed=f.voice_speed),f.volume!==1&&(p.volume=f.volume),f.voice_emotion!=="none"&&(p.voice_emotion=f.voice_emotion),f.responsiveness!==1&&(p.responsiveness=f.responsiveness),f.interruption_sensitivity!==1&&(p.interruption_sensitivity=f.interruption_sensitivity),f.enable_backchannel&&(p.enable_backchannel=!0,f.backchannel_frequency!==.8&&(p.backchannel_frequency=f.backchannel_frequency),f.backchannel_words.trim()&&(p.backchannel_words=f.backchannel_words.split(",").map(g=>g.trim()).filter(Boolean))),f.reminder_trigger_ms!==1e4&&(p.reminder_trigger_ms=f.reminder_trigger_ms),f.reminder_max_count!==1&&(p.reminder_max_count=f.reminder_max_count),f.ambient_sound!=="none"&&(p.ambient_sound=f.ambient_sound,f.ambient_sound_volume!==1&&(p.ambient_sound_volume=f.ambient_sound_volume)),f.begin_message_delay_ms>0&&(p.begin_message_delay_ms=f.begin_message_delay_ms),f.end_call_after_silence_ms!==6e5&&(p.end_call_after_silence_ms=f.end_call_after_silence_ms),f.max_call_duration_ms!==36e5&&(p.max_call_duration_ms=f.max_call_duration_ms),f.ring_duration_ms!==3e4&&(p.ring_duration_ms=f.ring_duration_ms),f.language!=="en-US"&&(p.language=f.language),f.boosted_keywords.trim()&&(p.boosted_keywords=f.boosted_keywords.split(",").map(g=>g.trim()).filter(Boolean)),f.stt_mode!=="fast"&&(p.stt_mode=f.stt_mode),f.vocab_specialization!=="general"&&(p.vocab_specialization=f.vocab_specialization),f.denoising_mode!=="noise-cancellation"&&(p.denoising_mode=f.denoising_mode),f.normalize_for_speech||(p.normalize_for_speech=!1),f.enable_voicemail_detection&&(p.enable_voicemail_detection=!0,f.voicemail_message&&(p.voicemail_message=f.voicemail_message),f.voicemail_detection_timeout_ms!==3e4&&(p.voicemail_detection_timeout_ms=f.voicemail_detection_timeout_ms)),f.webhook_url&&(p.webhook_url=f.webhook_url,f.webhook_timeout_ms!==1e4&&(p.webhook_timeout_ms=f.webhook_timeout_ms)),f.post_call_analysis_model!=="gpt-4.1-mini"&&(p.post_call_analysis_model=f.post_call_analysis_model),f.analysis_successful_prompt&&(p.analysis_successful_prompt=f.analysis_successful_prompt),f.analysis_summary_prompt&&(p.analysis_summary_prompt=f.analysis_summary_prompt),f.data_storage_setting!=="everything"&&(p.data_storage_setting=f.data_storage_setting),f.opt_in_signed_url&&(p.opt_in_signed_url=!0),f.allow_user_dtmf||(p.allow_user_dtmf=!1),f.is_public&&(p.is_public=!0),console.log("Creating Retell agent:",p),await ps.post("/api/retell/create-agent",p),H.success("Retell Agent Created Successfully"),t(),e()}catch(u){console.error("Error creating agent:",u),H.error("Failed to create agent: "+(((h=(o=u.response)==null?void 0:o.data)==null?void 0:h.message)||u.message))}finally{N(!1)}},K="bg-white/5 border-white/10 text-white focus:border-orange-500/50 placeholder:text-white/30",ae="bg-white/5 border-white/10 text-white focus:border-orange-500/50",A="bg-[#0b0f2e] border-white/10 text-white",G="focus:bg-white/10 focus:text-white",x="text-white/70 text-sm",R="space-y-4 p-4 rounded-xl bg-white/5",q=({label:b,value:Te,onChange:be,min:Fe,max:o,step:h,description:u})=>n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(Y,{className:x,children:b}),n.jsx("span",{className:"text-sm text-orange-400 font-mono",children:Te})]}),n.jsx(iu,{value:[Te],onValueChange:([p])=>be(p),min:Fe,max:o,step:h,className:"[&_[role=slider]]:bg-orange-500"}),u&&n.jsx("p",{className:"text-xs text-white/40",children:u})]});return n.jsx(Zt,{open:s,onOpenChange:e,children:n.jsxs(es,{className:"sm:max-w-[1300px] max-h-[90vh] overflow-y-auto bg-[#0b0f2e] border-white/10 text-white neon-fire-scroll p-0",children:[n.jsx(ts,{className:"p-6 pb-0",children:n.jsxs(ss,{className:"flex items-center gap-2 text-2xl font-bold text-orange-500",children:[n.jsx(ut,{className:"h-6 w-6"}),"Create Retell AI Agent"]})}),n.jsxs("form",{onSubmit:Z,className:"flex flex-col h-full",children:[n.jsx("div",{className:"px-6 py-3",children:n.jsxs("div",{className:"p-3 rounded-lg bg-orange-500/10 border border-orange-500/20 flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-orange-500/20 rounded-full",children:n.jsx(bo,{className:"h-4 w-4 text-orange-500"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-orange-400",children:"Retell AI Service"}),n.jsx("p",{className:"text-xs text-white/60",children:"Configure your AI voice agent with advanced settings"})]}),n.jsx("div",{className:"flex-1 max-w-xs",children:n.jsx(ye,{placeholder:"Agent Name *",value:f.agent_name,onChange:b=>O("agent_name",b.target.value),className:K,required:!0})})]})}),n.jsxs(wn,{value:E,onValueChange:j,className:"flex-1 flex flex-col",children:[n.jsx("div",{className:"px-6",children:n.jsxs(Sn,{className:"w-full bg-white/5 p-1 rounded-lg grid grid-cols-6 gap-1",children:[n.jsxs(ze,{value:"voice",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(js,{className:"h-3 w-3 mr-1"})," Voice"]}),n.jsxs(ze,{value:"llm",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(ut,{className:"h-3 w-3 mr-1"})," LLM"]}),n.jsxs(ze,{value:"call",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(Zs,{className:"h-3 w-3 mr-1"})," Call"]}),n.jsxs(ze,{value:"transcriber",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(is,{className:"h-3 w-3 mr-1"})," STT"]}),n.jsxs(ze,{value:"voicemail",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(pa,{className:"h-3 w-3 mr-1"})," Voicemail"]}),n.jsxs(ze,{value:"advanced",className:"data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 text-white/60 text-xs",children:[n.jsx(ks,{className:"h-3 w-3 mr-1"})," Advanced"]})]})}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6 pt-4",children:[n.jsxs(Ye,{value:"voice",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:R,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(js,{className:"h-4 w-4 text-orange-500"})," Voice Selection"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Voice *"}),n.jsxs(_e,{value:f.voice_id,onValueChange:b=>O("voice_id",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{placeholder:m?"Loading...":"Select voice"})}),n.jsx(Se,{className:A,children:r.map(b=>n.jsxs(ue,{value:b.voice_id,className:G,children:[b.voice_name||b.voice_id," (",b.provider||"Retell",")"]},b.voice_id))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Voice Model"}),n.jsxs(_e,{value:f.voice_model,onValueChange:b=>O("voice_model",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:em.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]})]})]}),n.jsxs("div",{className:R,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Voice Parameters"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsx(q,{label:"Speed",value:f.voice_speed,onChange:b=>O("voice_speed",b),min:.5,max:2,step:.1}),n.jsx(q,{label:"Temperature",value:f.voice_temperature,onChange:b=>O("voice_temperature",b),min:0,max:2,step:.1}),n.jsx(q,{label:"Volume",value:f.volume,onChange:b=>O("volume",b),min:0,max:2,step:.1})]})]}),n.jsxs("div",{className:R,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Voice Emotion & Fallback"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Voice Emotion"}),n.jsxs(_e,{value:f.voice_emotion,onValueChange:b=>O("voice_emotion",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:tm.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Fallback Voice IDs"}),n.jsx(ye,{placeholder:"openai-Alloy, deepgram-Angus",value:f.fallback_voice_ids,onChange:b=>O("fallback_voice_ids",b.target.value),className:K}),n.jsx("p",{className:"text-xs text-white/40",children:"Comma-separated, from different providers"})]})]})]})]}),n.jsxs(Ye,{value:"llm",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:R,children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(ut,{className:"h-4 w-4 text-orange-500"})," Response Engine (LLM)"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Y,{className:x,children:"Create New LLM"}),n.jsx(jt,{checked:y,onCheckedChange:S})]})]}),n.jsx("div",{className:"space-y-4",children:n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Agent Type"}),n.jsxs(_e,{value:f.agent_type,onValueChange:b=>O("agent_type",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:um.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]})}),y?n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20",children:n.jsx("p",{className:"text-xs text-green-400",children:"A new LLM will be created when you submit this form"})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Model *"}),n.jsxs(_e,{value:f.new_llm_model,onValueChange:b=>O("new_llm_model",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:cm.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Start Speaker"}),n.jsxs(_e,{value:f.new_llm_start_speaker,onValueChange:b=>O("new_llm_start_speaker",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsxs(Se,{className:A,children:[n.jsx(ue,{value:"agent",className:G,children:"Agent (speaks first)"}),n.jsx(ue,{value:"user",className:G,children:"User (waits for user)"})]})]})]})]}),n.jsx(q,{label:"Model Temperature",value:f.new_llm_temperature,onChange:b=>O("new_llm_temperature",b),min:0,max:1,step:.1,description:"Lower = more deterministic, Higher = more random"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Begin Message (First Utterance)"}),n.jsx(ht,{placeholder:"Hey, I am a virtual assistant calling from [Company Name]. How can I help you today?",value:f.new_llm_begin_message,onChange:b=>O("new_llm_begin_message",b.target.value),className:K+" min-h-[80px]"}),n.jsx("p",{className:"text-xs text-white/40",children:'Leave empty for dynamic generation, or set to "" for user to speak first'})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"General Prompt (System Prompt) *"}),n.jsx(ht,{placeholder:"You are a friendly and professional AI assistant for [Company Name]. Your role is to help customers with their inquiries...",value:f.new_llm_general_prompt,onChange:b=>O("new_llm_general_prompt",b.target.value),className:K+" min-h-[200px]"}),n.jsx("p",{className:"text-xs text-white/40",children:"This prompt guides the agent's behavior and personality throughout the conversation"})]})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Select LLM *"}),n.jsxs(_e,{value:f.llm_id,onValueChange:b=>O("llm_id",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{placeholder:m?"Loading...":"Select existing LLM"})}),n.jsx(Se,{className:A,children:i.map(b=>n.jsx(ue,{value:b.llm_id,className:G,children:n.jsxs("div",{className:"flex flex-col",children:[n.jsxs("span",{children:[b.llm_id.substring(0,20),"..."]}),n.jsxs("span",{className:"text-xs text-white/50",children:["Model: ",b.model||"Default"]})]})},b.llm_id))})]}),n.jsx("p",{className:"text-xs text-white/40",children:'Select from existing LLMs in your Retell dashboard, or toggle "Create New" to configure a new one'})]}),f.agent_type==="conversation_flow"&&n.jsxs("div",{className:"p-4 rounded-lg bg-blue-500/10 border border-blue-500/20 space-y-3",children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("div",{className:"p-1.5 bg-blue-500/20 rounded-full mt-0.5",children:n.jsx(ut,{className:"h-3 w-3 text-blue-400"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-blue-400",children:"Conversation Flow Workflow"}),n.jsx("p",{className:"text-xs text-white/60 mt-1",children:"To create a true Conversation Flow agent, you need a workflow ID from your Retell dashboard."})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Workflow ID (Optional)"}),n.jsx(ye,{placeholder:"workflow_xxxxxxxxxxxxxxxx",value:f.workflow_id,onChange:b=>O("workflow_id",b.target.value),className:K}),n.jsx("p",{className:"text-xs text-white/40",children:"Leave empty to use LLM-based conversation (will show as Single Prompt), or paste a workflow ID from your Retell dashboard"})]}),n.jsxs("div",{className:"p-2 bg-white/5 rounded text-xs text-white/60",children:[n.jsx("span",{className:"font-semibold text-white",children:"How to get a Workflow ID:"}),n.jsxs("ol",{className:"list-decimal list-inside mt-1 space-y-0.5 ml-2",children:[n.jsxs("li",{children:["Go to ",n.jsx("a",{href:"https://dashboard.retellai.com/workflows",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline",children:"Retell Dashboard → Workflows"})]}),n.jsx("li",{children:"Create or select a workflow"}),n.jsx("li",{children:'Copy the workflow ID (starts with "workflow_")'}),n.jsx("li",{children:"Paste it above"})]})]})]}),f.llm_id&&i.find(b=>b.llm_id===f.llm_id)&&n.jsxs("div",{className:"p-3 rounded-lg bg-orange-500/10 border border-orange-500/20",children:[n.jsx("p",{className:"text-xs text-orange-400 mb-2",children:"Selected LLM Details"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-white/50",children:"Model:"})," ",n.jsx("span",{className:"text-white",children:((Ee=i.find(b=>b.llm_id===f.llm_id))==null?void 0:Ee.model)||"Default"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-white/50",children:"Start Speaker:"})," ",n.jsx("span",{className:"text-white",children:(($e=i.find(b=>b.llm_id===f.llm_id))==null?void 0:$e.start_speaker)||"agent"})]})]}),((z=i.find(b=>b.llm_id===f.llm_id))==null?void 0:z.begin_message)&&n.jsxs("div",{className:"mt-2",children:[n.jsx("span",{className:"text-white/50 text-xs",children:"Begin Message:"}),n.jsx("p",{className:"text-white text-xs mt-1 p-2 bg-white/5 rounded",children:(Pt=i.find(b=>b.llm_id===f.llm_id))==null?void 0:Pt.begin_message})]})]})]})]}),n.jsxs("div",{className:R,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Agent Version Description"}),n.jsx(ht,{className:K+" min-h-[100px]",placeholder:"Describe this agent version...",value:f.version_description,onChange:b=>O("version_description",b.target.value)})]})]}),n.jsxs(Ye,{value:"call",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:R,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(Zs,{className:"h-4 w-4 text-orange-500"})," Call Behavior"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(q,{label:"Responsiveness",value:f.responsiveness,onChange:b=>O("responsiveness",b),min:0,max:1,step:.1,description:"How fast the agent responds"}),n.jsx(q,{label:"Interruption Sensitivity",value:f.interruption_sensitivity,onChange:b=>O("interruption_sensitivity",b),min:0,max:1,step:.1,description:"How easily user can interrupt"})]})]}),n.jsxs("div",{className:R,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Backchannel"}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx(Y,{className:x,children:"Enable Backchannel"}),n.jsx("p",{className:"text-xs text-white/40",children:'Agent says "yeah", "uh-huh" during conversation'})]}),n.jsx(jt,{checked:f.enable_backchannel,onCheckedChange:b=>O("enable_backchannel",b)})]}),f.enable_backchannel&&n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsx(q,{label:"Frequency",value:f.backchannel_frequency,onChange:b=>O("backchannel_frequency",b),min:0,max:1,step:.1}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Custom Words"}),n.jsx(ye,{placeholder:"yeah, uh-huh, right",value:f.backchannel_words,onChange:b=>O("backchannel_words",b.target.value),className:K})]})]})]}),n.jsxs("div",{className:R,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Reminders & Ambient"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Reminder Trigger (ms)"}),n.jsx(ye,{type:"number",value:f.reminder_trigger_ms,onChange:b=>O("reminder_trigger_ms",parseInt(b.target.value)||1e4),className:K})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Reminder Max Count"}),n.jsx(ye,{type:"number",min:0,value:f.reminder_max_count,onChange:b=>O("reminder_max_count",parseInt(b.target.value)||1),className:K})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Ambient Sound"}),n.jsxs(_e,{value:f.ambient_sound,onValueChange:b=>O("ambient_sound",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:sm.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]}),f.ambient_sound!=="none"&&n.jsx(q,{label:"Ambient Volume",value:f.ambient_sound_volume,onChange:b=>O("ambient_sound_volume",b),min:0,max:2,step:.1})]})]}),n.jsxs("div",{className:R,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Call Limits"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"End After Silence (ms)"}),n.jsx(ye,{type:"number",value:f.end_call_after_silence_ms,onChange:b=>O("end_call_after_silence_ms",parseInt(b.target.value)||6e5),className:K})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Max Duration (ms)"}),n.jsx(ye,{type:"number",value:f.max_call_duration_ms,onChange:b=>O("max_call_duration_ms",parseInt(b.target.value)||36e5),className:K})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Ring Duration (ms)"}),n.jsx(ye,{type:"number",value:f.ring_duration_ms,onChange:b=>O("ring_duration_ms",parseInt(b.target.value)||3e4),className:K})]})]})]})]}),n.jsxs(Ye,{value:"transcriber",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:R,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(vo,{className:"h-4 w-4 text-orange-500"})," Language & Recognition"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Language"}),n.jsxs(_e,{value:f.language,onValueChange:b=>O("language",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:rm.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"STT Mode"}),n.jsxs(_e,{value:f.stt_mode,onValueChange:b=>O("stt_mode",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:nm.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]})]})]}),n.jsxs("div",{className:R,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Audio Processing"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Vocab Specialization"}),n.jsxs(_e,{value:f.vocab_specialization,onValueChange:b=>O("vocab_specialization",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:am.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Denoising Mode"}),n.jsxs(_e,{value:f.denoising_mode,onValueChange:b=>O("denoising_mode",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:im.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between mt-4",children:[n.jsxs("div",{children:[n.jsx(Y,{className:x,children:"Normalize for Speech"}),n.jsx("p",{className:"text-xs text-white/40",children:"Convert numbers, dates to spoken form"})]}),n.jsx(jt,{checked:f.normalize_for_speech,onCheckedChange:b=>O("normalize_for_speech",b)})]})]}),n.jsxs("div",{className:R,children:[n.jsx("h4",{className:"text-sm font-semibold text-white",children:"Boosted Keywords"}),n.jsx(ht,{placeholder:"retell, company name, product names...",value:f.boosted_keywords,onChange:b=>O("boosted_keywords",b.target.value),className:K+" min-h-[80px]"}),n.jsx("p",{className:"text-xs text-white/40 mt-1",children:"Comma-separated words to prioritize in transcription"})]})]}),n.jsx(Ye,{value:"voicemail",className:"mt-0 space-y-4",children:n.jsxs("div",{className:R,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(pa,{className:"h-4 w-4 text-orange-500"})," Voicemail Detection"]}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx(Y,{className:x,children:"Enable Voicemail Detection"}),n.jsx("p",{className:"text-xs text-white/40",children:"Detect when call goes to voicemail"})]}),n.jsx(jt,{checked:f.enable_voicemail_detection,onCheckedChange:b=>O("enable_voicemail_detection",b)})]}),f.enable_voicemail_detection&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Voicemail Message"}),n.jsx(ht,{placeholder:"Hi, please give us a callback...",value:f.voicemail_message,onChange:b=>O("voicemail_message",b.target.value),className:K})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Detection Timeout (ms)"}),n.jsx(ye,{type:"number",value:f.voicemail_detection_timeout_ms,onChange:b=>O("voicemail_detection_timeout_ms",parseInt(b.target.value)||3e4),className:K})]})]})]})}),n.jsxs(Ye,{value:"advanced",className:"mt-0 space-y-4",children:[n.jsxs("div",{className:R,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(Dc,{className:"h-4 w-4 text-orange-500"})," Webhooks"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Webhook URL"}),n.jsx(ye,{placeholder:"https://your-webhook.com/events",value:f.webhook_url,onChange:b=>O("webhook_url",b.target.value),className:K})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Webhook Timeout (ms)"}),n.jsx(ye,{type:"number",value:f.webhook_timeout_ms,onChange:b=>O("webhook_timeout_ms",parseInt(b.target.value)||1e4),className:K})]})]})]}),n.jsxs("div",{className:R,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(ut,{className:"h-4 w-4 text-orange-500"})," Post-Call Analysis"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Analysis Model"}),n.jsxs(_e,{value:f.post_call_analysis_model,onValueChange:b=>O("post_call_analysis_model",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:lm.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Success Criteria Prompt"}),n.jsx(ht,{placeholder:"The agent finished the task and the call was complete...",value:f.analysis_successful_prompt,onChange:b=>O("analysis_successful_prompt",b.target.value),className:K})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Summary Prompt"}),n.jsx(ht,{placeholder:"Summarize the outcome of the conversation...",value:f.analysis_summary_prompt,onChange:b=>O("analysis_summary_prompt",b.target.value),className:K})]})]})]}),n.jsxs("div",{className:R,children:[n.jsxs("h4",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[n.jsx(yo,{className:"h-4 w-4 text-orange-500"})," Data & Privacy"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Y,{className:x,children:"Data Storage Setting"}),n.jsxs(_e,{value:f.data_storage_setting,onValueChange:b=>O("data_storage_setting",b),children:[n.jsx(xe,{className:ae,children:n.jsx(we,{})}),n.jsx(Se,{className:A,children:om.map(b=>n.jsx(ue,{value:b.value,className:G,children:b.label},b.value))})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Y,{className:x,children:"Signed URLs"}),n.jsx("p",{className:"text-xs text-white/40",children:"Enable signed URLs for recordings/logs"})]}),n.jsx(jt,{checked:f.opt_in_signed_url,onCheckedChange:b=>O("opt_in_signed_url",b)})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Y,{className:x,children:"Allow DTMF Input"}),n.jsx("p",{className:"text-xs text-white/40",children:"Accept keypad input during calls"})]}),n.jsx(jt,{checked:f.allow_user_dtmf,onCheckedChange:b=>O("allow_user_dtmf",b)})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Y,{className:x,children:"Public Agent"}),n.jsx("p",{className:"text-xs text-white/40",children:"Make available for public preview"})]}),n.jsx(jt,{checked:f.is_public,onCheckedChange:b=>O("is_public",b)})]})]})]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 p-6 pt-4 border-t border-white/10",children:[n.jsx(je,{type:"button",variant:"outline",onClick:e,disabled:_,className:"border-white/10 bg-transparent text-white hover:bg-white/10",children:"Cancel"}),n.jsx(je,{type:"submit",className:"px-6 py-2 rounded-lg text-sm font-semibold text-white bg-orange-500/20 border border-orange-500/30 shadow-[0_2px_5px_rgba(249,115,22,0.45)] hover:shadow-[0_5px_10px_rgba(249,115,22,0.65)] hover:bg-orange-500/40 transition-all",disabled:_||!f.agent_name||!f.voice_id||(f.agent_type==="single_prompt"||f.agent_type==="custom_llm")&&!y&&!f.llm_id||!y&&!f.llm_id||y&&!f.new_llm_general_prompt.trim(),children:_?n.jsxs(n.Fragment,{children:[n.jsx(Mt,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Agent"})]})]})]})})}const hm={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_BASE_URL:"https://ai.research-hero.com",VITE_FACEBOOK_APP_ID:"1939628080270711",VITE_FACEBOOK_APP_SECRET:"9b4f0b6de06cf54cc1bcdd1c13c37995",VITE_FACEBOOK_REDIRECT_URI:"https://ai.research-hero.com/api/auth/facebook/callback",VITE_FRONTEND_URL:"https://aiagent.research-hero.com",VITE_GMAIL_CLIENT_ID:"686955346191-el9qo3bhbgfo7fk4juanq8bq7g7iis7d.apps.googleusercontent.com",VITE_GMAIL_REDIRECT_URI:"https://ai.research-hero.com/api/gmail/auth/callback",VITE_GOOGLE_MAPS_API_KEY:"YOUR_ACTUAL_API_KEY_HERE",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_51S8GFm2MMm3Fy1PB45KAluHAtFTOmAY9qKUE4sITR1TA1zfX97ON36OAcAALplq6LbLgqXaTyY0hRB7ae55LzpBQ00DfkbC8oy",VITE_VAPI_BASE_URL:"https://api.vapi.ai",VITE_VAPI_PUBLIC_KEY:"eb3b26e3-7dbb-4fd6-a545-a954756a43aa"},Cm=()=>{var bt,Lt,_t;ou();const[s,e]=Q.useState(""),[t,r]=Q.useState(null),[a,i]=Q.useState(null),[l,c]=Q.useState(!1),[d,m]=Q.useState(!1),[v,_]=Q.useState(!1),[N,E]=Q.useState(!1),[j,y]=Q.useState(!1),[S,C]=Q.useState(!1),[T,f]=Q.useState(!1),[L,I]=Q.useState(!1),[O,Z]=Q.useState(!1),[K,ae]=Q.useState(null),[A,G]=Q.useState(null),[x,R]=Q.useState(!1),[q,Ee]=Q.useState(null),[$e,z]=Q.useState(new Set);console.log("🔍 Environment Debug:"),console.log("- VITE_VAPI_PUBLIC_KEY:",`${"eb3b26e3-7dbb-4fd6-a545-a954756a43aa".substring(0,8)}...`),console.log("- All env vars:",hm);const[Pt,b]=Q.useState({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"office",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"vapi",voiceId:"Cole",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),Te=qc(),{user:be}=Zc(),{data:Fe,isLoading:o}=er({queryKey:["syncedAgents",be==null?void 0:be.id,s],queryFn:()=>Jc(s),staleTime:0,refetchInterval:1e3,gcTime:5*60*1e3,enabled:!!(be!=null&&be.id),placeholderData:w=>w,retry:(w,F)=>{var $;return[404,204,402].includes(($=F==null?void 0:F.response)==null?void 0:$.status)?!1:w<2}}),{data:h}=er({queryKey:["retellAgents"],queryFn:Gc,staleTime:0,refetchInterval:1e3}),u=Uc.useMemo(()=>{const w=(Fe==null?void 0:Fe.data)||[],F=(h==null?void 0:h.data)||[],se=Array.isArray(F)?F.map($=>({id:$.agent_id,name:$.agent_name||"Unnamed Retell Agent",firstMessage:"Retell Agent (Details not loaded)",model:{provider:"retell",model:$.llm_id||"Unknown"},voice:{provider:"retell",voiceId:$.voice_id||"Unknown"},transcriber:{provider:"retell"},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),isRetell:!0})):[];return[...w,...se]},[Fe,h]);Sr({mutationFn:zc,onSuccess:w=>{console.log("✅ Assistant created successfully:",w),H.success(`Assistant "${Pt.name}" created successfully!`),_(!1),b({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"office",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"11labs",voiceId:"21m00Tcm4TlvDq8ikWAM",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),Te.invalidateQueries({queryKey:["syncedAgents"]}),Te.invalidateQueries({queryKey:["agents"]})},onError:w=>{var se,$,ie,oe,he,ce;console.error("❌ Error creating assistant:",w);let F="Failed to create assistant";($=(se=w.response)==null?void 0:se.data)!=null&&$.message?F=w.response.data.message:(oe=(ie=w.response)==null?void 0:ie.data)!=null&&oe.error?F=w.response.data.error:w.message&&(F=w.message),H.error(`Creation failed: ${F}`),console.error("Detailed error:",{status:(he=w.response)==null?void 0:he.status,data:(ce=w.response)==null?void 0:ce.data,message:w.message})}});const p=Sr({mutationFn:({id:w,data:F})=>Hc(w,F),onSuccess:(w,F)=>{console.log("✅ Assistant updated successfully:",w);const se=Object.keys(F.data)[0];H.success(`${se} updated successfully`),Te.invalidateQueries({queryKey:["syncedAgents",be==null?void 0:be.id]}),t&&D(t.id)},onError:(w,F)=>{var ie,oe,he,ce,Ce,xt;console.error("❌ Error updating assistant:",w);let se="Failed to update assistant";(oe=(ie=w.response)==null?void 0:ie.data)!=null&&oe.message?se=w.response.data.message:(ce=(he=w.response)==null?void 0:he.data)!=null&&ce.error?se=w.response.data.error:w.message&&(se=w.message);const $=Object.keys(F.data)[0];H.error(`Failed to update ${$}: ${se}`),console.error("Update error details:",{field:$,value:F.data[$],status:(Ce=w.response)==null?void 0:Ce.status,data:(xt=w.response)==null?void 0:xt.data,message:w.message})}}),g=Sr({mutationFn:({id:w,isRetell:F})=>F?Kc(w):Qc(w),onSuccess:w=>{console.log("✅ Delete success:",w),H.success(`Assistant "${q==null?void 0:q.name}" deleted successfully!`),R(!1),Ee(null),t&&q&&t.id===q.id&&(r(null),i(null)),Te.invalidateQueries({queryKey:["syncedAgents",be==null?void 0:be.id]})},onError:w=>{var $,ie,oe,he,ce,Ce;console.error("❌ Error deleting assistant:",w);let F="Unknown error occurred";(ie=($=w.response)==null?void 0:$.data)!=null&&ie.message?F=w.response.data.message:(he=(oe=w.response)==null?void 0:oe.data)!=null&&he.error?F=w.response.data.error:w.message&&(F=w.message);const se=(q==null?void 0:q.name)||"Assistant";H.error(`Failed to delete ${se}: ${F}`),console.error("Delete error details:",{assistantId:q==null?void 0:q.id,assistantName:q==null?void 0:q.name,status:(ce=w.response)==null?void 0:ce.status,data:(Ce=w.response)==null?void 0:Ce.data,message:w.message})}}),k=(be==null?void 0:be.isSuperAdmin)||!1,P=(Fe==null?void 0:Fe.total)||u.length;Q.useEffect(()=>{if(u.length>0){console.log("🔍 Agent data structure (first agent):",u[0]),console.log("🔍 Total agents loaded:",u.length),console.log("👑 Pagination disabled (Super Admin):",k),console.log("📊 Total assistants available:",P);const w=new Set;u.forEach((F,se)=>{((F.assistant_data||{}).metadata||{}).published===!0&&w.add(String(F.id)),se<3&&console.log(`🔍 Agent ${se+1}:`,{name:F.name,localId:F.id,assistantId:F.assistant_id,hasAssistantId:!!F.assistant_id,structure:Object.keys(F)})}),z(w),console.log("📊 Initialized published agents from metadata:",Array.from(w))}},[u]),Q.useEffect(()=>{if(t&&t.id){const w=t.assistant_id||t.id;D(w,t.isRetell)}},[t]);const D=async(w,F=!1)=>{var se,$,ie,oe,he,ce,Ce,xt,ms,Vn,Un,qn,Bn,$n,Jn,Gn,zn,Yn,Wn,Hn,Kn,Qn,Xn,Zn,ea,ta,sa,ra,na,aa,ia,oa,la,ca,ua,da,ha;c(!0);try{const wt=String(w);if(F){console.log("🔍 Fetching complete Retell details for agent:",wt);const Dt=await Yc(wt);console.log("📋 Complete Retell agent details:",Dt),i(Dt.data||Dt)}else{console.log("🔍 Fetching complete VAPI details for agent:",wt);const Dt=await Wc(wt);console.log("📋 Complete VAPI agent details:",Dt);const B=Dt.data||Dt;i({name:B.name||(t==null?void 0:t.name),firstMessage:B.firstMessage||(t==null?void 0:t.firstMessage),firstMessageMode:B.firstMessageMode||"assistant-speaks-first",firstMessageInterruptionsEnabled:B.firstMessageInterruptionsEnabled||!1,model:{provider:((se=B.model)==null?void 0:se.provider)||"openai",model:(($=B.model)==null?void 0:$.model)||"gpt-4",temperature:((ie=B.model)==null?void 0:ie.temperature)||.7,maxTokens:((oe=B.model)==null?void 0:oe.maxTokens)||1e3,numFastTurns:((he=B.model)==null?void 0:he.numFastTurns)||0,messages:((ce=B.model)==null?void 0:ce.messages)||[],tools:((Ce=B.model)==null?void 0:Ce.tools)||[],toolIds:((xt=B.model)==null?void 0:xt.toolIds)||[],knowledgeBase:(ms=B.model)==null?void 0:ms.knowledgeBase,knowledgeBaseId:(Vn=B.model)==null?void 0:Vn.knowledgeBaseId,emotionRecognitionEnabled:((Un=B.model)==null?void 0:Un.emotionRecognitionEnabled)||!1,thinking:((qn=B.model)==null?void 0:qn.thinking)||{type:"disabled"}},voice:{provider:((Bn=B.voice)==null?void 0:Bn.provider)||"11labs",voiceId:(($n=B.voice)==null?void 0:$n.voiceId)||"21m00Tcm4TlvDq8ikWAM",speed:((Jn=B.voice)==null?void 0:Jn.speed)||1,stability:(Gn=B.voice)==null?void 0:Gn.stability,similarityBoost:(zn=B.voice)==null?void 0:zn.similarityBoost,cachingEnabled:((Yn=B.voice)==null?void 0:Yn.cachingEnabled)||!1,chunkPlan:((Wn=B.voice)==null?void 0:Wn.chunkPlan)||{enabled:!1},fallbackPlan:(Hn=B.voice)==null?void 0:Hn.fallbackPlan},transcriber:{provider:((Kn=B.transcriber)==null?void 0:Kn.provider)||"deepgram",model:((Qn=B.transcriber)==null?void 0:Qn.model)||"nova-2",language:((Xn=B.transcriber)==null?void 0:Xn.language)||"en",confidenceThreshold:((Zn=B.transcriber)==null?void 0:Zn.confidenceThreshold)||.4,endOfTurnConfidenceThreshold:((ea=B.transcriber)==null?void 0:ea.endOfTurnConfidenceThreshold)||.7,minEndOfTurnSilenceWhenConfident:((ta=B.transcriber)==null?void 0:ta.minEndOfTurnSilenceWhenConfident)||160,maxTurnSilence:((sa=B.transcriber)==null?void 0:sa.maxTurnSilence)||400,wordFinalizationMaxWaitTime:((ra=B.transcriber)==null?void 0:ra.wordFinalizationMaxWaitTime)||160,enableUniversalStreamingApi:((na=B.transcriber)==null?void 0:na.enableUniversalStreamingApi)||!1,formatTurns:((aa=B.transcriber)==null?void 0:aa.formatTurns)||!1,disablePartialTranscripts:((ia=B.transcriber)==null?void 0:ia.disablePartialTranscripts)||!1,keywords:((oa=B.transcriber)==null?void 0:oa.keywords)||[],wordBoost:((la=B.transcriber)==null?void 0:la.wordBoost)||[]},systemMessage:((da=(ua=(ca=B.model)==null?void 0:ca.messages)==null?void 0:ua[0])==null?void 0:da.content)||B.systemMessage||"You are a helpful AI assistant.",endCallMessage:B.endCallMessage,voicemailMessage:B.voicemailMessage,endCallPhrases:B.endCallPhrases||[],functions:B.functions||[],tools:B.tools||[],customFunctions:B.customFunctions,variableValues:B.variableValues,maxDurationSeconds:B.maxDurationSeconds||600,backgroundSound:B.backgroundSound||"off",modelOutputInMessagesEnabled:B.modelOutputInMessagesEnabled||!1,backgroundDenoisingEnabled:B.backgroundDenoisingEnabled||!1,clientMessages:B.clientMessages,serverMessages:B.serverMessages,transportConfigurations:B.transportConfigurations||[],server:B.server,observabilityPlan:B.observabilityPlan,startSpeakingPlan:B.startSpeakingPlan,stopSpeakingPlan:B.stopSpeakingPlan,credentialIds:B.credentialIds||[],metadata:B.metadata||{},createdAt:B.createdAt,updatedAt:B.updatedAt,_rawVapiData:B})}}catch(wt){console.error("Error loading agent details:",wt),console.error("Error details:",((ha=wt.response)==null?void 0:ha.data)||wt.message),i({model:{provider:"OpenAI",model:"GPT-4"},voice:{provider:"11Labs",voiceId:"Default Voice"},transcriber:{provider:"Deepgram"},systemMessage:"You are a helpful AI assistant."})}finally{c(!1)}},V=w=>w?w.split(" ").map(F=>F.charAt(0)).join("").toUpperCase().substring(0,2):"NA",te=w=>{var F,se,$,ie,oe,he,ce,Ce,xt,ms;console.log("🎯 Template selected:",w),b({name:w.name||"",firstMessage:w.first_message||"",systemMessage:w.system_message||"You are a helpful AI assistant.",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:w.end_call_message||"",voicemailMessage:"",endCallPhrases:w.end_call_phrases||[],maxDurationSeconds:w.max_duration_seconds||600,backgroundSound:w.background_sound||"off",model:{provider:((F=w.model)==null?void 0:F.provider)||"openai",model:((se=w.model)==null?void 0:se.model)||"gpt-4",temperature:(($=w.model)==null?void 0:$.temperature)||.7,maxTokens:((ie=w.model)==null?void 0:ie.maxTokens)||1e3,numFastTurns:((oe=w.model)==null?void 0:oe.numFastTurns)||0},voice:{provider:((he=w.voice)==null?void 0:he.provider)||"vapi",voiceId:((ce=w.voice)==null?void 0:ce.voiceId)||"Cole",speed:((Ce=w.voice)==null?void 0:Ce.speed)||1},transcriber:{provider:((xt=w.transcriber)==null?void 0:xt.provider)||"deepgram",model:"nova-2",language:((ms=w.transcriber)==null?void 0:ms.language)||"en"}}),_(!0)},re=w=>{if(w==="retell"){y(!0);return}b({name:"",firstMessage:"",systemMessage:"",firstMessageMode:"assistant-speaks-first",firstMessageInterruptionsEnabled:!1,endCallMessage:"",voicemailMessage:"",endCallPhrases:[],maxDurationSeconds:600,backgroundSound:"off",model:{provider:"openai",model:"gpt-4",temperature:.7,maxTokens:1e3,numFastTurns:0},voice:{provider:"11labs",voiceId:"21m00Tcm4TlvDq8ikWAM",speed:1},transcriber:{provider:"deepgram",model:"nova-2",language:"en"}}),_(!0)},Je=(w,F)=>{if(!w)return"";const se=w.toLowerCase().trim();return(F==="model"?{openai:"openai","open-ai":"openai",anthropic:"anthropic",groq:"groq",together:"together",anyscale:"anyscale"}:{"11labs":"11labs",elevenlabs:"11labs","eleven-labs":"11labs",openai:"openai","open-ai":"openai",azure:"azure",playht:"playht","play-ht":"playht",deepgram:"deepgram",cartesia:"cartesia",lmnt:"lmnt"})[se]||se},at=(w,F)=>{if(!t){console.warn("No selected agent for field update");return}console.log("🔄 Field update:",w,"Value:",F,"Type:",typeof F,"Agent ID:",t.id),A&&clearTimeout(A),i($=>{const ie={...$};if(w.includes(".")){const[oe,he]=w.split(".");if(ie[oe]={...ie[oe],[he]:F},w==="model.provider"){const ce=ja(F);ce&&(ie.model.model=ce,console.log("🤖 Auto-selected model:",ce,"for provider:",F))}else if(w==="voice.provider"){const ce=ka(F);ce&&(ie.voice.voiceId=ce,console.log("🎤 Auto-selected voice:",ce,"for provider:",F))}else if(w==="transcriber.provider"){const ce=Ca(F);ce&&(ie.transcriber.model=ce,console.log("📝 Auto-selected transcriber model:",ce,"for provider:",F))}}else ie[w]=F;return ie});const se=setTimeout(()=>{const $={},ie=["status","published","publishedAt","systemMessage"];if(w.includes(".")){const[he,ce]=w.split(".");if(ie.includes(he)||ie.includes(ce)){console.log("⚠️ Skipping VAPI update for local-only field:",w);return}if($[he]={...a[he],[ce]:F},w==="model.provider"){const Ce=ja(F);Ce&&($.model.model=Ce)}else if(w==="voice.provider"){const Ce=ka(F);Ce&&($.voice.voiceId=Ce)}else if(w==="transcriber.provider"){const Ce=Ca(F);Ce&&($.transcriber.model=Ce)}}else{if(ie.includes(w)){console.log("⚠️ Skipping VAPI update for local-only field:",w);return}$[w]=F}console.log("🔄 Auto-saving field:",w,"with value:",F,"updateData:",$);const oe=t.assistant_id||t.id;console.log("🔍 Using assistant ID for VAPI:",oe,"Type:",typeof oe),p.mutate({id:String(oe),data:$})},1e3);G(se)},yt=w=>{if(!t){console.warn("No selected agent for system message update");return}console.log("🔄 System message update:",w),A&&clearTimeout(A),i(se=>{const $={...se};return $.systemMessage=w,$.model||($.model={}),$.model.messages||($.model.messages=[]),$.model.messages.length===0?$.model.messages.push({role:"system",content:w}):$.model.messages[0].role==="system"?$.model.messages[0].content=w:$.model.messages.unshift({role:"system",content:w}),$});const F=setTimeout(()=>{var he;const $=[...((he=a==null?void 0:a.model)==null?void 0:he.messages)||[]];$.length===0?$.push({role:"system",content:w}):$[0].role==="system"?$[0].content=w:$.unshift({role:"system",content:w});const ie={model:{...a==null?void 0:a.model,messages:$}};console.log("🔄 Auto-saving system message via model.messages:",ie);const oe=t.assistant_id||t.id;console.log("🔍 Using assistant ID for system message update:",oe),p.mutate({id:String(oe),data:ie})},1e3);G(F)};Q.useEffect(()=>()=>{A&&clearTimeout(A)},[A]);const ke=w=>{Ee(w),R(!0)},Be=()=>{if(q){const w=q.isRetell,F=q.assistant_id||q.agent_id||q.id;console.log(`🗑️ Deleting ${w?"Retell":"VAPI"} agent:`,q.id,"Using ID:",F),g.mutate({id:String(F),isRetell:w})}else H.error("No agent selected for deletion")},it=async w=>{var $,ie;if(!w||!w.id)return;const F=String(w.id),se=$e.has(F);try{console.log(`🔄 ${se?"Unpublishing":"Publishing"} agent:`,w.name);const oe={metadata:{...a==null?void 0:a.metadata,published:!se,publishedAt:se?null:new Date().toISOString()}},he=w.assistant_id||w.id;console.log("🔍 Using assistant ID for VAPI publish:",he,"Type:",typeof he),await p.mutateAsync({id:String(he),data:oe});const ce=new Set($e);se?(ce.delete(F),H.success(`${w.name} unpublished successfully`)):(ce.add(F),H.success(`${w.name} published successfully`)),z(ce),t&&t.id===w.id&&i(Ce=>({...Ce,metadata:oe.metadata}))}catch(oe){console.error("❌ Error toggling publish status:",oe);let he="Failed to update publish status";(ie=($=oe.response)==null?void 0:$.data)!=null&&ie.message?he=oe.response.data.message:oe.message&&(he=oe.message),H.error(`Failed to ${se?"unpublish":"publish"} ${w.name}: ${he}`)}};return n.jsxs("div",{className:"app-shell-bg flex flex-col h-screen text-white overflow-hidden",children:[n.jsx("div",{className:"flex-1 p-8 overflow-y-auto neon-fire-scroll",children:n.jsxs("div",{className:"max-w-full mx-auto space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between pb-6 border-b border-white/10",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-white/60",children:"Agents"}),n.jsx("p",{className:"text-white/50 text-sm mt-1",children:"Manage and configure your AI voice agents"})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"relative w-72",children:[n.jsx(xo,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-white/40"}),n.jsx(ye,{className:"bg-white/5 border-white/10 text-white pl-10 h-10",placeholder:"Search assistants...",value:s,onChange:w=>e(w.target.value)})]}),n.jsxs("button",{className:"px-5 py-2 rounded-lg text-sm font-semibold text-white bg-[linear-gradient(180deg,rgba(90,110,255,0.45),rgba(36,46,151,0.35))] border border-white/15 hover:shadow-[0_5px_10px_rgba(90,110,255,0.65)] hover:bg-[linear-gradient(180deg,rgba(90,110,255,0.6),rgba(36,46,151,0.45))] transition-all flex items-center gap-2",onClick:()=>E(!0),children:[n.jsx(_o,{className:"h-4 w-4"}),"Create Assistant"]})]})]}),n.jsx("div",{className:"neo-card p-1 overflow-hidden border-white/10 bg-[#0b0f2e]/50 backdrop-blur-xl rounded-xl",children:n.jsxs(eu,{children:[n.jsx(tu,{className:"bg-white/5",children:n.jsxs(Ms,{className:"border-white/10 hover:bg-transparent",children:[n.jsx(Is,{className:"text-white/70 font-semibold h-12",children:"Agent ID"}),n.jsx(Is,{className:"text-white/70 font-semibold h-12",children:"Agent"}),n.jsx(Is,{className:"text-white/70 font-semibold h-12",children:"Provider"}),n.jsx(Is,{className:"text-white/70 font-semibold h-12 text-right",children:"Actions"})]})}),n.jsx(su,{children:o?n.jsx(Ms,{children:n.jsx(Kt,{colSpan:5,className:"h-32 text-center",children:n.jsx(Mt,{className:"h-6 w-6 animate-spin text-white/20 mx-auto"})})}):u.filter(w=>(w==null?void 0:w.id)&&(w==null?void 0:w.name)).length===0?n.jsx(Ms,{children:n.jsx(Kt,{colSpan:5,className:"h-48 text-center",children:n.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2 opacity-30",children:[n.jsx(ut,{className:"h-12 w-12"}),n.jsx("p",{children:"No assistants found"})]})})}):u.filter(w=>(w==null?void 0:w.id)&&(w==null?void 0:w.name)).map(w=>n.jsxs(Ms,{className:"border-white/5 hover:bg-white/5 transition-colors group",children:[n.jsxs(Kt,{className:"text-white/80 font-mono text-xs",children:[String(w.assistant_id||w.id).substring(0,18),"..."]}),n.jsx(Kt,{className:"py-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(tr,{className:"h-10 w-10 ring-2 ring-white/10 transition-transform group-hover:scale-105",children:n.jsx(sr,{className:"bg-gradient-to-br from-indigo-500 to-green-500 text-indigo-100 font-medium",children:V(w.name)})}),n.jsx("div",{className:"font-medium text-white",children:w.name})]})}),n.jsx(Kt,{children:n.jsx(Nt,{variant:"outline",className:`capitalize font-normal ${w.isRetell?"border-orange-500/30 text-orange-400 bg-orange-500/5":"border-blue-500/30 text-blue-400 bg-blue-500/5"}`,children:w.isRetell?"Retell":"Vapi"})}),n.jsx(Kt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(je,{variant:"ghost",size:"icon",className:"h-8 w-8 text-white/30 text-orange-400 hover:text-white hover:bg-white/10",onClick:()=>{r(w),f(!0)},title:"View Details",children:n.jsx(Rc,{className:"h-4 w-4"})}),n.jsx(je,{variant:"ghost",size:"icon",className:"h-8 w-8 text-cyan-400 hover:text-blue-400 hover:bg-blue-400/10",onClick:()=>{r(w),I(!0)},title:"Edit Agent",children:n.jsx(fa,{className:"h-4 w-4"})}),n.jsx(je,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-400 hover:bg-red-400/10",onClick:()=>ke(w),title:"Delete Agent",children:n.jsx($r,{className:"h-4 w-4"})})]})})]},w.id))})]})})]})}),n.jsx(Zt,{open:T,onOpenChange:w=>{f(w),w||(r(null),i(null))},children:n.jsxs(es,{className:"bg-[#0b0f2e] border-white/10 text-white sm:max-w-[1200px] max-h-[95vh] overflow-y-auto neon-fire-scroll p-0",children:[n.jsx(ts,{className:"sr-only",children:n.jsx(ss,{children:"Agent Details"})}),t&&(t.isRetell?n.jsx(lu,{agent:t,details:a,isLoading:l,onEdit:()=>{f(!1),I(!0)},getInitials:V}):n.jsx(Ea,{agent:t,details:a,isLoading:l,onUpdateField:at,onUpdateSystemMessage:yt,onDelete:ke,onPublishToggle:it,isPublished:$e.has(String(t.id)),isSaving:p.isPending,onTalkToAssistant:()=>m(!0),MODEL_PROVIDERS:Sa,VOICE_PROVIDERS:wa,TRANSCRIBER_PROVIDERS:xa,getProviderModels:_a,getProviderVoices:ba,getTranscriberModels:ya,normalizeProviderValue:Je,getInitials:V}))]})}),t&&t.isRetell?n.jsx(cu,{isOpen:L,onClose:()=>I(!1),onSuccess:()=>{Te.invalidateQueries({queryKey:["syncedAgents"]}),D(t.id,!0)},agentId:t.agent_id||t.id,initialData:a}):n.jsx(Zt,{open:L,onOpenChange:I,children:n.jsxs(es,{className:"bg-[#0b0f2e] border-white/10 text-white sm:max-w-[1200px] max-h-[95vh] overflow-y-auto neon-fire-scroll p-0",children:[n.jsx(ts,{className:"p-6 pb-0",children:n.jsxs(ss,{className:"text-xl font-bold flex items-center gap-2",children:[n.jsx(fa,{className:"h-5 w-5 text-indigo-400"}),"Update Vapi Assistant"]})}),t&&n.jsx(Ea,{agent:t,details:a,isLoading:l,onUpdateField:at,onUpdateSystemMessage:yt,onDelete:ke,onPublishToggle:it,isPublished:$e.has(String(t.id)),isSaving:p.isPending,onTalkToAssistant:()=>m(!0),MODEL_PROVIDERS:Sa,VOICE_PROVIDERS:wa,TRANSCRIBER_PROVIDERS:xa,getProviderModels:_a,getProviderVoices:ba,getTranscriberModels:ya,normalizeProviderValue:Je,getInitials:V})]})}),n.jsx(Zt,{open:x,onOpenChange:R,children:n.jsxs(es,{className:"bg-[#0b0f2e] border-white/10 w-[500px] text-white sm:max-w-[425px]",children:[n.jsx(ts,{children:n.jsxs(ss,{className:"flex items-center gap-2 text-red-400",children:[n.jsx(ga,{className:"h-5 w-5"}),"Delete Assistant"]})}),n.jsx("div",{className:"py-4",children:n.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-red-500/10 rounded-lg border border-red-400/30",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx(ga,{className:"h-8 w-8 text-red-400"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-sm font-medium text-red-300",children:"Are you sure you want to delete this assistant?"}),n.jsxs("div",{className:"mt-2 text-sm text-red-200/80",children:[n.jsxs("p",{children:[n.jsx("strong",{children:q==null?void 0:q.name})," will be permanently deleted from both the provider and your database. This action cannot be undone."]}),n.jsxs("div",{className:"mt-2 text-xs text-red-300/70",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Agent ID:"})," ",q==null?void 0:q.id]}),(q==null?void 0:q.assistant_id)&&n.jsxs("p",{children:[n.jsx("strong",{children:"Provider Assistant ID:"})," ",q.assistant_id]})]})]})]})]})}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx(je,{variant:"outline",onClick:()=>R(!1),disabled:g.isPending,className:"border-white/20 text-white/70 bg-white/10 hover:bg-white/10 hover:text-white",children:"Cancel"}),n.jsx(je,{variant:"destructive",onClick:Be,disabled:g.isPending,className:"bg-red-600 hover:bg-red-700",children:g.isPending?n.jsxs(n.Fragment,{children:[n.jsx(Mt,{className:"h-4 w-4 mr-2 animate-spin"}),"Deleting..."]}):n.jsxs(n.Fragment,{children:[n.jsx($r,{className:"h-4 w-4 mr-2"}),"Delete Assistant"]})})]})]})}),d&&n.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[n.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:()=>m(!1)}),n.jsxs("div",{className:"ml-auto relative bg-[#0b0f2e] w-1/2 h-full shadow-2xl border-l border-white/10 transform transition-transform duration-300 ease-in-out",children:[n.jsx("div",{className:"bg-[#0b0f2e] border-b border-white/10 p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(tr,{className:"h-10 w-10 ring-2 ring-white/10",children:n.jsx(sr,{className:"text-white bg-gradient-to-br from-indigo-500/30 to-purple-500/30 font-medium",children:V((t==null?void 0:t.name)||"")})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-white",children:t==null?void 0:t.name}),n.jsx("p",{className:"text-white/50 text-sm",children:"AI Voice Assistant"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{id:"call-button-container",className:"min-w-[100px] min-h-[40px] bg-red-500/20 border border-red-400/30 rounded flex items-center justify-center"}),n.jsx(je,{variant:"ghost",size:"sm",onClick:()=>m(!1),className:"text-white/40 hover:text-white hover:bg-white/10 h-8 w-8 p-0 rounded-full",children:"×"})]})]})}),n.jsx("div",{className:"flex flex-col h-[calc(100vh-80px)]",children:t&&n.jsx(Xh,{agentId:String(t.id),agentName:t.name||"Unknown Agent",agentConfig:{...a,assistant_id:t.assistant_id||(a==null?void 0:a.assistant_id),firstMessage:(a==null?void 0:a.firstMessage)||`Hello! I'm ${t.name}. How can I help you today?`,systemMessage:((_t=(Lt=(bt=a==null?void 0:a.model)==null?void 0:bt.messages)==null?void 0:Lt[0])==null?void 0:_t.content)||`You are ${t.name}, a helpful AI assistant.`},onCallStart:()=>{console.log("🎙️ Started call with assistant:",t.name),H.success(`Connected to ${t.name}`)},onCallEnd:()=>{console.log("🎙️ Ended call with assistant:",t.name),H.info("Call ended")},onError:w=>{console.error("🎙️ Call error:",w),H.error(`Call error: ${w.message}`)}})})]})]}),n.jsx(Zh,{open:N,onOpenChange:E,onTemplateSelect:te,onCreateCustom:re}),n.jsx(dm,{isOpen:j,onClose:()=>y(!1),onSuccess:()=>{Te.invalidateQueries({queryKey:["syncedAgents"]}),Te.invalidateQueries({queryKey:["agents"]})}})]})};export{Cm as default};
//# sourceMappingURL=VapiStyleAgents-Z3bBmxXB.js.map
